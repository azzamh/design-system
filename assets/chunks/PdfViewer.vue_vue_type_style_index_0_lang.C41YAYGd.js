const __vite__fileDeps=["assets/chunks/interact.min.BcNng0lq.js","assets/chunks/commonjsHelpers.BosuxZz1.js","assets/chunks/pdf.Cy8vACuD.js","assets/chunks/vite-browser-external_commonjs-proxy.Da-Vy3Nl.js","assets/chunks/pdf_viewer.BoFNEgCE.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{I as m,r as k,aI as ne,aG as de,a1 as W,$ as X,d as M,o as I,c as z,p as h,q as e,m as ee,ac as O,K as N,w as U,b as le,f as A,t as te,a as L,l as ae,z as B,ah as ue,aJ as G,aH as K,ax as he,am as fe,as as Y,n as pe,ak as J,T as ve}from"./framework.CUNsVCb6.js";import{v as re}from"./index.Qh0pDOb9.js";import{P as ge,c as we,d as ye,e as me,_ as xe,g as _e}from"./use-idle.BxoOGwKb.js";import{_ as be}from"./Heading.vue_vue_type_script_setup_true_lang.CHbLt-WQ.js";import"./Heading.vue_vue_type_style_index_0_lang.l0sNRNKZ.js";import{w as oe,a as ie}from"./theme.D91MAGl-.js";import{u as Pe}from"./use-loading.BalfyRZx.js";import{u as Q,a as De}from"./index.CkoVn9rD.js";const Ee=Symbol("DropzoneContext");function Se(t,l){const d=m(!0),o=m(),r=k(),u=k();async function f(){if(g(),t.value){const{default:w}=await X(()=>import("./interact.min.BcNng0lq.js").then(c=>c.i),__vite__mapDeps([0,1]));w.dynamicDrop(!0),o.value=w(l.value,{context:t.value}).dropzone({accept:".pdf-object",overlap:.95,enabled:d.value,checker(c,y,T,C,$,p,n){var v;return T&&(((v=t.value)==null?void 0:v.contains(n))||n.classList.contains("pdf-object--external"))},ondragenter(c){u.value=c.target,c.target.classList.add("hover")},ondragleave(c){c.target.classList.remove("hover")},ondrop(c){u.value=c.target,r.value=c.target,c.target.classList.remove("hover")}})}}function g(){o.value&&o.value.unset()}return ne(t,w=>{w.some(y=>y.type==="childList"&&y.target.matches(l.value))&&f()},{subtree:!0,childList:!0}),de(()=>{g()}),W(Ee,{dropzone:r,hoverzone:u}),d}const ke="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='595'%20height='842'%20aria-labelledby='loading-aria'%20preserveAspectRatio='none'%20role='img'%20viewBox='0%200%20595%20842'%3e%3ctitle%20id='loading-aria'%3eLoading...%3c/title%3e%3crect%20width='100%25'%20height='100%25'%20x='0'%20y='0'%20clip-path='url(%23clip-path)'%20style='fill:url(%23fill)'/%3e%3cdefs%3e%3cclipPath%20id='clip-path'%3e%3crect%20width='191'%20height='14'%20x='44'%20y='64'%20rx='2.068'/%3e%3crect%20width='140'%20height='14'%20x='44'%20y='94'%20rx='2.068'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='152'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='182'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='212'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='242'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='272'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='302'%20rx='7'/%3e%3crect%20width='349'%20height='14'%20x='44'%20y='332'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='390'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='420'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='450'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='480'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='510'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='540'%20rx='7'/%3e%3crect%20width='183'%20height='14'%20x='44'%20y='570'%20rx='7'/%3e%3crect%20width='191'%20height='14'%20x='360'%20y='628'%20rx='2.068'/%3e%3crect%20width='140'%20height='14'%20x='411'%20y='678'%20rx='2.068'/%3e%3crect%20width='191'%20height='14'%20x='44'%20y='64'%20rx='2.068'/%3e%3crect%20width='140'%20height='14'%20x='44'%20y='94'%20rx='2.068'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='152'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='182'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='212'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='242'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='272'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='302'%20rx='7'/%3e%3crect%20width='349'%20height='14'%20x='44'%20y='332'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='390'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='420'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='450'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='480'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='510'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='540'%20rx='7'/%3e%3crect%20width='183'%20height='14'%20x='44'%20y='570'%20rx='7'/%3e%3crect%20width='191'%20height='14'%20x='360'%20y='628'%20rx='2.068'/%3e%3crect%20width='140'%20height='14'%20x='411'%20y='678'%20rx='2.068'/%3e%3c/clipPath%3e%3clinearGradient%20id='fill'%3e%3cstop%20offset='.6'%20stop-color='%23E7E7E8'%20stop-opacity='1'%3e%3canimate%20attributeName='offset'%20dur='2s'%20keyTimes='0;%200.25;%201'%20repeatCount='indefinite'%20values='-2;%20-2;%201'/%3e%3c/stop%3e%3cstop%20offset='1.6'%20stop-color='%23CFCFD1'%20stop-opacity='1'%3e%3canimate%20attributeName='offset'%20dur='2s'%20keyTimes='0;%200.25;%201'%20repeatCount='indefinite'%20values='-1;%20-1;%202'/%3e%3c/stop%3e%3cstop%20offset='2.6'%20stop-color='%23E7E7E8'%20stop-opacity='1'%3e%3canimate%20attributeName='offset'%20dur='2s'%20keyTimes='0;%200.25;%201'%20repeatCount='indefinite'%20values='0;%200;%203'/%3e%3c/stop%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",Te={"data-testid":"pdf-loading",class:"pdf__loading"},Ce=["src"],Ne=M({__name:"PdfLoading",setup(t){return(l,d)=>(I(),z("div",Te,[h("img",{src:e(ke),width:"793",height:"1122"},null,8,Ce)]))}});let R,V;async function H(){if(!R){const t=await X(()=>import("./pdf.Cy8vACuD.js").then(l=>l.p),__vite__mapDeps([2,1,3]));typeof window<"u"&&"Worker"in window&&(t.GlobalWorkerOptions.workerSrc=oe(`pdfjs-dist@${t.version}/build/pdf.worker.min.js`,ie())),R=t}return R}async function Z(){return await H(),V||(V=await X(()=>import("./pdf_viewer.BoFNEgCE.js").then(t=>t.p),__vite__mapDeps([4,1]))),V}async function Le(...t){return await H(),R.getDocument(...t)}async function Ve(){return oe(`pdfjs-dist@${await se()}/cmaps/`,ie())}async function se(){return await H(),R.version}async function $e(){return await Z(),new V.EventBus}async function Oe(...t){return await Z(),new V.PDFViewer(...t)}async function Re(...t){return await Z(),new V.PDFLinkService(...t)}const je={"data-testid":"pdf-error",class:"pdf__error"},Be={class:"mt-7"},Me=h("dt",null,"URL:",-1),Ie={class:"truncate"},ze=["href"],Fe=h("dt",null," Reason: ",-1),Ae=h("dt",null," PDFJS Version: ",-1),Ge=M({__name:"PdfError",props:{url:{type:String,default:""},error:{type:Object,default:()=>({})}},setup(t){const l=k("");return ee(async()=>{l.value=await se()}),(d,o)=>O((I(),z("div",je,[N(be,{element:"h3"},{default:U(()=>[le(" Failed to load PDF ")]),_:1}),h("dl",Be,[Me,h("dd",Ie,[h("a",{href:t.url,target:"_blank"},[h("code",null,A(t.url),1)],8,ze)]),Fe,h("dd",null,[h("code",null,A(t.error.message),1)]),Ae,h("dd",null,[h("code",null,A(e(l)),1)])])])),[[e(re),1122/793]])}}),Je=M({__name:"PdfObjects",props:{dropTarget:{type:String,default:".pdfViewer > .page"}},setup(t){const l=t,d=new Map,o=k(),r=we(),u=te(l,"dropTarget");return Se(o,u),W(ge,{...r,objects:d,root:o}),(f,g)=>(I(),z("div",{ref_key:"root",ref:o,class:"pdf-objects","data-testid":"pdf-objects"},[L(f.$slots,"default")],512))}});function Ue(t,l){const d=m(),o=m(),r=m(),u=m(),f=m(),g=ae(()=>{var a,i;return(i=(a=d.value)==null?void 0:a.numPages)!=null?i:0}),w=Q(1,.1,2),c=Q(1,1,De(g,1)),y=Pe(),T=m(!1),C=m(),$=G(),p=G(),n=G();async function v(a,i,x={}){y.value=!0,C.value=void 0;try{await b(),a&&(u.value=await Le({url:a,password:i,cMapUrl:await Ve(),cMapPacked:!0,disableStream:x.disableStream,disableRange:x.disableRange}),d.value=await u.value.promise,r.value.setDocument(d.value),f.value.setDocument(d.value),$.trigger(d.value))}catch(_){_ instanceof Error&&(C.value=_,p.trigger(_))}finally{y.value=!1}}async function b(){var a,i;u.value&&!u.value.destroyed&&(await u.value.destroy(),d.value=void 0,u.value=void 0,(a=r.value)==null||a.setDocument(null),(i=f.value)==null||i.setDocument(null))}async function F(){if(typeof navigator<"u"&&t.value&&l.value){const a=await $e();a.on("pagesinit",()=>{var _,j;const i=(j=(_=l.value)==null?void 0:_.clientWidth)!=null?j:0,x=i>0&&i<793;r.value.currentScaleValue=x?"page-width":"1",r.value.currentPageNumber=c.value,T.value=!0,n.trigger(r.value)}),a.on("pagechanging",i=>{c.value=i.pageNumber}),a.on("scalechanging",i=>{w.value=i.scale}),o.value=a,f.value=await Re({eventBus:o.value}),r.value=await Oe({container:t.value,viewer:l.value,eventBus:o.value,linkService:f.value,removePageBorders:!0,annotationEditorMode:-1}),f.value.setViewer(r.value)}}return B([t,l],async([a,i])=>{r.value?a&&i&&(r.value.container=a,r.value.viewer=i,d.value&&r.value.setDocument(d.value),r.value.update()):await F()}),B(c,a=>{r.value&&a!==r.value.currentPageNumber&&(r.value.currentPageNumber=a)}),B(w,a=>{r.value&&a!==r.value.currentScale&&(r.value.currentScale=a)}),ue(async()=>{var a;await b(),(a=r.value)==null||a.cleanup()}),{page:c,scale:w,totalPage:g,loading:y,error:C,ready:T,openDoc:v,closeDoc:b,pdfDoc:d,pdfEventBus:o,pdfViewer:r,pdfLoadingTask:u,pdfLinkService:f,onLoaded:$.on,onError:p.on,onReady:n.on}}const We=["data-page","data-scale"],Xe={class:"pdf__header"},He={class:"pdf__footer"},rt=M({__name:"PdfViewer",props:{src:{type:String,default:""},page:{type:Number,default:1},scale:{type:Number,default:1},password:{type:String,default:void 0},layout:{type:String,default:"fixed"},ratio:{type:[Number,String],default:210/297},offsetTop:{type:[Number,String],default:0},config:{type:[Object],default:()=>({})}},emits:["ready","loaded","error","error-password","update:page","update:scale"],setup(t,{expose:l,emit:d}){const o=t,r=d,u=k(),f=k(),g=k(),w=ye(f),c=K(o,"page"),y=K(o,"scale"),T=he(te(o,"offsetTop"),{nanToZero:!0}),C=me(u,{offsetTop:T}),$=ae(()=>{const s=[];return o.layout&&s.push(`pdf-viewer--layout-${o.layout}`),s}),{page:p,scale:n,totalPage:v,openDoc:b,closeDoc:F,pdfDoc:a,loading:i,error:x,onLoaded:_,onError:j,onReady:ce}=Ue(f,g);fe(()=>[o.src,o.password],([s,q])=>{b(s,q,o.config)},{debounce:500}),B(()=>o.layout,s=>{C.value=s==="fit"},{immediate:!0}),ee(async()=>{o.src&&b(o.src,o.password,o.config)}),_(s=>{r("loaded",s)}),j(s=>{s.name==="PasswordException"&&r("error-password",s),r("error",s)}),ce(s=>{r("ready",s)});function P(){n.value=Math.round(n.value/.1)*.1+.1}function D(){n.value=Math.round(n.value/.1)*.1-.1}function E(){p.value++}function S(){p.value--}return W(_e,{page:p,scale:n,totalPage:v,zoomIn:P,zoomOut:D,next:E,prev:S}),Y(p,c),Y(n,y),l({page:p,scale:n,root:u,container:f,viewer:g,loading:i,totalPage:v,zoomIn:P,zoomOut:D,next:E,prev:S,openDoc:b,closeDoc:F}),(s,q)=>O((I(),z("div",{ref_key:"root",ref:u,"data-testid":"pdf-viewer",class:pe(["pdf",e($)]),"data-page":e(p),"data-scale":e(n)},[h("div",Xe,[L(s.$slots,"header",{page:e(p),scale:e(n),totalPage:e(v),zoomIn:P,zoomOut:D,next:E,prev:S,doc:e(a)})]),N(Je,{class:"pdf__wrapper"},{default:U(()=>[h("div",{ref_key:"container",ref:f,class:"pdf__container pdfContainer"},[O(N(Ne,null,null,512),[[J,e(i)||!t.src]]),O(N(Ge,{url:t.src,error:e(x)},null,8,["url","error"]),[[J,!e(i)&&e(x)]]),h("div",{ref_key:"viewer",ref:g,class:"pdf__viewer pdfViewer"},null,512),L(s.$slots,"default",{page:e(p),scale:e(n),totalPage:e(v),zoomIn:P,zoomOut:D,next:E,prev:S,doc:e(a)})],512),L(s.$slots,"container",{page:e(p),scale:e(n),totalPage:e(v),zoomIn:P,zoomOut:D,next:E,prev:S,doc:e(a)}),N(ve,{name:"slide-up"},{default:U(()=>[O(N(xe,null,null,512),[[J,!e(w)&&!e(i)&&!e(x)]])]),_:1}),L(s.$slots,"body",{page:e(p),scale:e(n),totalPage:e(v),zoomIn:P,zoomOut:D,next:E,prev:S,doc:e(a)})]),_:3}),h("div",He,[L(s.$slots,"footer",{page:e(p),scale:e(n),totalPage:e(v),zoomIn:P,zoomOut:D,next:E,prev:S,doc:e(a)})])],10,We)),[[e(re),t.layout==="fixed"?Number(t.ratio):0]])}});export{Ee as D,rt as _};
