var h=Object.defineProperty;var d=(n,e,t)=>e in n?h(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var r=(n,e,t)=>(d(n,typeof e!="symbol"?e+"":e,t),t);import{x as g,ab as q,ac as m,P as p,ad as o,a as l,N as v}from"./framework.0290506e.js";class w{constructor(){r(this,"queue");r(this,"running");this.queue=[],this.running=!1}enqueue(e){this.queue.push(e)}dequeue(){return this.queue.shift()}async add(e){return await new Promise((t,u)=>{const s={resolve:t,reject:u,run:e};this.enqueue(s),this.run()})}run(){if(this.queue.length>0&&!this.running){this.running=!0;const e=this.dequeue();e.run().then(e.resolve).catch(e.reject).finally(()=>{this.running=!1,this.run()})}}}let a,i;const f=new w;async function y(n,e){if(a||(a=g(new Map)),!i){const u=document.createElement("div"),s=q({name:"GlobalContainer",render:()=>[...a.value.values()].map(c=>m(c.component,{ref:c.ref}))});document.body.append(u),s.mount(u),u.id="global",i=s}let t=a.value.get(n);return t||(t={component:e,ref:p()},a.value.set(n,t),o(a),await l()),v(t.ref)}async function b(n){a&&i&&(a.value.delete(n),o(a),await l())}async function j(n){return await f.add(()=>y(n,n))}async function x(n){return await f.add(()=>b(n))}export{x as r,j as u};
