import{d as D,r as v,t as M,l as $,c as S,m as N,O as k,a as x,p,n as O,a4 as y,o as V,U as F}from"./framework.Co3D4XSo.js";import{u as H}from"./index.DFE7H4fl.js";import{t as A}from"./base64.CRVHLH2y.js";import{c as I}from"./index.BMhYW6jJ.js";function L(o,f){return o?f.filter(c=>{const t=String(c.name).toLowerCase(),i=String(c.type).toLowerCase();return o.split(",").some(u=>{const l=u.trim().toLowerCase();return l.charAt(0)==="."?t.endsWith(l):l.endsWith("/*")?i.replace(/\/.*$/,"")===l.replace(/\/.*$/,""):i===l})}):f}const P=["multiple","accept","disabled"],U=D({__name:"Dropzone",props:{modelValue:{type:[globalThis.File,Array,String],default:void 0},modelModifiers:{type:Object,default:()=>({})},multiple:{type:[Boolean,String],default:!1},maxlength:{type:[Number,String],default:void 0},accept:{type:String,default:""},clearOnCancel:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},emits:["update:modelValue","change","cancel"],setup(o,{expose:f,emit:c}){const t=o,i=c,s=H(t),u=v(),l=v(),b=I(M(t,"maxlength"),{method:"parseInt"}),d=v(!1),m=v(!1),B=$(()=>{const a=[];return d.value&&a.push("dropzone--dragover"),m.value&&a.push("dropzone--hover"),t.disabled&&a.push("dropzone--disabled"),t.readonly&&a.push("dropzone--readonly"),a});function h(){l.value.value="",l.value.click()}function g(){l.value.value="",u.value=void 0,s.value=void 0}function T(a){if(!t.disabled&&!t.readonly){const e=a.dataTransfer.files;d.value=!1,z(e)}}function w(a){const e=a.target,n=e.files;z(n),t.multiple==="append"&&F(()=>{e.value=""})}function C(a){return Array.isArray(a)?Promise.all(a.map(e=>A(e))):A(a)}async function z(a){if(a.length>0){const e=L(t.accept,Array.from(a)),n=t.multiple===!1?e.at(0):e;let r=n;t.multiple==="append"&&Array.isArray(s.value)&&(r=[...s.value,...r]),Number.isInteger(b.value)&&Array.isArray(r)&&(r=r.slice(0,b.value)),u.value=r,t.modelModifiers.base64&&(r=await C(n)),s.value=r,i("change",r)}else t.clearOnCancel&&g(),i("cancel")}return f({browse:h,clear:g,input:l}),(a,e)=>(V(),S("label",{class:O(["dropzone",p(B)]),"data-testid":"dropzone",onDrop:y(T,["prevent"]),onDragover:e[0]||(e[0]=y(()=>{},["prevent"])),onDragenter:e[1]||(e[1]=y(n=>d.value=!0,["prevent"])),onDragleave:e[2]||(e[2]=y(n=>d.value=!1,["prevent"])),onMouseover:e[3]||(e[3]=n=>m.value=!0),onMouseout:e[4]||(e[4]=n=>m.value=!1)},[N("input",k({ref_key:"input",ref:l,"data-testid":"dropzone-input",class:"dropzone__input",type:"file",multiple:o.multiple!==!1,accept:o.accept,disabled:o.disabled||o.readonly},a.$attrs,{onChange:w}),null,16,P),x(a.$slots,"default",{isDragover:p(d),isHovered:p(m),disabled:o.disabled,readonly:o.readonly,model:p(s),rawModel:p(u),browse:h,clear:g})],34))}});export{U as _};
