var en=Object.defineProperty;var sn=(z,e)=>(e=Symbol[z])?e:Symbol.for("Symbol."+z);var nn=(z,e,j)=>e in z?en(z,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):z[e]=j;var yt=(z,e,j)=>(nn(z,typeof e!="symbol"?e+"":e,j),j),Ne=(z,e,j)=>{if(!e.has(z))throw TypeError("Cannot "+j)};var t=(z,e,j)=>(Ne(z,e,"read from private field"),j?j.call(z):e.get(z)),B=(z,e,j)=>{if(e.has(z))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(z):e.set(z,j)},nt=(z,e,j,c)=>(Ne(z,e,"write to private field"),c?c.call(z,j):e.set(z,j),j);var ge=(z,e,j,c)=>({set _(p){nt(z,e,p,j)},get _(){return t(z,e,c)}}),V=(z,e,j)=>(Ne(z,e,"access private method"),j);var rn=function(z,e){this[0]=z,this[1]=e},ys=(z,e,j)=>{var c=(M,X,D,P)=>{try{var u=j[M](X),L=(X=u.value)instanceof rn,_=u.done;Promise.resolve(L?X[0]:X).then(d=>L?c(M==="return"?M:"next",X[1]?{done:d.done,value:d.value}:d,D,P):D({value:d,done:_})).catch(d=>c("throw",d,D,P))}catch(d){P(d)}},p=M=>k[M]=X=>new Promise((D,P)=>c(M,X,D,P)),k={};return j=j.apply(z,e),k[sn("asyncIterator")]=()=>k,p("next"),p("throw"),p("return"),k};import{g as getDefaultExportFromCjs}from"./commonjsHelpers.BosuxZz1.js";import{r as require$$0}from"./vite-browser-external_commonjs-proxy.Da-Vy3Nl.js";function _mergeNamespaces(z,e){for(var j=0;j<e.length;j++){const c=e[j];if(typeof c!="string"&&!Array.isArray(c)){for(const p in c)if(p!=="default"&&!(p in z)){const k=Object.getOwnPropertyDescriptor(c,p);k&&Object.defineProperty(z,p,k.get?k:{enumerable:!0,get:()=>c[p]})}}}return Object.freeze(Object.defineProperty(z,Symbol.toStringTag,{value:"Module"}))}function commonjsRequire(z){throw new Error('Could not dynamically require "'+z+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$2={exports:{}},fs={exports:{}},_classes={},proxy$1={exports:{}},proxy=proxy$1.exports,hasRequiredProxy;function requireProxy(){if(hasRequiredProxy)return proxy$1.exports;hasRequiredProxy=1,Object.defineProperty(proxy,"__esModule",{value:!0});const z=function(){};function e(j,c={}){z.prototype.name=j;const p={};return new Proxy(z,{get(k,M){return M==="caller"?null:M==="__createMock__"?e:M==="__unenv__"?!0:M in c?c[M]:p[M]=p[M]||e(`${j}.${M.toString()}`)},apply(k,M,X){return e(`${j}()`)},construct(k,M,X){return e(`[${j}]`)},enumerate(){return[]}})}return proxy$1.exports=e("mock"),proxy$1.exports}var hasRequired_classes;function require_classes(){if(hasRequired_classes)return _classes;hasRequired_classes=1,Object.defineProperty(_classes,"__esModule",{value:!0}),_classes.WriteStream=_classes.StatsFs=_classes.Stats=_classes.ReadStream=_classes.FileWriteStream=_classes.FileReadStream=_classes.Dirent=_classes.Dir=void 0;var z=e(requireProxy());function e(j){return j&&j.__esModule?j:{default:j}}return _classes.Dir=z.default.__createMock__("fs.Dir"),_classes.Dirent=z.default.__createMock__("fs.Dirent"),_classes.Stats=z.default.__createMock__("fs.Stats"),_classes.ReadStream=z.default.__createMock__("fs.ReadStream"),_classes.WriteStream=z.default.__createMock__("fs.WriteStream"),_classes.FileReadStream=z.default.__createMock__("fs.FileReadStream"),_classes.FileWriteStream=z.default.__createMock__("fs.FileWriteStream"),_classes.StatsFs=z.default.__createMock__("fs.StatsFs"),_classes}var _constants={},hasRequired_constants;function require_constants(){return hasRequired_constants||(hasRequired_constants=1,Object.defineProperty(_constants,"__esModule",{value:!0}),_constants.constants=_constants.X_OK=_constants.W_OK=_constants.R_OK=_constants.F_OK=void 0,_constants.F_OK=0,_constants.R_OK=4,_constants.W_OK=2,_constants.X_OK=1,_constants.constants=Object.create({UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4})),_constants}var _fs={},utils={},hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils;hasRequiredUtils=1,Object.defineProperty(utils,"__esModule",{value:!0}),utils.createNotImplementedError=j,utils.mergeFns=e,utils.notImplemented=c,utils.notImplementedClass=p,utils.rawHeaders=z;function z(k){const M=[];for(const X in k)if(Array.isArray(k[X]))for(const D of k[X])M.push(X,D);else M.push(X,k[X]);return M}function e(...k){return function(...M){for(const X of k)X(...M)}}function j(k){throw new Error(`[unenv] ${k} is not implemented yet!`)}function c(k){return Object.assign(()=>{throw j(k)},{__unenv__:!0})}function p(k){return class{constructor(){yt(this,"__unenv__",!0);throw new Error(`[unenv] ${k} is not implemented yet!`)}}}return utils}var _promises={exports:{}},hasRequired_promises;function require_promises(){return hasRequired_promises||(hasRequired_promises=1,function(z,e){Object.defineProperty(e,"__esModule",{value:!0}),e.chown=e.chmod=e.appendFile=e.access=void 0,Object.defineProperty(e,"constants",{enumerable:!0,get:function(){return c.constants}}),e.writeFile=e.watch=e.utimes=e.unlink=e.truncate=e.symlink=e.statfs=e.stat=e.rmdir=e.rm=e.rename=e.realpath=e.readlink=e.readdir=e.readFile=e.opendir=e.open=e.mkdtemp=e.mkdir=e.lutimes=e.lstat=e.link=e.lchown=e.lchmod=e.default=e.cp=e.copyFile=void 0;var j=requireUtils(),c=require_constants();e.access=(0,j.notImplemented)("fs.access"),e.copyFile=(0,j.notImplemented)("fs.copyFile"),e.cp=(0,j.notImplemented)("fs.cp"),e.open=(0,j.notImplemented)("fs.open"),e.opendir=(0,j.notImplemented)("fs.opendir"),e.rename=(0,j.notImplemented)("fs.rename"),e.truncate=(0,j.notImplemented)("fs.truncate"),e.rm=(0,j.notImplemented)("fs.rm"),e.rmdir=(0,j.notImplemented)("fs.rmdir"),e.mkdir=(0,j.notImplemented)("fs.mkdir"),e.readdir=(0,j.notImplemented)("fs.readdir"),e.readlink=(0,j.notImplemented)("fs.readlink"),e.symlink=(0,j.notImplemented)("fs.symlink"),e.lstat=(0,j.notImplemented)("fs.lstat"),e.stat=(0,j.notImplemented)("fs.stat"),e.link=(0,j.notImplemented)("fs.link"),e.unlink=(0,j.notImplemented)("fs.unlink"),e.chmod=(0,j.notImplemented)("fs.chmod"),e.lchmod=(0,j.notImplemented)("fs.lchmod"),e.lchown=(0,j.notImplemented)("fs.lchown"),e.chown=(0,j.notImplemented)("fs.chown"),e.utimes=(0,j.notImplemented)("fs.utimes"),e.lutimes=(0,j.notImplemented)("fs.lutimes"),e.realpath=(0,j.notImplemented)("fs.realpath"),e.mkdtemp=(0,j.notImplemented)("fs.mkdtemp"),e.writeFile=(0,j.notImplemented)("fs.writeFile"),e.appendFile=(0,j.notImplemented)("fs.appendFile"),e.readFile=(0,j.notImplemented)("fs.readFile"),e.watch=(0,j.notImplemented)("fs.watch"),e.statfs=(0,j.notImplemented)("fs.statfs"),z.exports={}}(_promises,_promises.exports)),_promises.exports}var hasRequired_fs;function require_fs(){if(hasRequired_fs)return _fs;hasRequired_fs=1,Object.defineProperty(_fs,"__esModule",{value:!0}),_fs.writevSync=_fs.writev=_fs.writeSync=_fs.writeFileSync=_fs.writeFile=_fs.write=_fs.watchFile=_fs.watch=_fs.utimesSync=_fs.utimes=_fs.unwatchFile=_fs.unlinkSync=_fs.unlink=_fs.truncateSync=_fs.truncate=_fs.symlinkSync=_fs.symlink=_fs.statfsSync=_fs.statfs=_fs.statSync=_fs.stat=_fs.rmdirSync=_fs.rmdir=_fs.rmSync=_fs.rm=_fs.renameSync=_fs.rename=_fs.realpathSync=_fs.realpath=_fs.readvSync=_fs.readv=_fs.readlinkSync=_fs.readlink=_fs.readdirSync=_fs.readdir=_fs.readSync=_fs.readFileSync=_fs.readFile=_fs.read=_fs.opendirSync=_fs.opendir=_fs.openSync=_fs.openAsBlob=_fs.open=_fs.mkdtempSync=_fs.mkdtemp=_fs.mkdirSync=_fs.mkdir=_fs.lutimesSync=_fs.lutimes=_fs.lstatSync=_fs.lstat=_fs.linkSync=_fs.link=_fs.lchownSync=_fs.lchown=_fs.lchmodSync=_fs.lchmod=_fs.futimesSync=_fs.futimes=_fs.ftruncateSync=_fs.ftruncate=_fs.fsyncSync=_fs.fsync=_fs.fstatSync=_fs.fstat=_fs.fdatasyncSync=_fs.fdatasync=_fs.fchownSync=_fs.fchown=_fs.fchmodSync=_fs.fchmod=_fs.existsSync=_fs.exists=_fs.createWriteStream=_fs.createReadStream=_fs.cpSync=_fs.cp=_fs.copyFileSync=_fs.copyFile=_fs.closeSync=_fs.close=_fs.chownSync=_fs.chown=_fs.chmodSync=_fs.chmod=_fs.appendFileSync=_fs.appendFile=_fs.accessSync=_fs.access=_fs._toUnixTimestamp=void 0;var z=requireUtils(),e=c(require_promises());function j(X){if(typeof WeakMap!="function")return null;var D=new WeakMap,P=new WeakMap;return(j=function(u){return u?P:D})(X)}function c(X,D){if(!D&&X&&X.__esModule)return X;if(X===null||typeof X!="object"&&typeof X!="function")return{default:X};var P=j(D);if(P&&P.has(X))return P.get(X);var u={__proto__:null},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _ in X)if(_!=="default"&&Object.prototype.hasOwnProperty.call(X,_)){var d=L?Object.getOwnPropertyDescriptor(X,_):null;d&&(d.get||d.set)?Object.defineProperty(u,_,d):u[_]=X[_]}return u.default=X,P&&P.set(X,u),u}function p(X){const D=(0,z.notImplemented)(X);return D.__promisify__=()=>(0,z.notImplemented)(X+".__promisify__"),D.native=D,D}function k(X){const D=function(...P){const u=P.pop();X().catch(L=>u(L)).then(L=>u(void 0,L))};return D.__promisify__=X,D.native=D,D}_fs.access=k(e.access),_fs.appendFile=k(e.appendFile),_fs.chown=k(e.chown),_fs.chmod=k(e.chmod),_fs.copyFile=k(e.copyFile),_fs.cp=k(e.cp),_fs.lchown=k(e.lchown),_fs.lchmod=k(e.lchmod),_fs.link=k(e.link),_fs.lstat=k(e.lstat),_fs.lutimes=k(e.lutimes),_fs.mkdir=k(e.mkdir),_fs.mkdtemp=k(e.mkdtemp),_fs.realpath=k(e.realpath),_fs.open=k(e.open),_fs.opendir=k(e.opendir),_fs.readdir=k(e.readdir),_fs.readFile=k(e.readFile),_fs.readlink=k(e.readlink),_fs.rename=k(e.rename),_fs.rm=k(e.rm),_fs.rmdir=k(e.rmdir),_fs.stat=k(e.stat),_fs.symlink=k(e.symlink),_fs.truncate=k(e.truncate),_fs.unlink=k(e.unlink),_fs.utimes=k(e.utimes),_fs.writeFile=k(e.writeFile),_fs.statfs=k(e.statfs),_fs.close=p("fs.close"),_fs.createReadStream=p("fs.createReadStream"),_fs.createWriteStream=p("fs.createWriteStream"),_fs.exists=p("fs.exists"),_fs.fchown=p("fs.fchown"),_fs.fchmod=p("fs.fchmod"),_fs.fdatasync=p("fs.fdatasync"),_fs.fstat=p("fs.fstat"),_fs.fsync=p("fs.fsync"),_fs.ftruncate=p("fs.ftruncate"),_fs.futimes=p("fs.futimes"),_fs.lstatSync=p("fs.lstatSync"),_fs.read=p("fs.read"),_fs.readv=p("fs.readv"),_fs.realpathSync=p("fs.realpathSync"),_fs.statSync=p("fs.statSync"),_fs.unwatchFile=p("fs.unwatchFile"),_fs.watch=p("fs.watch"),_fs.watchFile=p("fs.watchFile"),_fs.write=p("fs.write"),_fs.writev=p("fs.writev"),_fs._toUnixTimestamp=p("fs._toUnixTimestamp"),_fs.openAsBlob=p("fs.openAsBlob"),_fs.appendFileSync=(0,z.notImplemented)("fs.appendFileSync"),_fs.accessSync=(0,z.notImplemented)("fs.accessSync"),_fs.chownSync=(0,z.notImplemented)("fs.chownSync"),_fs.chmodSync=(0,z.notImplemented)("fs.chmodSync"),_fs.closeSync=(0,z.notImplemented)("fs.closeSync"),_fs.copyFileSync=(0,z.notImplemented)("fs.copyFileSync"),_fs.cpSync=(0,z.notImplemented)("fs.cpSync");const M=()=>!1;return _fs.existsSync=M,_fs.fchownSync=(0,z.notImplemented)("fs.fchownSync"),_fs.fchmodSync=(0,z.notImplemented)("fs.fchmodSync"),_fs.fdatasyncSync=(0,z.notImplemented)("fs.fdatasyncSync"),_fs.fstatSync=(0,z.notImplemented)("fs.fstatSync"),_fs.fsyncSync=(0,z.notImplemented)("fs.fsyncSync"),_fs.ftruncateSync=(0,z.notImplemented)("fs.ftruncateSync"),_fs.futimesSync=(0,z.notImplemented)("fs.futimesSync"),_fs.lchownSync=(0,z.notImplemented)("fs.lchownSync"),_fs.lchmodSync=(0,z.notImplemented)("fs.lchmodSync"),_fs.linkSync=(0,z.notImplemented)("fs.linkSync"),_fs.lutimesSync=(0,z.notImplemented)("fs.lutimesSync"),_fs.mkdirSync=(0,z.notImplemented)("fs.mkdirSync"),_fs.mkdtempSync=(0,z.notImplemented)("fs.mkdtempSync"),_fs.openSync=(0,z.notImplemented)("fs.openSync"),_fs.opendirSync=(0,z.notImplemented)("fs.opendirSync"),_fs.readdirSync=(0,z.notImplemented)("fs.readdirSync"),_fs.readSync=(0,z.notImplemented)("fs.readSync"),_fs.readvSync=(0,z.notImplemented)("fs.readvSync"),_fs.readFileSync=(0,z.notImplemented)("fs.readFileSync"),_fs.readlinkSync=(0,z.notImplemented)("fs.readlinkSync"),_fs.renameSync=(0,z.notImplemented)("fs.renameSync"),_fs.rmSync=(0,z.notImplemented)("fs.rmSync"),_fs.rmdirSync=(0,z.notImplemented)("fs.rmdirSync"),_fs.symlinkSync=(0,z.notImplemented)("fs.symlinkSync"),_fs.truncateSync=(0,z.notImplemented)("fs.truncateSync"),_fs.unlinkSync=(0,z.notImplemented)("fs.unlinkSync"),_fs.utimesSync=(0,z.notImplemented)("fs.utimesSync"),_fs.writeFileSync=(0,z.notImplemented)("fs.writeFileSync"),_fs.writeSync=(0,z.notImplemented)("fs.writeSync"),_fs.writevSync=(0,z.notImplemented)("fs.writevSync"),_fs.statfsSync=(0,z.notImplemented)("fs.statfsSync"),_fs}var hasRequiredFs;function requireFs(){return hasRequiredFs||(hasRequiredFs=1,function(z,e){Object.defineProperty(e,"__esModule",{value:!0});var j={promises:!0};e.promises=e.default=void 0;var c=D(require_classes());Object.keys(c).forEach(function(u){u==="default"||u==="__esModule"||Object.prototype.hasOwnProperty.call(j,u)||u in e&&e[u]===c[u]||Object.defineProperty(e,u,{enumerable:!0,get:function(){return c[u]}})});var p=D(require_constants());Object.keys(p).forEach(function(u){u==="default"||u==="__esModule"||Object.prototype.hasOwnProperty.call(j,u)||u in e&&e[u]===p[u]||Object.defineProperty(e,u,{enumerable:!0,get:function(){return p[u]}})});var k=D(require_fs());Object.keys(k).forEach(function(u){u==="default"||u==="__esModule"||Object.prototype.hasOwnProperty.call(j,u)||u in e&&e[u]===k[u]||Object.defineProperty(e,u,{enumerable:!0,get:function(){return k[u]}})});var M=D(require_promises());function X(u){if(typeof WeakMap!="function")return null;var L=new WeakMap,_=new WeakMap;return(X=function(d){return d?_:L})(u)}function D(u,L){if(!L&&u&&u.__esModule)return u;if(u===null||typeof u!="object"&&typeof u!="function")return{default:u};var _=X(L);if(_&&_.has(u))return _.get(u);var d={__proto__:null},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in u)if(b!=="default"&&Object.prototype.hasOwnProperty.call(u,b)){var g=m?Object.getOwnPropertyDescriptor(u,b):null;g&&(g.get||g.set)?Object.defineProperty(d,b,g):d[b]=u[b]}return d.default=u,_&&_.set(u,d),d}const P=e.promises=M;z.exports={...c,...p,...k,promises:P}}(fs,fs.exports)),fs.exports}var url={exports:{}},hasRequiredUrl;function requireUrl(){return hasRequiredUrl||(hasRequiredUrl=1,function(z,e){Object.defineProperty(e,"__esModule",{value:!0}),e.urlToHttpOptions=e.resolve=e.pathToFileURL=e.parse=e.format=e.fileURLToPath=e.domainToUnicode=e.domainToASCII=e.default=e.URLSearchParams=e.URL=void 0;const j=e.URL=globalThis.URL,c=e.URLSearchParams=globalThis.URLSearchParams,p=function(_,d,m){const b=new j(_);if(!d&&!m)return b;throw new Error("parseQueryString and slashesDenoteHost are unsupported")};e.parse=p;const k=function(_,d){const m=new j(d,new j(_,"resolve://"));if(m.protocol==="resolve:"){const{pathname:b,search:g,hash:S}=m;return b+g+S}return m.toString()};e.resolve=k;const M=function(_){return{protocol:_.protocol,hostname:_.hostname,hash:_.hash,search:_.search,pathname:_.pathname,path:_.pathname+_.search||"",href:_.href,port:_.port,auth:_.username&&_.username+_.password?":"+_.password:""}};e.urlToHttpOptions=M;const X=function(_,d){let m;if(typeof _=="string")m=new j(_);else if(_ instanceof j)m=_;else throw new TypeError("format urlObject is not supported");return d&&(d.auth===!1&&(m.username="",m.password=""),d.fragment===!1&&(m.hash=""),d.search===!1&&(m.search="")),m.toString()};e.format=X;const D=function(_){return _};e.domainToASCII=D;const P=function(_){return _};e.domainToUnicode=P;const u=function(_){return new j(_)};e.pathToFileURL=u;const L=function(_){return typeof _=="string"&&(_=new j(_)),_.pathname};e.fileURLToPath=L,z.exports={URL:j,URLSearchParams:c,domainToASCII:D,domainToUnicode:P,fileURLToPath:L,format:X,parse:p,pathToFileURL:u,resolve:k,urlToHttpOptions:M}}(url,url.exports)),url.exports}var http={exports:{}},_consts={},hasRequired_consts;function require_consts(){return hasRequired_consts||(hasRequired_consts=1,Object.defineProperty(_consts,"__esModule",{value:!0}),_consts.maxHeaderSize=_consts.STATUS_CODES=_consts.METHODS=void 0,_consts.METHODS=["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PRI","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE"],_consts.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a Teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"},_consts.maxHeaderSize=16384),_consts}var _request={},socket={},duplex={},readable={},events={exports:{}},_events={},hasRequired_events;function require_events(){if(hasRequired_events)return _events;hasRequired_events=1,Object.defineProperty(_events,"__esModule",{value:!0}),_events.EventEmitter=void 0,_events.once=j;let z=10;class e{constructor(){yt(this,"__unenv__",!0);yt(this,"_events",Object.create(null));yt(this,"_maxListeners")}static get defaultMaxListeners(){return z}static set defaultMaxListeners(d){if(typeof d!="number"||d<0||Number.isNaN(d))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+d+".");z=d}setMaxListeners(d){if(typeof d!="number"||d<0||Number.isNaN(d))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+d+".");return this._maxListeners=d,this}getMaxListeners(){return X(this)}emit(d,...m){if(!this._events[d]||this._events[d].length===0)return!1;if(d==="error"){let b;if(m.length>0&&(b=m[0]),b instanceof Error)throw b;const g=new Error("Unhandled error."+(b?" ("+b.message+")":""));throw g.context=b,g}for(const b of this._events[d])(b.listener||b).apply(this,m);return!0}addListener(d,m){return c(this,d,m,!1)}on(d,m){return c(this,d,m,!1)}prependListener(d,m){return c(this,d,m,!0)}once(d,m){return this.on(d,M(this,d,m))}prependOnceListener(d,m){return this.prependListener(d,M(this,d,m))}removeListener(d,m){return p(this,d,m)}off(d,m){return this.removeListener(d,m)}removeAllListeners(d){return k(this,d)}listeners(d){return D(this,d,!0)}rawListeners(d){return D(this,d,!1)}listenerCount(d){return this.rawListeners(d).length}eventNames(){return Object.keys(this._events)}}_events.EventEmitter=e;function j(_,d){return new Promise(function(m,b){function g(C){_.removeListener(d,S),b(C)}function S(){typeof _.removeListener=="function"&&_.removeListener("error",g),m(Array.prototype.slice.call(arguments))}L(_,d,S,{once:!0}),d!=="error"&&u(_,g,{once:!0})})}function c(_,d,m,b){var S;P(m),_._events.newListener!==void 0&&_.emit("newListener",d,m.listener||m),_._events[d]||(_._events[d]=[]),b?_._events[d].unshift(m):_._events[d].push(m);const g=X(_);if(g>0&&_._events[d].length>g&&!_._events[d].warned){_._events[d].warned=!0;const C=new Error(`[unenv] Possible EventEmitter memory leak detected. ${_._events[d].length} ${d} listeners added. Use emitter.setMaxListeners() to increase limit`);C.name="MaxListenersExceededWarning",C.emitter=_,C.type=d,C.count=(S=_._events[d])==null?void 0:S.length,console.warn(C)}return _}function p(_,d,m){if(P(m),!_._events[d]||_._events[d].length===0)return _;const b=_._events[d].length;return _._events[d]=_._events[d].filter(g=>g!==m),b===_._events[d].length||(_._events.removeListener&&_.emit("removeListener",d,m.listener||m),_._events[d].length===0&&delete _._events[d]),_}function k(_,d){if(!_._events[d]||_._events[d].length===0)return _;if(_._events.removeListener)for(const m of _._events[d])_.emit("removeListener",d,m.listener||m);return delete _._events[d],_}function M(_,d,m){let b=!1;const g=(...S)=>{if(!b)return _.removeListener(d,g),b=!0,S.length===0?m.call(_):m.apply(_,S)};return g.listener=m,g}function X(_){var d;return(d=_._maxListeners)!=null?d:e.defaultMaxListeners}function D(_,d,m){let b=_._events[d];return typeof b=="function"&&(b=[b]),m?b.map(g=>g.listener||g):b}function P(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}function u(_,d,m){typeof _.on=="function"&&L(_,"error",d,m)}function L(_,d,m,b){if(typeof _.on=="function")b.once?_.once(d,m):_.on(d,m);else if(typeof _.addEventListener=="function")_.addEventListener(d,m);else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof _)}return _events}var hasRequiredEvents;function requireEvents(){return hasRequiredEvents||(hasRequiredEvents=1,function(z,e){Object.defineProperty(e,"__esModule",{value:!0}),e.once=e.default=e.EventEmitter=void 0;var j=require_events();const c=e.EventEmitter=globalThis.EventEmitter||j.EventEmitter,p=e.once=j.once;z.exports={EventEmitter:c,once:p}}(events,events.exports)),events.exports}var hasRequiredReadable;function requireReadable(){if(hasRequiredReadable)return readable;hasRequiredReadable=1,Object.defineProperty(readable,"__esModule",{value:!0}),readable._Readable=readable.Readable=void 0;var z=requireUtils(),e=requireEvents();class j extends e.EventEmitter{constructor(k){super();yt(this,"__unenv__",!0);yt(this,"readableEncoding",null);yt(this,"readableEnded",!0);yt(this,"readableFlowing",!1);yt(this,"readableHighWaterMark",0);yt(this,"readableLength",0);yt(this,"readableObjectMode",!1);yt(this,"readableAborted",!1);yt(this,"readableDidRead",!1);yt(this,"closed",!1);yt(this,"errored",null);yt(this,"readable",!1);yt(this,"destroyed",!1)}static from(k,M){return new j(M)}_read(k){}read(k){}setEncoding(k){return this}pause(){return this}resume(){return this}isPaused(){return!0}unpipe(k){return this}unshift(k,M){}wrap(k){return this}push(k,M){return!1}_destroy(k,M){this.removeAllListeners()}destroy(k){return this.destroyed=!0,this._destroy(k),this}pipe(k,M){return{}}compose(k,M){throw new Error("[unenv] Method not implemented.")}[Symbol.asyncDispose](){return this.destroy(),Promise.resolve()}[Symbol.asyncIterator](){return ys(this,null,function*(){throw(0,z.createNotImplementedError)("Readable.asyncIterator")})}iterator(k){throw(0,z.createNotImplementedError)("Readable.iterator")}map(k,M){throw(0,z.createNotImplementedError)("Readable.map")}filter(k,M){throw(0,z.createNotImplementedError)("Readable.filter")}forEach(k,M){throw(0,z.createNotImplementedError)("Readable.forEach")}reduce(k,M,X){throw(0,z.createNotImplementedError)("Readable.reduce")}find(k,M){throw(0,z.createNotImplementedError)("Readable.find")}findIndex(k,M){throw(0,z.createNotImplementedError)("Readable.findIndex")}some(k,M){throw(0,z.createNotImplementedError)("Readable.some")}toArray(k){throw(0,z.createNotImplementedError)("Readable.toArray")}every(k,M){throw(0,z.createNotImplementedError)("Readable.every")}flatMap(k,M){throw(0,z.createNotImplementedError)("Readable.flatMap")}drop(k,M){throw(0,z.createNotImplementedError)("Readable.drop")}take(k,M){throw(0,z.createNotImplementedError)("Readable.take")}asIndexedPairs(k){throw(0,z.createNotImplementedError)("Readable.asIndexedPairs")}}return readable._Readable=j,readable.Readable=globalThis.Readable||j,readable}var writable={},hasRequiredWritable;function requireWritable(){if(hasRequiredWritable)return writable;hasRequiredWritable=1,Object.defineProperty(writable,"__esModule",{value:!0}),writable.Writable=void 0;var z=requireEvents();class e extends z.EventEmitter{constructor(p){super();yt(this,"__unenv__",!0);yt(this,"writable",!0);yt(this,"writableEnded",!1);yt(this,"writableFinished",!1);yt(this,"writableHighWaterMark",0);yt(this,"writableLength",0);yt(this,"writableObjectMode",!1);yt(this,"writableCorked",0);yt(this,"closed",!1);yt(this,"errored",null);yt(this,"writableNeedDrain",!1);yt(this,"destroyed",!1);yt(this,"_data");yt(this,"_encoding","utf-8")}pipe(p,k){return{}}_write(p,k,M){if(this.writableEnded){M&&M();return}if(this._data===void 0)this._data=p;else{const X=typeof this._data=="string"?Buffer.from(this._data,this._encoding||k||"utf8"):this._data,D=typeof p=="string"?Buffer.from(p,k||this._encoding||"utf8"):p;this._data=Buffer.concat([X,D])}this._encoding=k,M&&M()}_writev(p,k){}_destroy(p,k){}_final(p){}write(p,k,M){const X=typeof k=="string"?this._encoding:"utf-8",D=typeof k=="function"?k:typeof M=="function"?M:void 0;return this._write(p,X,D),!0}setDefaultEncoding(p){return this}end(p,k,M){const X=typeof p=="function"?p:typeof k=="function"?k:typeof M=="function"?M:void 0;if(this.writableEnded)return X&&X(),this;const D=p===X?void 0:p;if(D){const P=k===X?void 0:k;this.write(D,P,X)}return this.writableEnded=!0,this.writableFinished=!0,this.emit("close"),this.emit("finish"),this}cork(){}uncork(){}destroy(p){return this.destroyed=!0,delete this._data,this.removeAllListeners(),this}compose(p,k){throw new Error("[h3] Method not implemented.")}}return writable.Writable=globalThis.Writable||e,writable}var hasRequiredDuplex;function requireDuplex(){if(hasRequiredDuplex)return duplex;hasRequiredDuplex=1,Object.defineProperty(duplex,"__esModule",{value:!0}),duplex._Duplex=duplex.Duplex=void 0;var z=requireUtils(),e=requireReadable(),j=requireWritable();const c=class{constructor(M=new e.Readable,X=new j.Writable){yt(this,"allowHalfOpen",!0);yt(this,"_destroy");Object.assign(this,M),Object.assign(this,X),this._destroy=(0,z.mergeFns)(M._destroy,X._destroy)}};function p(){return Object.assign(c.prototype,e.Readable.prototype),Object.assign(c.prototype,j.Writable.prototype),c}const k=duplex._Duplex=p();return duplex.Duplex=globalThis.Duplex||k,duplex}var hasRequiredSocket;function requireSocket(){if(hasRequiredSocket)return socket;hasRequiredSocket=1,Object.defineProperty(socket,"__esModule",{value:!0}),socket.SocketAddress=socket.Socket=void 0;var z=requireDuplex();class e extends z.Duplex{constructor(k){super();yt(this,"__unenv__",!0);yt(this,"bufferSize",0);yt(this,"bytesRead",0);yt(this,"bytesWritten",0);yt(this,"connecting",!1);yt(this,"destroyed",!1);yt(this,"pending",!1);yt(this,"localAddress","");yt(this,"localPort",0);yt(this,"remoteAddress","");yt(this,"remoteFamily","");yt(this,"remotePort",0);yt(this,"autoSelectFamilyAttemptedAddresses",[]);yt(this,"readyState","readOnly")}write(k,M,X){return!1}connect(k,M,X){return this}end(k,M,X){return this}setEncoding(k){return this}pause(){return this}resume(){return this}setTimeout(k,M){return this}setNoDelay(k){return this}setKeepAlive(k,M){return this}address(){return{}}unref(){return this}ref(){return this}destroySoon(){this.destroy()}resetAndDestroy(){const k=new Error("ERR_SOCKET_CLOSED");return k.code="ERR_SOCKET_CLOSED",this.destroy(k),this}}socket.Socket=e;class j{constructor(p){yt(this,"__unenv__",!0);yt(this,"address");yt(this,"family");yt(this,"port");yt(this,"flowlabel");this.address=p.address,this.family=p.family,this.port=p.port,this.flowlabel=p.flowlabel}}return socket.SocketAddress=j,socket}var hasRequired_request;function require_request(){if(hasRequired_request)return _request;hasRequired_request=1,Object.defineProperty(_request,"__esModule",{value:!0}),_request.IncomingMessage=void 0;var z=requireSocket(),e=requireReadable(),j=requireUtils();class c extends e.Readable{constructor(X){super();yt(this,"__unenv__",{});yt(this,"aborted",!1);yt(this,"httpVersion","1.1");yt(this,"httpVersionMajor",1);yt(this,"httpVersionMinor",1);yt(this,"complete",!0);yt(this,"connection");yt(this,"socket");yt(this,"headers",{});yt(this,"trailers",{});yt(this,"method","GET");yt(this,"url","/");yt(this,"statusCode",200);yt(this,"statusMessage","");yt(this,"closed",!1);yt(this,"errored",null);yt(this,"readable",!1);this.socket=this.connection=X||new z.Socket}get rawHeaders(){return(0,j.rawHeaders)(this.headers)}get rawTrailers(){return[]}setTimeout(X,D){return this}get headersDistinct(){return p(this.headers)}get trailersDistinct(){return p(this.trailers)}}_request.IncomingMessage=c;function p(k){const M={};for(const[X,D]of Object.entries(k))X&&(M[X]=(Array.isArray(D)?D:[D]).filter(Boolean));return M}return _request}var _response={},hasRequired_response;function require_response(){if(hasRequired_response)return _response;hasRequired_response=1,Object.defineProperty(_response,"__esModule",{value:!0}),_response.ServerResponse=void 0;var z=requireWritable();class e extends z.Writable{constructor(p){super();yt(this,"__unenv__",!0);yt(this,"statusCode",200);yt(this,"statusMessage","");yt(this,"upgrading",!1);yt(this,"chunkedEncoding",!1);yt(this,"shouldKeepAlive",!1);yt(this,"useChunkedEncodingByDefault",!1);yt(this,"sendDate",!1);yt(this,"finished",!1);yt(this,"headersSent",!1);yt(this,"strictContentLength",!1);yt(this,"connection",null);yt(this,"socket",null);yt(this,"req");yt(this,"_headers",{});this.req=p}assignSocket(p){p._httpMessage=this,this.socket=p,this.connection=p,this.emit("socket",p),this._flush()}_flush(){this.flushHeaders()}detachSocket(p){}writeContinue(p){}writeHead(p,k,M){p&&(this.statusCode=p),typeof k=="string"&&(this.statusMessage=k,k=void 0);const X=M||k;if(X&&!Array.isArray(X))for(const D in X)this.setHeader(D,X[D]);return this.headersSent=!0,this}writeProcessing(){}setTimeout(p,k){return this}appendHeader(p,k){p=p.toLowerCase();const M=this._headers[p],X=[...Array.isArray(M)?M:[M],...Array.isArray(k)?k:[k]].filter(Boolean);return this._headers[p]=X.length>1?X:X[0],this}setHeader(p,k){return this._headers[p.toLowerCase()]=k,this}getHeader(p){return this._headers[p.toLowerCase()]}getHeaders(){return this._headers}getHeaderNames(){return Object.keys(this._headers)}hasHeader(p){return p.toLowerCase()in this._headers}removeHeader(p){delete this._headers[p.toLowerCase()]}addTrailers(p){}flushHeaders(){}writeEarlyHints(p,k){typeof k=="function"&&k()}}return _response.ServerResponse=e,_response}var hasRequiredHttp;function requireHttp(){return hasRequiredHttp||(hasRequiredHttp=1,function(z,e){Object.defineProperty(e,"__esModule",{value:!0});var j={createServer:!0,request:!0,get:!0,Server:!0,OutgoingMessage:!0,ClientRequest:!0,Agent:!0,globalAgent:!0,validateHeaderName:!0,validateHeaderValue:!0,setMaxIdleHTTPParsers:!0};e.validateHeaderValue=e.validateHeaderName=e.setMaxIdleHTTPParsers=e.request=e.globalAgent=e.get=e.default=e.createServer=e.Server=e.OutgoingMessage=e.ClientRequest=e.Agent=void 0;var c=requireUtils(),p=u(requireProxy()),k=P(require_consts());Object.keys(k).forEach(function(a){a==="default"||a==="__esModule"||Object.prototype.hasOwnProperty.call(j,a)||a in e&&e[a]===k[a]||Object.defineProperty(e,a,{enumerable:!0,get:function(){return k[a]}})});var M=require_request();Object.keys(M).forEach(function(a){a==="default"||a==="__esModule"||Object.prototype.hasOwnProperty.call(j,a)||a in e&&e[a]===M[a]||Object.defineProperty(e,a,{enumerable:!0,get:function(){return M[a]}})});var X=require_response();Object.keys(X).forEach(function(a){a==="default"||a==="__esModule"||Object.prototype.hasOwnProperty.call(j,a)||a in e&&e[a]===X[a]||Object.defineProperty(e,a,{enumerable:!0,get:function(){return X[a]}})});function D(a){if(typeof WeakMap!="function")return null;var I=new WeakMap,A=new WeakMap;return(D=function(o){return o?A:I})(a)}function P(a,I){if(!I&&a&&a.__esModule)return a;if(a===null||typeof a!="object"&&typeof a!="function")return{default:a};var A=D(I);if(A&&A.has(a))return A.get(a);var o={__proto__:null},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in a)if(v!=="default"&&Object.prototype.hasOwnProperty.call(a,v)){var W=F?Object.getOwnPropertyDescriptor(a,v):null;W&&(W.get||W.set)?Object.defineProperty(o,v,W):o[v]=a[v]}return o.default=a,A&&A.set(a,o),o}function u(a){return a&&a.__esModule?a:{default:a}}const L=e.createServer=(0,c.notImplemented)("http.createServer"),_=e.request=(0,c.notImplemented)("http.request"),d=e.get=(0,c.notImplemented)("http.get"),m=e.Server=p.default.__createMock__("http.Server"),b=e.OutgoingMessage=p.default.__createMock__("http.OutgoingMessage"),g=e.ClientRequest=p.default.__createMock__("http.ClientRequest"),S=e.Agent=p.default.__createMock__("http.Agent"),C=e.globalAgent=new S,x=e.validateHeaderName=(0,c.notImplemented)("http.validateHeaderName"),w=e.validateHeaderValue=(0,c.notImplemented)("http.validateHeaderValue"),l=e.setMaxIdleHTTPParsers=(0,c.notImplemented)("http.setMaxIdleHTTPParsers");z.exports={...k,IncomingMessage:M.IncomingMessage,ServerResponse:X.ServerResponse,createServer:L,request:_,get:d,Server:m,OutgoingMessage:b,ClientRequest:g,Agent:S,globalAgent:C,validateHeaderName:x,validateHeaderValue:w,setMaxIdleHTTPParsers:l}}(http,http.exports)),http.exports}(function(module,exports){(function(e,j){module.exports=e.pdfjsLib=j()})(globalThis,()=>(()=>{var __webpack_modules__=[,(z,e)=>{var Vt;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=ht,e.bytesToString=H,e.createValidAbsoluteUrl=Tt,e.getModificationDate=Pt,e.getUuid=Xt,e.getVerbosityLevel=K,e.info=at,e.isArrayBuffer=ut,e.isArrayEqual=wt,e.isNodeJS=void 0,e.normalizeUnicode=Yt,e.objectFromMap=dt,e.objectSize=ot,e.setVerbosityLevel=R,e.shadow=kt,e.string32=st,e.stringToBytes=it,e.stringToPDFString=pt,e.stringToUTF8String=et,e.unreachable=G,e.utf8StringToString=tt,e.warn=ct;const j=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=j;const c=[1,0,0,1,0,0];e.IDENTITY_MATRIX=c;const p=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=p;const k=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=k;const M=1.35;e.LINE_FACTOR=M;const X=.35;e.LINE_DESCENT_FACTOR=X;const D=X/M;e.BASELINE_FACTOR=D;const P={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=P;const u={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=u;const L="pdfjs_internal_editor_";e.AnnotationEditorPrefix=L;const _={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=_;const d={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=d;const m={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=m;const b={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=b;const g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=g;const S={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=S;const C={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=C;const x={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=x;const w={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=w;const l={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=l;const a={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=a;const I={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=I;const A={O:"PageOpen",C:"PageClose"};e.PageActionEventType=A;const o={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=o;const F={NONE:0,BINARY:1};e.CMapCompressionType=F;const v={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=v;const W={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=W;let Y=o.WARNINGS;function R(lt){Number.isInteger(lt)&&(Y=lt)}function K(){return Y}function at(lt){Y>=o.INFOS&&console.log(`Info: ${lt}`)}function ct(lt){Y>=o.WARNINGS&&console.log(`Warning: ${lt}`)}function G(lt){throw new Error(lt)}function ht(lt,Z){lt||G(Z)}function gt(lt){switch(lt==null?void 0:lt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Tt(lt,Z=null,$=null){if(!lt)return null;try{if($&&typeof lt=="string"){if($.addDefaultProtocol&&lt.startsWith("www.")){const bt=lt.match(/\./g);(bt==null?void 0:bt.length)>=2&&(lt=`http://${lt}`)}if($.tryConvertEncoding)try{lt=et(lt)}catch(bt){}}const _t=Z?new URL(lt,Z):new URL(lt);if(gt(_t))return _t}catch(_t){}return null}function kt(lt,Z,$,_t=!1){return Object.defineProperty(lt,Z,{value:$,enumerable:!_t,configurable:!0,writable:!1}),$}const T=function(){function Z($,_t){this.constructor===Z&&G("Cannot initialize BaseException."),this.message=$,this.name=_t}return Z.prototype=new Error,Z.constructor=Z,Z}();e.BaseException=T;class n extends T{constructor(Z,$){super(Z,"PasswordException"),this.code=$}}e.PasswordException=n;class r extends T{constructor(Z,$){super(Z,"UnknownErrorException"),this.details=$}}e.UnknownErrorException=r;class i extends T{constructor(Z){super(Z,"InvalidPDFException")}}e.InvalidPDFException=i;class h extends T{constructor(Z){super(Z,"MissingPDFException")}}e.MissingPDFException=h;class f extends T{constructor(Z,$){super(Z,"UnexpectedResponseException"),this.status=$}}e.UnexpectedResponseException=f;class E extends T{constructor(Z){super(Z,"FormatError")}}e.FormatError=E;class O extends T{constructor(Z){super(Z,"AbortException")}}e.AbortException=O;function H(lt){(typeof lt!="object"||(lt==null?void 0:lt.length)===void 0)&&G("Invalid argument for bytesToString");const Z=lt.length,$=8192;if(Z<$)return String.fromCharCode.apply(null,lt);const _t=[];for(let bt=0;bt<Z;bt+=$){const ee=Math.min(bt+$,Z),te=lt.subarray(bt,ee);_t.push(String.fromCharCode.apply(null,te))}return _t.join("")}function it(lt){typeof lt!="string"&&G("Invalid argument for stringToBytes");const Z=lt.length,$=new Uint8Array(Z);for(let _t=0;_t<Z;++_t)$[_t]=lt.charCodeAt(_t)&255;return $}function st(lt){return String.fromCharCode(lt>>24&255,lt>>16&255,lt>>8&255,lt&255)}function ot(lt){return Object.keys(lt).length}function dt(lt){const Z=Object.create(null);for(const[$,_t]of lt)Z[$]=_t;return Z}function vt(){const lt=new Uint8Array(4);return lt[0]=1,new Uint32Array(lt.buffer,0,1)[0]===1}function ft(){try{return new Function(""),!0}catch(lt){return!1}}class Ft{static get isLittleEndian(){return kt(this,"isLittleEndian",vt())}static get isEvalSupported(){return kt(this,"isEvalSupported",ft())}static get isOffscreenCanvasSupported(){return kt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?kt(this,"platform",{isWin:!1,isMac:!1}):kt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Z,$;return kt(this,"isCSSRoundSupported",($=(Z=globalThis.CSS)==null?void 0:Z.supports)==null?void 0:$.call(Z,"width: round(1.5px, 1px)"))}}e.FeatureTest=Ft;const Bt=[...Array(256).keys()].map(lt=>lt.toString(16).padStart(2,"0"));class Et{static makeHexColor(Z,$,_t){return`#${Bt[Z]}${Bt[$]}${Bt[_t]}`}static scaleMinMax(Z,$){let _t;Z[0]?(Z[0]<0&&(_t=$[0],$[0]=$[1],$[1]=_t),$[0]*=Z[0],$[1]*=Z[0],Z[3]<0&&(_t=$[2],$[2]=$[3],$[3]=_t),$[2]*=Z[3],$[3]*=Z[3]):(_t=$[0],$[0]=$[2],$[2]=_t,_t=$[1],$[1]=$[3],$[3]=_t,Z[1]<0&&(_t=$[2],$[2]=$[3],$[3]=_t),$[2]*=Z[1],$[3]*=Z[1],Z[2]<0&&(_t=$[0],$[0]=$[1],$[1]=_t),$[0]*=Z[2],$[1]*=Z[2]),$[0]+=Z[4],$[1]+=Z[4],$[2]+=Z[5],$[3]+=Z[5]}static transform(Z,$){return[Z[0]*$[0]+Z[2]*$[1],Z[1]*$[0]+Z[3]*$[1],Z[0]*$[2]+Z[2]*$[3],Z[1]*$[2]+Z[3]*$[3],Z[0]*$[4]+Z[2]*$[5]+Z[4],Z[1]*$[4]+Z[3]*$[5]+Z[5]]}static applyTransform(Z,$){const _t=Z[0]*$[0]+Z[1]*$[2]+$[4],bt=Z[0]*$[1]+Z[1]*$[3]+$[5];return[_t,bt]}static applyInverseTransform(Z,$){const _t=$[0]*$[3]-$[1]*$[2],bt=(Z[0]*$[3]-Z[1]*$[2]+$[2]*$[5]-$[4]*$[3])/_t,ee=(-Z[0]*$[1]+Z[1]*$[0]+$[4]*$[1]-$[5]*$[0])/_t;return[bt,ee]}static getAxialAlignedBoundingBox(Z,$){const _t=this.applyTransform(Z,$),bt=this.applyTransform(Z.slice(2,4),$),ee=this.applyTransform([Z[0],Z[3]],$),te=this.applyTransform([Z[2],Z[1]],$);return[Math.min(_t[0],bt[0],ee[0],te[0]),Math.min(_t[1],bt[1],ee[1],te[1]),Math.max(_t[0],bt[0],ee[0],te[0]),Math.max(_t[1],bt[1],ee[1],te[1])]}static inverseTransform(Z){const $=Z[0]*Z[3]-Z[1]*Z[2];return[Z[3]/$,-Z[1]/$,-Z[2]/$,Z[0]/$,(Z[2]*Z[5]-Z[4]*Z[3])/$,(Z[4]*Z[1]-Z[5]*Z[0])/$]}static singularValueDecompose2dScale(Z){const $=[Z[0],Z[2],Z[1],Z[3]],_t=Z[0]*$[0]+Z[1]*$[2],bt=Z[0]*$[1]+Z[1]*$[3],ee=Z[2]*$[0]+Z[3]*$[2],te=Z[2]*$[1]+Z[3]*$[3],Q=(_t+te)/2,St=Math.sqrt((_t+te)**2-4*(_t*te-ee*bt))/2,Ot=Q+St||1,Rt=Q-St||1;return[Math.sqrt(Ot),Math.sqrt(Rt)]}static normalizeRect(Z){const $=Z.slice(0);return Z[0]>Z[2]&&($[0]=Z[2],$[2]=Z[0]),Z[1]>Z[3]&&($[1]=Z[3],$[3]=Z[1]),$}static intersect(Z,$){const _t=Math.max(Math.min(Z[0],Z[2]),Math.min($[0],$[2])),bt=Math.min(Math.max(Z[0],Z[2]),Math.max($[0],$[2]));if(_t>bt)return null;const ee=Math.max(Math.min(Z[1],Z[3]),Math.min($[1],$[3])),te=Math.min(Math.max(Z[1],Z[3]),Math.max($[1],$[3]));return ee>te?null:[_t,ee,bt,te]}static bezierBoundingBox(Z,$,_t,bt,ee,te,Q,St){const Ot=[],Rt=[[],[]];let Nt,Ut,Qt,At,Kt,Lt,N,s;for(let J=0;J<2;++J){if(J===0?(Ut=6*Z-12*_t+6*ee,Nt=-3*Z+9*_t-9*ee+3*Q,Qt=3*_t-3*Z):(Ut=6*$-12*bt+6*te,Nt=-3*$+9*bt-9*te+3*St,Qt=3*bt-3*$),Math.abs(Nt)<1e-12){if(Math.abs(Ut)<1e-12)continue;At=-Qt/Ut,0<At&&At<1&&Ot.push(At);continue}N=Ut*Ut-4*Qt*Nt,s=Math.sqrt(N),!(N<0)&&(Kt=(-Ut+s)/(2*Nt),0<Kt&&Kt<1&&Ot.push(Kt),Lt=(-Ut-s)/(2*Nt),0<Lt&&Lt<1&&Ot.push(Lt))}let y=Ot.length,U;const q=y;for(;y--;)At=Ot[y],U=1-At,Rt[0][y]=U*U*U*Z+3*U*U*At*_t+3*U*At*At*ee+At*At*At*Q,Rt[1][y]=U*U*U*$+3*U*U*At*bt+3*U*At*At*te+At*At*At*St;return Rt[0][q]=Z,Rt[1][q]=$,Rt[0][q+1]=Q,Rt[1][q+1]=St,Rt[0].length=Rt[1].length=q+2,[Math.min(...Rt[0]),Math.min(...Rt[1]),Math.max(...Rt[0]),Math.max(...Rt[1])]}}e.Util=Et;const Dt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function pt(lt){if(lt[0]>="ï"){let $;if(lt[0]==="þ"&&lt[1]==="ÿ"?$="utf-16be":lt[0]==="ÿ"&&lt[1]==="þ"?$="utf-16le":lt[0]==="ï"&&lt[1]==="»"&&lt[2]==="¿"&&($="utf-8"),$)try{const _t=new TextDecoder($,{fatal:!0}),bt=it(lt);return _t.decode(bt)}catch(_t){ct(`stringToPDFString: "${_t}".`)}}const Z=[];for(let $=0,_t=lt.length;$<_t;$++){const bt=Dt[lt.charCodeAt($)];Z.push(bt?String.fromCharCode(bt):lt.charAt($))}return Z.join("")}function et(lt){return decodeURIComponent(escape(lt))}function tt(lt){return unescape(encodeURIComponent(lt))}function ut(lt){return typeof lt=="object"&&(lt==null?void 0:lt.byteLength)!==void 0}function wt(lt,Z){if(lt.length!==Z.length)return!1;for(let $=0,_t=lt.length;$<_t;$++)if(lt[$]!==Z[$])return!1;return!0}function Pt(lt=new Date){return[lt.getUTCFullYear().toString(),(lt.getUTCMonth()+1).toString().padStart(2,"0"),lt.getUTCDate().toString().padStart(2,"0"),lt.getUTCHours().toString().padStart(2,"0"),lt.getUTCMinutes().toString().padStart(2,"0"),lt.getUTCSeconds().toString().padStart(2,"0")].join("")}class Wt{constructor(){B(this,Vt,!1);this.promise=new Promise((Z,$)=>{this.resolve=_t=>{nt(this,Vt,!0),Z(_t)},this.reject=_t=>{nt(this,Vt,!0),$(_t)}})}get settled(){return t(this,Vt)}}Vt=new WeakMap,e.PromiseCapability=Wt;let qt=null,Ht=null;function Yt(lt){return qt||(qt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ht=new Map([["ﬅ","ſt"]])),lt.replaceAll(qt,(Z,$,_t)=>$?$.normalize("NFKC"):Ht.get(_t))}function Xt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const lt=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(lt);else for(let Z=0;Z<32;Z++)lt[Z]=Math.floor(Math.random()*255);return H(lt)}const Gt="pdfjs_internal_id_";e.AnnotationPrefix=Gt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var z,j,c,p,he,M,Ee,D,P,u,L,_,d,m,b,g,we,C,x,Ue,l,a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(A){var Wt,qt;if(typeof A=="string"||A instanceof URL?A={url:A}:(0,_util.isArrayBuffer)(A)&&(A={data:A}),typeof A!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!A.url&&!A.data&&!A.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const o=new PDFDocumentLoadingTask,{docId:F}=o,v=A.url?getUrlProp(A.url):null,W=A.data?getDataProp(A.data):null,Y=A.httpHeaders||null,R=A.withCredentials===!0,K=(Wt=A.password)!=null?Wt:null,at=A.range instanceof PDFDataRangeTransport?A.range:null,ct=Number.isInteger(A.rangeChunkSize)&&A.rangeChunkSize>0?A.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let G=A.worker instanceof PDFWorker?A.worker:null;const ht=A.verbosity,gt=typeof A.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(A.docBaseUrl)?A.docBaseUrl:null,Tt=typeof A.cMapUrl=="string"?A.cMapUrl:null,kt=A.cMapPacked!==!1,T=A.CMapReaderFactory||DefaultCMapReaderFactory,n=typeof A.standardFontDataUrl=="string"?A.standardFontDataUrl:null,r=A.StandardFontDataFactory||DefaultStandardFontDataFactory,i=A.stopAtErrors!==!0,h=Number.isInteger(A.maxImageSize)&&A.maxImageSize>-1?A.maxImageSize:-1,f=A.isEvalSupported!==!1,E=typeof A.isOffscreenCanvasSupported=="boolean"?A.isOffscreenCanvasSupported:!_util.isNodeJS,O=Number.isInteger(A.canvasMaxAreaInBytes)?A.canvasMaxAreaInBytes:-1,H=typeof A.disableFontFace=="boolean"?A.disableFontFace:_util.isNodeJS,it=A.fontExtraProperties===!0,st=A.enableXfa===!0,ot=A.ownerDocument||globalThis.document,dt=A.disableRange===!0,vt=A.disableStream===!0,ft=A.disableAutoFetch===!0,Ft=A.pdfBug===!0,Bt=at?at.length:(qt=A.length)!=null?qt:NaN,Et=typeof A.useSystemFonts=="boolean"?A.useSystemFonts:!_util.isNodeJS&&!H,Dt=typeof A.useWorkerFetch=="boolean"?A.useWorkerFetch:T===_display_utils.DOMCMapReaderFactory&&r===_display_utils.DOMStandardFontDataFactory&&Tt&&n&&(0,_display_utils.isValidFetchUrl)(Tt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(n,document.baseURI),pt=A.canvasFactory||new DefaultCanvasFactory({ownerDocument:ot}),et=A.filterFactory||new DefaultFilterFactory({docId:F,ownerDocument:ot}),tt=null;(0,_util.setVerbosityLevel)(ht);const ut={canvasFactory:pt,filterFactory:et};if(Dt||(ut.cMapReaderFactory=new T({baseUrl:Tt,isCompressed:kt}),ut.standardFontDataFactory=new r({baseUrl:n})),!G){const Ht={verbosity:ht,port:_worker_options.GlobalWorkerOptions.workerPort};G=Ht.port?PDFWorker.fromPort(Ht):new PDFWorker(Ht),o._worker=G}const wt={docId:F,apiVersion:"3.11.174",data:W,password:K,disableAutoFetch:ft,rangeChunkSize:ct,length:Bt,docBaseUrl:gt,enableXfa:st,evaluatorOptions:{maxImageSize:h,disableFontFace:H,ignoreErrors:i,isEvalSupported:f,isOffscreenCanvasSupported:E,canvasMaxAreaInBytes:O,fontExtraProperties:it,useSystemFonts:Et,cMapUrl:Dt?Tt:null,standardFontDataUrl:Dt?n:null}},Pt={ignoreErrors:i,isEvalSupported:f,disableFontFace:H,fontExtraProperties:it,enableXfa:st,ownerDocument:ot,disableAutoFetch:ft,pdfBug:Ft,styleElement:tt};return G.promise.then(function(){if(o.destroyed)throw new Error("Loading aborted");const Ht=_fetchDocument(G,wt),Yt=new Promise(function(Xt){let Gt;at?Gt=new _transport_stream.PDFDataTransportStream({length:Bt,initialData:at.initialData,progressiveDone:at.progressiveDone,contentDispositionFilename:at.contentDispositionFilename,disableRange:dt,disableStream:vt},at):W||(Gt=(lt=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(lt):(0,_display_utils.isValidFetchUrl)(lt.url)?new _displayFetch_stream.PDFFetchStream(lt):new _displayNetwork.PDFNetworkStream(lt))({url:v,length:Bt,httpHeaders:Y,withCredentials:R,rangeChunkSize:ct,disableRange:dt,disableStream:vt})),Xt(Gt)});return Promise.all([Ht,Yt]).then(function([Xt,Gt]){if(o.destroyed)throw new Error("Loading aborted");const Vt=new _message_handler.MessageHandler(F,Xt,G.port),lt=new WorkerTransport(Vt,o,Gt,Pt,ut);o._transport=lt,Vt.send("Ready",null)})}).catch(o._capability.reject),o}async function _fetchDocument(A,o){if(A.destroyed)throw new Error("Worker was destroyed");const F=await A.messageHandler.sendWithPromise("GetDocRequest",o,o.data?[o.data.buffer]:null);if(A.destroyed)throw new Error("Worker was destroyed");return F}function getUrlProp(A){if(A instanceof URL)return A.href;try{return new URL(A,window.location).href}catch(o){if(_util.isNodeJS&&typeof A=="string")return A}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(A){if(_util.isNodeJS&&typeof Buffer<"u"&&A instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(A instanceof Uint8Array&&A.byteLength===A.buffer.byteLength)return A;if(typeof A=="string")return(0,_util.stringToBytes)(A);if(typeof A=="object"&&!isNaN(A==null?void 0:A.length)||(0,_util.isArrayBuffer)(A))return new Uint8Array(A);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${ge(e,z)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var o,F,v;this.destroyed=!0;try{(o=this._worker)!=null&&o.port&&(this._worker._pendingDestroy=!0),await((F=this._transport)==null?void 0:F.destroy())}catch(W){throw(v=this._worker)!=null&&v.port&&delete this._worker._pendingDestroy,W}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};z=new WeakMap,B(e,z,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(o,F,v=!1,W=null){this.length=o,this.initialData=F,this.progressiveDone=v,this.contentDispositionFilename=W,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(o){this._rangeListeners.push(o)}addProgressListener(o){this._progressListeners.push(o)}addProgressiveReadListener(o){this._progressiveReadListeners.push(o)}addProgressiveDoneListener(o){this._progressiveDoneListeners.push(o)}onDataRange(o,F){for(const v of this._rangeListeners)v(o,F)}onDataProgress(o,F){this._readyCapability.promise.then(()=>{for(const v of this._progressListeners)v(o,F)})}onDataProgressiveRead(o){this._readyCapability.promise.then(()=>{for(const F of this._progressiveReadListeners)F(o)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const o of this._progressiveDoneListeners)o()})}transportReady(){this._readyCapability.resolve()}requestDataRange(o,F){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(o,F){this._pdfInfo=o,this._transport=F,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(v=>{if(!v)return v;const W=[];for(const Y in v)W.push(...v[Y]);return W}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(o){return this._transport.getPage(o)}getPageIndex(o){return this._transport.getPageIndex(o)}getDestinations(){return this._transport.getDestinations()}getDestination(o){return this._transport.getDestination(o)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(o=!1){return this._transport.startCleanup(o||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(o,F,v,W=!1){B(this,p);B(this,M);B(this,j,null);B(this,c,!1);this._pageIndex=o,this._pageInfo=F,this._transport=v,this._stats=W?new _display_utils.StatTimer:null,this._pdfBug=W,this.commonObjs=v.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:o,rotation:F=this.rotate,offsetX:v=0,offsetY:W=0,dontFlip:Y=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:o,rotation:F,offsetX:v,offsetY:W,dontFlip:Y})}getAnnotations({intent:o="display"}={}){const F=this._transport.getRenderingIntent(o);return this._transport.getAnnotations(this._pageIndex,F.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var o;return((o=this._transport._htmlForXfa)==null?void 0:o.children[this._pageIndex])||null}render({canvasContext:o,viewport:F,intent:v="display",annotationMode:W=_util.AnnotationMode.ENABLE,transform:Y=null,background:R=null,optionalContentConfigPromise:K=null,annotationCanvasMap:at=null,pageColors:ct=null,printAnnotationStorage:G=null}){var r,i;(r=this._stats)==null||r.time("Overall");const ht=this._transport.getRenderingIntent(v,W,G);nt(this,c,!1),V(this,M,Ee).call(this),K||(K=this._transport.getOptionalContentConfig());let gt=this._intentStates.get(ht.cacheKey);gt||(gt=Object.create(null),this._intentStates.set(ht.cacheKey,gt)),gt.streamReaderCancelTimeout&&(clearTimeout(gt.streamReaderCancelTimeout),gt.streamReaderCancelTimeout=null);const Tt=!!(ht.renderingIntent&_util.RenderingIntentFlag.PRINT);gt.displayReadyCapability||(gt.displayReadyCapability=new _util.PromiseCapability,gt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(i=this._stats)==null||i.time("Page Request"),this._pumpOperatorList(ht));const kt=h=>{var f,E;gt.renderTasks.delete(T),(this._maybeCleanupAfterRender||Tt)&&nt(this,c,!0),V(this,p,he).call(this,!Tt),h?(T.capability.reject(h),this._abortOperatorList({intentState:gt,reason:h instanceof Error?h:new Error(h)})):T.capability.resolve(),(f=this._stats)==null||f.timeEnd("Rendering"),(E=this._stats)==null||E.timeEnd("Overall")},T=new InternalRenderTask({callback:kt,params:{canvasContext:o,viewport:F,transform:Y,background:R},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:at,operatorList:gt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Tt,pdfBug:this._pdfBug,pageColors:ct});(gt.renderTasks||(gt.renderTasks=new Set)).add(T);const n=T.task;return Promise.all([gt.displayReadyCapability.promise,K]).then(([h,f])=>{var E;if(this.destroyed){kt();return}(E=this._stats)==null||E.time("Rendering"),T.initializeGraphics({transparency:h,optionalContentConfig:f}),T.operatorListChanged()}).catch(kt),n}getOperatorList({intent:o="display",annotationMode:F=_util.AnnotationMode.ENABLE,printAnnotationStorage:v=null}={}){var at;function W(){R.operatorList.lastChunk&&(R.opListReadCapability.resolve(R.operatorList),R.renderTasks.delete(K))}const Y=this._transport.getRenderingIntent(o,F,v,!0);let R=this._intentStates.get(Y.cacheKey);R||(R=Object.create(null),this._intentStates.set(Y.cacheKey,R));let K;return R.opListReadCapability||(K=Object.create(null),K.operatorListChanged=W,R.opListReadCapability=new _util.PromiseCapability,(R.renderTasks||(R.renderTasks=new Set)).add(K),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(at=this._stats)==null||at.time("Page Request"),this._pumpOperatorList(Y)),R.opListReadCapability.promise}streamTextContent({includeMarkedContent:o=!1,disableNormalization:F=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:o===!0,disableNormalization:F===!0},{highWaterMark:100,size(W){return W.items.length}})}getTextContent(o={}){if(this._transport._htmlForXfa)return this.getXfa().then(v=>_xfa_text.XfaText.textContent(v));const F=this.streamTextContent(o);return new Promise(function(v,W){function Y(){R.read().then(function({value:at,done:ct}){if(ct){v(K);return}Object.assign(K.styles,at.styles),K.items.push(...at.items),Y()},W)}const R=F.getReader(),K={items:[],styles:Object.create(null)};Y()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const o=[];for(const F of this._intentStates.values())if(this._abortOperatorList({intentState:F,reason:new Error("Page was destroyed."),force:!0}),!F.opListReadCapability)for(const v of F.renderTasks)o.push(v.completed),v.cancel();return this.objs.clear(),nt(this,c,!1),V(this,M,Ee).call(this),Promise.all(o)}cleanup(o=!1){nt(this,c,!0);const F=V(this,p,he).call(this,!1);return o&&F&&this._stats&&(this._stats=new _display_utils.StatTimer),F}_startRenderPage(o,F){var W,Y;const v=this._intentStates.get(F);v&&((W=this._stats)==null||W.timeEnd("Page Request"),(Y=v.displayReadyCapability)==null||Y.resolve(o))}_renderPageChunk(o,F){for(let v=0,W=o.length;v<W;v++)F.operatorList.fnArray.push(o.fnArray[v]),F.operatorList.argsArray.push(o.argsArray[v]);F.operatorList.lastChunk=o.lastChunk,F.operatorList.separateAnnots=o.separateAnnots;for(const v of F.renderTasks)v.operatorListChanged();o.lastChunk&&V(this,p,he).call(this,!0)}_pumpOperatorList({renderingIntent:o,cacheKey:F,annotationStorageSerializable:v}){const{map:W,transfers:Y}=v,K=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:o,cacheKey:F,annotationStorage:W},Y).getReader(),at=this._intentStates.get(F);at.streamReader=K;const ct=()=>{K.read().then(({value:G,done:ht})=>{if(ht){at.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(G,at),ct())},G=>{if(at.streamReader=null,!this._transport.destroyed){if(at.operatorList){at.operatorList.lastChunk=!0;for(const ht of at.renderTasks)ht.operatorListChanged();V(this,p,he).call(this,!0)}if(at.displayReadyCapability)at.displayReadyCapability.reject(G);else if(at.opListReadCapability)at.opListReadCapability.reject(G);else throw G}})};ct()}_abortOperatorList({intentState:o,reason:F,force:v=!1}){if(o.streamReader){if(o.streamReaderCancelTimeout&&(clearTimeout(o.streamReaderCancelTimeout),o.streamReaderCancelTimeout=null),!v){if(o.renderTasks.size>0)return;if(F instanceof _display_utils.RenderingCancelledException){let W=RENDERING_CANCELLED_TIMEOUT;F.extraDelay>0&&F.extraDelay<1e3&&(W+=F.extraDelay),o.streamReaderCancelTimeout=setTimeout(()=>{o.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:o,reason:F,force:!0})},W);return}}if(o.streamReader.cancel(new _util.AbortException(F.message)).catch(()=>{}),o.streamReader=null,!this._transport.destroyed){for(const[W,Y]of this._intentStates)if(Y===o){this._intentStates.delete(W);break}this.cleanup()}}}get stats(){return this._stats}}j=new WeakMap,c=new WeakMap,p=new WeakSet,he=function(o=!1){if(V(this,M,Ee).call(this),!t(this,c)||this.destroyed)return!1;if(o)return nt(this,j,setTimeout(()=>{nt(this,j,null),V(this,p,he).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:F,operatorList:v}of this._intentStates.values())if(F.size>0||!v.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),nt(this,c,!1),!0},M=new WeakSet,Ee=function(){t(this,j)&&(clearTimeout(t(this,j)),nt(this,j,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){B(this,D,new Set);B(this,P,Promise.resolve())}postMessage(o,F){const v={data:structuredClone(o,F?{transfer:F}:null)};t(this,P).then(()=>{for(const W of t(this,D))W.call(this,v)})}addEventListener(o,F){t(this,D).add(F)}removeEventListener(o,F){t(this,D).delete(F)}terminate(){t(this,D).clear()}}D=new WeakMap,P=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const A=(u=document==null?void 0:document.currentScript)==null?void 0:u.src;A&&(PDFWorkerUtil.fallbackWorkerSrc=A.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(A,o){let F;try{if(F=new URL(A),!F.origin||F.origin==="null")return!1}catch(W){return!1}const v=new URL(o,F);return F.origin===v.origin},PDFWorkerUtil.createCDNWrapper=function(A){const o=`importScripts("${A}");`;return URL.createObjectURL(new Blob([o]))}}const _PDFWorker=class _PDFWorker{constructor({name:A=null,port:o=null,verbosity:F=(0,_util.getVerbosityLevel)()}={}){var v;if(this.name=A,this.destroyed=!1,this.verbosity=F,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,o){if((v=t(_PDFWorker,L))!=null&&v.has(o))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,L)||nt(_PDFWorker,L,new WeakMap)).set(o,this),this._initializeFromPort(o);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(A){this._port=A,this._messageHandler=new _message_handler.MessageHandler("main","worker",A),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:A}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,A)||(A=PDFWorkerUtil.createCDNWrapper(new URL(A,window.location).href));const o=new Worker(A),F=new _message_handler.MessageHandler("main","worker",o),v=()=>{o.removeEventListener("error",W),F.destroy(),o.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},W=()=>{this._webWorker||v()};o.addEventListener("error",W),F.on("test",R=>{if(o.removeEventListener("error",W),this.destroyed){v();return}R?(this._messageHandler=F,this._port=o,this._webWorker=o,this._readyCapability.resolve(),F.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),F.destroy(),o.terminate())}),F.on("ready",R=>{if(o.removeEventListener("error",W),this.destroyed){v();return}try{Y()}catch(K){this._setupFakeWorker()}});const Y=()=>{const R=new Uint8Array;F.send("test",R,[R.buffer])};Y();return}catch(o){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(A=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const o=new LoopbackPort;this._port=o;const F=`fake${PDFWorkerUtil.fakeWorkerId++}`,v=new _message_handler.MessageHandler(F+"_worker",F,o);A.setup(v,o);const W=new _message_handler.MessageHandler(F,F+"_worker",o);this._messageHandler=W,this._readyCapability.resolve(),W.send("configure",{verbosity:this.verbosity})}).catch(A=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${A.message}".`))})}destroy(){var A;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(A=t(_PDFWorker,L))==null||A.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(A){var F;if(!(A!=null&&A.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const o=(F=t(this,L))==null?void 0:F.get(A.port);if(o){if(o._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return o}return new _PDFWorker(A)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var A;try{return((A=globalThis.pdfjsWorker)==null?void 0:A.WorkerMessageHandler)||null}catch(o){return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};L=new WeakMap,B(_PDFWorker,L,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(o,F,v,W,Y){B(this,g);B(this,_,new Map);B(this,d,new Map);B(this,m,new Map);B(this,b,null);this.messageHandler=o,this.loadingTask=F,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:W.ownerDocument,styleElement:W.styleElement}),this._params=W,this.canvasFactory=Y.canvasFactory,this.filterFactory=Y.filterFactory,this.cMapReaderFactory=Y.cMapReaderFactory,this.standardFontDataFactory=Y.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=v,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(o,F=_util.AnnotationMode.ENABLE,v=null,W=!1){let Y=_util.RenderingIntentFlag.DISPLAY,R=_annotation_storage.SerializableEmpty;switch(o){case"any":Y=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":Y=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${o}`)}switch(F){case _util.AnnotationMode.DISABLE:Y+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:Y+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:Y+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,R=(Y&_util.RenderingIntentFlag.PRINT&&v instanceof _annotation_storage.PrintAnnotationStorage?v:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${F}`)}return W&&(Y+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:Y,cacheKey:`${Y}_${R.hash}`,annotationStorageSerializable:R}}destroy(){var v;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(v=t(this,b))==null||v.reject(new Error("Worker was destroyed during onPassword callback"));const o=[];for(const W of t(this,d).values())o.push(W._destroy());t(this,d).clear(),t(this,m).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const F=this.messageHandler.sendWithPromise("Terminate",null);return o.push(F),Promise.all(o).then(()=>{var W;this.commonObjs.clear(),this.fontLoader.clear(),t(this,_).clear(),this.filterFactory.destroy(),(W=this._networkStream)==null||W.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:o,loadingTask:F}=this;o.on("GetReader",(v,W)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Y=>{this._lastProgress={loaded:Y.loaded,total:Y.total}},W.onPull=()=>{this._fullReader.read().then(function({value:Y,done:R}){if(R){W.close();return}(0,_util.assert)(Y instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),W.enqueue(new Uint8Array(Y),1,[Y])}).catch(Y=>{W.error(Y)})},W.onCancel=Y=>{this._fullReader.cancel(Y),W.ready.catch(R=>{if(!this.destroyed)throw R})}}),o.on("ReaderHeadersReady",v=>{const W=new _util.PromiseCapability,Y=this._fullReader;return Y.headersReady.then(()=>{var R;(!Y.isStreamingSupported||!Y.isRangeSupported)&&(this._lastProgress&&((R=F.onProgress)==null||R.call(F,this._lastProgress)),Y.onProgress=K=>{var at;(at=F.onProgress)==null||at.call(F,{loaded:K.loaded,total:K.total})}),W.resolve({isStreamingSupported:Y.isStreamingSupported,isRangeSupported:Y.isRangeSupported,contentLength:Y.contentLength})},W.reject),W.promise}),o.on("GetRangeReader",(v,W)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Y=this._networkStream.getRangeReader(v.begin,v.end);if(!Y){W.close();return}W.onPull=()=>{Y.read().then(function({value:R,done:K}){if(K){W.close();return}(0,_util.assert)(R instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),W.enqueue(new Uint8Array(R),1,[R])}).catch(R=>{W.error(R)})},W.onCancel=R=>{Y.cancel(R),W.ready.catch(K=>{if(!this.destroyed)throw K})}}),o.on("GetDoc",({pdfInfo:v})=>{this._numPages=v.numPages,this._htmlForXfa=v.htmlForXfa,delete v.htmlForXfa,F._capability.resolve(new PDFDocumentProxy(v,this))}),o.on("DocException",function(v){let W;switch(v.name){case"PasswordException":W=new _util.PasswordException(v.message,v.code);break;case"InvalidPDFException":W=new _util.InvalidPDFException(v.message);break;case"MissingPDFException":W=new _util.MissingPDFException(v.message);break;case"UnexpectedResponseException":W=new _util.UnexpectedResponseException(v.message,v.status);break;case"UnknownErrorException":W=new _util.UnknownErrorException(v.message,v.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}F._capability.reject(W)}),o.on("PasswordRequest",v=>{if(nt(this,b,new _util.PromiseCapability),F.onPassword){const W=Y=>{Y instanceof Error?t(this,b).reject(Y):t(this,b).resolve({password:Y})};try{F.onPassword(W,v.code)}catch(Y){t(this,b).reject(Y)}}else t(this,b).reject(new _util.PasswordException(v.message,v.code));return t(this,b).promise}),o.on("DataLoaded",v=>{var W;(W=F.onProgress)==null||W.call(F,{loaded:v.length,total:v.length}),this.downloadInfoCapability.resolve(v)}),o.on("StartRenderPage",v=>{if(this.destroyed)return;t(this,d).get(v.pageIndex)._startRenderPage(v.transparency,v.cacheKey)}),o.on("commonobj",([v,W,Y])=>{var R;if(!this.destroyed&&!this.commonObjs.has(v))switch(W){case"Font":const K=this._params;if("error"in Y){const G=Y.error;(0,_util.warn)(`Error during font loading: ${G}`),this.commonObjs.resolve(v,G);break}const at=K.pdfBug&&((R=globalThis.FontInspector)!=null&&R.enabled)?(G,ht)=>globalThis.FontInspector.fontAdded(G,ht):null,ct=new _font_loader.FontFaceObject(Y,{isEvalSupported:K.isEvalSupported,disableFontFace:K.disableFontFace,ignoreErrors:K.ignoreErrors,inspectFont:at});this.fontLoader.bind(ct).catch(G=>o.sendWithPromise("FontFallback",{id:v})).finally(()=>{!K.fontExtraProperties&&ct.data&&(ct.data=null),this.commonObjs.resolve(v,ct)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(v,Y);break;default:throw new Error(`Got unknown common object type ${W}`)}}),o.on("obj",([v,W,Y,R])=>{var at;if(this.destroyed)return;const K=t(this,d).get(W);if(!K.objs.has(v))switch(Y){case"Image":if(K.objs.resolve(v,R),R){let ct;if(R.bitmap){const{width:G,height:ht}=R;ct=G*ht*4}else ct=((at=R.data)==null?void 0:at.length)||0;ct>_util.MAX_IMAGE_SIZE_TO_CACHE&&(K._maybeCleanupAfterRender=!0)}break;case"Pattern":K.objs.resolve(v,R);break;default:throw new Error(`Got unknown object type ${Y}`)}}),o.on("DocProgress",v=>{var W;this.destroyed||(W=F.onProgress)==null||W.call(F,{loaded:v.loaded,total:v.total})}),o.on("FetchBuiltInCMap",v=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(v):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),o.on("FetchStandardFontData",v=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(v):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var v,W;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:o,transfers:F}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:o,filename:(W=(v=this._fullReader)==null?void 0:v.filename)!=null?W:null},F).finally(()=>{this.annotationStorage.resetModified()})}getPage(o){if(!Number.isInteger(o)||o<=0||o>this._numPages)return Promise.reject(new Error("Invalid page request."));const F=o-1,v=t(this,m).get(F);if(v)return v;const W=this.messageHandler.sendWithPromise("GetPage",{pageIndex:F}).then(Y=>{if(this.destroyed)throw new Error("Transport destroyed");const R=new PDFPageProxy(F,Y,this,this._params.pdfBug);return t(this,d).set(F,R),R});return t(this,m).set(F,W),W}getPageIndex(o){return typeof o!="object"||o===null||!Number.isInteger(o.num)||o.num<0||!Number.isInteger(o.gen)||o.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:o.num,gen:o.gen})}getAnnotations(o,F){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:o,intent:F})}getFieldObjects(){return V(this,g,we).call(this,"GetFieldObjects")}hasJSActions(){return V(this,g,we).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(o){return typeof o!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:o})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return V(this,g,we).call(this,"GetDocJSActions")}getPageJSActions(o){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:o})}getStructTree(o){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:o})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(o=>new _optional_content_config.OptionalContentConfig(o))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const o="GetMetadata",F=t(this,_).get(o);if(F)return F;const v=this.messageHandler.sendWithPromise(o,null).then(W=>{var Y,R,K,at;return{info:W[0],metadata:W[1]?new _metadata.Metadata(W[1]):null,contentDispositionFilename:(R=(Y=this._fullReader)==null?void 0:Y.filename)!=null?R:null,contentLength:(at=(K=this._fullReader)==null?void 0:K.contentLength)!=null?at:null}});return t(this,_).set(o,v),v}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(o=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const F of t(this,d).values())if(!F.cleanup())throw new Error(`startCleanup: Page ${F.pageNumber} is currently rendering.`);this.commonObjs.clear(),o||this.fontLoader.clear(),t(this,_).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:o,enableXfa:F}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:o,enableXfa:F})}}_=new WeakMap,d=new WeakMap,m=new WeakMap,b=new WeakMap,g=new WeakSet,we=function(o,F=null){const v=t(this,_).get(o);if(v)return v;const W=this.messageHandler.sendWithPromise(o,F);return t(this,_).set(o,W),W};class PDFObjects{constructor(){B(this,x);B(this,C,Object.create(null))}get(o,F=null){if(F){const W=V(this,x,Ue).call(this,o);return W.capability.promise.then(()=>F(W.data)),null}const v=t(this,C)[o];if(!(v!=null&&v.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${o}.`);return v.data}has(o){const F=t(this,C)[o];return(F==null?void 0:F.capability.settled)||!1}resolve(o,F=null){const v=V(this,x,Ue).call(this,o);v.data=F,v.capability.resolve()}clear(){var o;for(const F in t(this,C)){const{data:v}=t(this,C)[F];(o=v==null?void 0:v.bitmap)==null||o.close()}nt(this,C,Object.create(null))}}C=new WeakMap,x=new WeakSet,Ue=function(o){var F;return(F=t(this,C))[o]||(F[o]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(o){B(this,l,null);nt(this,l,o),this.onContinue=null}get promise(){return t(this,l).capability.promise}cancel(o=0){t(this,l).cancel(null,o)}get separateAnnots(){const{separateAnnots:o}=t(this,l).operatorList;if(!o)return!1;const{annotationCanvasMap:F}=t(this,l);return o.form||o.canvas&&(F==null?void 0:F.size)>0}}l=new WeakMap,exports.RenderTask=RenderTask;const I=class I{constructor({callback:o,params:F,objs:v,commonObjs:W,annotationCanvasMap:Y,operatorList:R,pageIndex:K,canvasFactory:at,filterFactory:ct,useRequestAnimationFrame:G=!1,pdfBug:ht=!1,pageColors:gt=null}){this.callback=o,this.params=F,this.objs=v,this.commonObjs=W,this.annotationCanvasMap=Y,this.operatorListIdx=null,this.operatorList=R,this._pageIndex=K,this.canvasFactory=at,this.filterFactory=ct,this._pdfBug=ht,this.pageColors=gt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=G===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=F.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:o=!1,optionalContentConfig:F}){var K,at;if(this.cancelled)return;if(this._canvas){if(t(I,a).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(I,a).add(this._canvas)}this._pdfBug&&((K=globalThis.StepperManager)!=null&&K.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:v,viewport:W,transform:Y,background:R}=this.params;this.gfx=new _canvas.CanvasGraphics(v,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:F},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Y,viewport:W,transparency:o,background:R}),this.operatorListIdx=0,this.graphicsReady=!0,(at=this.graphicsReadyCallback)==null||at.call(this)}cancel(o=null,F=0){var v;this.running=!1,this.cancelled=!0,(v=this.gfx)==null||v.endDrawing(),t(I,a).delete(this._canvas),this.callback(o||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,F))}operatorListChanged(){var o;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(o=this.stepper)==null||o.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(I,a).delete(this._canvas),this.callback())))}};a=new WeakMap,B(I,a,new WeakSet);let InternalRenderTask=I;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(z,e,j)=>{var P,u,L,vs,d;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var c=j(1),p=j(4),k=j(8);const M=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=M;class X{constructor(){B(this,L);B(this,P,!1);B(this,u,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(b,g){const S=t(this,u).get(b);return S===void 0?g:Object.assign(g,S)}getRawValue(b){return t(this,u).get(b)}remove(b){if(t(this,u).delete(b),t(this,u).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const g of t(this,u).values())if(g instanceof p.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(b,g){const S=t(this,u).get(b);let C=!1;if(S!==void 0)for(const[x,w]of Object.entries(g))S[x]!==w&&(C=!0,S[x]=w);else C=!0,t(this,u).set(b,g);C&&V(this,L,vs).call(this),g instanceof p.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(g.constructor._type)}has(b){return t(this,u).has(b)}getAll(){return t(this,u).size>0?(0,c.objectFromMap)(t(this,u)):null}setAll(b){for(const[g,S]of Object.entries(b))this.setValue(g,S)}get size(){return t(this,u).size}resetModified(){t(this,P)&&(nt(this,P,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new D(this)}get serializable(){if(t(this,u).size===0)return M;const b=new Map,g=new k.MurmurHash3_64,S=[],C=Object.create(null);let x=!1;for(const[w,l]of t(this,u)){const a=l instanceof p.AnnotationEditor?l.serialize(!1,C):l;a&&(b.set(w,a),g.update(`${w}:${JSON.stringify(a)}`),x||(x=!!a.bitmap))}if(x)for(const w of b.values())w.bitmap&&S.push(w.bitmap);return b.size>0?{map:b,hash:g.hexdigest(),transfers:S}:M}}P=new WeakMap,u=new WeakMap,L=new WeakSet,vs=function(){t(this,P)||(nt(this,P,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=X;class D extends X{constructor(g){super();B(this,d,void 0);const{map:S,hash:C,transfers:x}=g.serializable,w=structuredClone(S,x?{transfer:x}:null);nt(this,d,{map:w,hash:C,transfers:x})}get print(){(0,c.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,d)}}d=new WeakMap,e.PrintAnnotationStorage=D},(z,e,j)=>{var D,P,u,L,_,d,m,b,g,S,C,x,w,l,a,Be,A,je,F,He,W,We,R,Ss,at,Es,G,ws,gt,qe,kt,Cs;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var c=j(5),p=j(1),k=j(6);const n=class n{constructor(i){B(this,a);B(this,A);B(this,W);B(this,R);B(this,at);B(this,G);B(this,gt);B(this,kt);B(this,D,"");B(this,P,!1);B(this,u,null);B(this,L,null);B(this,_,null);B(this,d,!1);B(this,m,null);B(this,b,this.focusin.bind(this));B(this,g,this.focusout.bind(this));B(this,S,!1);B(this,C,!1);B(this,x,!1);yt(this,"_initialOptions",Object.create(null));yt(this,"_uiManager",null);yt(this,"_focusEventsAllowed",!0);yt(this,"_l10nPromise",null);B(this,w,!1);B(this,l,n._zIndex++);this.constructor===n&&(0,p.unreachable)("Cannot initialize AnnotationEditor."),this.parent=i.parent,this.id=i.id,this.width=this.height=null,this.pageIndex=i.parent.pageIndex,this.name=i.name,this.div=null,this._uiManager=i.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=i.isCentered,this._structTreeParentId=null;const{rotation:h,rawDims:{pageWidth:f,pageHeight:E,pageX:O,pageY:H}}=this.parent.viewport;this.rotation=h,this.pageRotation=(360+h-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[f,E],this.pageTranslation=[O,H];const[it,st]=this.parentDimensions;this.x=i.x/it,this.y=i.y/st,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,p.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(i){const h=new X({id:i.parent.getNextId(),parent:i.parent,uiManager:i._uiManager});h.annotationElementId=i.annotationElementId,h.deleted=!0,h._uiManager.addToAnnotationStorage(h)}static initialize(i,h=null){if(n._l10nPromise||(n._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(E=>[E,i.get(E)]))),h!=null&&h.strings)for(const E of h.strings)n._l10nPromise.set(E,i.get(E));if(n._borderLineWidth!==-1)return;const f=getComputedStyle(document.documentElement);n._borderLineWidth=parseFloat(f.getPropertyValue("--outline-width"))||0}static updateDefaultParams(i,h){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(i){return!1}static paste(i,h){(0,p.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,w)}set _isDraggable(i){var h;nt(this,w,i),(h=this.div)==null||h.classList.toggle("draggable",i)}center(){const[i,h]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*h/(i*2),this.y+=this.width*i/(h*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*h/(i*2),this.y-=this.width*i/(h*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(i){this._uiManager.addCommands(i)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,l)}setParent(i){i!==null&&(this.pageIndex=i.pageIndex,this.pageDimensions=i.pageDimensions),this.parent=i}focusin(i){this._focusEventsAllowed&&(t(this,S)?nt(this,S,!1):this.parent.setSelected(this))}focusout(i){var f;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const h=i.relatedTarget;h!=null&&h.closest(`#${this.id}`)||(i.preventDefault(),(f=this.parent)!=null&&f.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(i,h,f,E){const[O,H]=this.parentDimensions;[f,E]=this.screenToPageTranslation(f,E),this.x=(i+f)/O,this.y=(h+E)/H,this.fixAndSetPosition()}translate(i,h){V(this,a,Be).call(this,this.parentDimensions,i,h)}translateInPage(i,h){V(this,a,Be).call(this,this.pageDimensions,i,h),this.div.scrollIntoView({block:"nearest"})}drag(i,h){const[f,E]=this.parentDimensions;if(this.x+=i/f,this.y+=h/E,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:ot,y:dt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,ot,dt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:O,y:H}=this;const[it,st]=V(this,A,je).call(this);O+=it,H+=st,this.div.style.left=`${(100*O).toFixed(2)}%`,this.div.style.top=`${(100*H).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[i,h]=this.pageDimensions;let{x:f,y:E,width:O,height:H}=this;switch(O*=i,H*=h,f*=i,E*=h,this.rotation){case 0:f=Math.max(0,Math.min(i-O,f)),E=Math.max(0,Math.min(h-H,E));break;case 90:f=Math.max(0,Math.min(i-H,f)),E=Math.min(h,Math.max(O,E));break;case 180:f=Math.min(i,Math.max(O,f)),E=Math.min(h,Math.max(H,E));break;case 270:f=Math.min(i,Math.max(H,f)),E=Math.max(0,Math.min(h-O,E));break}this.x=f/=i,this.y=E/=h;const[it,st]=V(this,A,je).call(this);f+=it,E+=st;const{style:ot}=this.div;ot.left=`${(100*f).toFixed(2)}%`,ot.top=`${(100*E).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(i,h){var f;return V(f=n,F,He).call(f,i,h,this.parentRotation)}pageTranslationToScreen(i,h){var f;return V(f=n,F,He).call(f,i,h,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:i,pageDimensions:[h,f]}=this,E=h*i,O=f*i;return p.FeatureTest.isCSSRoundSupported?[Math.round(E),Math.round(O)]:[E,O]}setDims(i,h){var O;const[f,E]=this.parentDimensions;this.div.style.width=`${(100*i/f).toFixed(2)}%`,t(this,d)||(this.div.style.height=`${(100*h/E).toFixed(2)}%`),(O=t(this,u))==null||O.classList.toggle("small",i<n.SMALL_EDITOR_SIZE||h<n.SMALL_EDITOR_SIZE)}fixDims(){const{style:i}=this.div,{height:h,width:f}=i,E=f.endsWith("%"),O=!t(this,d)&&h.endsWith("%");if(E&&O)return;const[H,it]=this.parentDimensions;E||(i.width=`${(100*parseFloat(f)/H).toFixed(2)}%`),!t(this,d)&&!O&&(i.height=`${(100*parseFloat(h)/it).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,u))return;const i=nt(this,u,document.createElement("button"));i.className="altText";const h=await n._l10nPromise.get("editor_alt_text_button_label");i.textContent=h,i.setAttribute("aria-label",h),i.tabIndex="0",i.addEventListener("contextmenu",k.noContextMenu),i.addEventListener("pointerdown",f=>f.stopPropagation()),i.addEventListener("click",f=>{f.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),i.addEventListener("keydown",f=>{f.target===i&&f.key==="Enter"&&(f.preventDefault(),this._uiManager.editAltText(this))}),V(this,gt,qe).call(this),this.div.append(i),n.SMALL_EDITOR_SIZE||(n.SMALL_EDITOR_SIZE=Math.min(128,Math.round(i.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,D),decorative:t(this,P)}}set altTextData({altText:i,decorative:h}){t(this,D)===i&&t(this,P)===h||(nt(this,D,i),nt(this,P,h),V(this,gt,qe).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,b)),this.div.addEventListener("focusout",t(this,g));const[i,h]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*h/i).toFixed(2)}%`,this.div.style.maxHeight=`${(100*i/h).toFixed(2)}%`);const[f,E]=this.getInitialTranslation();return this.translate(f,E),(0,c.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(i){const{isMac:h}=p.FeatureTest.platform;if(i.button!==0||i.ctrlKey&&h){i.preventDefault();return}nt(this,S,!0),V(this,kt,Cs).call(this,i)}moveInDOM(){var i;(i=this.parent)==null||i.moveEditorInDOM(this)}_setParentAndPosition(i,h,f){i.changeParent(this),this.x=h,this.y=f,this.fixAndSetPosition()}getRect(i,h){const f=this.parentScale,[E,O]=this.pageDimensions,[H,it]=this.pageTranslation,st=i/f,ot=h/f,dt=this.x*E,vt=this.y*O,ft=this.width*E,Ft=this.height*O;switch(this.rotation){case 0:return[dt+st+H,O-vt-ot-Ft+it,dt+st+ft+H,O-vt-ot+it];case 90:return[dt+ot+H,O-vt+st+it,dt+ot+Ft+H,O-vt+st+ft+it];case 180:return[dt-st-ft+H,O-vt+ot+it,dt-st+H,O-vt+ot+Ft+it];case 270:return[dt-ot-Ft+H,O-vt-st-ft+it,dt-ot+H,O-vt-st+it];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(i,h){const[f,E,O,H]=i,it=O-f,st=H-E;switch(this.rotation){case 0:return[f,h-H,it,st];case 90:return[f,h-E,st,it];case 180:return[O,h-E,it,st];case 270:return[O,h-H,st,it];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){nt(this,x,!0)}disableEditMode(){nt(this,x,!1)}isInEditMode(){return t(this,x)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var i,h;(i=this.div)==null||i.addEventListener("focusin",t(this,b)),(h=this.div)==null||h.addEventListener("focusout",t(this,g))}serialize(i=!1,h=null){(0,p.unreachable)("An editor must be serializable")}static deserialize(i,h,f){const E=new this.prototype.constructor({parent:h,id:h.getNextId(),uiManager:f});E.rotation=i.rotation;const[O,H]=E.pageDimensions,[it,st,ot,dt]=E.getRectInCurrentCoords(i.rect,H);return E.x=it/O,E.y=st/H,E.width=ot/O,E.height=dt/H,E}remove(){var i;this.div.removeEventListener("focusin",t(this,b)),this.div.removeEventListener("focusout",t(this,g)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(i=t(this,u))==null||i.remove(),nt(this,u,null),nt(this,L,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(V(this,R,Ss).call(this),t(this,m).classList.remove("hidden"))}select(){var i;this.makeResizable(),(i=this.div)==null||i.classList.add("selectedEditor")}unselect(){var i,h,f;(i=t(this,m))==null||i.classList.add("hidden"),(h=this.div)==null||h.classList.remove("selectedEditor"),(f=this.div)!=null&&f.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(i,h){}disableEditing(){t(this,u)&&(t(this,u).hidden=!0)}enableEditing(){t(this,u)&&(t(this,u).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,C)}set isEditing(i){nt(this,C,i),this.parent&&(i?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(i,h){nt(this,d,!0);const f=i/h,{style:E}=this.div;E.aspectRatio=f,E.height="auto"}static get MIN_SIZE(){return 16}};D=new WeakMap,P=new WeakMap,u=new WeakMap,L=new WeakMap,_=new WeakMap,d=new WeakMap,m=new WeakMap,b=new WeakMap,g=new WeakMap,S=new WeakMap,C=new WeakMap,x=new WeakMap,w=new WeakMap,l=new WeakMap,a=new WeakSet,Be=function([i,h],f,E){[f,E]=this.screenToPageTranslation(f,E),this.x+=f/i,this.y+=E/h,this.fixAndSetPosition()},A=new WeakSet,je=function(){const[i,h]=this.parentDimensions,{_borderLineWidth:f}=n,E=f/i,O=f/h;switch(this.rotation){case 90:return[-E,O];case 180:return[E,O];case 270:return[E,-O];default:return[-E,-O]}},F=new WeakSet,He=function(i,h,f){switch(f){case 90:return[h,-i];case 180:return[-i,-h];case 270:return[-h,i];default:return[i,h]}},W=new WeakSet,We=function(i){switch(i){case 90:{const[h,f]=this.pageDimensions;return[0,-h/f,f/h,0]}case 180:return[-1,0,0,-1];case 270:{const[h,f]=this.pageDimensions;return[0,h/f,-f/h,0]}default:return[1,0,0,1]}},R=new WeakSet,Ss=function(){if(t(this,m))return;nt(this,m,document.createElement("div")),t(this,m).classList.add("resizers");const i=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||i.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const h of i){const f=document.createElement("div");t(this,m).append(f),f.classList.add("resizer",h),f.addEventListener("pointerdown",V(this,at,Es).bind(this,h)),f.addEventListener("contextmenu",k.noContextMenu)}this.div.prepend(t(this,m))},at=new WeakSet,Es=function(i,h){h.preventDefault();const{isMac:f}=p.FeatureTest.platform;if(h.button!==0||h.ctrlKey&&f)return;const E=V(this,G,ws).bind(this,i),O=this._isDraggable;this._isDraggable=!1;const H={passive:!0,capture:!0};window.addEventListener("pointermove",E,H);const it=this.x,st=this.y,ot=this.width,dt=this.height,vt=this.parent.div.style.cursor,ft=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(h.target).cursor;const Ft=()=>{this._isDraggable=O,window.removeEventListener("pointerup",Ft),window.removeEventListener("blur",Ft),window.removeEventListener("pointermove",E,H),this.parent.div.style.cursor=vt,this.div.style.cursor=ft;const Bt=this.x,Et=this.y,Dt=this.width,pt=this.height;Bt===it&&Et===st&&Dt===ot&&pt===dt||this.addCommands({cmd:()=>{this.width=Dt,this.height=pt,this.x=Bt,this.y=Et;const[et,tt]=this.parentDimensions;this.setDims(et*Dt,tt*pt),this.fixAndSetPosition()},undo:()=>{this.width=ot,this.height=dt,this.x=it,this.y=st;const[et,tt]=this.parentDimensions;this.setDims(et*ot,tt*dt),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",Ft),window.addEventListener("blur",Ft)},G=new WeakSet,ws=function(i,h){const[f,E]=this.parentDimensions,O=this.x,H=this.y,it=this.width,st=this.height,ot=n.MIN_SIZE/f,dt=n.MIN_SIZE/E,vt=_t=>Math.round(_t*1e4)/1e4,ft=V(this,W,We).call(this,this.rotation),Ft=(_t,bt)=>[ft[0]*_t+ft[2]*bt,ft[1]*_t+ft[3]*bt],Bt=V(this,W,We).call(this,360-this.rotation),Et=(_t,bt)=>[Bt[0]*_t+Bt[2]*bt,Bt[1]*_t+Bt[3]*bt];let Dt,pt,et=!1,tt=!1;switch(i){case"topLeft":et=!0,Dt=(_t,bt)=>[0,0],pt=(_t,bt)=>[_t,bt];break;case"topMiddle":Dt=(_t,bt)=>[_t/2,0],pt=(_t,bt)=>[_t/2,bt];break;case"topRight":et=!0,Dt=(_t,bt)=>[_t,0],pt=(_t,bt)=>[0,bt];break;case"middleRight":tt=!0,Dt=(_t,bt)=>[_t,bt/2],pt=(_t,bt)=>[0,bt/2];break;case"bottomRight":et=!0,Dt=(_t,bt)=>[_t,bt],pt=(_t,bt)=>[0,0];break;case"bottomMiddle":Dt=(_t,bt)=>[_t/2,bt],pt=(_t,bt)=>[_t/2,0];break;case"bottomLeft":et=!0,Dt=(_t,bt)=>[0,bt],pt=(_t,bt)=>[_t,0];break;case"middleLeft":tt=!0,Dt=(_t,bt)=>[0,bt/2],pt=(_t,bt)=>[_t,bt/2];break}const ut=Dt(it,st),wt=pt(it,st);let Pt=Ft(...wt);const Wt=vt(O+Pt[0]),qt=vt(H+Pt[1]);let Ht=1,Yt=1,[Xt,Gt]=this.screenToPageTranslation(h.movementX,h.movementY);if([Xt,Gt]=Et(Xt/f,Gt/E),et){const _t=Math.hypot(it,st);Ht=Yt=Math.max(Math.min(Math.hypot(wt[0]-ut[0]-Xt,wt[1]-ut[1]-Gt)/_t,1/it,1/st),ot/it,dt/st)}else tt?Ht=Math.max(ot,Math.min(1,Math.abs(wt[0]-ut[0]-Xt)))/it:Yt=Math.max(dt,Math.min(1,Math.abs(wt[1]-ut[1]-Gt)))/st;const Vt=vt(it*Ht),lt=vt(st*Yt);Pt=Ft(...pt(Vt,lt));const Z=Wt-Pt[0],$=qt-Pt[1];this.width=Vt,this.height=lt,this.x=Z,this.y=$,this.setDims(f*Vt,E*lt),this.fixAndSetPosition()},gt=new WeakSet,qe=async function(){var f;const i=t(this,u);if(!i)return;if(!t(this,D)&&!t(this,P)){i.classList.remove("done"),(f=t(this,L))==null||f.remove();return}n._l10nPromise.get("editor_alt_text_edit_button_label").then(E=>{i.setAttribute("aria-label",E)});let h=t(this,L);if(!h){nt(this,L,h=document.createElement("span")),h.className="tooltip",h.setAttribute("role","tooltip");const E=h.id=`alt-text-tooltip-${this.id}`;i.setAttribute("aria-describedby",E);const O=100;i.addEventListener("mouseenter",()=>{nt(this,_,setTimeout(()=>{nt(this,_,null),t(this,L).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},O))}),i.addEventListener("mouseleave",()=>{var H;clearTimeout(t(this,_)),nt(this,_,null),(H=t(this,L))==null||H.classList.remove("show")})}i.classList.add("done"),h.innerText=t(this,P)?await n._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,D),h.parentNode||i.append(h)},kt=new WeakSet,Cs=function(i){if(!this._isDraggable)return;const h=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let f,E;h&&(f={passive:!0,capture:!0},E=H=>{const[it,st]=this.screenToPageTranslation(H.movementX,H.movementY);this._uiManager.dragSelectedEditors(it,st)},window.addEventListener("pointermove",E,f));const O=()=>{if(window.removeEventListener("pointerup",O),window.removeEventListener("blur",O),h&&window.removeEventListener("pointermove",E,f),nt(this,S,!1),!this._uiManager.endDragSession()){const{isMac:H}=p.FeatureTest.platform;i.ctrlKey&&!H||i.shiftKey||i.metaKey&&H?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",O),window.addEventListener("blur",O)},B(n,F),yt(n,"_borderLineWidth",-1),yt(n,"_colorManager",new c.ColorManager),yt(n,"_zIndex",1),yt(n,"SMALL_EDITOR_SIZE",0);let M=n;e.AnnotationEditor=M;class X extends M{constructor(i){super(i),this.annotationElementId=i.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(z,e,j)=>{var d,m,b,g,S,Ge,w,l,a,I,A,Ts,v,W,Y,R,K,at,ct,G,ht,gt,Tt,kt,T,n,r,i,h,f,E,O,H,it,st,ot,dt,vt,ft,Ft,Bt,Et,Dt,pt,et,tt,ut,Ps,Pt,ze,qt,Xe,Yt,Ce,Gt,Ve,lt,$e,$,re,bt,me,te,Rs,St,xs,Rt,Ye,Ut,_e,At,Ke;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=k,e.opacityToHex=M;var c=j(1),p=j(6);function k(N,s,y){for(const U of y)s.addEventListener(U,N[U].bind(N))}function M(N){return Math.round(Math.min(255,Math.max(1,255*N))).toString(16).padStart(2,"0")}class X{constructor(){B(this,d,0)}getId(){return`${c.AnnotationEditorPrefix}${ge(this,d)._++}`}}d=new WeakMap;const x=class x{constructor(){B(this,S);B(this,m,(0,c.getUuid)());B(this,b,0);B(this,g,null)}static get _isSVGFittingCanvas(){const s='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',U=new OffscreenCanvas(1,3).getContext("2d"),q=new Image;q.src=s;const J=q.decode().then(()=>(U.drawImage(q,0,0,1,1,0,0,1,3),new Uint32Array(U.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,c.shadow)(this,"_isSVGFittingCanvas",J)}async getFromFile(s){const{lastModified:y,name:U,size:q,type:J}=s;return V(this,S,Ge).call(this,`${y}_${U}_${q}_${J}`,s)}async getFromUrl(s){return V(this,S,Ge).call(this,s,s)}async getFromId(s){t(this,g)||nt(this,g,new Map);const y=t(this,g).get(s);return y?y.bitmap?(y.refCounter+=1,y):y.file?this.getFromFile(y.file):this.getFromUrl(y.url):null}getSvgUrl(s){const y=t(this,g).get(s);return y!=null&&y.isSvg?y.svgUrl:null}deleteId(s){t(this,g)||nt(this,g,new Map);const y=t(this,g).get(s);y&&(y.refCounter-=1,y.refCounter===0&&(y.bitmap=null))}isValidId(s){return s.startsWith(`image_${t(this,m)}_`)}};m=new WeakMap,b=new WeakMap,g=new WeakMap,S=new WeakSet,Ge=async function(s,y){t(this,g)||nt(this,g,new Map);let U=t(this,g).get(s);if(U===null)return null;if(U!=null&&U.bitmap)return U.refCounter+=1,U;try{U||(U={bitmap:null,id:`image_${t(this,m)}_${ge(this,b)._++}`,refCounter:0,isSvg:!1});let q;if(typeof y=="string"){U.url=y;const J=await fetch(y);if(!J.ok)throw new Error(J.statusText);q=await J.blob()}else q=U.file=y;if(q.type==="image/svg+xml"){const J=x._isSVGFittingCanvas,rt=new FileReader,mt=new Image,Ct=new Promise((xt,zt)=>{mt.onload=()=>{U.bitmap=mt,U.isSvg=!0,xt()},rt.onload=async()=>{const Mt=U.svgUrl=rt.result;mt.src=await J?`${Mt}#svgView(preserveAspectRatio(none))`:Mt},mt.onerror=rt.onerror=zt});rt.readAsDataURL(q),await Ct}else U.bitmap=await createImageBitmap(q);U.refCounter=1}catch(q){console.error(q),U=null}return t(this,g).set(s,U),U&&t(this,g).set(U.id,U),U};let D=x;class P{constructor(s=128){B(this,w,[]);B(this,l,!1);B(this,a,void 0);B(this,I,-1);nt(this,a,s)}add({cmd:s,undo:y,mustExec:U,type:q=NaN,overwriteIfSameType:J=!1,keepUndo:rt=!1}){if(U&&s(),t(this,l))return;const mt={cmd:s,undo:y,type:q};if(t(this,I)===-1){t(this,w).length>0&&(t(this,w).length=0),nt(this,I,0),t(this,w).push(mt);return}if(J&&t(this,w)[t(this,I)].type===q){rt&&(mt.undo=t(this,w)[t(this,I)].undo),t(this,w)[t(this,I)]=mt;return}const Ct=t(this,I)+1;Ct===t(this,a)?t(this,w).splice(0,1):(nt(this,I,Ct),Ct<t(this,w).length&&t(this,w).splice(Ct)),t(this,w).push(mt)}undo(){t(this,I)!==-1&&(nt(this,l,!0),t(this,w)[t(this,I)].undo(),nt(this,l,!1),nt(this,I,t(this,I)-1))}redo(){t(this,I)<t(this,w).length-1&&(nt(this,I,t(this,I)+1),nt(this,l,!0),t(this,w)[t(this,I)].cmd(),nt(this,l,!1))}hasSomethingToUndo(){return t(this,I)!==-1}hasSomethingToRedo(){return t(this,I)<t(this,w).length-1}destroy(){nt(this,w,null)}}w=new WeakMap,l=new WeakMap,a=new WeakMap,I=new WeakMap,e.CommandManager=P;class u{constructor(s){B(this,A);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:y}=c.FeatureTest.platform;for(const[U,q,J={}]of s)for(const rt of U){const mt=rt.startsWith("mac+");y&&mt?(this.callbacks.set(rt.slice(4),{callback:q,options:J}),this.allKeys.add(rt.split("+").at(-1))):!y&&!mt&&(this.callbacks.set(rt,{callback:q,options:J}),this.allKeys.add(rt.split("+").at(-1)))}}exec(s,y){if(!this.allKeys.has(y.key))return;const U=this.callbacks.get(V(this,A,Ts).call(this,y));if(!U)return;const{callback:q,options:{bubbles:J=!1,args:rt=[],checker:mt=null}}=U;mt&&!mt(s,y)||(q.bind(s,...rt)(),J||(y.stopPropagation(),y.preventDefault()))}}A=new WeakSet,Ts=function(s){s.altKey&&this.buffer.push("alt"),s.ctrlKey&&this.buffer.push("ctrl"),s.metaKey&&this.buffer.push("meta"),s.shiftKey&&this.buffer.push("shift"),this.buffer.push(s.key);const y=this.buffer.join("+");return this.buffer.length=0,y},e.KeyboardManager=u;const F=class F{get _colors(){const s=new Map([["CanvasText",null],["Canvas",null]]);return(0,p.getColorValues)(s),(0,c.shadow)(this,"_colors",s)}convert(s){const y=(0,p.getRGB)(s);if(!window.matchMedia("(forced-colors: active)").matches)return y;for(const[U,q]of this._colors)if(q.every((J,rt)=>J===y[rt]))return F._colorsMapping.get(U);return y}getHexCode(s){const y=this._colors.get(s);return y?c.Util.makeHexColor(...y):s}};yt(F,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let L=F;e.ColorManager=L;const Lt=class Lt{constructor(s,y,U,q,J,rt){B(this,ut);B(this,Pt);B(this,qt);B(this,Yt);B(this,Gt);B(this,lt);B(this,$);B(this,bt);B(this,te);B(this,St);B(this,Rt);B(this,Ut);B(this,At);B(this,v,null);B(this,W,new Map);B(this,Y,new Map);B(this,R,null);B(this,K,null);B(this,at,new P);B(this,ct,0);B(this,G,new Set);B(this,ht,null);B(this,gt,null);B(this,Tt,new Set);B(this,kt,null);B(this,T,new X);B(this,n,!1);B(this,r,!1);B(this,i,null);B(this,h,c.AnnotationEditorType.NONE);B(this,f,new Set);B(this,E,null);B(this,O,this.blur.bind(this));B(this,H,this.focus.bind(this));B(this,it,this.copy.bind(this));B(this,st,this.cut.bind(this));B(this,ot,this.paste.bind(this));B(this,dt,this.keydown.bind(this));B(this,vt,this.onEditingAction.bind(this));B(this,ft,this.onPageChanging.bind(this));B(this,Ft,this.onScaleChanging.bind(this));B(this,Bt,this.onRotationChanging.bind(this));B(this,Et,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});B(this,Dt,[0,0]);B(this,pt,null);B(this,et,null);B(this,tt,null);nt(this,et,s),nt(this,tt,y),nt(this,R,U),this._eventBus=q,this._eventBus._on("editingaction",t(this,vt)),this._eventBus._on("pagechanging",t(this,ft)),this._eventBus._on("scalechanging",t(this,Ft)),this._eventBus._on("rotationchanging",t(this,Bt)),nt(this,K,J.annotationStorage),nt(this,kt,J.filterFactory),nt(this,E,rt),this.viewParameters={realScale:p.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const s=Lt.prototype,y=J=>{const{activeElement:rt}=document;return rt&&t(J,et).contains(rt)&&J.hasSomethingToControl()},U=this.TRANSLATE_SMALL,q=this.TRANSLATE_BIG;return(0,c.shadow)(this,"_keyboardManager",new u([[["ctrl+a","mac+meta+a"],s.selectAll],[["ctrl+z","mac+meta+z"],s.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],s.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],s.delete],[["Escape","mac+Escape"],s.unselectAll],[["ArrowLeft","mac+ArrowLeft"],s.translateSelectedEditors,{args:[-U,0],checker:y}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],s.translateSelectedEditors,{args:[-q,0],checker:y}],[["ArrowRight","mac+ArrowRight"],s.translateSelectedEditors,{args:[U,0],checker:y}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],s.translateSelectedEditors,{args:[q,0],checker:y}],[["ArrowUp","mac+ArrowUp"],s.translateSelectedEditors,{args:[0,-U],checker:y}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],s.translateSelectedEditors,{args:[0,-q],checker:y}],[["ArrowDown","mac+ArrowDown"],s.translateSelectedEditors,{args:[0,U],checker:y}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],s.translateSelectedEditors,{args:[0,q],checker:y}]]))}destroy(){V(this,Yt,Ce).call(this),V(this,Pt,ze).call(this),this._eventBus._off("editingaction",t(this,vt)),this._eventBus._off("pagechanging",t(this,ft)),this._eventBus._off("scalechanging",t(this,Ft)),this._eventBus._off("rotationchanging",t(this,Bt));for(const s of t(this,Y).values())s.destroy();t(this,Y).clear(),t(this,W).clear(),t(this,Tt).clear(),nt(this,v,null),t(this,f).clear(),t(this,at).destroy(),t(this,R).destroy()}get hcmFilter(){return(0,c.shadow)(this,"hcmFilter",t(this,E)?t(this,kt).addHCMFilter(t(this,E).foreground,t(this,E).background):"none")}get direction(){return(0,c.shadow)(this,"direction",getComputedStyle(t(this,et)).direction)}editAltText(s){var y;(y=t(this,R))==null||y.editAltText(this,s)}onPageChanging({pageNumber:s}){nt(this,ct,s-1)}focusMainContainer(){t(this,et).focus()}findParent(s,y){for(const U of t(this,Y).values()){const{x:q,y:J,width:rt,height:mt}=U.div.getBoundingClientRect();if(s>=q&&s<=q+rt&&y>=J&&y<=J+mt)return U}return null}disableUserSelect(s=!1){t(this,tt).classList.toggle("noUserSelect",s)}addShouldRescale(s){t(this,Tt).add(s)}removeShouldRescale(s){t(this,Tt).delete(s)}onScaleChanging({scale:s}){this.commitOrRemove(),this.viewParameters.realScale=s*p.PixelsPerInch.PDF_TO_CSS_UNITS;for(const y of t(this,Tt))y.onScaleChanging()}onRotationChanging({pagesRotation:s}){this.commitOrRemove(),this.viewParameters.rotation=s}addToAnnotationStorage(s){!s.isEmpty()&&t(this,K)&&!t(this,K).has(s.id)&&t(this,K).setValue(s.id,s)}blur(){if(!this.hasSelection)return;const{activeElement:s}=document;for(const y of t(this,f))if(y.div.contains(s)){nt(this,i,[y,s]),y._focusEventsAllowed=!1;break}}focus(){if(!t(this,i))return;const[s,y]=t(this,i);nt(this,i,null),y.addEventListener("focusin",()=>{s._focusEventsAllowed=!0},{once:!0}),y.focus()}addEditListeners(){V(this,qt,Xe).call(this),V(this,Gt,Ve).call(this)}removeEditListeners(){V(this,Yt,Ce).call(this),V(this,lt,$e).call(this)}copy(s){var U;if(s.preventDefault(),(U=t(this,v))==null||U.commitOrRemove(),!this.hasSelection)return;const y=[];for(const q of t(this,f)){const J=q.serialize(!0);J&&y.push(J)}y.length!==0&&s.clipboardData.setData("application/pdfjs",JSON.stringify(y))}cut(s){this.copy(s),this.delete()}paste(s){s.preventDefault();const{clipboardData:y}=s;for(const J of y.items)for(const rt of t(this,gt))if(rt.isHandlingMimeForPasting(J.type)){rt.paste(J,this.currentLayer);return}let U=y.getData("application/pdfjs");if(!U)return;try{U=JSON.parse(U)}catch(J){(0,c.warn)(`paste: "${J.message}".`);return}if(!Array.isArray(U))return;this.unselectAll();const q=this.currentLayer;try{const J=[];for(const Ct of U){const xt=q.deserialize(Ct);if(!xt)return;J.push(xt)}const rt=()=>{for(const Ct of J)V(this,Rt,Ye).call(this,Ct);V(this,At,Ke).call(this,J)},mt=()=>{for(const Ct of J)Ct.remove()};this.addCommands({cmd:rt,undo:mt,mustExec:!0})}catch(J){(0,c.warn)(`paste: "${J.message}".`)}}keydown(s){var y;(y=this.getActive())!=null&&y.shouldGetKeyboardEvents()||Lt._keyboardManager.exec(this,s)}onEditingAction(s){["undo","redo","delete","selectAll"].includes(s.name)&&this[s.name]()}setEditingState(s){s?(V(this,ut,Ps).call(this),V(this,qt,Xe).call(this),V(this,Gt,Ve).call(this),V(this,$,re).call(this,{isEditing:t(this,h)!==c.AnnotationEditorType.NONE,isEmpty:V(this,Ut,_e).call(this),hasSomethingToUndo:t(this,at).hasSomethingToUndo(),hasSomethingToRedo:t(this,at).hasSomethingToRedo(),hasSelectedEditor:!1})):(V(this,Pt,ze).call(this),V(this,Yt,Ce).call(this),V(this,lt,$e).call(this),V(this,$,re).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(s){if(!t(this,gt)){nt(this,gt,s);for(const y of t(this,gt))V(this,bt,me).call(this,y.defaultPropertiesToUpdate)}}getId(){return t(this,T).getId()}get currentLayer(){return t(this,Y).get(t(this,ct))}getLayer(s){return t(this,Y).get(s)}get currentPageIndex(){return t(this,ct)}addLayer(s){t(this,Y).set(s.pageIndex,s),t(this,n)?s.enable():s.disable()}removeLayer(s){t(this,Y).delete(s.pageIndex)}updateMode(s,y=null){if(t(this,h)!==s){if(nt(this,h,s),s===c.AnnotationEditorType.NONE){this.setEditingState(!1),V(this,St,xs).call(this);return}this.setEditingState(!0),V(this,te,Rs).call(this),this.unselectAll();for(const U of t(this,Y).values())U.updateMode(s);if(y){for(const U of t(this,W).values())if(U.annotationElementId===y){this.setSelected(U),U.enterInEditMode();break}}}}updateToolbar(s){s!==t(this,h)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:s})}updateParams(s,y){if(t(this,gt)){if(s===c.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(s);return}for(const U of t(this,f))U.updateParams(s,y);for(const U of t(this,gt))U.updateDefaultParams(s,y)}}enableWaiting(s=!1){if(t(this,r)!==s){nt(this,r,s);for(const y of t(this,Y).values())s?y.disableClick():y.enableClick(),y.div.classList.toggle("waiting",s)}}getEditors(s){const y=[];for(const U of t(this,W).values())U.pageIndex===s&&y.push(U);return y}getEditor(s){return t(this,W).get(s)}addEditor(s){t(this,W).set(s.id,s)}removeEditor(s){var y;t(this,W).delete(s.id),this.unselect(s),(!s.annotationElementId||!t(this,G).has(s.annotationElementId))&&((y=t(this,K))==null||y.remove(s.id))}addDeletedAnnotationElement(s){t(this,G).add(s.annotationElementId),s.deleted=!0}isDeletedAnnotationElement(s){return t(this,G).has(s)}removeDeletedAnnotationElement(s){t(this,G).delete(s.annotationElementId),s.deleted=!1}setActiveEditor(s){t(this,v)!==s&&(nt(this,v,s),s&&V(this,bt,me).call(this,s.propertiesToUpdate))}toggleSelected(s){if(t(this,f).has(s)){t(this,f).delete(s),s.unselect(),V(this,$,re).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,f).add(s),s.select(),V(this,bt,me).call(this,s.propertiesToUpdate),V(this,$,re).call(this,{hasSelectedEditor:!0})}setSelected(s){for(const y of t(this,f))y!==s&&y.unselect();t(this,f).clear(),t(this,f).add(s),s.select(),V(this,bt,me).call(this,s.propertiesToUpdate),V(this,$,re).call(this,{hasSelectedEditor:!0})}isSelected(s){return t(this,f).has(s)}unselect(s){s.unselect(),t(this,f).delete(s),V(this,$,re).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,f).size!==0}undo(){t(this,at).undo(),V(this,$,re).call(this,{hasSomethingToUndo:t(this,at).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:V(this,Ut,_e).call(this)})}redo(){t(this,at).redo(),V(this,$,re).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,at).hasSomethingToRedo(),isEmpty:V(this,Ut,_e).call(this)})}addCommands(s){t(this,at).add(s),V(this,$,re).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:V(this,Ut,_e).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const s=[...t(this,f)],y=()=>{for(const q of s)q.remove()},U=()=>{for(const q of s)V(this,Rt,Ye).call(this,q)};this.addCommands({cmd:y,undo:U,mustExec:!0})}commitOrRemove(){var s;(s=t(this,v))==null||s.commitOrRemove()}hasSomethingToControl(){return t(this,v)||this.hasSelection}selectAll(){for(const s of t(this,f))s.commit();V(this,At,Ke).call(this,t(this,W).values())}unselectAll(){if(t(this,v)){t(this,v).commitOrRemove();return}if(this.hasSelection){for(const s of t(this,f))s.unselect();t(this,f).clear(),V(this,$,re).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(s,y,U=!1){if(U||this.commitOrRemove(),!this.hasSelection)return;t(this,Dt)[0]+=s,t(this,Dt)[1]+=y;const[q,J]=t(this,Dt),rt=[...t(this,f)],mt=1e3;t(this,pt)&&clearTimeout(t(this,pt)),nt(this,pt,setTimeout(()=>{nt(this,pt,null),t(this,Dt)[0]=t(this,Dt)[1]=0,this.addCommands({cmd:()=>{for(const Ct of rt)t(this,W).has(Ct.id)&&Ct.translateInPage(q,J)},undo:()=>{for(const Ct of rt)t(this,W).has(Ct.id)&&Ct.translateInPage(-q,-J)},mustExec:!1})},mt));for(const Ct of rt)Ct.translateInPage(s,y)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),nt(this,ht,new Map);for(const s of t(this,f))t(this,ht).set(s,{savedX:s.x,savedY:s.y,savedPageIndex:s.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,ht))return!1;this.disableUserSelect(!1);const s=t(this,ht);nt(this,ht,null);let y=!1;for(const[{x:q,y:J,pageIndex:rt},mt]of s)mt.newX=q,mt.newY=J,mt.newPageIndex=rt,y||(y=q!==mt.savedX||J!==mt.savedY||rt!==mt.savedPageIndex);if(!y)return!1;const U=(q,J,rt,mt)=>{if(t(this,W).has(q.id)){const Ct=t(this,Y).get(mt);Ct?q._setParentAndPosition(Ct,J,rt):(q.pageIndex=mt,q.x=J,q.y=rt)}};return this.addCommands({cmd:()=>{for(const[q,{newX:J,newY:rt,newPageIndex:mt}]of s)U(q,J,rt,mt)},undo:()=>{for(const[q,{savedX:J,savedY:rt,savedPageIndex:mt}]of s)U(q,J,rt,mt)},mustExec:!0}),!0}dragSelectedEditors(s,y){if(t(this,ht))for(const U of t(this,ht).keys())U.drag(s,y)}rebuild(s){if(s.parent===null){const y=this.getLayer(s.pageIndex);y?(y.changeParent(s),y.addOrRebuild(s)):(this.addEditor(s),this.addToAnnotationStorage(s),s.rebuild())}else s.parent.addOrRebuild(s)}isActive(s){return t(this,v)===s}getActive(){return t(this,v)}getMode(){return t(this,h)}get imageManager(){return(0,c.shadow)(this,"imageManager",new D)}};v=new WeakMap,W=new WeakMap,Y=new WeakMap,R=new WeakMap,K=new WeakMap,at=new WeakMap,ct=new WeakMap,G=new WeakMap,ht=new WeakMap,gt=new WeakMap,Tt=new WeakMap,kt=new WeakMap,T=new WeakMap,n=new WeakMap,r=new WeakMap,i=new WeakMap,h=new WeakMap,f=new WeakMap,E=new WeakMap,O=new WeakMap,H=new WeakMap,it=new WeakMap,st=new WeakMap,ot=new WeakMap,dt=new WeakMap,vt=new WeakMap,ft=new WeakMap,Ft=new WeakMap,Bt=new WeakMap,Et=new WeakMap,Dt=new WeakMap,pt=new WeakMap,et=new WeakMap,tt=new WeakMap,ut=new WeakSet,Ps=function(){window.addEventListener("focus",t(this,H)),window.addEventListener("blur",t(this,O))},Pt=new WeakSet,ze=function(){window.removeEventListener("focus",t(this,H)),window.removeEventListener("blur",t(this,O))},qt=new WeakSet,Xe=function(){window.addEventListener("keydown",t(this,dt),{capture:!0})},Yt=new WeakSet,Ce=function(){window.removeEventListener("keydown",t(this,dt),{capture:!0})},Gt=new WeakSet,Ve=function(){document.addEventListener("copy",t(this,it)),document.addEventListener("cut",t(this,st)),document.addEventListener("paste",t(this,ot))},lt=new WeakSet,$e=function(){document.removeEventListener("copy",t(this,it)),document.removeEventListener("cut",t(this,st)),document.removeEventListener("paste",t(this,ot))},$=new WeakSet,re=function(s){Object.entries(s).some(([U,q])=>t(this,Et)[U]!==q)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,Et),s)})},bt=new WeakSet,me=function(s){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:s})},te=new WeakSet,Rs=function(){if(!t(this,n)){nt(this,n,!0);for(const s of t(this,Y).values())s.enable()}},St=new WeakSet,xs=function(){if(this.unselectAll(),t(this,n)){nt(this,n,!1);for(const s of t(this,Y).values())s.disable()}},Rt=new WeakSet,Ye=function(s){const y=t(this,Y).get(s.pageIndex);y?y.addOrRebuild(s):this.addEditor(s)},Ut=new WeakSet,_e=function(){if(t(this,W).size===0)return!0;if(t(this,W).size===1)for(const s of t(this,W).values())return s.isEmpty();return!1},At=new WeakSet,Ke=function(s){t(this,f).clear();for(const y of s)y.isEmpty()||(t(this,f).add(y),y.select());V(this,$,re).call(this,{hasSelectedEditor:!0})},yt(Lt,"TRANSLATE_SMALL",1),yt(Lt,"TRANSLATE_BIG",10);let _=Lt;e.AnnotationEditorUIManager=_},(z,e,j)=>{var ct,G,ht,gt,Tt,kt,T,n,r,i,h,f,de,O,ue,it,Je,ot,Te,vt,Pe,Ft,be,Et,Ae;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=I,e.getColorValues=W,e.getCurrentTransform=Y,e.getCurrentTransformInverse=R,e.getFilenameFromUrl=S,e.getPdfFilenameFromUrl=C,e.getRGB=v,e.getXfaPageViewport=F,e.isDataScheme=b,e.isPdfFile=g,e.isValidFetchUrl=w,e.loadScript=a,e.noContextMenu=l,e.setLayerDimensions=K;var c=j(7),p=j(1);const k="http://www.w3.org/2000/svg",at=class at{};yt(at,"CSS",96),yt(at,"PDF",72),yt(at,"PDF_TO_CSS_UNITS",at.CSS/at.PDF);let M=at;e.PixelsPerInch=M;class X extends c.BaseFilterFactory{constructor({docId:tt,ownerDocument:ut=globalThis.document}={}){super();B(this,f);B(this,O);B(this,it);B(this,ot);B(this,vt);B(this,Ft);B(this,Et);B(this,ct,void 0);B(this,G,void 0);B(this,ht,void 0);B(this,gt,void 0);B(this,Tt,void 0);B(this,kt,void 0);B(this,T,void 0);B(this,n,void 0);B(this,r,void 0);B(this,i,void 0);B(this,h,0);nt(this,ht,tt),nt(this,gt,ut)}addFilter(tt){if(!tt)return"none";let ut=t(this,f,de).get(tt);if(ut)return ut;let wt,Pt,Wt,qt;if(tt.length===1){const Gt=tt[0],Vt=new Array(256);for(let lt=0;lt<256;lt++)Vt[lt]=Gt[lt]/255;qt=wt=Pt=Wt=Vt.join(",")}else{const[Gt,Vt,lt]=tt,Z=new Array(256),$=new Array(256),_t=new Array(256);for(let bt=0;bt<256;bt++)Z[bt]=Gt[bt]/255,$[bt]=Vt[bt]/255,_t[bt]=lt[bt]/255;wt=Z.join(","),Pt=$.join(","),Wt=_t.join(","),qt=`${wt}${Pt}${Wt}`}if(ut=t(this,f,de).get(qt),ut)return t(this,f,de).set(tt,ut),ut;const Ht=`g_${t(this,ht)}_transfer_map_${ge(this,h)._++}`,Yt=`url(#${Ht})`;t(this,f,de).set(tt,Yt),t(this,f,de).set(qt,Yt);const Xt=V(this,ot,Te).call(this,Ht);return V(this,Ft,be).call(this,wt,Pt,Wt,Xt),Yt}addHCMFilter(tt,ut){var Vt;const wt=`${tt}-${ut}`;if(t(this,kt)===wt)return t(this,T);if(nt(this,kt,wt),nt(this,T,"none"),(Vt=t(this,Tt))==null||Vt.remove(),!tt||!ut)return t(this,T);const Pt=V(this,Et,Ae).call(this,tt);tt=p.Util.makeHexColor(...Pt);const Wt=V(this,Et,Ae).call(this,ut);if(ut=p.Util.makeHexColor(...Wt),t(this,O,ue).style.color="",tt==="#000000"&&ut==="#ffffff"||tt===ut)return t(this,T);const qt=new Array(256);for(let lt=0;lt<=255;lt++){const Z=lt/255;qt[lt]=Z<=.03928?Z/12.92:((Z+.055)/1.055)**2.4}const Ht=qt.join(","),Yt=`g_${t(this,ht)}_hcm_filter`,Xt=nt(this,n,V(this,ot,Te).call(this,Yt));V(this,Ft,be).call(this,Ht,Ht,Ht,Xt),V(this,it,Je).call(this,Xt);const Gt=(lt,Z)=>{const $=Pt[lt]/255,_t=Wt[lt]/255,bt=new Array(Z+1);for(let ee=0;ee<=Z;ee++)bt[ee]=$+ee/Z*(_t-$);return bt.join(",")};return V(this,Ft,be).call(this,Gt(0,5),Gt(1,5),Gt(2,5),Xt),nt(this,T,`url(#${Yt})`),t(this,T)}addHighlightHCMFilter(tt,ut,wt,Pt){var _t;const Wt=`${tt}-${ut}-${wt}-${Pt}`;if(t(this,r)===Wt)return t(this,i);if(nt(this,r,Wt),nt(this,i,"none"),(_t=t(this,n))==null||_t.remove(),!tt||!ut)return t(this,i);const[qt,Ht]=[tt,ut].map(V(this,Et,Ae).bind(this));let Yt=Math.round(.2126*qt[0]+.7152*qt[1]+.0722*qt[2]),Xt=Math.round(.2126*Ht[0]+.7152*Ht[1]+.0722*Ht[2]),[Gt,Vt]=[wt,Pt].map(V(this,Et,Ae).bind(this));Xt<Yt&&([Yt,Xt,Gt,Vt]=[Xt,Yt,Vt,Gt]),t(this,O,ue).style.color="";const lt=(bt,ee,te)=>{const Q=new Array(256),St=(Xt-Yt)/te,Ot=bt/255,Rt=(ee-bt)/(255*te);let Nt=0;for(let Ut=0;Ut<=te;Ut++){const Qt=Math.round(Yt+Ut*St),At=Ot+Ut*Rt;for(let Kt=Nt;Kt<=Qt;Kt++)Q[Kt]=At;Nt=Qt+1}for(let Ut=Nt;Ut<256;Ut++)Q[Ut]=Q[Nt-1];return Q.join(",")},Z=`g_${t(this,ht)}_hcm_highlight_filter`,$=nt(this,n,V(this,ot,Te).call(this,Z));return V(this,it,Je).call(this,$),V(this,Ft,be).call(this,lt(Gt[0],Vt[0],5),lt(Gt[1],Vt[1],5),lt(Gt[2],Vt[2],5),$),nt(this,i,`url(#${Z})`),t(this,i)}destroy(tt=!1){tt&&(t(this,T)||t(this,i))||(t(this,G)&&(t(this,G).parentNode.parentNode.remove(),nt(this,G,null)),t(this,ct)&&(t(this,ct).clear(),nt(this,ct,null)),nt(this,h,0))}}ct=new WeakMap,G=new WeakMap,ht=new WeakMap,gt=new WeakMap,Tt=new WeakMap,kt=new WeakMap,T=new WeakMap,n=new WeakMap,r=new WeakMap,i=new WeakMap,h=new WeakMap,f=new WeakSet,de=function(){return t(this,ct)||nt(this,ct,new Map)},O=new WeakSet,ue=function(){if(!t(this,G)){const tt=t(this,gt).createElement("div"),{style:ut}=tt;ut.visibility="hidden",ut.contain="strict",ut.width=ut.height=0,ut.position="absolute",ut.top=ut.left=0,ut.zIndex=-1;const wt=t(this,gt).createElementNS(k,"svg");wt.setAttribute("width",0),wt.setAttribute("height",0),nt(this,G,t(this,gt).createElementNS(k,"defs")),tt.append(wt),wt.append(t(this,G)),t(this,gt).body.append(tt)}return t(this,G)},it=new WeakSet,Je=function(tt){const ut=t(this,gt).createElementNS(k,"feColorMatrix");ut.setAttribute("type","matrix"),ut.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),tt.append(ut)},ot=new WeakSet,Te=function(tt){const ut=t(this,gt).createElementNS(k,"filter");return ut.setAttribute("color-interpolation-filters","sRGB"),ut.setAttribute("id",tt),t(this,O,ue).append(ut),ut},vt=new WeakSet,Pe=function(tt,ut,wt){const Pt=t(this,gt).createElementNS(k,ut);Pt.setAttribute("type","discrete"),Pt.setAttribute("tableValues",wt),tt.append(Pt)},Ft=new WeakSet,be=function(tt,ut,wt,Pt){const Wt=t(this,gt).createElementNS(k,"feComponentTransfer");Pt.append(Wt),V(this,vt,Pe).call(this,Wt,"feFuncR",tt),V(this,vt,Pe).call(this,Wt,"feFuncG",ut),V(this,vt,Pe).call(this,Wt,"feFuncB",wt)},Et=new WeakSet,Ae=function(tt){return t(this,O,ue).style.color=tt,v(getComputedStyle(t(this,O,ue)).getPropertyValue("color"))},e.DOMFilterFactory=X;class D extends c.BaseCanvasFactory{constructor({ownerDocument:et=globalThis.document}={}){super(),this._document=et}_createCanvas(et,tt){const ut=this._document.createElement("canvas");return ut.width=et,ut.height=tt,ut}}e.DOMCanvasFactory=D;async function P(pt,et=!1){if(w(pt,document.baseURI)){const tt=await fetch(pt);if(!tt.ok)throw new Error(tt.statusText);return et?new Uint8Array(await tt.arrayBuffer()):(0,p.stringToBytes)(await tt.text())}return new Promise((tt,ut)=>{const wt=new XMLHttpRequest;wt.open("GET",pt,!0),et&&(wt.responseType="arraybuffer"),wt.onreadystatechange=()=>{if(wt.readyState===XMLHttpRequest.DONE){if(wt.status===200||wt.status===0){let Pt;if(et&&wt.response?Pt=new Uint8Array(wt.response):!et&&wt.responseText&&(Pt=(0,p.stringToBytes)(wt.responseText)),Pt){tt(Pt);return}}ut(new Error(wt.statusText))}},wt.send(null)})}class u extends c.BaseCMapReaderFactory{_fetchData(et,tt){return P(et,this.isCompressed).then(ut=>({cMapData:ut,compressionType:tt}))}}e.DOMCMapReaderFactory=u;class L extends c.BaseStandardFontDataFactory{_fetchData(et){return P(et,!0)}}e.DOMStandardFontDataFactory=L;class _ extends c.BaseSVGFactory{_createSVG(et){return document.createElementNS(k,et)}}e.DOMSVGFactory=_;class d{constructor({viewBox:et,scale:tt,rotation:ut,offsetX:wt=0,offsetY:Pt=0,dontFlip:Wt=!1}){this.viewBox=et,this.scale=tt,this.rotation=ut,this.offsetX=wt,this.offsetY=Pt;const qt=(et[2]+et[0])/2,Ht=(et[3]+et[1])/2;let Yt,Xt,Gt,Vt;switch(ut%=360,ut<0&&(ut+=360),ut){case 180:Yt=-1,Xt=0,Gt=0,Vt=1;break;case 90:Yt=0,Xt=1,Gt=1,Vt=0;break;case 270:Yt=0,Xt=-1,Gt=-1,Vt=0;break;case 0:Yt=1,Xt=0,Gt=0,Vt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Wt&&(Gt=-Gt,Vt=-Vt);let lt,Z,$,_t;Yt===0?(lt=Math.abs(Ht-et[1])*tt+wt,Z=Math.abs(qt-et[0])*tt+Pt,$=(et[3]-et[1])*tt,_t=(et[2]-et[0])*tt):(lt=Math.abs(qt-et[0])*tt+wt,Z=Math.abs(Ht-et[1])*tt+Pt,$=(et[2]-et[0])*tt,_t=(et[3]-et[1])*tt),this.transform=[Yt*tt,Xt*tt,Gt*tt,Vt*tt,lt-Yt*tt*qt-Gt*tt*Ht,Z-Xt*tt*qt-Vt*tt*Ht],this.width=$,this.height=_t}get rawDims(){const{viewBox:et}=this;return(0,p.shadow)(this,"rawDims",{pageWidth:et[2]-et[0],pageHeight:et[3]-et[1],pageX:et[0],pageY:et[1]})}clone({scale:et=this.scale,rotation:tt=this.rotation,offsetX:ut=this.offsetX,offsetY:wt=this.offsetY,dontFlip:Pt=!1}={}){return new d({viewBox:this.viewBox.slice(),scale:et,rotation:tt,offsetX:ut,offsetY:wt,dontFlip:Pt})}convertToViewportPoint(et,tt){return p.Util.applyTransform([et,tt],this.transform)}convertToViewportRectangle(et){const tt=p.Util.applyTransform([et[0],et[1]],this.transform),ut=p.Util.applyTransform([et[2],et[3]],this.transform);return[tt[0],tt[1],ut[0],ut[1]]}convertToPdfPoint(et,tt){return p.Util.applyInverseTransform([et,tt],this.transform)}}e.PageViewport=d;class m extends p.BaseException{constructor(et,tt=0){super(et,"RenderingCancelledException"),this.extraDelay=tt}}e.RenderingCancelledException=m;function b(pt){const et=pt.length;let tt=0;for(;tt<et&&pt[tt].trim()==="";)tt++;return pt.substring(tt,tt+5).toLowerCase()==="data:"}function g(pt){return typeof pt=="string"&&/\.pdf$/i.test(pt)}function S(pt,et=!1){return et||([pt]=pt.split(/[#?]/,1)),pt.substring(pt.lastIndexOf("/")+1)}function C(pt,et="document.pdf"){if(typeof pt!="string")return et;if(b(pt))return(0,p.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),et;const tt=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,ut=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,wt=tt.exec(pt);let Pt=ut.exec(wt[1])||ut.exec(wt[2])||ut.exec(wt[3]);if(Pt&&(Pt=Pt[0],Pt.includes("%")))try{Pt=ut.exec(decodeURIComponent(Pt))[0]}catch(Wt){}return Pt||et}class x{constructor(){yt(this,"started",Object.create(null));yt(this,"times",[])}time(et){et in this.started&&(0,p.warn)(`Timer is already running for ${et}`),this.started[et]=Date.now()}timeEnd(et){et in this.started||(0,p.warn)(`Timer has not been started for ${et}`),this.times.push({name:et,start:this.started[et],end:Date.now()}),delete this.started[et]}toString(){const et=[];let tt=0;for(const{name:ut}of this.times)tt=Math.max(ut.length,tt);for(const{name:ut,start:wt,end:Pt}of this.times)et.push(`${ut.padEnd(tt)} ${Pt-wt}ms
`);return et.join("")}}e.StatTimer=x;function w(pt,et){try{const{protocol:tt}=et?new URL(pt,et):new URL(pt);return tt==="http:"||tt==="https:"}catch(tt){return!1}}function l(pt){pt.preventDefault()}function a(pt,et=!1){return new Promise((tt,ut)=>{const wt=document.createElement("script");wt.src=pt,wt.onload=function(Pt){et&&wt.remove(),tt(Pt)},wt.onerror=function(){ut(new Error(`Cannot load script at: ${wt.src}`))},(document.head||document.documentElement).append(wt)})}function I(pt){console.log("Deprecated API usage: "+pt)}let A;class o{static toDateObject(et){if(!et||typeof et!="string")return null;A||(A=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const tt=A.exec(et);if(!tt)return null;const ut=parseInt(tt[1],10);let wt=parseInt(tt[2],10);wt=wt>=1&&wt<=12?wt-1:0;let Pt=parseInt(tt[3],10);Pt=Pt>=1&&Pt<=31?Pt:1;let Wt=parseInt(tt[4],10);Wt=Wt>=0&&Wt<=23?Wt:0;let qt=parseInt(tt[5],10);qt=qt>=0&&qt<=59?qt:0;let Ht=parseInt(tt[6],10);Ht=Ht>=0&&Ht<=59?Ht:0;const Yt=tt[7]||"Z";let Xt=parseInt(tt[8],10);Xt=Xt>=0&&Xt<=23?Xt:0;let Gt=parseInt(tt[9],10)||0;return Gt=Gt>=0&&Gt<=59?Gt:0,Yt==="-"?(Wt+=Xt,qt+=Gt):Yt==="+"&&(Wt-=Xt,qt-=Gt),new Date(Date.UTC(ut,wt,Pt,Wt,qt,Ht))}}e.PDFDateString=o;function F(pt,{scale:et=1,rotation:tt=0}){const{width:ut,height:wt}=pt.attributes.style,Pt=[0,0,parseInt(ut),parseInt(wt)];return new d({viewBox:Pt,scale:et,rotation:tt})}function v(pt){if(pt.startsWith("#")){const et=parseInt(pt.slice(1),16);return[(et&16711680)>>16,(et&65280)>>8,et&255]}return pt.startsWith("rgb(")?pt.slice(4,-1).split(",").map(et=>parseInt(et)):pt.startsWith("rgba(")?pt.slice(5,-1).split(",").map(et=>parseInt(et)).slice(0,3):((0,p.warn)(`Not a valid color format: "${pt}"`),[0,0,0])}function W(pt){const et=document.createElement("span");et.style.visibility="hidden",document.body.append(et);for(const tt of pt.keys()){et.style.color=tt;const ut=window.getComputedStyle(et).color;pt.set(tt,v(ut))}et.remove()}function Y(pt){const{a:et,b:tt,c:ut,d:wt,e:Pt,f:Wt}=pt.getTransform();return[et,tt,ut,wt,Pt,Wt]}function R(pt){const{a:et,b:tt,c:ut,d:wt,e:Pt,f:Wt}=pt.getTransform().invertSelf();return[et,tt,ut,wt,Pt,Wt]}function K(pt,et,tt=!1,ut=!0){if(et instanceof d){const{pageWidth:wt,pageHeight:Pt}=et.rawDims,{style:Wt}=pt,qt=p.FeatureTest.isCSSRoundSupported,Ht=`var(--scale-factor) * ${wt}px`,Yt=`var(--scale-factor) * ${Pt}px`,Xt=qt?`round(${Ht}, 1px)`:`calc(${Ht})`,Gt=qt?`round(${Yt}, 1px)`:`calc(${Yt})`;!tt||et.rotation%180===0?(Wt.width=Xt,Wt.height=Gt):(Wt.width=Gt,Wt.height=Xt)}ut&&pt.setAttribute("data-main-rotation",et.rotation)}},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var c=j(1);class p{constructor(){this.constructor===p&&(0,c.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(u){return"none"}addHCMFilter(u,L){return"none"}addHighlightHCMFilter(u,L,_,d){return"none"}destroy(u=!1){}}e.BaseFilterFactory=p;class k{constructor(){this.constructor===k&&(0,c.unreachable)("Cannot initialize BaseCanvasFactory.")}create(u,L){if(u<=0||L<=0)throw new Error("Invalid canvas size");const _=this._createCanvas(u,L);return{canvas:_,context:_.getContext("2d")}}reset(u,L,_){if(!u.canvas)throw new Error("Canvas is not specified");if(L<=0||_<=0)throw new Error("Invalid canvas size");u.canvas.width=L,u.canvas.height=_}destroy(u){if(!u.canvas)throw new Error("Canvas is not specified");u.canvas.width=0,u.canvas.height=0,u.canvas=null,u.context=null}_createCanvas(u,L){(0,c.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=k;class M{constructor({baseUrl:u=null,isCompressed:L=!0}){this.constructor===M&&(0,c.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=u,this.isCompressed=L}async fetch({name:u}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!u)throw new Error("CMap name must be specified.");const L=this.baseUrl+u+(this.isCompressed?".bcmap":""),_=this.isCompressed?c.CMapCompressionType.BINARY:c.CMapCompressionType.NONE;return this._fetchData(L,_).catch(d=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${L}`)})}_fetchData(u,L){(0,c.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=M;class X{constructor({baseUrl:u=null}){this.constructor===X&&(0,c.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=u}async fetch({filename:u}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!u)throw new Error("Font filename must be specified.");const L=`${this.baseUrl}${u}`;return this._fetchData(L).catch(_=>{throw new Error(`Unable to load font data at: ${L}`)})}_fetchData(u){(0,c.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=X;class D{constructor(){this.constructor===D&&(0,c.unreachable)("Cannot initialize BaseSVGFactory.")}create(u,L,_=!1){if(u<=0||L<=0)throw new Error("Invalid SVG dimensions");const d=this._createSVG("svg:svg");return d.setAttribute("version","1.1"),_||(d.setAttribute("width",`${u}px`),d.setAttribute("height",`${L}px`)),d.setAttribute("preserveAspectRatio","none"),d.setAttribute("viewBox",`0 0 ${u} ${L}`),d}createElement(u){if(typeof u!="string")throw new Error("Invalid SVG element type");return this._createSVG(u)}_createSVG(u){(0,c.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=D},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var c=j(1);const p=3285377520,k=4294901760,M=65535;class X{constructor(P){this.h1=P?P&4294967295:p,this.h2=P?P&4294967295:p}update(P){let u,L;if(typeof P=="string"){u=new Uint8Array(P.length*2),L=0;for(let I=0,A=P.length;I<A;I++){const o=P.charCodeAt(I);o<=255?u[L++]=o:(u[L++]=o>>>8,u[L++]=o&255)}}else if((0,c.isArrayBuffer)(P))u=P.slice(),L=u.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const _=L>>2,d=L-_*4,m=new Uint32Array(u.buffer,0,_);let b=0,g=0,S=this.h1,C=this.h2;const x=3432918353,w=461845907,l=x&M,a=w&M;for(let I=0;I<_;I++)I&1?(b=m[I],b=b*x&k|b*l&M,b=b<<15|b>>>17,b=b*w&k|b*a&M,S^=b,S=S<<13|S>>>19,S=S*5+3864292196):(g=m[I],g=g*x&k|g*l&M,g=g<<15|g>>>17,g=g*w&k|g*a&M,C^=g,C=C<<13|C>>>19,C=C*5+3864292196);switch(b=0,d){case 3:b^=u[_*4+2]<<16;case 2:b^=u[_*4+1]<<8;case 1:b^=u[_*4],b=b*x&k|b*l&M,b=b<<15|b>>>17,b=b*w&k|b*a&M,_&1?S^=b:C^=b}this.h1=S,this.h2=C}hexdigest(){let P=this.h1,u=this.h2;return P^=u>>>1,P=P*3981806797&k|P*36045&M,u=u*4283543511&k|((u<<16|P>>>16)*2950163797&k)>>>16,P^=u>>>1,P=P*444984403&k|P*60499&M,u=u*3301882366&k|((u<<16|P>>>16)*3120437893&k)>>>16,P^=u>>>1,(P>>>0).toString(16).padStart(8,"0")+(u>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=X},(z,e,j)=>{var M;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var c=j(1);class p{constructor({ownerDocument:D=globalThis.document,styleElement:P=null}){B(this,M,new Set);this._document=D,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(D){this.nativeFontFaces.add(D),this._document.fonts.add(D)}removeNativeFontFace(D){this.nativeFontFaces.delete(D),this._document.fonts.delete(D)}insertRule(D){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const P=this.styleElement.sheet;P.insertRule(D,P.cssRules.length)}clear(){for(const D of this.nativeFontFaces)this._document.fonts.delete(D);this.nativeFontFaces.clear(),t(this,M).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(D){if(!(!D||t(this,M).has(D.loadedName))){if((0,c.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:P,src:u,style:L}=D,_=new FontFace(P,u,L);this.addNativeFontFace(_);try{await _.load(),t(this,M).add(P)}catch(d){(0,c.warn)(`Cannot load system font: ${D.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(_)}return}(0,c.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(D){if(D.attached||D.missingFile&&!D.systemFontInfo)return;if(D.attached=!0,D.systemFontInfo){await this.loadSystemFont(D.systemFontInfo);return}if(this.isFontLoadingAPISupported){const u=D.createNativeFontFace();if(u){this.addNativeFontFace(u);try{await u.loaded}catch(L){throw(0,c.warn)(`Failed to load font '${u.family}': '${L}'.`),D.disableFontFace=!0,L}}return}const P=D.createFontFaceRule();if(P){if(this.insertRule(P),this.isSyncFontLoadingSupported)return;await new Promise(u=>{const L=this._queueLoadingCallback(u);this._prepareFontLoadEvent(D,L)})}}get isFontLoadingAPISupported(){var P;const D=!!((P=this._document)!=null&&P.fonts);return(0,c.shadow)(this,"isFontLoadingAPISupported",D)}get isSyncFontLoadingSupported(){let D=!1;return(c.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(D=!0),(0,c.shadow)(this,"isSyncFontLoadingSupported",D)}_queueLoadingCallback(D){function P(){for((0,c.assert)(!L.done,"completeRequest() cannot be called twice."),L.done=!0;u.length>0&&u[0].done;){const _=u.shift();setTimeout(_.callback,0)}}const{loadingRequests:u}=this,L={done:!1,complete:P,callback:D};return u.push(L),L}get _loadTestFont(){const D=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,c.shadow)(this,"_loadTestFont",D)}_prepareFontLoadEvent(D,P){function u(v,W){return v.charCodeAt(W)<<24|v.charCodeAt(W+1)<<16|v.charCodeAt(W+2)<<8|v.charCodeAt(W+3)&255}function L(v,W,Y,R){const K=v.substring(0,W),at=v.substring(W+Y);return K+R+at}let _,d;const m=this._document.createElement("canvas");m.width=1,m.height=1;const b=m.getContext("2d");let g=0;function S(v,W){if(++g>30){(0,c.warn)("Load test font never loaded."),W();return}if(b.font="30px "+v,b.fillText(".",0,20),b.getImageData(0,0,1,1).data[3]>0){W();return}setTimeout(S.bind(null,v,W))}const C=`lt${Date.now()}${this.loadTestFontId++}`;let x=this._loadTestFont;x=L(x,976,C.length,C);const l=16,a=1482184792;let I=u(x,l);for(_=0,d=C.length-3;_<d;_+=4)I=I-a+u(C,_)|0;_<C.length&&(I=I-a+u(C+"XXX",_)|0),x=L(x,l,4,(0,c.string32)(I));const A=`url(data:font/opentype;base64,${btoa(x)});`,o=`@font-face {font-family:"${C}";src:${A}}`;this.insertRule(o);const F=this._document.createElement("div");F.style.visibility="hidden",F.style.width=F.style.height="10px",F.style.position="absolute",F.style.top=F.style.left="0px";for(const v of[D.loadedName,C]){const W=this._document.createElement("span");W.textContent="Hi",W.style.fontFamily=v,F.append(W)}this._document.body.append(F),S(C,()=>{F.remove(),P.complete()})}}M=new WeakMap,e.FontLoader=p;class k{constructor(D,{isEvalSupported:P=!0,disableFontFace:u=!1,ignoreErrors:L=!1,inspectFont:_=null}){this.compiledGlyphs=Object.create(null);for(const d in D)this[d]=D[d];this.isEvalSupported=P!==!1,this.disableFontFace=u===!0,this.ignoreErrors=L===!0,this._inspectFont=_}createNativeFontFace(){var P;if(!this.data||this.disableFontFace)return null;let D;if(!this.cssFontInfo)D=new FontFace(this.loadedName,this.data,{});else{const u={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(u.style=`oblique ${this.cssFontInfo.italicAngle}deg`),D=new FontFace(this.cssFontInfo.fontFamily,this.data,u)}return(P=this._inspectFont)==null||P.call(this,this),D}createFontFaceRule(){var L;if(!this.data||this.disableFontFace)return null;const D=(0,c.bytesToString)(this.data),P=`url(data:${this.mimetype};base64,${btoa(D)});`;let u;if(!this.cssFontInfo)u=`@font-face {font-family:"${this.loadedName}";src:${P}}`;else{let _=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(_+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),u=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${_}src:${P}}`}return(L=this._inspectFont)==null||L.call(this,this,P),u}getPathGenerator(D,P){if(this.compiledGlyphs[P]!==void 0)return this.compiledGlyphs[P];let u;try{u=D.get(this.loadedName+"_path_"+P)}catch(L){if(!this.ignoreErrors)throw L;return(0,c.warn)(`getPathGenerator - ignoring character: "${L}".`),this.compiledGlyphs[P]=function(_,d){}}if(this.isEvalSupported&&c.FeatureTest.isEvalSupported){const L=[];for(const _ of u){const d=_.args!==void 0?_.args.join(","):"";L.push("c.",_.cmd,"(",d,`);
`)}return this.compiledGlyphs[P]=new Function("c","size",L.join(""))}return this.compiledGlyphs[P]=function(L,_){for(const d of u)d.cmd==="scale"&&(d.args=[_,-_]),L[d.cmd].apply(L,d.args)}}}e.FontFaceObject=k},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var c=j(7);j(1);const p=function(P){return new Promise((u,L)=>{requireFs().readFile(P,(d,m)=>{if(d||!m){L(new Error(d));return}u(new Uint8Array(m))})})};class k extends c.BaseFilterFactory{}e.NodeFilterFactory=k;class M extends c.BaseCanvasFactory{_createCanvas(u,L){return require$$0.createCanvas(u,L)}}e.NodeCanvasFactory=M;class X extends c.BaseCMapReaderFactory{_fetchData(u,L){return p(u).then(_=>({cMapData:_,compressionType:L}))}}e.NodeCMapReaderFactory=X;class D extends c.BaseStandardFontDataFactory{_fetchData(u){return p(u)}}e.NodeStandardFontDataFactory=D},(z,e,j)=>{var G,Qe,gt,Ze;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var c=j(1),p=j(6),k=j(12),M=j(13);const X=16,D=100,P=4096,u=15,L=10,_=1e3,d=16;function m(T,n){if(T._removeMirroring)throw new Error("Context is already forwarding operations.");T.__originalSave=T.save,T.__originalRestore=T.restore,T.__originalRotate=T.rotate,T.__originalScale=T.scale,T.__originalTranslate=T.translate,T.__originalTransform=T.transform,T.__originalSetTransform=T.setTransform,T.__originalResetTransform=T.resetTransform,T.__originalClip=T.clip,T.__originalMoveTo=T.moveTo,T.__originalLineTo=T.lineTo,T.__originalBezierCurveTo=T.bezierCurveTo,T.__originalRect=T.rect,T.__originalClosePath=T.closePath,T.__originalBeginPath=T.beginPath,T._removeMirroring=()=>{T.save=T.__originalSave,T.restore=T.__originalRestore,T.rotate=T.__originalRotate,T.scale=T.__originalScale,T.translate=T.__originalTranslate,T.transform=T.__originalTransform,T.setTransform=T.__originalSetTransform,T.resetTransform=T.__originalResetTransform,T.clip=T.__originalClip,T.moveTo=T.__originalMoveTo,T.lineTo=T.__originalLineTo,T.bezierCurveTo=T.__originalBezierCurveTo,T.rect=T.__originalRect,T.closePath=T.__originalClosePath,T.beginPath=T.__originalBeginPath,delete T._removeMirroring},T.save=function(){n.save(),this.__originalSave()},T.restore=function(){n.restore(),this.__originalRestore()},T.translate=function(i,h){n.translate(i,h),this.__originalTranslate(i,h)},T.scale=function(i,h){n.scale(i,h),this.__originalScale(i,h)},T.transform=function(i,h,f,E,O,H){n.transform(i,h,f,E,O,H),this.__originalTransform(i,h,f,E,O,H)},T.setTransform=function(i,h,f,E,O,H){n.setTransform(i,h,f,E,O,H),this.__originalSetTransform(i,h,f,E,O,H)},T.resetTransform=function(){n.resetTransform(),this.__originalResetTransform()},T.rotate=function(i){n.rotate(i),this.__originalRotate(i)},T.clip=function(i){n.clip(i),this.__originalClip(i)},T.moveTo=function(r,i){n.moveTo(r,i),this.__originalMoveTo(r,i)},T.lineTo=function(r,i){n.lineTo(r,i),this.__originalLineTo(r,i)},T.bezierCurveTo=function(r,i,h,f,E,O){n.bezierCurveTo(r,i,h,f,E,O),this.__originalBezierCurveTo(r,i,h,f,E,O)},T.rect=function(r,i,h,f){n.rect(r,i,h,f),this.__originalRect(r,i,h,f)},T.closePath=function(){n.closePath(),this.__originalClosePath()},T.beginPath=function(){n.beginPath(),this.__originalBeginPath()}}class b{constructor(n){this.canvasFactory=n,this.cache=Object.create(null)}getCanvas(n,r,i){let h;return this.cache[n]!==void 0?(h=this.cache[n],this.canvasFactory.reset(h,r,i)):(h=this.canvasFactory.create(r,i),this.cache[n]=h),h}delete(n){delete this.cache[n]}clear(){for(const n in this.cache){const r=this.cache[n];this.canvasFactory.destroy(r),delete this.cache[n]}}}function g(T,n,r,i,h,f,E,O,H,it){const[st,ot,dt,vt,ft,Ft]=(0,p.getCurrentTransform)(T);if(ot===0&&dt===0){const Dt=E*st+ft,pt=Math.round(Dt),et=O*vt+Ft,tt=Math.round(et),ut=(E+H)*st+ft,wt=Math.abs(Math.round(ut)-pt)||1,Pt=(O+it)*vt+Ft,Wt=Math.abs(Math.round(Pt)-tt)||1;return T.setTransform(Math.sign(st),0,0,Math.sign(vt),pt,tt),T.drawImage(n,r,i,h,f,0,0,wt,Wt),T.setTransform(st,ot,dt,vt,ft,Ft),[wt,Wt]}if(st===0&&vt===0){const Dt=O*dt+ft,pt=Math.round(Dt),et=E*ot+Ft,tt=Math.round(et),ut=(O+it)*dt+ft,wt=Math.abs(Math.round(ut)-pt)||1,Pt=(E+H)*ot+Ft,Wt=Math.abs(Math.round(Pt)-tt)||1;return T.setTransform(0,Math.sign(ot),Math.sign(dt),0,pt,tt),T.drawImage(n,r,i,h,f,0,0,Wt,wt),T.setTransform(st,ot,dt,vt,ft,Ft),[Wt,wt]}T.drawImage(n,r,i,h,f,E,O,H,it);const Bt=Math.hypot(st,ot),Et=Math.hypot(dt,vt);return[Bt*H,Et*it]}function S(T){const{width:n,height:r}=T;if(n>_||r>_)return null;const i=1e3,h=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),f=n+1;let E=new Uint8Array(f*(r+1)),O,H,it;const st=n+7&-8;let ot=new Uint8Array(st*r),dt=0;for(const Et of T.data){let Dt=128;for(;Dt>0;)ot[dt++]=Et&Dt?0:255,Dt>>=1}let vt=0;for(dt=0,ot[dt]!==0&&(E[0]=1,++vt),H=1;H<n;H++)ot[dt]!==ot[dt+1]&&(E[H]=ot[dt]?2:1,++vt),dt++;for(ot[dt]!==0&&(E[H]=2,++vt),O=1;O<r;O++){dt=O*st,it=O*f,ot[dt-st]!==ot[dt]&&(E[it]=ot[dt]?1:8,++vt);let Et=(ot[dt]?4:0)+(ot[dt-st]?8:0);for(H=1;H<n;H++)Et=(Et>>2)+(ot[dt+1]?4:0)+(ot[dt-st+1]?8:0),h[Et]&&(E[it+H]=h[Et],++vt),dt++;if(ot[dt-st]!==ot[dt]&&(E[it+H]=ot[dt]?2:4,++vt),vt>i)return null}for(dt=st*(r-1),it=O*f,ot[dt]!==0&&(E[it]=8,++vt),H=1;H<n;H++)ot[dt]!==ot[dt+1]&&(E[it+H]=ot[dt]?4:8,++vt),dt++;if(ot[dt]!==0&&(E[it+H]=4,++vt),vt>i)return null;const ft=new Int32Array([0,f,-1,0,-f,0,0,0,1]),Ft=new Path2D;for(O=0;vt&&O<=r;O++){let Et=O*f;const Dt=Et+n;for(;Et<Dt&&!E[Et];)Et++;if(Et===Dt)continue;Ft.moveTo(Et%f,O);const pt=Et;let et=E[Et];do{const tt=ft[et];do Et+=tt;while(!E[Et]);const ut=E[Et];ut!==5&&ut!==10?(et=ut,E[Et]=0):(et=ut&51*et>>4,E[Et]&=et>>2|et<<2),Ft.lineTo(Et%f,Et/f|0),E[Et]||--vt}while(pt!==Et);--O}return ot=null,E=null,function(Et){Et.save(),Et.scale(1/n,-1/r),Et.translate(0,-r),Et.fill(Ft),Et.beginPath(),Et.restore()}}class C{constructor(n,r){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=c.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=c.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,n,r])}clone(){const n=Object.create(this);return n.clipBox=this.clipBox.slice(),n}setCurrentPoint(n,r){this.x=n,this.y=r}updatePathMinMax(n,r,i){[r,i]=c.Util.applyTransform([r,i],n),this.minX=Math.min(this.minX,r),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,r),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(n,r){const i=c.Util.applyTransform(r,n),h=c.Util.applyTransform(r.slice(2),n);this.minX=Math.min(this.minX,i[0],h[0]),this.minY=Math.min(this.minY,i[1],h[1]),this.maxX=Math.max(this.maxX,i[0],h[0]),this.maxY=Math.max(this.maxY,i[1],h[1])}updateScalingPathMinMax(n,r){c.Util.scaleMinMax(n,r),this.minX=Math.min(this.minX,r[0]),this.maxX=Math.max(this.maxX,r[1]),this.minY=Math.min(this.minY,r[2]),this.maxY=Math.max(this.maxY,r[3])}updateCurvePathMinMax(n,r,i,h,f,E,O,H,it,st){const ot=c.Util.bezierBoundingBox(r,i,h,f,E,O,H,it);if(st){st[0]=Math.min(st[0],ot[0],ot[2]),st[1]=Math.max(st[1],ot[0],ot[2]),st[2]=Math.min(st[2],ot[1],ot[3]),st[3]=Math.max(st[3],ot[1],ot[3]);return}this.updateRectMinMax(n,ot)}getPathBoundingBox(n=k.PathType.FILL,r=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(n===k.PathType.STROKE){r||(0,c.unreachable)("Stroke bounding box must include transform.");const h=c.Util.singularValueDecompose2dScale(r),f=h[0]*this.lineWidth/2,E=h[1]*this.lineWidth/2;i[0]-=f,i[1]-=E,i[2]+=f,i[3]+=E}return i}updateClipFromPath(){const n=c.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(n||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(n){this.clipBox=n,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(n=k.PathType.FILL,r=null){return c.Util.intersect(this.clipBox,this.getPathBoundingBox(n,r))}}function x(T,n){if(typeof ImageData<"u"&&n instanceof ImageData){T.putImageData(n,0,0);return}const r=n.height,i=n.width,h=r%d,f=(r-h)/d,E=h===0?f:f+1,O=T.createImageData(i,d);let H=0,it;const st=n.data,ot=O.data;let dt,vt,ft,Ft;if(n.kind===c.ImageKind.GRAYSCALE_1BPP){const Bt=st.byteLength,Et=new Uint32Array(ot.buffer,0,ot.byteLength>>2),Dt=Et.length,pt=i+7>>3,et=4294967295,tt=c.FeatureTest.isLittleEndian?4278190080:255;for(dt=0;dt<E;dt++){for(ft=dt<f?d:h,it=0,vt=0;vt<ft;vt++){const ut=Bt-H;let wt=0;const Pt=ut>pt?i:ut*8-7,Wt=Pt&-8;let qt=0,Ht=0;for(;wt<Wt;wt+=8)Ht=st[H++],Et[it++]=Ht&128?et:tt,Et[it++]=Ht&64?et:tt,Et[it++]=Ht&32?et:tt,Et[it++]=Ht&16?et:tt,Et[it++]=Ht&8?et:tt,Et[it++]=Ht&4?et:tt,Et[it++]=Ht&2?et:tt,Et[it++]=Ht&1?et:tt;for(;wt<Pt;wt++)qt===0&&(Ht=st[H++],qt=128),Et[it++]=Ht&qt?et:tt,qt>>=1}for(;it<Dt;)Et[it++]=0;T.putImageData(O,0,dt*d)}}else if(n.kind===c.ImageKind.RGBA_32BPP){for(vt=0,Ft=i*d*4,dt=0;dt<f;dt++)ot.set(st.subarray(H,H+Ft)),H+=Ft,T.putImageData(O,0,vt),vt+=d;dt<E&&(Ft=i*h*4,ot.set(st.subarray(H,H+Ft)),T.putImageData(O,0,vt))}else if(n.kind===c.ImageKind.RGB_24BPP)for(ft=d,Ft=i*ft,dt=0;dt<E;dt++){for(dt>=f&&(ft=h,Ft=i*ft),it=0,vt=Ft;vt--;)ot[it++]=st[H++],ot[it++]=st[H++],ot[it++]=st[H++],ot[it++]=255;T.putImageData(O,0,dt*d)}else throw new Error(`bad image kind: ${n.kind}`)}function w(T,n){if(n.bitmap){T.drawImage(n.bitmap,0,0);return}const r=n.height,i=n.width,h=r%d,f=(r-h)/d,E=h===0?f:f+1,O=T.createImageData(i,d);let H=0;const it=n.data,st=O.data;for(let ot=0;ot<E;ot++){const dt=ot<f?d:h;({srcPos:H}=(0,M.convertBlackAndWhiteToRGBA)({src:it,srcPos:H,dest:st,width:i,height:dt,nonBlackColor:0})),T.putImageData(O,0,ot*d)}}function l(T,n){const r=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of r)T[i]!==void 0&&(n[i]=T[i]);T.setLineDash!==void 0&&(n.setLineDash(T.getLineDash()),n.lineDashOffset=T.lineDashOffset)}function a(T){if(T.strokeStyle=T.fillStyle="#000000",T.fillRule="nonzero",T.globalAlpha=1,T.lineWidth=1,T.lineCap="butt",T.lineJoin="miter",T.miterLimit=10,T.globalCompositeOperation="source-over",T.font="10px sans-serif",T.setLineDash!==void 0&&(T.setLineDash([]),T.lineDashOffset=0),!c.isNodeJS){const{filter:n}=T;n!=="none"&&n!==""&&(T.filter="none")}}function I(T,n,r,i){const h=T.length;for(let f=3;f<h;f+=4){const E=T[f];if(E===0)T[f-3]=n,T[f-2]=r,T[f-1]=i;else if(E<255){const O=255-E;T[f-3]=T[f-3]*E+n*O>>8,T[f-2]=T[f-2]*E+r*O>>8,T[f-1]=T[f-1]*E+i*O>>8}}}function A(T,n,r){const i=T.length,h=1/255;for(let f=3;f<i;f+=4){const E=r?r[T[f]]:T[f];n[f]=n[f]*E*h|0}}function o(T,n,r){const i=T.length;for(let h=3;h<i;h+=4){const f=T[h-3]*77+T[h-2]*152+T[h-1]*28;n[h]=r?n[h]*r[f>>8]>>8:n[h]*f>>16}}function F(T,n,r,i,h,f,E,O,H,it,st){const ot=!!f,dt=ot?f[0]:0,vt=ot?f[1]:0,ft=ot?f[2]:0,Ft=h==="Luminosity"?o:A,Et=Math.min(i,Math.ceil(1048576/r));for(let Dt=0;Dt<i;Dt+=Et){const pt=Math.min(Et,i-Dt),et=T.getImageData(O-it,Dt+(H-st),r,pt),tt=n.getImageData(O,Dt+H,r,pt);ot&&I(et.data,dt,vt,ft),Ft(et.data,tt.data,E),n.putImageData(tt,O,Dt+H)}}function v(T,n,r,i){const h=i[0],f=i[1],E=i[2]-h,O=i[3]-f;E===0||O===0||(F(n.context,r,E,O,n.subtype,n.backdrop,n.transferMap,h,f,n.offsetX,n.offsetY),T.save(),T.globalAlpha=1,T.globalCompositeOperation="source-over",T.setTransform(1,0,0,1,0,0),T.drawImage(r.canvas,0,0),T.restore())}function W(T,n){const r=c.Util.singularValueDecompose2dScale(T);r[0]=Math.fround(r[0]),r[1]=Math.fround(r[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*p.PixelsPerInch.PDF_TO_CSS_UNITS);return n!==void 0?n:r[0]<=i||r[1]<=i}const Y=["butt","round","square"],R=["miter","round","bevel"],K={},at={},kt=class kt{constructor(n,r,i,h,f,{optionalContentConfig:E,markedContentStack:O=null},H,it){B(this,G);B(this,gt);this.ctx=n,this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=r,this.objs=i,this.canvasFactory=h,this.filterFactory=f,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=O||[],this.optionalContentConfig=E,this.cachedCanvases=new b(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=H,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=it,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(n,r=null){return typeof n=="string"?n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n):r}beginDrawing({transform:n,viewport:r,transparency:i=!1,background:h=null}){const f=this.ctx.canvas.width,E=this.ctx.canvas.height,O=this.ctx.fillStyle;if(this.ctx.fillStyle=h||"#ffffff",this.ctx.fillRect(0,0,f,E),this.ctx.fillStyle=O,i){const H=this.cachedCanvases.getCanvas("transparent",f,E);this.compositeCtx=this.ctx,this.transparentCanvas=H.canvas,this.ctx=H.context,this.ctx.save(),this.ctx.transform(...(0,p.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),a(this.ctx),n&&(this.ctx.transform(...n),this.outputScaleX=n[0],this.outputScaleY=n[0]),this.ctx.transform(...r.transform),this.viewportScale=r.scale,this.baseTransform=(0,p.getCurrentTransform)(this.ctx)}executeOperatorList(n,r,i,h){const f=n.argsArray,E=n.fnArray;let O=r||0;const H=f.length;if(H===O)return O;const it=H-O>L&&typeof i=="function",st=it?Date.now()+u:0;let ot=0;const dt=this.commonObjs,vt=this.objs;let ft;for(;;){if(h!==void 0&&O===h.nextBreakPoint)return h.breakIt(O,i),O;if(ft=E[O],ft!==c.OPS.dependency)this[ft].apply(this,f[O]);else for(const Ft of f[O]){const Bt=Ft.startsWith("g_")?dt:vt;if(!Bt.has(Ft))return Bt.get(Ft,i),O}if(O++,O===H)return O;if(it&&++ot>L){if(Date.now()>st)return i(),O;ot=0}}}endDrawing(){V(this,G,Qe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const n of this._cachedBitmapsMap.values()){for(const r of n.values())typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement&&(r.width=r.height=0);n.clear()}this._cachedBitmapsMap.clear(),V(this,gt,Ze).call(this)}_scaleImage(n,r){const i=n.width,h=n.height;let f=Math.max(Math.hypot(r[0],r[1]),1),E=Math.max(Math.hypot(r[2],r[3]),1),O=i,H=h,it="prescale1",st,ot;for(;f>2&&O>1||E>2&&H>1;){let dt=O,vt=H;f>2&&O>1&&(dt=O>=16384?Math.floor(O/2)-1||1:Math.ceil(O/2),f/=O/dt),E>2&&H>1&&(vt=H>=16384?Math.floor(H/2)-1||1:Math.ceil(H)/2,E/=H/vt),st=this.cachedCanvases.getCanvas(it,dt,vt),ot=st.context,ot.clearRect(0,0,dt,vt),ot.drawImage(n,0,0,O,H,0,0,dt,vt),n=st.canvas,O=dt,H=vt,it=it==="prescale1"?"prescale2":"prescale1"}return{img:n,paintWidth:O,paintHeight:H}}_createMaskCanvas(n){const r=this.ctx,{width:i,height:h}=n,f=this.current.fillColor,E=this.current.patternFill,O=(0,p.getCurrentTransform)(r);let H,it,st,ot;if((n.bitmap||n.data)&&n.count>1){const wt=n.bitmap||n.data.buffer;it=JSON.stringify(E?O:[O.slice(0,4),f]),H=this._cachedBitmapsMap.get(wt),H||(H=new Map,this._cachedBitmapsMap.set(wt,H));const Pt=H.get(it);if(Pt&&!E){const Wt=Math.round(Math.min(O[0],O[2])+O[4]),qt=Math.round(Math.min(O[1],O[3])+O[5]);return{canvas:Pt,offsetX:Wt,offsetY:qt}}st=Pt}st||(ot=this.cachedCanvases.getCanvas("maskCanvas",i,h),w(ot.context,n));let dt=c.Util.transform(O,[1/i,0,0,-1/h,0,0]);dt=c.Util.transform(dt,[1,0,0,1,0,-h]);const vt=c.Util.applyTransform([0,0],dt),ft=c.Util.applyTransform([i,h],dt),Ft=c.Util.normalizeRect([vt[0],vt[1],ft[0],ft[1]]),Bt=Math.round(Ft[2]-Ft[0])||1,Et=Math.round(Ft[3]-Ft[1])||1,Dt=this.cachedCanvases.getCanvas("fillCanvas",Bt,Et),pt=Dt.context,et=Math.min(vt[0],ft[0]),tt=Math.min(vt[1],ft[1]);pt.translate(-et,-tt),pt.transform(...dt),st||(st=this._scaleImage(ot.canvas,(0,p.getCurrentTransformInverse)(pt)),st=st.img,H&&E&&H.set(it,st)),pt.imageSmoothingEnabled=W((0,p.getCurrentTransform)(pt),n.interpolate),g(pt,st,0,0,st.width,st.height,0,0,i,h),pt.globalCompositeOperation="source-in";const ut=c.Util.transform((0,p.getCurrentTransformInverse)(pt),[1,0,0,1,-et,-tt]);return pt.fillStyle=E?f.getPattern(r,this,ut,k.PathType.FILL):f,pt.fillRect(0,0,i,h),H&&!E&&(this.cachedCanvases.delete("fillCanvas"),H.set(it,Dt.canvas)),{canvas:Dt.canvas,offsetX:Math.round(et),offsetY:Math.round(tt)}}setLineWidth(n){n!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=n,this.ctx.lineWidth=n}setLineCap(n){this.ctx.lineCap=Y[n]}setLineJoin(n){this.ctx.lineJoin=R[n]}setMiterLimit(n){this.ctx.miterLimit=n}setDash(n,r){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(n),i.lineDashOffset=r)}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(const[r,i]of n)switch(r){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const n=this.inSMaskMode;this.current.activeSMask&&!n?this.beginSMaskMode():!this.current.activeSMask&&n&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const n=this.ctx.canvas.width,r=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,h=this.cachedCanvases.getCanvas(i,n,r);this.suspendedCtx=this.ctx,this.ctx=h.context;const f=this.ctx;f.setTransform(...(0,p.getCurrentTransform)(this.suspendedCtx)),l(this.suspendedCtx,f),m(f,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),l(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(n){if(!this.current.activeSMask)return;n?(n[0]=Math.floor(n[0]),n[1]=Math.floor(n[1]),n[2]=Math.ceil(n[2]),n[3]=Math.ceil(n[3])):n=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const r=this.current.activeSMask,i=this.suspendedCtx;v(i,r,this.ctx,n),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(l(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const n=this.current;this.stateStack.push(n),this.current=n.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),l(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(n,r,i,h,f,E){this.ctx.transform(n,r,i,h,f,E),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(n,r,i){const h=this.ctx,f=this.current;let E=f.x,O=f.y,H,it;const st=(0,p.getCurrentTransform)(h),ot=st[0]===0&&st[3]===0||st[1]===0&&st[2]===0,dt=ot?i.slice(0):null;for(let vt=0,ft=0,Ft=n.length;vt<Ft;vt++)switch(n[vt]|0){case c.OPS.rectangle:E=r[ft++],O=r[ft++];const Bt=r[ft++],Et=r[ft++],Dt=E+Bt,pt=O+Et;h.moveTo(E,O),Bt===0||Et===0?h.lineTo(Dt,pt):(h.lineTo(Dt,O),h.lineTo(Dt,pt),h.lineTo(E,pt)),ot||f.updateRectMinMax(st,[E,O,Dt,pt]),h.closePath();break;case c.OPS.moveTo:E=r[ft++],O=r[ft++],h.moveTo(E,O),ot||f.updatePathMinMax(st,E,O);break;case c.OPS.lineTo:E=r[ft++],O=r[ft++],h.lineTo(E,O),ot||f.updatePathMinMax(st,E,O);break;case c.OPS.curveTo:H=E,it=O,E=r[ft+4],O=r[ft+5],h.bezierCurveTo(r[ft],r[ft+1],r[ft+2],r[ft+3],E,O),f.updateCurvePathMinMax(st,H,it,r[ft],r[ft+1],r[ft+2],r[ft+3],E,O,dt),ft+=6;break;case c.OPS.curveTo2:H=E,it=O,h.bezierCurveTo(E,O,r[ft],r[ft+1],r[ft+2],r[ft+3]),f.updateCurvePathMinMax(st,H,it,E,O,r[ft],r[ft+1],r[ft+2],r[ft+3],dt),E=r[ft+2],O=r[ft+3],ft+=4;break;case c.OPS.curveTo3:H=E,it=O,E=r[ft+2],O=r[ft+3],h.bezierCurveTo(r[ft],r[ft+1],E,O,E,O),f.updateCurvePathMinMax(st,H,it,r[ft],r[ft+1],E,O,E,O,dt),ft+=4;break;case c.OPS.closePath:h.closePath();break}ot&&f.updateScalingPathMinMax(st,dt),f.setCurrentPoint(E,O)}closePath(){this.ctx.closePath()}stroke(n=!0){const r=this.ctx,i=this.current.strokeColor;r.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&(i!=null&&i.getPattern)?(r.save(),r.strokeStyle=i.getPattern(r,this,(0,p.getCurrentTransformInverse)(r),k.PathType.STROKE),this.rescaleAndStroke(!1),r.restore()):this.rescaleAndStroke(!0)),n&&this.consumePath(this.current.getClippedPathBoundingBox()),r.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(n=!0){const r=this.ctx,i=this.current.fillColor,h=this.current.patternFill;let f=!1;h&&(r.save(),r.fillStyle=i.getPattern(r,this,(0,p.getCurrentTransformInverse)(r),k.PathType.FILL),f=!0);const E=this.current.getClippedPathBoundingBox();this.contentVisible&&E!==null&&(this.pendingEOFill?(r.fill("evenodd"),this.pendingEOFill=!1):r.fill()),f&&r.restore(),n&&this.consumePath(E)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=K}eoClip(){this.pendingClip=at}beginText(){this.current.textMatrix=c.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const n=this.pendingTextPaths,r=this.ctx;if(n===void 0){r.beginPath();return}r.save(),r.beginPath();for(const i of n)r.setTransform(...i.transform),r.translate(i.x,i.y),i.addToPath(r,i.fontSize);r.restore(),r.clip(),r.beginPath(),delete this.pendingTextPaths}setCharSpacing(n){this.current.charSpacing=n}setWordSpacing(n){this.current.wordSpacing=n}setHScale(n){this.current.textHScale=n/100}setLeading(n){this.current.leading=-n}setFont(n,r){var st;const i=this.commonObjs.get(n),h=this.current;if(!i)throw new Error(`Can't find font for ${n}`);if(h.fontMatrix=i.fontMatrix||c.FONT_IDENTITY_MATRIX,(h.fontMatrix[0]===0||h.fontMatrix[3]===0)&&(0,c.warn)("Invalid font matrix for font "+n),r<0?(r=-r,h.fontDirection=-1):h.fontDirection=1,this.current.font=i,this.current.fontSize=r,i.isType3Font)return;const f=i.loadedName||"sans-serif",E=((st=i.systemFontInfo)==null?void 0:st.css)||`"${f}", ${i.fallbackName}`;let O="normal";i.black?O="900":i.bold&&(O="bold");const H=i.italic?"italic":"normal";let it=r;r<X?it=X:r>D&&(it=D),this.current.fontSizeScale=r/it,this.ctx.font=`${H} ${O} ${it}px ${E}`}setTextRenderingMode(n){this.current.textRenderingMode=n}setTextRise(n){this.current.textRise=n}moveText(n,r){this.current.x=this.current.lineX+=n,this.current.y=this.current.lineY+=r}setLeadingMoveText(n,r){this.setLeading(-r),this.moveText(n,r)}setTextMatrix(n,r,i,h,f,E){this.current.textMatrix=[n,r,i,h,f,E],this.current.textMatrixScale=Math.hypot(n,r),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(n,r,i,h){const f=this.ctx,E=this.current,O=E.font,H=E.textRenderingMode,it=E.fontSize/E.fontSizeScale,st=H&c.TextRenderingMode.FILL_STROKE_MASK,ot=!!(H&c.TextRenderingMode.ADD_TO_PATH_FLAG),dt=E.patternFill&&!O.missingFile;let vt;(O.disableFontFace||ot||dt)&&(vt=O.getPathGenerator(this.commonObjs,n)),O.disableFontFace||dt?(f.save(),f.translate(r,i),f.beginPath(),vt(f,it),h&&f.setTransform(...h),(st===c.TextRenderingMode.FILL||st===c.TextRenderingMode.FILL_STROKE)&&f.fill(),(st===c.TextRenderingMode.STROKE||st===c.TextRenderingMode.FILL_STROKE)&&f.stroke(),f.restore()):((st===c.TextRenderingMode.FILL||st===c.TextRenderingMode.FILL_STROKE)&&f.fillText(n,r,i),(st===c.TextRenderingMode.STROKE||st===c.TextRenderingMode.FILL_STROKE)&&f.strokeText(n,r,i)),ot&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,p.getCurrentTransform)(f),x:r,y:i,fontSize:it,addToPath:vt})}get isFontSubpixelAAEnabled(){const{context:n}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);n.scale(1.5,1),n.fillText("I",0,10);const r=n.getImageData(0,0,10,10).data;let i=!1;for(let h=3;h<r.length;h+=4)if(r[h]>0&&r[h]<255){i=!0;break}return(0,c.shadow)(this,"isFontSubpixelAAEnabled",i)}showText(n){const r=this.current,i=r.font;if(i.isType3Font)return this.showType3Text(n);const h=r.fontSize;if(h===0)return;const f=this.ctx,E=r.fontSizeScale,O=r.charSpacing,H=r.wordSpacing,it=r.fontDirection,st=r.textHScale*it,ot=n.length,dt=i.vertical,vt=dt?1:-1,ft=i.defaultVMetrics,Ft=h*r.fontMatrix[0],Bt=r.textRenderingMode===c.TextRenderingMode.FILL&&!i.disableFontFace&&!r.patternFill;f.save(),f.transform(...r.textMatrix),f.translate(r.x,r.y+r.textRise),it>0?f.scale(st,-1):f.scale(st,1);let Et;if(r.patternFill){f.save();const ut=r.fillColor.getPattern(f,this,(0,p.getCurrentTransformInverse)(f),k.PathType.FILL);Et=(0,p.getCurrentTransform)(f),f.restore(),f.fillStyle=ut}let Dt=r.lineWidth;const pt=r.textMatrixScale;if(pt===0||Dt===0){const ut=r.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;(ut===c.TextRenderingMode.STROKE||ut===c.TextRenderingMode.FILL_STROKE)&&(Dt=this.getSinglePixelWidth())}else Dt/=pt;if(E!==1&&(f.scale(E,E),Dt/=E),f.lineWidth=Dt,i.isInvalidPDFjsFont){const ut=[];let wt=0;for(const Pt of n)ut.push(Pt.unicode),wt+=Pt.width;f.fillText(ut.join(""),0,0),r.x+=wt*Ft*st,f.restore(),this.compose();return}let et=0,tt;for(tt=0;tt<ot;++tt){const ut=n[tt];if(typeof ut=="number"){et+=vt*ut*h/1e3;continue}let wt=!1;const Pt=(ut.isSpace?H:0)+O,Wt=ut.fontChar,qt=ut.accent;let Ht,Yt,Xt=ut.width;if(dt){const Vt=ut.vmetric||ft,lt=-(ut.vmetric?Vt[1]:Xt*.5)*Ft,Z=Vt[2]*Ft;Xt=Vt?-Vt[0]:Xt,Ht=lt/E,Yt=(et+Z)/E}else Ht=et/E,Yt=0;if(i.remeasure&&Xt>0){const Vt=f.measureText(Wt).width*1e3/h*E;if(Xt<Vt&&this.isFontSubpixelAAEnabled){const lt=Xt/Vt;wt=!0,f.save(),f.scale(lt,1),Ht/=lt}else Xt!==Vt&&(Ht+=(Xt-Vt)/2e3*h/E)}if(this.contentVisible&&(ut.isInFont||i.missingFile)){if(Bt&&!qt)f.fillText(Wt,Ht,Yt);else if(this.paintChar(Wt,Ht,Yt,Et),qt){const Vt=Ht+h*qt.offset.x/E,lt=Yt-h*qt.offset.y/E;this.paintChar(qt.fontChar,Vt,lt,Et)}}const Gt=dt?Xt*Ft-Pt*it:Xt*Ft+Pt*it;et+=Gt,wt&&f.restore()}dt?r.y-=et:r.x+=et*st,f.restore(),this.compose()}showType3Text(n){const r=this.ctx,i=this.current,h=i.font,f=i.fontSize,E=i.fontDirection,O=h.vertical?1:-1,H=i.charSpacing,it=i.wordSpacing,st=i.textHScale*E,ot=i.fontMatrix||c.FONT_IDENTITY_MATRIX,dt=n.length,vt=i.textRenderingMode===c.TextRenderingMode.INVISIBLE;let ft,Ft,Bt,Et;if(!(vt||f===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,r.save(),r.transform(...i.textMatrix),r.translate(i.x,i.y),r.scale(st,E),ft=0;ft<dt;++ft){if(Ft=n[ft],typeof Ft=="number"){Et=O*Ft*f/1e3,this.ctx.translate(Et,0),i.x+=Et*st;continue}const Dt=(Ft.isSpace?it:0)+H,pt=h.charProcOperatorList[Ft.operatorListId];if(!pt){(0,c.warn)(`Type3 character "${Ft.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Ft,this.save(),r.scale(f,f),r.transform(...ot),this.executeOperatorList(pt),this.restore()),Bt=c.Util.applyTransform([Ft.width,0],ot)[0]*f+Dt,r.translate(Bt,0),i.x+=Bt*st}r.restore(),this.processingType3=null}}setCharWidth(n,r){}setCharWidthAndBounds(n,r,i,h,f,E){this.ctx.rect(i,h,f-i,E-h),this.ctx.clip(),this.endPath()}getColorN_Pattern(n){let r;if(n[0]==="TilingPattern"){const i=n[1],h=this.baseTransform||(0,p.getCurrentTransform)(this.ctx),f={createCanvasGraphics:E=>new kt(E,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};r=new k.TilingPattern(n,i,this.ctx,f,h)}else r=this._getPattern(n[1],n[2]);return r}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(n,r,i){const h=c.Util.makeHexColor(n,r,i);this.ctx.strokeStyle=h,this.current.strokeColor=h}setFillRGBColor(n,r,i){const h=c.Util.makeHexColor(n,r,i);this.ctx.fillStyle=h,this.current.fillColor=h,this.current.patternFill=!1}_getPattern(n,r=null){let i;return this.cachedPatterns.has(n)?i=this.cachedPatterns.get(n):(i=(0,k.getShadingPattern)(this.getObject(n)),this.cachedPatterns.set(n,i)),r&&(i.matrix=r),i}shadingFill(n){if(!this.contentVisible)return;const r=this.ctx;this.save();const i=this._getPattern(n);r.fillStyle=i.getPattern(r,this,(0,p.getCurrentTransformInverse)(r),k.PathType.SHADING);const h=(0,p.getCurrentTransformInverse)(r);if(h){const{width:f,height:E}=r.canvas,[O,H,it,st]=c.Util.getAxialAlignedBoundingBox([0,0,f,E],h);this.ctx.fillRect(O,H,it-O,st-H)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,c.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,c.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(n,r){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(n)&&n.length===6&&this.transform(...n),this.baseTransform=(0,p.getCurrentTransform)(this.ctx),r)){const i=r[2]-r[0],h=r[3]-r[1];this.ctx.rect(r[0],r[1],i,h),this.current.updateRectMinMax((0,p.getCurrentTransform)(this.ctx),r),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(n){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;n.isolated||(0,c.info)("TODO: Support non-isolated groups."),n.knockout&&(0,c.warn)("Knockout groups not supported.");const i=(0,p.getCurrentTransform)(r);if(n.matrix&&r.transform(...n.matrix),!n.bbox)throw new Error("Bounding box is required.");let h=c.Util.getAxialAlignedBoundingBox(n.bbox,(0,p.getCurrentTransform)(r));const f=[0,0,r.canvas.width,r.canvas.height];h=c.Util.intersect(h,f)||[0,0,0,0];const E=Math.floor(h[0]),O=Math.floor(h[1]);let H=Math.max(Math.ceil(h[2])-E,1),it=Math.max(Math.ceil(h[3])-O,1),st=1,ot=1;H>P&&(st=H/P,H=P),it>P&&(ot=it/P,it=P),this.current.startNewPathAndClipBox([0,0,H,it]);let dt="groupAt"+this.groupLevel;n.smask&&(dt+="_smask_"+this.smaskCounter++%2);const vt=this.cachedCanvases.getCanvas(dt,H,it),ft=vt.context;ft.scale(1/st,1/ot),ft.translate(-E,-O),ft.transform(...i),n.smask?this.smaskStack.push({canvas:vt.canvas,context:ft,offsetX:E,offsetY:O,scaleX:st,scaleY:ot,subtype:n.smask.subtype,backdrop:n.smask.backdrop,transferMap:n.smask.transferMap||null,startTransformInverse:null}):(r.setTransform(1,0,0,1,0,0),r.translate(E,O),r.scale(st,ot),r.save()),l(r,ft),this.ctx=ft,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(n){if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,n.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const h=(0,p.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...h);const f=c.Util.getAxialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],h);this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(f)}}beginAnnotation(n,r,i,h,f){if(V(this,G,Qe).call(this),a(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(r)&&r.length===4){const E=r[2]-r[0],O=r[3]-r[1];if(f&&this.annotationCanvasMap){i=i.slice(),i[4]-=r[0],i[5]-=r[1],r=r.slice(),r[0]=r[1]=0,r[2]=E,r[3]=O;const[H,it]=c.Util.singularValueDecompose2dScale((0,p.getCurrentTransform)(this.ctx)),{viewportScale:st}=this,ot=Math.ceil(E*this.outputScaleX*st),dt=Math.ceil(O*this.outputScaleY*st);this.annotationCanvas=this.canvasFactory.create(ot,dt);const{canvas:vt,context:ft}=this.annotationCanvas;this.annotationCanvasMap.set(n,vt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ft,this.ctx.save(),this.ctx.setTransform(H,0,0,-it,0,O*it),a(this.ctx)}else a(this.ctx),this.ctx.rect(r[0],r[1],E,O),this.ctx.clip(),this.endPath()}this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...h)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),V(this,gt,Ze).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(n){if(!this.contentVisible)return;const r=n.count;n=this.getObject(n.data,n),n.count=r;const i=this.ctx,h=this.processingType3;if(h&&(h.compiled===void 0&&(h.compiled=S(n)),h.compiled)){h.compiled(i);return}const f=this._createMaskCanvas(n),E=f.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(E,f.offsetX,f.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(n,r,i=0,h=0,f,E){if(!this.contentVisible)return;n=this.getObject(n.data,n);const O=this.ctx;O.save();const H=(0,p.getCurrentTransform)(O);O.transform(r,i,h,f,0,0);const it=this._createMaskCanvas(n);O.setTransform(1,0,0,1,it.offsetX-H[4],it.offsetY-H[5]);for(let st=0,ot=E.length;st<ot;st+=2){const dt=c.Util.transform(H,[r,i,h,f,E[st],E[st+1]]),[vt,ft]=c.Util.applyTransform([0,0],dt);O.drawImage(it.canvas,vt,ft)}O.restore(),this.compose()}paintImageMaskXObjectGroup(n){if(!this.contentVisible)return;const r=this.ctx,i=this.current.fillColor,h=this.current.patternFill;for(const f of n){const{data:E,width:O,height:H,transform:it}=f,st=this.cachedCanvases.getCanvas("maskCanvas",O,H),ot=st.context;ot.save();const dt=this.getObject(E,f);w(ot,dt),ot.globalCompositeOperation="source-in",ot.fillStyle=h?i.getPattern(ot,this,(0,p.getCurrentTransformInverse)(r),k.PathType.FILL):i,ot.fillRect(0,0,O,H),ot.restore(),r.save(),r.transform(...it),r.scale(1,-1),g(r,st.canvas,0,0,O,H,0,-1,1,1),r.restore()}this.compose()}paintImageXObject(n){if(!this.contentVisible)return;const r=this.getObject(n);if(!r){(0,c.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(r)}paintImageXObjectRepeat(n,r,i,h){if(!this.contentVisible)return;const f=this.getObject(n);if(!f){(0,c.warn)("Dependent image isn't ready yet");return}const E=f.width,O=f.height,H=[];for(let it=0,st=h.length;it<st;it+=2)H.push({transform:[r,0,0,i,h[it],h[it+1]],x:0,y:0,w:E,h:O});this.paintInlineImageXObjectGroup(f,H)}applyTransferMapsToCanvas(n){return this.current.transferMaps!=="none"&&(n.filter=this.current.transferMaps,n.drawImage(n.canvas,0,0),n.filter="none"),n.canvas}applyTransferMapsToBitmap(n){if(this.current.transferMaps==="none")return n.bitmap;const{bitmap:r,width:i,height:h}=n,f=this.cachedCanvases.getCanvas("inlineImage",i,h),E=f.context;return E.filter=this.current.transferMaps,E.drawImage(r,0,0),E.filter="none",f.canvas}paintInlineImageXObject(n){if(!this.contentVisible)return;const r=n.width,i=n.height,h=this.ctx;if(this.save(),!c.isNodeJS){const{filter:O}=h;O!=="none"&&O!==""&&(h.filter="none")}h.scale(1/r,-1/i);let f;if(n.bitmap)f=this.applyTransferMapsToBitmap(n);else if(typeof HTMLElement=="function"&&n instanceof HTMLElement||!n.data)f=n;else{const H=this.cachedCanvases.getCanvas("inlineImage",r,i).context;x(H,n),f=this.applyTransferMapsToCanvas(H)}const E=this._scaleImage(f,(0,p.getCurrentTransformInverse)(h));h.imageSmoothingEnabled=W((0,p.getCurrentTransform)(h),n.interpolate),g(h,E.img,0,0,E.paintWidth,E.paintHeight,0,-i,r,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(n,r){if(!this.contentVisible)return;const i=this.ctx;let h;if(n.bitmap)h=n.bitmap;else{const f=n.width,E=n.height,H=this.cachedCanvases.getCanvas("inlineImage",f,E).context;x(H,n),h=this.applyTransferMapsToCanvas(H)}for(const f of r)i.save(),i.transform(...f.transform),i.scale(1,-1),g(i,h,f.x,f.y,f.w,f.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(n){}markPointProps(n,r){}beginMarkedContent(n){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(n,r){n==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(n){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const i=this.ctx;this.pendingClip&&(r||(this.pendingClip===at?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const n=(0,p.getCurrentTransform)(this.ctx);if(n[1]===0&&n[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(n[0]),Math.abs(n[3]));else{const r=Math.abs(n[0]*n[3]-n[2]*n[1]),i=Math.hypot(n[0],n[2]),h=Math.hypot(n[1],n[3]);this._cachedGetSinglePixelWidth=Math.max(i,h)/r}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:n}=this.current,{a:r,b:i,c:h,d:f}=this.ctx.getTransform();let E,O;if(i===0&&h===0){const H=Math.abs(r),it=Math.abs(f);if(H===it)if(n===0)E=O=1/H;else{const st=H*n;E=O=st<1?1/st:1}else if(n===0)E=1/H,O=1/it;else{const st=H*n,ot=it*n;E=st<1?1/st:1,O=ot<1?1/ot:1}}else{const H=Math.abs(r*f-i*h),it=Math.hypot(r,i),st=Math.hypot(h,f);if(n===0)E=st/H,O=it/H;else{const ot=n*H;E=st>ot?st/ot:1,O=it>ot?it/ot:1}}this._cachedScaleForStroking[0]=E,this._cachedScaleForStroking[1]=O}return this._cachedScaleForStroking}rescaleAndStroke(n){const{ctx:r}=this,{lineWidth:i}=this.current,[h,f]=this.getScaleForStroking();if(r.lineWidth=i||1,h===1&&f===1){r.stroke();return}const E=r.getLineDash();if(n&&r.save(),r.scale(h,f),E.length>0){const O=Math.max(h,f);r.setLineDash(E.map(H=>H/O)),r.lineDashOffset/=O}r.stroke(),n&&r.restore()}isContentVisible(){for(let n=this.markedContentStack.length-1;n>=0;n--)if(!this.markedContentStack[n].visible)return!1;return!0}};G=new WeakSet,Qe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},gt=new WeakSet,Ze=function(){if(this.pageColors){const n=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(n!=="none"){const r=this.ctx.filter;this.ctx.filter=n,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=r}}};let ct=kt;e.CanvasGraphics=ct;for(const T in c.OPS)ct.prototype[T]!==void 0&&(ct.prototype[c.OPS[T]]=ct.prototype[T])},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=d;var c=j(1),p=j(6);const k={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=k;function M(S,C){if(!C)return;const x=C[2]-C[0],w=C[3]-C[1],l=new Path2D;l.rect(C[0],C[1],x,w),S.clip(l)}class X{constructor(){this.constructor===X&&(0,c.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,c.unreachable)("Abstract method `getPattern` called.")}}class D extends X{constructor(C){super(),this._type=C[1],this._bbox=C[2],this._colorStops=C[3],this._p0=C[4],this._p1=C[5],this._r0=C[6],this._r1=C[7],this.matrix=null}_createGradient(C){let x;this._type==="axial"?x=C.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(x=C.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const w of this._colorStops)x.addColorStop(w[0],w[1]);return x}getPattern(C,x,w,l){let a;if(l===k.STROKE||l===k.FILL){const I=x.current.getClippedPathBoundingBox(l,(0,p.getCurrentTransform)(C))||[0,0,0,0],A=Math.ceil(I[2]-I[0])||1,o=Math.ceil(I[3]-I[1])||1,F=x.cachedCanvases.getCanvas("pattern",A,o,!0),v=F.context;v.clearRect(0,0,v.canvas.width,v.canvas.height),v.beginPath(),v.rect(0,0,v.canvas.width,v.canvas.height),v.translate(-I[0],-I[1]),w=c.Util.transform(w,[1,0,0,1,I[0],I[1]]),v.transform(...x.baseTransform),this.matrix&&v.transform(...this.matrix),M(v,this._bbox),v.fillStyle=this._createGradient(v),v.fill(),a=C.createPattern(F.canvas,"no-repeat");const W=new DOMMatrix(w);a.setTransform(W)}else M(C,this._bbox),a=this._createGradient(C);return a}}function P(S,C,x,w,l,a,I,A){const o=C.coords,F=C.colors,v=S.data,W=S.width*4;let Y;o[x+1]>o[w+1]&&(Y=x,x=w,w=Y,Y=a,a=I,I=Y),o[w+1]>o[l+1]&&(Y=w,w=l,l=Y,Y=I,I=A,A=Y),o[x+1]>o[w+1]&&(Y=x,x=w,w=Y,Y=a,a=I,I=Y);const R=(o[x]+C.offsetX)*C.scaleX,K=(o[x+1]+C.offsetY)*C.scaleY,at=(o[w]+C.offsetX)*C.scaleX,ct=(o[w+1]+C.offsetY)*C.scaleY,G=(o[l]+C.offsetX)*C.scaleX,ht=(o[l+1]+C.offsetY)*C.scaleY;if(K>=ht)return;const gt=F[a],Tt=F[a+1],kt=F[a+2],T=F[I],n=F[I+1],r=F[I+2],i=F[A],h=F[A+1],f=F[A+2],E=Math.round(K),O=Math.round(ht);let H,it,st,ot,dt,vt,ft,Ft;for(let Bt=E;Bt<=O;Bt++){if(Bt<ct){const tt=Bt<K?0:(K-Bt)/(K-ct);H=R-(R-at)*tt,it=gt-(gt-T)*tt,st=Tt-(Tt-n)*tt,ot=kt-(kt-r)*tt}else{let tt;Bt>ht?tt=1:ct===ht?tt=0:tt=(ct-Bt)/(ct-ht),H=at-(at-G)*tt,it=T-(T-i)*tt,st=n-(n-h)*tt,ot=r-(r-f)*tt}let Et;Bt<K?Et=0:Bt>ht?Et=1:Et=(K-Bt)/(K-ht),dt=R-(R-G)*Et,vt=gt-(gt-i)*Et,ft=Tt-(Tt-h)*Et,Ft=kt-(kt-f)*Et;const Dt=Math.round(Math.min(H,dt)),pt=Math.round(Math.max(H,dt));let et=W*Bt+Dt*4;for(let tt=Dt;tt<=pt;tt++)Et=(H-tt)/(H-dt),Et<0?Et=0:Et>1&&(Et=1),v[et++]=it-(it-vt)*Et|0,v[et++]=st-(st-ft)*Et|0,v[et++]=ot-(ot-Ft)*Et|0,v[et++]=255}}function u(S,C,x){const w=C.coords,l=C.colors;let a,I;switch(C.type){case"lattice":const A=C.verticesPerRow,o=Math.floor(w.length/A)-1,F=A-1;for(a=0;a<o;a++){let v=a*A;for(let W=0;W<F;W++,v++)P(S,x,w[v],w[v+1],w[v+A],l[v],l[v+1],l[v+A]),P(S,x,w[v+A+1],w[v+1],w[v+A],l[v+A+1],l[v+1],l[v+A])}break;case"triangles":for(a=0,I=w.length;a<I;a+=3)P(S,x,w[a],w[a+1],w[a+2],l[a],l[a+1],l[a+2]);break;default:throw new Error("illegal figure")}}class L extends X{constructor(C){super(),this._coords=C[2],this._colors=C[3],this._figures=C[4],this._bounds=C[5],this._bbox=C[7],this._background=C[8],this.matrix=null}_createMeshCanvas(C,x,w){const A=Math.floor(this._bounds[0]),o=Math.floor(this._bounds[1]),F=Math.ceil(this._bounds[2])-A,v=Math.ceil(this._bounds[3])-o,W=Math.min(Math.ceil(Math.abs(F*C[0]*1.1)),3e3),Y=Math.min(Math.ceil(Math.abs(v*C[1]*1.1)),3e3),R=F/W,K=v/Y,at={coords:this._coords,colors:this._colors,offsetX:-A,offsetY:-o,scaleX:1/R,scaleY:1/K},ct=W+2*2,G=Y+2*2,ht=w.getCanvas("mesh",ct,G,!1),gt=ht.context,Tt=gt.createImageData(W,Y);if(x){const T=Tt.data;for(let n=0,r=T.length;n<r;n+=4)T[n]=x[0],T[n+1]=x[1],T[n+2]=x[2],T[n+3]=255}for(const T of this._figures)u(Tt,T,at);return gt.putImageData(Tt,2,2),{canvas:ht.canvas,offsetX:A-2*R,offsetY:o-2*K,scaleX:R,scaleY:K}}getPattern(C,x,w,l){M(C,this._bbox);let a;if(l===k.SHADING)a=c.Util.singularValueDecompose2dScale((0,p.getCurrentTransform)(C));else if(a=c.Util.singularValueDecompose2dScale(x.baseTransform),this.matrix){const A=c.Util.singularValueDecompose2dScale(this.matrix);a=[a[0]*A[0],a[1]*A[1]]}const I=this._createMeshCanvas(a,l===k.SHADING?null:this._background,x.cachedCanvases);return l!==k.SHADING&&(C.setTransform(...x.baseTransform),this.matrix&&C.transform(...this.matrix)),C.translate(I.offsetX,I.offsetY),C.scale(I.scaleX,I.scaleY),C.createPattern(I.canvas,"no-repeat")}}class _ extends X{getPattern(){return"hotpink"}}function d(S){switch(S[0]){case"RadialAxial":return new D(S);case"Mesh":return new L(S);case"Dummy":return new _}throw new Error(`Unknown IR type: ${S[0]}`)}const m={COLORED:1,UNCOLORED:2},g=class g{constructor(C,x,w,l,a){this.operatorList=C[2],this.matrix=C[3]||[1,0,0,1,0,0],this.bbox=C[4],this.xstep=C[5],this.ystep=C[6],this.paintType=C[7],this.tilingType=C[8],this.color=x,this.ctx=w,this.canvasGraphicsFactory=l,this.baseTransform=a}createPatternCanvas(C){const x=this.operatorList,w=this.bbox,l=this.xstep,a=this.ystep,I=this.paintType,A=this.tilingType,o=this.color,F=this.canvasGraphicsFactory;(0,c.info)("TilingType: "+A);const v=w[0],W=w[1],Y=w[2],R=w[3],K=c.Util.singularValueDecompose2dScale(this.matrix),at=c.Util.singularValueDecompose2dScale(this.baseTransform),ct=[K[0]*at[0],K[1]*at[1]],G=this.getSizeAndScale(l,this.ctx.canvas.width,ct[0]),ht=this.getSizeAndScale(a,this.ctx.canvas.height,ct[1]),gt=C.cachedCanvases.getCanvas("pattern",G.size,ht.size,!0),Tt=gt.context,kt=F.createCanvasGraphics(Tt);kt.groupLevel=C.groupLevel,this.setFillAndStrokeStyleToContext(kt,I,o);let T=v,n=W,r=Y,i=R;return v<0&&(T=0,r+=Math.abs(v)),W<0&&(n=0,i+=Math.abs(W)),Tt.translate(-(G.scale*T),-(ht.scale*n)),kt.transform(G.scale,0,0,ht.scale,0,0),Tt.save(),this.clipBbox(kt,T,n,r,i),kt.baseTransform=(0,p.getCurrentTransform)(kt.ctx),kt.executeOperatorList(x),kt.endDrawing(),{canvas:gt.canvas,scaleX:G.scale,scaleY:ht.scale,offsetX:T,offsetY:n}}getSizeAndScale(C,x,w){C=Math.abs(C);const l=Math.max(g.MAX_PATTERN_SIZE,x);let a=Math.ceil(C*w);return a>=l?a=l:w=a/C,{scale:w,size:a}}clipBbox(C,x,w,l,a){const I=l-x,A=a-w;C.ctx.rect(x,w,I,A),C.current.updateRectMinMax((0,p.getCurrentTransform)(C.ctx),[x,w,l,a]),C.clip(),C.endPath()}setFillAndStrokeStyleToContext(C,x,w){const l=C.ctx,a=C.current;switch(x){case m.COLORED:const I=this.ctx;l.fillStyle=I.fillStyle,l.strokeStyle=I.strokeStyle,a.fillColor=I.fillStyle,a.strokeColor=I.strokeStyle;break;case m.UNCOLORED:const A=c.Util.makeHexColor(w[0],w[1],w[2]);l.fillStyle=A,l.strokeStyle=A,a.fillColor=A,a.strokeColor=A;break;default:throw new c.FormatError(`Unsupported paint type: ${x}`)}}getPattern(C,x,w,l){let a=w;l!==k.SHADING&&(a=c.Util.transform(a,x.baseTransform),this.matrix&&(a=c.Util.transform(a,this.matrix)));const I=this.createPatternCanvas(x);let A=new DOMMatrix(a);A=A.translate(I.offsetX,I.offsetY),A=A.scale(1/I.scaleX,1/I.scaleY);const o=C.createPattern(I.canvas,"repeat");return o.setTransform(A),o}};yt(g,"MAX_PATTERN_SIZE",3e3);let b=g;e.TilingPattern=b},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=k,e.convertToRGBA=p,e.grayToRGBA=X;var c=j(1);function p(D){switch(D.kind){case c.ImageKind.GRAYSCALE_1BPP:return k(D);case c.ImageKind.RGB_24BPP:return M(D)}return null}function k({src:D,srcPos:P=0,dest:u,width:L,height:_,nonBlackColor:d=4294967295,inverseDecode:m=!1}){const b=c.FeatureTest.isLittleEndian?4278190080:255,[g,S]=m?[d,b]:[b,d],C=L>>3,x=L&7,w=D.length;u=new Uint32Array(u.buffer);let l=0;for(let a=0;a<_;a++){for(const A=P+C;P<A;P++){const o=P<w?D[P]:255;u[l++]=o&128?S:g,u[l++]=o&64?S:g,u[l++]=o&32?S:g,u[l++]=o&16?S:g,u[l++]=o&8?S:g,u[l++]=o&4?S:g,u[l++]=o&2?S:g,u[l++]=o&1?S:g}if(x===0)continue;const I=P<w?D[P++]:255;for(let A=0;A<x;A++)u[l++]=I&1<<7-A?S:g}return{srcPos:P,destPos:l}}function M({src:D,srcPos:P=0,dest:u,destPos:L=0,width:_,height:d}){let m=0;const b=D.length>>2,g=new Uint32Array(D.buffer,P,b);if(c.FeatureTest.isLittleEndian){for(;m<b-2;m+=3,L+=4){const S=g[m],C=g[m+1],x=g[m+2];u[L]=S|4278190080,u[L+1]=S>>>24|C<<8|4278190080,u[L+2]=C>>>16|x<<16|4278190080,u[L+3]=x>>>8|4278190080}for(let S=m*4,C=D.length;S<C;S+=3)u[L++]=D[S]|D[S+1]<<8|D[S+2]<<16|4278190080}else{for(;m<b-2;m+=3,L+=4){const S=g[m],C=g[m+1],x=g[m+2];u[L]=S|255,u[L+1]=S<<24|C>>>8|255,u[L+2]=C<<16|x>>>16|255,u[L+3]=x<<8|255}for(let S=m*4,C=D.length;S<C;S+=3)u[L++]=D[S]<<24|D[S+1]<<16|D[S+2]<<8|255}return{srcPos:P,destPos:L}}function X(D,P){if(c.FeatureTest.isLittleEndian)for(let u=0,L=D.length;u<L;u++)P[u]=D[u]*65793|4278190080;else for(let u=0,L=D.length;u<L;u++)P[u]=D[u]*16843008|255}},(z,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const j=Object.create(null);e.GlobalWorkerOptions=j,j.workerPort=null,j.workerSrc=""},(z,e,j)=>{var D,ks,u,Fs,_,Re;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var c=j(1);const p={UNKNOWN:0,DATA:1,ERROR:2},k={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function M(m){switch(m instanceof Error||typeof m=="object"&&m!==null||(0,c.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),m.name){case"AbortException":return new c.AbortException(m.message);case"MissingPDFException":return new c.MissingPDFException(m.message);case"PasswordException":return new c.PasswordException(m.message,m.code);case"UnexpectedResponseException":return new c.UnexpectedResponseException(m.message,m.status);case"UnknownErrorException":return new c.UnknownErrorException(m.message,m.details);default:return new c.UnknownErrorException(m.message,m.toString())}}class X{constructor(b,g,S){B(this,D);B(this,u);B(this,_);this.sourceName=b,this.targetName=g,this.comObj=S,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=C=>{const x=C.data;if(x.targetName!==this.sourceName)return;if(x.stream){V(this,u,Fs).call(this,x);return}if(x.callback){const l=x.callbackId,a=this.callbackCapabilities[l];if(!a)throw new Error(`Cannot resolve callback ${l}`);if(delete this.callbackCapabilities[l],x.callback===p.DATA)a.resolve(x.data);else if(x.callback===p.ERROR)a.reject(M(x.reason));else throw new Error("Unexpected callback case");return}const w=this.actionHandler[x.action];if(!w)throw new Error(`Unknown action from worker: ${x.action}`);if(x.callbackId){const l=this.sourceName,a=x.sourceName;new Promise(function(I){I(w(x.data))}).then(function(I){S.postMessage({sourceName:l,targetName:a,callback:p.DATA,callbackId:x.callbackId,data:I})},function(I){S.postMessage({sourceName:l,targetName:a,callback:p.ERROR,callbackId:x.callbackId,reason:M(I)})});return}if(x.streamId){V(this,D,ks).call(this,x);return}w(x.data)},S.addEventListener("message",this._onComObjOnMessage)}on(b,g){const S=this.actionHandler;if(S[b])throw new Error(`There is already an actionName called "${b}"`);S[b]=g}send(b,g,S){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:b,data:g},S)}sendWithPromise(b,g,S){const C=this.callbackId++,x=new c.PromiseCapability;this.callbackCapabilities[C]=x;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:b,callbackId:C,data:g},S)}catch(w){x.reject(w)}return x.promise}sendWithStream(b,g,S,C){const x=this.streamId++,w=this.sourceName,l=this.targetName,a=this.comObj;return new ReadableStream({start:I=>{const A=new c.PromiseCapability;return this.streamControllers[x]={controller:I,startCall:A,pullCall:null,cancelCall:null,isClosed:!1},a.postMessage({sourceName:w,targetName:l,action:b,streamId:x,data:g,desiredSize:I.desiredSize},C),A.promise},pull:I=>{const A=new c.PromiseCapability;return this.streamControllers[x].pullCall=A,a.postMessage({sourceName:w,targetName:l,stream:k.PULL,streamId:x,desiredSize:I.desiredSize}),A.promise},cancel:I=>{(0,c.assert)(I instanceof Error,"cancel must have a valid reason");const A=new c.PromiseCapability;return this.streamControllers[x].cancelCall=A,this.streamControllers[x].isClosed=!0,a.postMessage({sourceName:w,targetName:l,stream:k.CANCEL,streamId:x,reason:M(I)}),A.promise}},S)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}D=new WeakSet,ks=function(b){const g=b.streamId,S=this.sourceName,C=b.sourceName,x=this.comObj,w=this,l=this.actionHandler[b.action],a={enqueue(I,A=1,o){if(this.isCancelled)return;const F=this.desiredSize;this.desiredSize-=A,F>0&&this.desiredSize<=0&&(this.sinkCapability=new c.PromiseCapability,this.ready=this.sinkCapability.promise),x.postMessage({sourceName:S,targetName:C,stream:k.ENQUEUE,streamId:g,chunk:I},o)},close(){this.isCancelled||(this.isCancelled=!0,x.postMessage({sourceName:S,targetName:C,stream:k.CLOSE,streamId:g}),delete w.streamSinks[g])},error(I){(0,c.assert)(I instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,x.postMessage({sourceName:S,targetName:C,stream:k.ERROR,streamId:g,reason:M(I)}))},sinkCapability:new c.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:b.desiredSize,ready:null};a.sinkCapability.resolve(),a.ready=a.sinkCapability.promise,this.streamSinks[g]=a,new Promise(function(I){I(l(b.data,a))}).then(function(){x.postMessage({sourceName:S,targetName:C,stream:k.START_COMPLETE,streamId:g,success:!0})},function(I){x.postMessage({sourceName:S,targetName:C,stream:k.START_COMPLETE,streamId:g,reason:M(I)})})},u=new WeakSet,Fs=function(b){const g=b.streamId,S=this.sourceName,C=b.sourceName,x=this.comObj,w=this.streamControllers[g],l=this.streamSinks[g];switch(b.stream){case k.START_COMPLETE:b.success?w.startCall.resolve():w.startCall.reject(M(b.reason));break;case k.PULL_COMPLETE:b.success?w.pullCall.resolve():w.pullCall.reject(M(b.reason));break;case k.PULL:if(!l){x.postMessage({sourceName:S,targetName:C,stream:k.PULL_COMPLETE,streamId:g,success:!0});break}l.desiredSize<=0&&b.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=b.desiredSize,new Promise(function(a){var I;a((I=l.onPull)==null?void 0:I.call(l))}).then(function(){x.postMessage({sourceName:S,targetName:C,stream:k.PULL_COMPLETE,streamId:g,success:!0})},function(a){x.postMessage({sourceName:S,targetName:C,stream:k.PULL_COMPLETE,streamId:g,reason:M(a)})});break;case k.ENQUEUE:if((0,c.assert)(w,"enqueue should have stream controller"),w.isClosed)break;w.controller.enqueue(b.chunk);break;case k.CLOSE:if((0,c.assert)(w,"close should have stream controller"),w.isClosed)break;w.isClosed=!0,w.controller.close(),V(this,_,Re).call(this,w,g);break;case k.ERROR:(0,c.assert)(w,"error should have stream controller"),w.controller.error(M(b.reason)),V(this,_,Re).call(this,w,g);break;case k.CANCEL_COMPLETE:b.success?w.cancelCall.resolve():w.cancelCall.reject(M(b.reason)),V(this,_,Re).call(this,w,g);break;case k.CANCEL:if(!l)break;new Promise(function(a){var I;a((I=l.onCancel)==null?void 0:I.call(l,M(b.reason)))}).then(function(){x.postMessage({sourceName:S,targetName:C,stream:k.CANCEL_COMPLETE,streamId:g,success:!0})},function(a){x.postMessage({sourceName:S,targetName:C,stream:k.CANCEL_COMPLETE,streamId:g,reason:M(a)})}),l.sinkCapability.reject(M(b.reason)),l.isCancelled=!0,delete this.streamSinks[g];break;default:throw new Error("Unexpected stream case")}},_=new WeakSet,Re=async function(b,g){var S,C,x;await Promise.allSettled([(S=b.startCall)==null?void 0:S.promise,(C=b.pullCall)==null?void 0:C.promise,(x=b.cancelCall)==null?void 0:x.promise]),delete this.streamControllers[g]},e.MessageHandler=X},(z,e,j)=>{var k,M;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var c=j(1);class p{constructor({parsedData:D,rawData:P}){B(this,k,void 0);B(this,M,void 0);nt(this,k,D),nt(this,M,P)}getRaw(){return t(this,M)}get(D){var P;return(P=t(this,k).get(D))!=null?P:null}getAll(){return(0,c.objectFromMap)(t(this,k))}has(D){return t(this,k).has(D)}}k=new WeakMap,M=new WeakMap,e.Metadata=p},(z,e,j)=>{var D,P,u,L,_,d,ts;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var c=j(1),p=j(8);const k=Symbol("INTERNAL");class M{constructor(g,S){B(this,D,!0);this.name=g,this.intent=S}get visible(){return t(this,D)}_setVisible(g,S){g!==k&&(0,c.unreachable)("Internal method `_setVisible` called."),nt(this,D,S)}}D=new WeakMap;class X{constructor(g){B(this,d);B(this,P,null);B(this,u,new Map);B(this,L,null);B(this,_,null);if(this.name=null,this.creator=null,g!==null){this.name=g.name,this.creator=g.creator,nt(this,_,g.order);for(const S of g.groups)t(this,u).set(S.id,new M(S.name,S.intent));if(g.baseState==="OFF")for(const S of t(this,u).values())S._setVisible(k,!1);for(const S of g.on)t(this,u).get(S)._setVisible(k,!0);for(const S of g.off)t(this,u).get(S)._setVisible(k,!1);nt(this,L,this.getHash())}}isVisible(g){if(t(this,u).size===0)return!0;if(!g)return(0,c.warn)("Optional content group not defined."),!0;if(g.type==="OCG")return t(this,u).has(g.id)?t(this,u).get(g.id).visible:((0,c.warn)(`Optional content group not found: ${g.id}`),!0);if(g.type==="OCMD"){if(g.expression)return V(this,d,ts).call(this,g.expression);if(!g.policy||g.policy==="AnyOn"){for(const S of g.ids){if(!t(this,u).has(S))return(0,c.warn)(`Optional content group not found: ${S}`),!0;if(t(this,u).get(S).visible)return!0}return!1}else if(g.policy==="AllOn"){for(const S of g.ids){if(!t(this,u).has(S))return(0,c.warn)(`Optional content group not found: ${S}`),!0;if(!t(this,u).get(S).visible)return!1}return!0}else if(g.policy==="AnyOff"){for(const S of g.ids){if(!t(this,u).has(S))return(0,c.warn)(`Optional content group not found: ${S}`),!0;if(!t(this,u).get(S).visible)return!0}return!1}else if(g.policy==="AllOff"){for(const S of g.ids){if(!t(this,u).has(S))return(0,c.warn)(`Optional content group not found: ${S}`),!0;if(t(this,u).get(S).visible)return!1}return!0}return(0,c.warn)(`Unknown optional content policy ${g.policy}.`),!0}return(0,c.warn)(`Unknown group type ${g.type}.`),!0}setVisibility(g,S=!0){if(!t(this,u).has(g)){(0,c.warn)(`Optional content group not found: ${g}`);return}t(this,u).get(g)._setVisible(k,!!S),nt(this,P,null)}get hasInitialVisibility(){return t(this,L)===null||this.getHash()===t(this,L)}getOrder(){return t(this,u).size?t(this,_)?t(this,_).slice():[...t(this,u).keys()]:null}getGroups(){return t(this,u).size>0?(0,c.objectFromMap)(t(this,u)):null}getGroup(g){return t(this,u).get(g)||null}getHash(){if(t(this,P)!==null)return t(this,P);const g=new p.MurmurHash3_64;for(const[S,C]of t(this,u))g.update(`${S}:${C.visible}`);return nt(this,P,g.hexdigest())}}P=new WeakMap,u=new WeakMap,L=new WeakMap,_=new WeakMap,d=new WeakSet,ts=function(g){const S=g.length;if(S<2)return!0;const C=g[0];for(let x=1;x<S;x++){const w=g[x];let l;if(Array.isArray(w))l=V(this,d,ts).call(this,w);else if(t(this,u).has(w))l=t(this,u).get(w).visible;else return(0,c.warn)(`Optional content group not found: ${w}`),!0;switch(C){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return C==="And"},e.OptionalContentConfig=X},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var c=j(1),p=j(6);class k{constructor({length:P,initialData:u,progressiveDone:L=!1,contentDispositionFilename:_=null,disableRange:d=!1,disableStream:m=!1},b){if((0,c.assert)(b,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=L,this._contentDispositionFilename=_,(u==null?void 0:u.length)>0){const g=u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength?u.buffer:new Uint8Array(u).buffer;this._queuedChunks.push(g)}this._pdfDataRangeTransport=b,this._isStreamingSupported=!m,this._isRangeSupported=!d,this._contentLength=P,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((g,S)=>{this._onReceiveData({begin:g,chunk:S})}),this._pdfDataRangeTransport.addProgressListener((g,S)=>{this._onProgress({loaded:g,total:S})}),this._pdfDataRangeTransport.addProgressiveReadListener(g=>{this._onReceiveData({chunk:g})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:P,chunk:u}){const L=u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength?u.buffer:new Uint8Array(u).buffer;if(P===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(L):this._queuedChunks.push(L);else{const _=this._rangeReaders.some(function(d){return d._begin!==P?!1:(d._enqueue(L),!0)});(0,c.assert)(_,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var P,u;return(u=(P=this._fullRequestReader)==null?void 0:P._loaded)!=null?u:0}_onProgress(P){var u,L,_,d;P.total===void 0?(L=(u=this._rangeReaders[0])==null?void 0:u.onProgress)==null||L.call(u,{loaded:P.loaded}):(d=(_=this._fullRequestReader)==null?void 0:_.onProgress)==null||d.call(_,{loaded:P.loaded,total:P.total})}_onProgressiveDone(){var P;(P=this._fullRequestReader)==null||P.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(P){const u=this._rangeReaders.indexOf(P);u>=0&&this._rangeReaders.splice(u,1)}getFullReader(){(0,c.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const P=this._queuedChunks;return this._queuedChunks=null,new M(this,P,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(P,u){if(u<=this._progressiveDataLength)return null;const L=new X(this,P,u);return this._pdfDataRangeTransport.requestDataRange(P,u),this._rangeReaders.push(L),L}cancelAllRequests(P){var u;(u=this._fullRequestReader)==null||u.cancel(P);for(const L of this._rangeReaders.slice(0))L.cancel(P);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=k;class M{constructor(P,u,L=!1,_=null){this._stream=P,this._done=L||!1,this._filename=(0,p.isPdfFile)(_)?_:null,this._queuedChunks=u||[],this._loaded=0;for(const d of this._queuedChunks)this._loaded+=d.byteLength;this._requests=[],this._headersReady=Promise.resolve(),P._fullRequestReader=this,this.onProgress=null}_enqueue(P){this._done||(this._requests.length>0?this._requests.shift().resolve({value:P,done:!1}):this._queuedChunks.push(P),this._loaded+=P.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const P=new c.PromiseCapability;return this._requests.push(P),P.promise}cancel(P){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class X{constructor(P,u,L){this._stream=P,this._begin=u,this._end=L,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(P){if(!this._done){if(this._requests.length===0)this._queuedChunk=P;else{this._requests.shift().resolve({value:P,done:!1});for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const P=new c.PromiseCapability;return this._requests.push(P),P.promise}cancel(P){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var c=j(1),p=j(20);function k(L,_,d){return{method:"GET",headers:L,signal:d.signal,mode:"cors",credentials:_?"include":"same-origin",redirect:"follow"}}function M(L){const _=new Headers;for(const d in L){const m=L[d];m!==void 0&&_.append(d,m)}return _}function X(L){return L instanceof Uint8Array?L.buffer:L instanceof ArrayBuffer?L:((0,c.warn)(`getArrayBuffer - unexpected data format: ${L}`),new Uint8Array(L).buffer)}class D{constructor(_){this.source=_,this.isHttp=/^https?:/i.test(_.url),this.httpHeaders=this.isHttp&&_.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var _,d;return(d=(_=this._fullRequestReader)==null?void 0:_._loaded)!=null?d:0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new P(this),this._fullRequestReader}getRangeReader(_,d){if(d<=this._progressiveDataLength)return null;const m=new u(this,_,d);return this._rangeRequestReaders.push(m),m}cancelAllRequests(_){var d;(d=this._fullRequestReader)==null||d.cancel(_);for(const m of this._rangeRequestReaders.slice(0))m.cancel(_)}}e.PDFFetchStream=D;class P{constructor(_){this._stream=_,this._reader=null,this._loaded=0,this._filename=null;const d=_.source;this._withCredentials=d.withCredentials||!1,this._contentLength=d.length,this._headersCapability=new c.PromiseCapability,this._disableRange=d.disableRange||!1,this._rangeChunkSize=d.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!d.disableStream,this._isRangeSupported=!d.disableRange,this._headers=M(this._stream.httpHeaders);const m=d.url;fetch(m,k(this._headers,this._withCredentials,this._abortController)).then(b=>{if(!(0,p.validateResponseStatus)(b.status))throw(0,p.createResponseStatusError)(b.status,m);this._reader=b.body.getReader(),this._headersCapability.resolve();const g=x=>b.headers.get(x),{allowRangeRequests:S,suggestedLength:C}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=S,this._contentLength=C||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new c.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var m;await this._headersCapability.promise;const{value:_,done:d}=await this._reader.read();return d?{value:_,done:d}:(this._loaded+=_.byteLength,(m=this.onProgress)==null||m.call(this,{loaded:this._loaded,total:this._contentLength}),{value:X(_),done:!1})}cancel(_){var d;(d=this._reader)==null||d.cancel(_),this._abortController.abort()}}class u{constructor(_,d,m){this._stream=_,this._reader=null,this._loaded=0;const b=_.source;this._withCredentials=b.withCredentials||!1,this._readCapability=new c.PromiseCapability,this._isStreamingSupported=!b.disableStream,this._abortController=new AbortController,this._headers=M(this._stream.httpHeaders),this._headers.append("Range",`bytes=${d}-${m-1}`);const g=b.url;fetch(g,k(this._headers,this._withCredentials,this._abortController)).then(S=>{if(!(0,p.validateResponseStatus)(S.status))throw(0,p.createResponseStatusError)(S.status,g);this._readCapability.resolve(),this._reader=S.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var m;await this._readCapability.promise;const{value:_,done:d}=await this._reader.read();return d?{value:_,done:d}:(this._loaded+=_.byteLength,(m=this.onProgress)==null||m.call(this,{loaded:this._loaded}),{value:X(_),done:!1})}cancel(_){var d;(d=this._reader)==null||d.cancel(_),this._abortController.abort()}}},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=D,e.extractFilenameFromHeader=X,e.validateRangeRequestCapabilities=M,e.validateResponseStatus=P;var c=j(1),p=j(21),k=j(6);function M({getResponseHeader:u,isHttp:L,rangeChunkSize:_,disableRange:d}){const m={allowRangeRequests:!1,suggestedLength:void 0},b=parseInt(u("Content-Length"),10);return!Number.isInteger(b)||(m.suggestedLength=b,b<=2*_)||d||!L||u("Accept-Ranges")!=="bytes"||(u("Content-Encoding")||"identity")!=="identity"||(m.allowRangeRequests=!0),m}function X(u){const L=u("Content-Disposition");if(L){let _=(0,p.getFilenameFromContentDispositionHeader)(L);if(_.includes("%"))try{_=decodeURIComponent(_)}catch(d){}if((0,k.isPdfFile)(_))return _}return null}function D(u,L){return u===404||u===0&&L.startsWith("file:")?new c.MissingPDFException('Missing PDF "'+L+'".'):new c.UnexpectedResponseException(`Unexpected server response (${u}) while retrieving PDF "${L}".`,u)}function P(u){return u===200||u===206}},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=p;var c=j(1);function p(k){let M=!0,X=D("filename\\*","i").exec(k);if(X){X=X[1];let b=_(X);return b=unescape(b),b=d(b),b=m(b),u(b)}if(X=L(k),X){const b=m(X);return u(b)}if(X=D("filename","i").exec(k),X){X=X[1];let b=_(X);return b=m(b),u(b)}function D(b,g){return new RegExp("(?:^|;)\\s*"+b+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function P(b,g){if(b){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const S=new TextDecoder(b,{fatal:!0}),C=(0,c.stringToBytes)(g);g=S.decode(C),M=!1}catch(S){}}return g}function u(b){return M&&/[\x80-\xff]/.test(b)&&(b=P("utf-8",b),M&&(b=P("iso-8859-1",b))),b}function L(b){const g=[];let S;const C=D("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(S=C.exec(b))!==null;){let[,w,l,a]=S;if(w=parseInt(w,10),w in g){if(w===0)break;continue}g[w]=[l,a]}const x=[];for(let w=0;w<g.length&&w in g;++w){let[l,a]=g[w];a=_(a),l&&(a=unescape(a),w===0&&(a=d(a))),x.push(a)}return x.join("")}function _(b){if(b.startsWith('"')){const g=b.slice(1).split('\\"');for(let S=0;S<g.length;++S){const C=g[S].indexOf('"');C!==-1&&(g[S]=g[S].slice(0,C),g.length=S+1),g[S]=g[S].replaceAll(/\\(.)/g,"$1")}b=g.join('"')}return b}function d(b){const g=b.indexOf("'");if(g===-1)return b;const S=b.slice(0,g),x=b.slice(g+1).replace(/^[^']*'/,"");return P(S,x)}function m(b){return!b.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(b)?b:b.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,S,C,x){if(C==="q"||C==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,l){return String.fromCharCode(parseInt(l,16))}),P(S,x);try{x=atob(x)}catch(w){}return P(S,x)})}return""}},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var c=j(1),p=j(20);const k=200,M=206;function X(_){const d=_.response;return typeof d!="string"?d:(0,c.stringToBytes)(d).buffer}class D{constructor(d,m={}){this.url=d,this.isHttp=/^https?:/i.test(d),this.httpHeaders=this.isHttp&&m.httpHeaders||Object.create(null),this.withCredentials=m.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(d,m,b){const g={begin:d,end:m};for(const S in b)g[S]=b[S];return this.request(g)}requestFull(d){return this.request(d)}request(d){const m=new XMLHttpRequest,b=this.currXhrId++,g=this.pendingRequests[b]={xhr:m};m.open("GET",this.url),m.withCredentials=this.withCredentials;for(const S in this.httpHeaders){const C=this.httpHeaders[S];C!==void 0&&m.setRequestHeader(S,C)}return this.isHttp&&"begin"in d&&"end"in d?(m.setRequestHeader("Range",`bytes=${d.begin}-${d.end-1}`),g.expectedStatus=M):g.expectedStatus=k,m.responseType="arraybuffer",d.onError&&(m.onerror=function(S){d.onError(m.status)}),m.onreadystatechange=this.onStateChange.bind(this,b),m.onprogress=this.onProgress.bind(this,b),g.onHeadersReceived=d.onHeadersReceived,g.onDone=d.onDone,g.onError=d.onError,g.onProgress=d.onProgress,m.send(null),b}onProgress(d,m){var g;const b=this.pendingRequests[d];b&&((g=b.onProgress)==null||g.call(b,m))}onStateChange(d,m){var w,l,a;const b=this.pendingRequests[d];if(!b)return;const g=b.xhr;if(g.readyState>=2&&b.onHeadersReceived&&(b.onHeadersReceived(),delete b.onHeadersReceived),g.readyState!==4||!(d in this.pendingRequests))return;if(delete this.pendingRequests[d],g.status===0&&this.isHttp){(w=b.onError)==null||w.call(b,g.status);return}const S=g.status||k;if(!(S===k&&b.expectedStatus===M)&&S!==b.expectedStatus){(l=b.onError)==null||l.call(b,g.status);return}const x=X(g);if(S===M){const I=g.getResponseHeader("Content-Range"),A=/bytes (\d+)-(\d+)\/(\d+)/.exec(I);b.onDone({begin:parseInt(A[1],10),chunk:x})}else x?b.onDone({begin:0,chunk:x}):(a=b.onError)==null||a.call(b,g.status)}getRequestXhr(d){return this.pendingRequests[d].xhr}isPendingRequest(d){return d in this.pendingRequests}abortRequest(d){const m=this.pendingRequests[d].xhr;delete this.pendingRequests[d],m.abort()}}class P{constructor(d){this._source=d,this._manager=new D(d.url,{httpHeaders:d.httpHeaders,withCredentials:d.withCredentials}),this._rangeChunkSize=d.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(d){const m=this._rangeRequestReaders.indexOf(d);m>=0&&this._rangeRequestReaders.splice(m,1)}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new u(this._manager,this._source),this._fullRequestReader}getRangeReader(d,m){const b=new L(this._manager,d,m);return b.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(b),b}cancelAllRequests(d){var m;(m=this._fullRequestReader)==null||m.cancel(d);for(const b of this._rangeRequestReaders.slice(0))b.cancel(d)}}e.PDFNetworkStream=P;class u{constructor(d,m){this._manager=d;const b={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=m.url,this._fullRequestId=d.requestFull(b),this._headersReceivedCapability=new c.PromiseCapability,this._disableRange=m.disableRange||!1,this._contentLength=m.length,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const d=this._fullRequestId,m=this._manager.getRequestXhr(d),b=C=>m.getResponseHeader(C),{allowRangeRequests:g,suggestedLength:S}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:b,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});g&&(this._isRangeSupported=!0),this._contentLength=S||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(b),this._isRangeSupported&&this._manager.abortRequest(d),this._headersReceivedCapability.resolve()}_onDone(d){if(d&&(this._requests.length>0?this._requests.shift().resolve({value:d.chunk,done:!1}):this._cachedChunks.push(d.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(d){this._storedError=(0,p.createResponseStatusError)(d,this._url),this._headersReceivedCapability.reject(this._storedError);for(const m of this._requests)m.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(d){var m;(m=this.onProgress)==null||m.call(this,{loaded:d.loaded,total:d.lengthComputable?d.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const d=new c.PromiseCapability;return this._requests.push(d),d.promise}cancel(d){this._done=!0,this._headersReceivedCapability.reject(d);for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L{constructor(d,m,b){this._manager=d;const g={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=d.url,this._requestId=d.requestRange(m,b,g),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var d;(d=this.onClosed)==null||d.call(this,this)}_onDone(d){const m=d.chunk;this._requests.length>0?this._requests.shift().resolve({value:m,done:!1}):this._queuedChunk=m,this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(d){this._storedError=(0,p.createResponseStatusError)(d,this._url);for(const m of this._requests)m.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(d){var m;this.isStreamingSupported||(m=this.onProgress)==null||m.call(this,{loaded:d.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const d=new c.PromiseCapability;return this._requests.push(d),d.promise}cancel(d){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var c=j(1),p=j(20);const k=/^file:\/\/\/[a-zA-Z]:\//;function M(b){const g=requireUrl(),S=g.parse(b);return S.protocol==="file:"||S.host?S:/^[a-z]:[/\\]/i.test(b)?g.parse(`file:///${b}`):(S.host||(S.protocol="file:"),S)}class X{constructor(g){this.source=g,this.url=M(g.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&g.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var g,S;return(S=(g=this._fullRequestReader)==null?void 0:g._loaded)!=null?S:0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new d(this):new L(this),this._fullRequestReader}getRangeReader(g,S){if(S<=this._progressiveDataLength)return null;const C=this.isFsUrl?new m(this,g,S):new _(this,g,S);return this._rangeRequestReaders.push(C),C}cancelAllRequests(g){var S;(S=this._fullRequestReader)==null||S.cancel(g);for(const C of this._rangeRequestReaders.slice(0))C.cancel(g)}}e.PDFNodeStream=X;class D{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null;const S=g.source;this._contentLength=S.length,this._loaded=0,this._filename=null,this._disableRange=S.disableRange||!1,this._rangeChunkSize=S.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!S.disableStream,this._isRangeSupported=!S.disableRange,this._readableStream=null,this._readCapability=new c.PromiseCapability,this._headersCapability=new c.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var C;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new c.PromiseCapability,this.read()):(this._loaded+=g.length,(C=this.onProgress)==null||C.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",S=>{this._error(S)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new c.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class P{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new c.PromiseCapability;const S=g.source;this._isStreamingSupported=!S.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var C;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new c.PromiseCapability,this.read()):(this._loaded+=g.length,(C=this.onProgress)==null||C.call(this,{loaded:this._loaded}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",S=>{this._error(S)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function u(b,g){return{protocol:b.protocol,auth:b.auth,host:b.hostname,port:b.port,path:b.path,method:"GET",headers:g}}class L extends D{constructor(g){super(g);const S=C=>{if(C.statusCode===404){const a=new c.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=a,this._headersCapability.reject(a);return}this._headersCapability.resolve(),this._setReadableStream(C);const x=a=>this._readableStream.headers[a.toLowerCase()],{allowRangeRequests:w,suggestedLength:l}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:g.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=w,this._contentLength=l||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(x)};if(this._request=null,this._url.protocol==="http:"){const C=requireHttp();this._request=C.request(u(this._url,g.httpHeaders),S)}else{const C=requireProxy();this._request=C.request(u(this._url,g.httpHeaders),S)}this._request.on("error",C=>{this._storedError=C,this._headersCapability.reject(C)}),this._request.end()}}class _ extends P{constructor(g,S,C){super(g),this._httpHeaders={};for(const w in g.httpHeaders){const l=g.httpHeaders[w];l!==void 0&&(this._httpHeaders[w]=l)}this._httpHeaders.Range=`bytes=${S}-${C-1}`;const x=w=>{if(w.statusCode===404){const l=new c.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=l;return}this._setReadableStream(w)};if(this._request=null,this._url.protocol==="http:"){const w=requireHttp();this._request=w.request(u(this._url,this._httpHeaders),x)}else{const w=requireProxy();this._request=w.request(u(this._url,this._httpHeaders),x)}this._request.on("error",w=>{this._storedError=w}),this._request.end()}}class d extends D{constructor(g){super(g);let S=decodeURIComponent(this._url.path);k.test(this._url.href)&&(S=S.replace(/^\//,""));const C=requireFs();C.lstat(S,(x,w)=>{if(x){x.code==="ENOENT"&&(x=new c.MissingPDFException(`Missing PDF "${S}".`)),this._storedError=x,this._headersCapability.reject(x);return}this._contentLength=w.size,this._setReadableStream(C.createReadStream(S)),this._headersCapability.resolve()})}}class m extends P{constructor(g,S,C){super(g);let x=decodeURIComponent(this._url.path);k.test(this._url.href)&&(x=x.replace(/^\//,""));const w=requireFs();this._setReadableStream(w.createReadStream(x,{start:S,end:C-1}))}}},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var c=j(6),p=j(1);const k={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},M="http://www.w3.org/XML/1998/namespace",X="http://www.w3.org/1999/xlink",D=["butt","round","square"],P=["miter","round","bevel"],u=function(w,l="",a=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!a)return URL.createObjectURL(new Blob([w],{type:l}));const I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let A=`data:${l};base64,`;for(let o=0,F=w.length;o<F;o+=3){const v=w[o]&255,W=w[o+1]&255,Y=w[o+2]&255,R=v>>2,K=(v&3)<<4|W>>4,at=o+1<F?(W&15)<<2|Y>>6:64,ct=o+2<F?Y&63:64;A+=I[R]+I[K]+I[at]+I[ct]}return A},L=function(){const w=new Uint8Array([137,80,78,71,13,10,26,10]),l=12,a=new Int32Array(256);for(let Y=0;Y<256;Y++){let R=Y;for(let K=0;K<8;K++)R=R&1?3988292384^R>>1&2147483647:R>>1&2147483647;a[Y]=R}function I(Y,R,K){let at=-1;for(let ct=R;ct<K;ct++){const G=(at^Y[ct])&255,ht=a[G];at=at>>>8^ht}return at^-1}function A(Y,R,K,at){let ct=at;const G=R.length;K[ct]=G>>24&255,K[ct+1]=G>>16&255,K[ct+2]=G>>8&255,K[ct+3]=G&255,ct+=4,K[ct]=Y.charCodeAt(0)&255,K[ct+1]=Y.charCodeAt(1)&255,K[ct+2]=Y.charCodeAt(2)&255,K[ct+3]=Y.charCodeAt(3)&255,ct+=4,K.set(R,ct),ct+=R.length;const ht=I(K,at+4,ct);K[ct]=ht>>24&255,K[ct+1]=ht>>16&255,K[ct+2]=ht>>8&255,K[ct+3]=ht&255}function o(Y,R,K){let at=1,ct=0;for(let G=R;G<K;++G)at=(at+(Y[G]&255))%65521,ct=(ct+at)%65521;return ct<<16|at}function F(Y){if(!p.isNodeJS)return v(Y);try{const R=parseInt(process.versions.node)>=8?Y:Buffer.from(Y),K=requireProxy().deflateSync(R,{level:9});return K instanceof Uint8Array?K:new Uint8Array(K)}catch(R){(0,p.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+R)}return v(Y)}function v(Y){let R=Y.length;const K=65535,at=Math.ceil(R/K),ct=new Uint8Array(2+R+at*5+4);let G=0;ct[G++]=120,ct[G++]=156;let ht=0;for(;R>K;)ct[G++]=0,ct[G++]=255,ct[G++]=255,ct[G++]=0,ct[G++]=0,ct.set(Y.subarray(ht,ht+K),G),G+=K,ht+=K,R-=K;ct[G++]=1,ct[G++]=R&255,ct[G++]=R>>8&255,ct[G++]=~R&65535&255,ct[G++]=(~R&65535)>>8&255,ct.set(Y.subarray(ht),G),G+=Y.length-ht;const gt=o(Y,0,Y.length);return ct[G++]=gt>>24&255,ct[G++]=gt>>16&255,ct[G++]=gt>>8&255,ct[G++]=gt&255,ct}function W(Y,R,K,at){const ct=Y.width,G=Y.height;let ht,gt,Tt;const kt=Y.data;switch(R){case p.ImageKind.GRAYSCALE_1BPP:gt=0,ht=1,Tt=ct+7>>3;break;case p.ImageKind.RGB_24BPP:gt=2,ht=8,Tt=ct*3;break;case p.ImageKind.RGBA_32BPP:gt=6,ht=8,Tt=ct*4;break;default:throw new Error("invalid format")}const T=new Uint8Array((1+Tt)*G);let n=0,r=0;for(let H=0;H<G;++H)T[n++]=0,T.set(kt.subarray(r,r+Tt),n),r+=Tt,n+=Tt;if(R===p.ImageKind.GRAYSCALE_1BPP&&at){n=0;for(let H=0;H<G;H++){n++;for(let it=0;it<Tt;it++)T[n++]^=255}}const i=new Uint8Array([ct>>24&255,ct>>16&255,ct>>8&255,ct&255,G>>24&255,G>>16&255,G>>8&255,G&255,ht,gt,0,0,0]),h=F(T),f=w.length+l*3+i.length+h.length,E=new Uint8Array(f);let O=0;return E.set(w,O),O+=w.length,A("IHDR",i,E,O),O+=l+i.length,A("IDATA",h,E,O),O+=l+h.length,A("IEND",new Uint8Array(0),E,O),u(E,"image/png",K)}return function(R,K,at){const ct=R.kind===void 0?p.ImageKind.GRAYSCALE_1BPP:R.kind;return W(R,ct,K,at)}}();class _{constructor(){this.fontSizeScale=1,this.fontWeight=k.fontWeight,this.fontSize=0,this.textMatrix=p.IDENTITY_MATRIX,this.fontMatrix=p.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=p.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=k.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(l,a){this.x=l,this.y=a}}function d(w){let l=[];const a=[];for(const I of w){if(I.fn==="save"){l.push({fnId:92,fn:"group",items:[]}),a.push(l),l=l.at(-1).items;continue}I.fn==="restore"?l=a.pop():l.push(I)}return l}function m(w){if(Number.isInteger(w))return w.toString();const l=w.toFixed(10);let a=l.length-1;if(l[a]!=="0")return l;do a--;while(l[a]==="0");return l.substring(0,l[a]==="."?a:a+1)}function b(w){if(w[4]===0&&w[5]===0){if(w[1]===0&&w[2]===0)return w[0]===1&&w[3]===1?"":`scale(${m(w[0])} ${m(w[3])})`;if(w[0]===w[3]&&w[1]===-w[2]){const l=Math.acos(w[0])*180/Math.PI;return`rotate(${m(l)})`}}else if(w[0]===1&&w[1]===0&&w[2]===0&&w[3]===1)return`translate(${m(w[4])} ${m(w[5])})`;return`matrix(${m(w[0])} ${m(w[1])} ${m(w[2])} ${m(w[3])} ${m(w[4])} ${m(w[5])})`}let g=0,S=0,C=0;class x{constructor(l,a,I=!1){(0,c.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new c.DOMSVGFactory,this.current=new _,this.transformMatrix=p.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=l,this.objs=a,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!I,this._operatorIdMapping=[];for(const A in p.OPS)this._operatorIdMapping[p.OPS[A]]=A}getObject(l,a=null){return typeof l=="string"?l.startsWith("g_")?this.commonObjs.get(l):this.objs.get(l):a}save(){this.transformStack.push(this.transformMatrix);const l=this.current;this.extraStack.push(l),this.current=l.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(l){this.save(),this.executeOpTree(l),this.restore()}loadDependencies(l){const a=l.fnArray,I=l.argsArray;for(let A=0,o=a.length;A<o;A++)if(a[A]===p.OPS.dependency)for(const F of I[A]){const v=F.startsWith("g_")?this.commonObjs:this.objs,W=new Promise(Y=>{v.get(F,Y)});this.current.dependencies.push(W)}return Promise.all(this.current.dependencies)}transform(l,a,I,A,o,F){const v=[l,a,I,A,o,F];this.transformMatrix=p.Util.transform(this.transformMatrix,v),this.tgrp=null}getSVG(l,a){this.viewport=a;const I=this._initialize(a);return this.loadDependencies(l).then(()=>(this.transformMatrix=p.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(l)),I))}convertOpList(l){const a=this._operatorIdMapping,I=l.argsArray,A=l.fnArray,o=[];for(let F=0,v=A.length;F<v;F++){const W=A[F];o.push({fnId:W,fn:a[W],args:I[F]})}return d(o)}executeOpTree(l){for(const a of l){const I=a.fn,A=a.fnId,o=a.args;switch(A|0){case p.OPS.beginText:this.beginText();break;case p.OPS.dependency:break;case p.OPS.setLeading:this.setLeading(o);break;case p.OPS.setLeadingMoveText:this.setLeadingMoveText(o[0],o[1]);break;case p.OPS.setFont:this.setFont(o);break;case p.OPS.showText:this.showText(o[0]);break;case p.OPS.showSpacedText:this.showText(o[0]);break;case p.OPS.endText:this.endText();break;case p.OPS.moveText:this.moveText(o[0],o[1]);break;case p.OPS.setCharSpacing:this.setCharSpacing(o[0]);break;case p.OPS.setWordSpacing:this.setWordSpacing(o[0]);break;case p.OPS.setHScale:this.setHScale(o[0]);break;case p.OPS.setTextMatrix:this.setTextMatrix(o[0],o[1],o[2],o[3],o[4],o[5]);break;case p.OPS.setTextRise:this.setTextRise(o[0]);break;case p.OPS.setTextRenderingMode:this.setTextRenderingMode(o[0]);break;case p.OPS.setLineWidth:this.setLineWidth(o[0]);break;case p.OPS.setLineJoin:this.setLineJoin(o[0]);break;case p.OPS.setLineCap:this.setLineCap(o[0]);break;case p.OPS.setMiterLimit:this.setMiterLimit(o[0]);break;case p.OPS.setFillRGBColor:this.setFillRGBColor(o[0],o[1],o[2]);break;case p.OPS.setStrokeRGBColor:this.setStrokeRGBColor(o[0],o[1],o[2]);break;case p.OPS.setStrokeColorN:this.setStrokeColorN(o);break;case p.OPS.setFillColorN:this.setFillColorN(o);break;case p.OPS.shadingFill:this.shadingFill(o[0]);break;case p.OPS.setDash:this.setDash(o[0],o[1]);break;case p.OPS.setRenderingIntent:this.setRenderingIntent(o[0]);break;case p.OPS.setFlatness:this.setFlatness(o[0]);break;case p.OPS.setGState:this.setGState(o[0]);break;case p.OPS.fill:this.fill();break;case p.OPS.eoFill:this.eoFill();break;case p.OPS.stroke:this.stroke();break;case p.OPS.fillStroke:this.fillStroke();break;case p.OPS.eoFillStroke:this.eoFillStroke();break;case p.OPS.clip:this.clip("nonzero");break;case p.OPS.eoClip:this.clip("evenodd");break;case p.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case p.OPS.paintImageXObject:this.paintImageXObject(o[0]);break;case p.OPS.paintInlineImageXObject:this.paintInlineImageXObject(o[0]);break;case p.OPS.paintImageMaskXObject:this.paintImageMaskXObject(o[0]);break;case p.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(o[0],o[1]);break;case p.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case p.OPS.closePath:this.closePath();break;case p.OPS.closeStroke:this.closeStroke();break;case p.OPS.closeFillStroke:this.closeFillStroke();break;case p.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case p.OPS.nextLine:this.nextLine();break;case p.OPS.transform:this.transform(o[0],o[1],o[2],o[3],o[4],o[5]);break;case p.OPS.constructPath:this.constructPath(o[0],o[1]);break;case p.OPS.endPath:this.endPath();break;case 92:this.group(a.items);break;default:(0,p.warn)(`Unimplemented operator ${I}`);break}}}setWordSpacing(l){this.current.wordSpacing=l}setCharSpacing(l){this.current.charSpacing=l}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(l,a,I,A,o,F){const v=this.current;v.textMatrix=v.lineMatrix=[l,a,I,A,o,F],v.textMatrixScale=Math.hypot(l,a),v.x=v.lineX=0,v.y=v.lineY=0,v.xcoords=[],v.ycoords=[],v.tspan=this.svgFactory.createElement("svg:tspan"),v.tspan.setAttributeNS(null,"font-family",v.fontFamily),v.tspan.setAttributeNS(null,"font-size",`${m(v.fontSize)}px`),v.tspan.setAttributeNS(null,"y",m(-v.y)),v.txtElement=this.svgFactory.createElement("svg:text"),v.txtElement.append(v.tspan)}beginText(){const l=this.current;l.x=l.lineX=0,l.y=l.lineY=0,l.textMatrix=p.IDENTITY_MATRIX,l.lineMatrix=p.IDENTITY_MATRIX,l.textMatrixScale=1,l.tspan=this.svgFactory.createElement("svg:tspan"),l.txtElement=this.svgFactory.createElement("svg:text"),l.txtgrp=this.svgFactory.createElement("svg:g"),l.xcoords=[],l.ycoords=[]}moveText(l,a){const I=this.current;I.x=I.lineX+=l,I.y=I.lineY+=a,I.xcoords=[],I.ycoords=[],I.tspan=this.svgFactory.createElement("svg:tspan"),I.tspan.setAttributeNS(null,"font-family",I.fontFamily),I.tspan.setAttributeNS(null,"font-size",`${m(I.fontSize)}px`),I.tspan.setAttributeNS(null,"y",m(-I.y))}showText(l){const a=this.current,I=a.font,A=a.fontSize;if(A===0)return;const o=a.fontSizeScale,F=a.charSpacing,v=a.wordSpacing,W=a.fontDirection,Y=a.textHScale*W,R=I.vertical,K=R?1:-1,at=I.defaultVMetrics,ct=A*a.fontMatrix[0];let G=0;for(const Tt of l){if(Tt===null){G+=W*v;continue}else if(typeof Tt=="number"){G+=K*Tt*A/1e3;continue}const kt=(Tt.isSpace?v:0)+F,T=Tt.fontChar;let n,r,i=Tt.width;if(R){let f;const E=Tt.vmetric||at;f=Tt.vmetric?E[1]:i*.5,f=-f*ct;const O=E[2]*ct;i=E?-E[0]:i,n=f/o,r=(G+O)/o}else n=G/o,r=0;(Tt.isInFont||I.missingFile)&&(a.xcoords.push(a.x+n),R&&a.ycoords.push(-a.y+r),a.tspan.textContent+=T);const h=R?i*ct-kt*W:i*ct+kt*W;G+=h}a.tspan.setAttributeNS(null,"x",a.xcoords.map(m).join(" ")),R?a.tspan.setAttributeNS(null,"y",a.ycoords.map(m).join(" ")):a.tspan.setAttributeNS(null,"y",m(-a.y)),R?a.y-=G:a.x+=G*Y,a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${m(a.fontSize)}px`),a.fontStyle!==k.fontStyle&&a.tspan.setAttributeNS(null,"font-style",a.fontStyle),a.fontWeight!==k.fontWeight&&a.tspan.setAttributeNS(null,"font-weight",a.fontWeight);const ht=a.textRenderingMode&p.TextRenderingMode.FILL_STROKE_MASK;if(ht===p.TextRenderingMode.FILL||ht===p.TextRenderingMode.FILL_STROKE?(a.fillColor!==k.fillColor&&a.tspan.setAttributeNS(null,"fill",a.fillColor),a.fillAlpha<1&&a.tspan.setAttributeNS(null,"fill-opacity",a.fillAlpha)):a.textRenderingMode===p.TextRenderingMode.ADD_TO_PATH?a.tspan.setAttributeNS(null,"fill","transparent"):a.tspan.setAttributeNS(null,"fill","none"),ht===p.TextRenderingMode.STROKE||ht===p.TextRenderingMode.FILL_STROKE){const Tt=1/(a.textMatrixScale||1);this._setStrokeAttributes(a.tspan,Tt)}let gt=a.textMatrix;a.textRise!==0&&(gt=gt.slice(),gt[5]+=a.textRise),a.txtElement.setAttributeNS(null,"transform",`${b(gt)} scale(${m(Y)}, -1)`),a.txtElement.setAttributeNS(M,"xml:space","preserve"),a.txtElement.append(a.tspan),a.txtgrp.append(a.txtElement),this._ensureTransformGroup().append(a.txtElement)}setLeadingMoveText(l,a){this.setLeading(-a),this.moveText(l,a)}addFontStyle(l){if(!l.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const a=u(l.data,l.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${l.loadedName}"; src: url(${a}); }
`}setFont(l){const a=this.current,I=this.commonObjs.get(l[0]);let A=l[1];a.font=I,this.embedFonts&&!I.missingFile&&!this.embeddedFonts[I.loadedName]&&(this.addFontStyle(I),this.embeddedFonts[I.loadedName]=I),a.fontMatrix=I.fontMatrix||p.FONT_IDENTITY_MATRIX;let o="normal";I.black?o="900":I.bold&&(o="bold");const F=I.italic?"italic":"normal";A<0?(A=-A,a.fontDirection=-1):a.fontDirection=1,a.fontSize=A,a.fontFamily=I.loadedName,a.fontWeight=o,a.fontStyle=F,a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"y",m(-a.y)),a.xcoords=[],a.ycoords=[]}endText(){var a;const l=this.current;l.textRenderingMode&p.TextRenderingMode.ADD_TO_PATH_FLAG&&((a=l.txtElement)!=null&&a.hasChildNodes())&&(l.element=l.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(l){l>0&&(this.current.lineWidth=l)}setLineCap(l){this.current.lineCap=D[l]}setLineJoin(l){this.current.lineJoin=P[l]}setMiterLimit(l){this.current.miterLimit=l}setStrokeAlpha(l){this.current.strokeAlpha=l}setStrokeRGBColor(l,a,I){this.current.strokeColor=p.Util.makeHexColor(l,a,I)}setFillAlpha(l){this.current.fillAlpha=l}setFillRGBColor(l,a,I){this.current.fillColor=p.Util.makeHexColor(l,a,I),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(l){this.current.strokeColor=this._makeColorN_Pattern(l)}setFillColorN(l){this.current.fillColor=this._makeColorN_Pattern(l)}shadingFill(l){const{width:a,height:I}=this.viewport,A=p.Util.inverseTransform(this.transformMatrix),[o,F,v,W]=p.Util.getAxialAlignedBoundingBox([0,0,a,I],A),Y=this.svgFactory.createElement("svg:rect");Y.setAttributeNS(null,"x",o),Y.setAttributeNS(null,"y",F),Y.setAttributeNS(null,"width",v-o),Y.setAttributeNS(null,"height",W-F),Y.setAttributeNS(null,"fill",this._makeShadingPattern(l)),this.current.fillAlpha<1&&Y.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Y)}_makeColorN_Pattern(l){return l[0]==="TilingPattern"?this._makeTilingPattern(l):this._makeShadingPattern(l)}_makeTilingPattern(l){const a=l[1],I=l[2],A=l[3]||p.IDENTITY_MATRIX,[o,F,v,W]=l[4],Y=l[5],R=l[6],K=l[7],at=`shading${C++}`,[ct,G,ht,gt]=p.Util.normalizeRect([...p.Util.applyTransform([o,F],A),...p.Util.applyTransform([v,W],A)]),[Tt,kt]=p.Util.singularValueDecompose2dScale(A),T=Y*Tt,n=R*kt,r=this.svgFactory.createElement("svg:pattern");r.setAttributeNS(null,"id",at),r.setAttributeNS(null,"patternUnits","userSpaceOnUse"),r.setAttributeNS(null,"width",T),r.setAttributeNS(null,"height",n),r.setAttributeNS(null,"x",`${ct}`),r.setAttributeNS(null,"y",`${G}`);const i=this.svg,h=this.transformMatrix,f=this.current.fillColor,E=this.current.strokeColor,O=this.svgFactory.create(ht-ct,gt-G);if(this.svg=O,this.transformMatrix=A,K===2){const H=p.Util.makeHexColor(...a);this.current.fillColor=H,this.current.strokeColor=H}return this.executeOpTree(this.convertOpList(I)),this.svg=i,this.transformMatrix=h,this.current.fillColor=f,this.current.strokeColor=E,r.append(O.childNodes[0]),this.defs.append(r),`url(#${at})`}_makeShadingPattern(l){switch(typeof l=="string"&&(l=this.objs.get(l)),l[0]){case"RadialAxial":const a=`shading${C++}`,I=l[3];let A;switch(l[1]){case"axial":const o=l[4],F=l[5];A=this.svgFactory.createElement("svg:linearGradient"),A.setAttributeNS(null,"id",a),A.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),A.setAttributeNS(null,"x1",o[0]),A.setAttributeNS(null,"y1",o[1]),A.setAttributeNS(null,"x2",F[0]),A.setAttributeNS(null,"y2",F[1]);break;case"radial":const v=l[4],W=l[5],Y=l[6],R=l[7];A=this.svgFactory.createElement("svg:radialGradient"),A.setAttributeNS(null,"id",a),A.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),A.setAttributeNS(null,"cx",W[0]),A.setAttributeNS(null,"cy",W[1]),A.setAttributeNS(null,"r",R),A.setAttributeNS(null,"fx",v[0]),A.setAttributeNS(null,"fy",v[1]),A.setAttributeNS(null,"fr",Y);break;default:throw new Error(`Unknown RadialAxial type: ${l[1]}`)}for(const o of I){const F=this.svgFactory.createElement("svg:stop");F.setAttributeNS(null,"offset",o[0]),F.setAttributeNS(null,"stop-color",o[1]),A.append(F)}return this.defs.append(A),`url(#${a})`;case"Mesh":return(0,p.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${l[0]}`)}}setDash(l,a){this.current.dashArray=l,this.current.dashPhase=a}constructPath(l,a){const I=this.current;let A=I.x,o=I.y,F=[],v=0;for(const W of l)switch(W|0){case p.OPS.rectangle:A=a[v++],o=a[v++];const Y=a[v++],R=a[v++],K=A+Y,at=o+R;F.push("M",m(A),m(o),"L",m(K),m(o),"L",m(K),m(at),"L",m(A),m(at),"Z");break;case p.OPS.moveTo:A=a[v++],o=a[v++],F.push("M",m(A),m(o));break;case p.OPS.lineTo:A=a[v++],o=a[v++],F.push("L",m(A),m(o));break;case p.OPS.curveTo:A=a[v+4],o=a[v+5],F.push("C",m(a[v]),m(a[v+1]),m(a[v+2]),m(a[v+3]),m(A),m(o)),v+=6;break;case p.OPS.curveTo2:F.push("C",m(A),m(o),m(a[v]),m(a[v+1]),m(a[v+2]),m(a[v+3])),A=a[v+2],o=a[v+3],v+=4;break;case p.OPS.curveTo3:A=a[v+2],o=a[v+3],F.push("C",m(a[v]),m(a[v+1]),m(A),m(o),m(A),m(o)),v+=4;break;case p.OPS.closePath:F.push("Z");break}F=F.join(" "),I.path&&l.length>0&&l[0]!==p.OPS.rectangle&&l[0]!==p.OPS.moveTo?F=I.path.getAttributeNS(null,"d")+F:(I.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(I.path)),I.path.setAttributeNS(null,"d",F),I.path.setAttributeNS(null,"fill","none"),I.element=I.path,I.setCurrentPoint(A,o)}endPath(){const l=this.current;if(l.path=null,!this.pendingClip)return;if(!l.element){this.pendingClip=null;return}const a=`clippath${g++}`,I=this.svgFactory.createElement("svg:clipPath");I.setAttributeNS(null,"id",a),I.setAttributeNS(null,"transform",b(this.transformMatrix));const A=l.element.cloneNode(!0);if(this.pendingClip==="evenodd"?A.setAttributeNS(null,"clip-rule","evenodd"):A.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,I.append(A),this.defs.append(I),l.activeClipUrl){l.clipGroup=null;for(const o of this.extraStack)o.clipGroup=null;I.setAttributeNS(null,"clip-path",l.activeClipUrl)}l.activeClipUrl=`url(#${a})`,this.tgrp=null}clip(l){this.pendingClip=l}closePath(){const l=this.current;if(l.path){const a=`${l.path.getAttributeNS(null,"d")}Z`;l.path.setAttributeNS(null,"d",a)}}setLeading(l){this.current.leading=-l}setTextRise(l){this.current.textRise=l}setTextRenderingMode(l){this.current.textRenderingMode=l}setHScale(l){this.current.textHScale=l/100}setRenderingIntent(l){}setFlatness(l){}setGState(l){for(const[a,I]of l)switch(a){case"LW":this.setLineWidth(I);break;case"LC":this.setLineCap(I);break;case"LJ":this.setLineJoin(I);break;case"ML":this.setMiterLimit(I);break;case"D":this.setDash(I[0],I[1]);break;case"RI":this.setRenderingIntent(I);break;case"FL":this.setFlatness(I);break;case"Font":this.setFont(I);break;case"CA":this.setStrokeAlpha(I);break;case"ca":this.setFillAlpha(I);break;default:(0,p.warn)(`Unimplemented graphic state operator ${a}`);break}}fill(){const l=this.current;l.element&&(l.element.setAttributeNS(null,"fill",l.fillColor),l.element.setAttributeNS(null,"fill-opacity",l.fillAlpha),this.endPath())}stroke(){const l=this.current;l.element&&(this._setStrokeAttributes(l.element),l.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(l,a=1){const I=this.current;let A=I.dashArray;a!==1&&A.length>0&&(A=A.map(function(o){return a*o})),l.setAttributeNS(null,"stroke",I.strokeColor),l.setAttributeNS(null,"stroke-opacity",I.strokeAlpha),l.setAttributeNS(null,"stroke-miterlimit",m(I.miterLimit)),l.setAttributeNS(null,"stroke-linecap",I.lineCap),l.setAttributeNS(null,"stroke-linejoin",I.lineJoin),l.setAttributeNS(null,"stroke-width",m(a*I.lineWidth)+"px"),l.setAttributeNS(null,"stroke-dasharray",A.map(m).join(" ")),l.setAttributeNS(null,"stroke-dashoffset",m(a*I.dashPhase)+"px")}eoFill(){var l;(l=this.current.element)==null||l.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var l;(l=this.current.element)==null||l.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y","0"),l.setAttributeNS(null,"width","1px"),l.setAttributeNS(null,"height","1px"),l.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(l)}paintImageXObject(l){const a=this.getObject(l);if(!a){(0,p.warn)(`Dependent image with object ID ${l} is not ready yet`);return}this.paintInlineImageXObject(a)}paintInlineImageXObject(l,a){const I=l.width,A=l.height,o=L(l,this.forceDataSchema,!!a),F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",m(I)),F.setAttributeNS(null,"height",m(A)),this.current.element=F,this.clip("nonzero");const v=this.svgFactory.createElement("svg:image");v.setAttributeNS(X,"xlink:href",o),v.setAttributeNS(null,"x","0"),v.setAttributeNS(null,"y",m(-A)),v.setAttributeNS(null,"width",m(I)+"px"),v.setAttributeNS(null,"height",m(A)+"px"),v.setAttributeNS(null,"transform",`scale(${m(1/I)} ${m(-1/A)})`),a?a.append(v):this._ensureTransformGroup().append(v)}paintImageMaskXObject(l){const a=this.getObject(l.data,l);if(a.bitmap){(0,p.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const I=this.current,A=a.width,o=a.height,F=I.fillColor;I.maskId=`mask${S++}`;const v=this.svgFactory.createElement("svg:mask");v.setAttributeNS(null,"id",I.maskId);const W=this.svgFactory.createElement("svg:rect");W.setAttributeNS(null,"x","0"),W.setAttributeNS(null,"y","0"),W.setAttributeNS(null,"width",m(A)),W.setAttributeNS(null,"height",m(o)),W.setAttributeNS(null,"fill",F),W.setAttributeNS(null,"mask",`url(#${I.maskId})`),this.defs.append(v),this._ensureTransformGroup().append(W),this.paintInlineImageXObject(a,v)}paintFormXObjectBegin(l,a){if(Array.isArray(l)&&l.length===6&&this.transform(l[0],l[1],l[2],l[3],l[4],l[5]),a){const I=a[2]-a[0],A=a[3]-a[1],o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x",a[0]),o.setAttributeNS(null,"y",a[1]),o.setAttributeNS(null,"width",m(I)),o.setAttributeNS(null,"height",m(A)),this.current.element=o,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(l){const a=this.svgFactory.create(l.width,l.height),I=this.svgFactory.createElement("svg:defs");a.append(I),this.defs=I;const A=this.svgFactory.createElement("svg:g");return A.setAttributeNS(null,"transform",b(l.transform)),a.append(A),this.svg=A,a}_ensureClipGroup(){if(!this.current.clipGroup){const l=this.svgFactory.createElement("svg:g");l.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(l),this.current.clipGroup=l}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",b(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=x},(z,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class j{static textContent(p){const k=[],M={items:k,styles:Object.create(null)};function X(D){var L;if(!D)return;let P=null;const u=D.name;if(u==="#text")P=D.value;else if(j.shouldBuildText(u))(L=D==null?void 0:D.attributes)!=null&&L.textContent?P=D.attributes.textContent:D.value&&(P=D.value);else return;if(P!==null&&k.push({str:P}),!!D.children)for(const _ of D.children)X(_)}return X(p),M}static shouldBuildText(p){return!(p==="textarea"||p==="input"||p==="option"||p==="select")}}e.XfaText=j},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=b,e.updateTextLayer=g;var c=j(1),p=j(6);const k=1e5,M=30,X=.8,D=new Map;function P(S,C){let x;if(C&&c.FeatureTest.isOffscreenCanvasSupported)x=new OffscreenCanvas(S,S).getContext("2d",{alpha:!1});else{const w=document.createElement("canvas");w.width=w.height=S,x=w.getContext("2d",{alpha:!1})}return x}function u(S,C){const x=D.get(S);if(x)return x;const w=P(M,C);w.font=`${M}px ${S}`;const l=w.measureText("");let a=l.fontBoundingBoxAscent,I=Math.abs(l.fontBoundingBoxDescent);if(a){const o=a/(a+I);return D.set(S,o),w.canvas.width=w.canvas.height=0,o}w.strokeStyle="red",w.clearRect(0,0,M,M),w.strokeText("g",0,0);let A=w.getImageData(0,0,M,M).data;I=0;for(let o=A.length-1-3;o>=0;o-=4)if(A[o]>0){I=Math.ceil(o/4/M);break}w.clearRect(0,0,M,M),w.strokeText("A",0,M),A=w.getImageData(0,0,M,M).data,a=0;for(let o=0,F=A.length;o<F;o+=4)if(A[o]>0){a=M-Math.floor(o/4/M);break}if(w.canvas.width=w.canvas.height=0,a){const o=a/(a+I);return D.set(S,o),o}return D.set(S,X),X}function L(S,C,x){const w=document.createElement("span"),l={angle:0,canvasWidth:0,hasText:C.str!=="",hasEOL:C.hasEOL,fontSize:0};S._textDivs.push(w);const a=c.Util.transform(S._transform,C.transform);let I=Math.atan2(a[1],a[0]);const A=x[C.fontName];A.vertical&&(I+=Math.PI/2);const o=Math.hypot(a[2],a[3]),F=o*u(A.fontFamily,S._isOffscreenCanvasSupported);let v,W;I===0?(v=a[4],W=a[5]-F):(v=a[4]+F*Math.sin(I),W=a[5]-F*Math.cos(I));const Y="calc(var(--scale-factor)*",R=w.style;S._container===S._rootContainer?(R.left=`${(100*v/S._pageWidth).toFixed(2)}%`,R.top=`${(100*W/S._pageHeight).toFixed(2)}%`):(R.left=`${Y}${v.toFixed(2)}px)`,R.top=`${Y}${W.toFixed(2)}px)`),R.fontSize=`${Y}${o.toFixed(2)}px)`,R.fontFamily=A.fontFamily,l.fontSize=o,w.setAttribute("role","presentation"),w.textContent=C.str,w.dir=C.dir,S._fontInspectorEnabled&&(w.dataset.fontName=C.fontName),I!==0&&(l.angle=I*(180/Math.PI));let K=!1;if(C.str.length>1)K=!0;else if(C.str!==" "&&C.transform[0]!==C.transform[3]){const at=Math.abs(C.transform[0]),ct=Math.abs(C.transform[3]);at!==ct&&Math.max(at,ct)/Math.min(at,ct)>1.5&&(K=!0)}K&&(l.canvasWidth=A.vertical?C.height:C.width),S._textDivProperties.set(w,l),S._isReadableStream&&S._layoutText(w)}function _(S){const{div:C,scale:x,properties:w,ctx:l,prevFontSize:a,prevFontFamily:I}=S,{style:A}=C;let o="";if(w.canvasWidth!==0&&w.hasText){const{fontFamily:F}=A,{canvasWidth:v,fontSize:W}=w;(a!==W||I!==F)&&(l.font=`${W*x}px ${F}`,S.prevFontSize=W,S.prevFontFamily=F);const{width:Y}=l.measureText(C.textContent);Y>0&&(o=`scaleX(${v*x/Y})`)}w.angle!==0&&(o=`rotate(${w.angle}deg) ${o}`),o.length>0&&(A.transform=o)}function d(S){if(S._canceled)return;const C=S._textDivs,x=S._capability;if(C.length>k){x.resolve();return}if(!S._isReadableStream)for(const l of C)S._layoutText(l);x.resolve()}class m{constructor({textContentSource:C,container:x,viewport:w,textDivs:l,textDivProperties:a,textContentItemsStr:I,isOffscreenCanvasSupported:A}){var Y;this._textContentSource=C,this._isReadableStream=C instanceof ReadableStream,this._container=this._rootContainer=x,this._textDivs=l||[],this._textContentItemsStr=I||[],this._isOffscreenCanvasSupported=A,this._fontInspectorEnabled=!!((Y=globalThis.FontInspector)!=null&&Y.enabled),this._reader=null,this._textDivProperties=a||new WeakMap,this._canceled=!1,this._capability=new c.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:w.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:P(0,A)};const{pageWidth:o,pageHeight:F,pageX:v,pageY:W}=w.rawDims;this._transform=[1,0,0,-1,-v,W+F],this._pageWidth=o,this._pageHeight=F,(0,p.setLayerDimensions)(x,w),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new c.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new c.AbortException("TextLayer task cancelled."))}_processItems(C,x){for(const w of C){if(w.str===void 0){if(w.type==="beginMarkedContentProps"||w.type==="beginMarkedContent"){const l=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),w.id!==null&&this._container.setAttribute("id",`${w.id}`),l.append(this._container)}else w.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(w.str),L(this,w,x)}}_layoutText(C){const x=this._layoutTextParams.properties=this._textDivProperties.get(C);if(this._layoutTextParams.div=C,_(this._layoutTextParams),x.hasText&&this._container.append(C),x.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this._container.append(w)}}_render(){const C=new c.PromiseCapability;let x=Object.create(null);if(this._isReadableStream){const w=()=>{this._reader.read().then(({value:l,done:a})=>{if(a){C.resolve();return}Object.assign(x,l.styles),this._processItems(l.items,x),w()},C.reject)};this._reader=this._textContentSource.getReader(),w()}else if(this._textContentSource){const{items:w,styles:l}=this._textContentSource;this._processItems(w,l),C.resolve()}else throw new Error('No "textContentSource" parameter specified.');C.promise.then(()=>{x=null,d(this)},this._capability.reject)}}e.TextLayerRenderTask=m;function b(S){!S.textContentSource&&(S.textContent||S.textContentStream)&&((0,p.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),S.textContentSource=S.textContent||S.textContentStream);const{container:C,viewport:x}=S,w=getComputedStyle(C),l=w.getPropertyValue("visibility"),a=parseFloat(w.getPropertyValue("--scale-factor"));l==="visible"&&(!a||Math.abs(a-x.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const I=new m(S);return I._render(),I}function g({container:S,viewport:C,textDivs:x,textDivProperties:w,isOffscreenCanvasSupported:l,mustRotate:a=!0,mustRescale:I=!0}){if(a&&(0,p.setLayerDimensions)(S,{rotation:C.rotation}),I){const A=P(0,l),F={prevFontSize:null,prevFontFamily:null,div:null,scale:C.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:A};for(const v of x)F.properties=w.get(v),F.div=v,_(F)}}},(z,e,j)=>{var u,L,_,d,m,b,g,S,C,x,w,es,a,xe,A,ss,F,ns;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var c=j(1),p=j(4),k=j(28),M=j(33),X=j(6),D=j(34);const W=class W{constructor({uiManager:R,pageIndex:K,div:at,accessibilityManager:ct,annotationLayer:G,viewport:ht,l10n:gt}){B(this,w);B(this,a);B(this,A);B(this,F);B(this,u,void 0);B(this,L,!1);B(this,_,null);B(this,d,this.pointerup.bind(this));B(this,m,this.pointerdown.bind(this));B(this,b,new Map);B(this,g,!1);B(this,S,!1);B(this,C,!1);B(this,x,void 0);const Tt=[k.FreeTextEditor,M.InkEditor,D.StampEditor];if(!W._initialized){W._initialized=!0;for(const kt of Tt)kt.initialize(gt)}R.registerEditorTypes(Tt),nt(this,x,R),this.pageIndex=K,this.div=at,nt(this,u,ct),nt(this,_,G),this.viewport=ht,t(this,x).addLayer(this)}get isEmpty(){return t(this,b).size===0}updateToolbar(R){t(this,x).updateToolbar(R)}updateMode(R=t(this,x).getMode()){V(this,F,ns).call(this),R===c.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),R!==c.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",R===c.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",R===c.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",R===c.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(R){if(!R&&t(this,x).getMode()!==c.AnnotationEditorType.INK)return;if(!R){for(const at of t(this,b).values())if(at.isEmpty()){at.setInBackground();return}}V(this,a,xe).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(R){t(this,x).setEditingState(R)}addCommands(R){t(this,x).addCommands(R)}enable(){this.div.style.pointerEvents="auto";const R=new Set;for(const at of t(this,b).values())at.enableEditing(),at.annotationElementId&&R.add(at.annotationElementId);if(!t(this,_))return;const K=t(this,_).getEditableAnnotations();for(const at of K){if(at.hide(),t(this,x).isDeletedAnnotationElement(at.data.id)||R.has(at.data.id))continue;const ct=this.deserialize(at);ct&&(this.addOrRebuild(ct),ct.enableEditing())}}disable(){var K;nt(this,C,!0),this.div.style.pointerEvents="none";const R=new Set;for(const at of t(this,b).values()){if(at.disableEditing(),!at.annotationElementId||at.serialize()!==null){R.add(at.annotationElementId);continue}(K=this.getEditableAnnotation(at.annotationElementId))==null||K.show(),at.remove()}if(t(this,_)){const at=t(this,_).getEditableAnnotations();for(const ct of at){const{id:G}=ct.data;R.has(G)||t(this,x).isDeletedAnnotationElement(G)||ct.show()}}V(this,F,ns).call(this),this.isEmpty&&(this.div.hidden=!0),nt(this,C,!1)}getEditableAnnotation(R){var K;return((K=t(this,_))==null?void 0:K.getEditableAnnotation(R))||null}setActiveEditor(R){t(this,x).getActive()!==R&&t(this,x).setActiveEditor(R)}enableClick(){this.div.addEventListener("pointerdown",t(this,m)),this.div.addEventListener("pointerup",t(this,d))}disableClick(){this.div.removeEventListener("pointerdown",t(this,m)),this.div.removeEventListener("pointerup",t(this,d))}attach(R){t(this,b).set(R.id,R);const{annotationElementId:K}=R;K&&t(this,x).isDeletedAnnotationElement(K)&&t(this,x).removeDeletedAnnotationElement(R)}detach(R){var K;t(this,b).delete(R.id),(K=t(this,u))==null||K.removePointerInTextLayer(R.contentDiv),!t(this,C)&&R.annotationElementId&&t(this,x).addDeletedAnnotationElement(R)}remove(R){this.detach(R),t(this,x).removeEditor(R),R.div.contains(document.activeElement)&&setTimeout(()=>{t(this,x).focusMainContainer()},0),R.div.remove(),R.isAttachedToDOM=!1,t(this,S)||this.addInkEditorIfNeeded(!1)}changeParent(R){var K;R.parent!==this&&(R.annotationElementId&&(t(this,x).addDeletedAnnotationElement(R.annotationElementId),p.AnnotationEditor.deleteAnnotationElement(R),R.annotationElementId=null),this.attach(R),(K=R.parent)==null||K.detach(R),R.setParent(this),R.div&&R.isAttachedToDOM&&(R.div.remove(),this.div.append(R.div)))}add(R){if(this.changeParent(R),t(this,x).addEditor(R),this.attach(R),!R.isAttachedToDOM){const K=R.render();this.div.append(K),R.isAttachedToDOM=!0}R.fixAndSetPosition(),R.onceAdded(),t(this,x).addToAnnotationStorage(R)}moveEditorInDOM(R){var at;if(!R.isAttachedToDOM)return;const{activeElement:K}=document;R.div.contains(K)&&(R._focusEventsAllowed=!1,setTimeout(()=>{R.div.contains(document.activeElement)?R._focusEventsAllowed=!0:(R.div.addEventListener("focusin",()=>{R._focusEventsAllowed=!0},{once:!0}),K.focus())},0)),R._structTreeParentId=(at=t(this,u))==null?void 0:at.moveElementInDOM(this.div,R.div,R.contentDiv,!0)}addOrRebuild(R){R.needsToBeRebuilt()?R.rebuild():this.add(R)}addUndoableEditor(R){const K=()=>R._uiManager.rebuild(R),at=()=>{R.remove()};this.addCommands({cmd:K,undo:at,mustExec:!1})}getNextId(){return t(this,x).getId()}pasteEditor(R,K){t(this,x).updateToolbar(R),t(this,x).updateMode(R);const{offsetX:at,offsetY:ct}=V(this,A,ss).call(this),G=this.getNextId(),ht=V(this,w,es).call(this,{parent:this,id:G,x:at,y:ct,uiManager:t(this,x),isCentered:!0,...K});ht&&this.add(ht)}deserialize(R){var K;switch((K=R.annotationType)!=null?K:R.annotationEditorType){case c.AnnotationEditorType.FREETEXT:return k.FreeTextEditor.deserialize(R,this,t(this,x));case c.AnnotationEditorType.INK:return M.InkEditor.deserialize(R,this,t(this,x));case c.AnnotationEditorType.STAMP:return D.StampEditor.deserialize(R,this,t(this,x))}return null}addNewEditor(){V(this,a,xe).call(this,V(this,A,ss).call(this),!0)}setSelected(R){t(this,x).setSelected(R)}toggleSelected(R){t(this,x).toggleSelected(R)}isSelected(R){return t(this,x).isSelected(R)}unselect(R){t(this,x).unselect(R)}pointerup(R){const{isMac:K}=c.FeatureTest.platform;if(!(R.button!==0||R.ctrlKey&&K)&&R.target===this.div&&t(this,g)){if(nt(this,g,!1),!t(this,L)){nt(this,L,!0);return}if(t(this,x).getMode()===c.AnnotationEditorType.STAMP){t(this,x).unselectAll();return}V(this,a,xe).call(this,R,!1)}}pointerdown(R){if(t(this,g)){nt(this,g,!1);return}const{isMac:K}=c.FeatureTest.platform;if(R.button!==0||R.ctrlKey&&K||R.target!==this.div)return;nt(this,g,!0);const at=t(this,x).getActive();nt(this,L,!at||at.isEmpty())}findNewParent(R,K,at){const ct=t(this,x).findParent(K,at);return ct===null||ct===this?!1:(ct.changeParent(R),!0)}destroy(){var R,K;((R=t(this,x).getActive())==null?void 0:R.parent)===this&&(t(this,x).commitOrRemove(),t(this,x).setActiveEditor(null));for(const at of t(this,b).values())(K=t(this,u))==null||K.removePointerInTextLayer(at.contentDiv),at.setParent(null),at.isAttachedToDOM=!1,at.div.remove();this.div=null,t(this,b).clear(),t(this,x).removeLayer(this)}render({viewport:R}){this.viewport=R,(0,X.setLayerDimensions)(this.div,R);for(const K of t(this,x).getEditors(this.pageIndex))this.add(K);this.updateMode()}update({viewport:R}){t(this,x).commitOrRemove(),this.viewport=R,(0,X.setLayerDimensions)(this.div,{rotation:R.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:R,pageHeight:K}=this.viewport.rawDims;return[R,K]}};u=new WeakMap,L=new WeakMap,_=new WeakMap,d=new WeakMap,m=new WeakMap,b=new WeakMap,g=new WeakMap,S=new WeakMap,C=new WeakMap,x=new WeakMap,w=new WeakSet,es=function(R){switch(t(this,x).getMode()){case c.AnnotationEditorType.FREETEXT:return new k.FreeTextEditor(R);case c.AnnotationEditorType.INK:return new M.InkEditor(R);case c.AnnotationEditorType.STAMP:return new D.StampEditor(R)}return null},a=new WeakSet,xe=function(R,K){const at=this.getNextId(),ct=V(this,w,es).call(this,{parent:this,id:at,x:R.offsetX,y:R.offsetY,uiManager:t(this,x),isCentered:K});return ct&&this.add(ct),ct},A=new WeakSet,ss=function(){const{x:R,y:K,width:at,height:ct}=this.div.getBoundingClientRect(),G=Math.max(0,R),ht=Math.max(0,K),gt=Math.min(window.innerWidth,R+at),Tt=Math.min(window.innerHeight,K+ct),kt=(G+gt)/2-R,T=(ht+Tt)/2-K,[n,r]=this.viewport.rotation%180===0?[kt,T]:[T,kt];return{offsetX:n,offsetY:r}},F=new WeakSet,ns=function(){nt(this,S,!0);for(const R of t(this,b).values())R.isEmpty()&&R.remove();nt(this,S,!1)},yt(W,"_initialized",!1);let P=W;e.AnnotationEditorLayer=P},(z,e,j)=>{var D,P,u,L,_,d,m,b,g,S,Ms,x,Is,l,Ds,I,ye,o,is,v,Os,Y,rs;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var c=j(1),p=j(5),k=j(4),M=j(29);const K=class K extends k.AnnotationEditor{constructor(G){super({...G,name:"freeTextEditor"});B(this,S);B(this,x);B(this,l);B(this,I);B(this,o);B(this,v);B(this,Y);B(this,D,this.editorDivBlur.bind(this));B(this,P,this.editorDivFocus.bind(this));B(this,u,this.editorDivInput.bind(this));B(this,L,this.editorDivKeydown.bind(this));B(this,_,void 0);B(this,d,"");B(this,m,`${this.id}-editor`);B(this,b,void 0);B(this,g,null);nt(this,_,G.color||K._defaultColor||k.AnnotationEditor._defaultLineColor),nt(this,b,G.fontSize||K._defaultFontSize)}static get _keyboardManager(){const G=K.prototype,ht=kt=>kt.isEmpty(),gt=p.AnnotationEditorUIManager.TRANSLATE_SMALL,Tt=p.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,c.shadow)(this,"_keyboardManager",new p.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],G.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],G.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],G._translateEmpty,{args:[-gt,0],checker:ht}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],G._translateEmpty,{args:[-Tt,0],checker:ht}],[["ArrowRight","mac+ArrowRight"],G._translateEmpty,{args:[gt,0],checker:ht}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],G._translateEmpty,{args:[Tt,0],checker:ht}],[["ArrowUp","mac+ArrowUp"],G._translateEmpty,{args:[0,-gt],checker:ht}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],G._translateEmpty,{args:[0,-Tt],checker:ht}],[["ArrowDown","mac+ArrowDown"],G._translateEmpty,{args:[0,gt],checker:ht}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],G._translateEmpty,{args:[0,Tt],checker:ht}]]))}static initialize(G){k.AnnotationEditor.initialize(G,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const ht=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(ht.getPropertyValue("--freetext-padding"))}static updateDefaultParams(G,ht){switch(G){case c.AnnotationEditorParamsType.FREETEXT_SIZE:K._defaultFontSize=ht;break;case c.AnnotationEditorParamsType.FREETEXT_COLOR:K._defaultColor=ht;break}}updateParams(G,ht){switch(G){case c.AnnotationEditorParamsType.FREETEXT_SIZE:V(this,S,Ms).call(this,ht);break;case c.AnnotationEditorParamsType.FREETEXT_COLOR:V(this,x,Is).call(this,ht);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.FREETEXT_SIZE,K._defaultFontSize],[c.AnnotationEditorParamsType.FREETEXT_COLOR,K._defaultColor||k.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[c.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,b)],[c.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,_)]]}_translateEmpty(G,ht){this._uiManager.translateSelectedEditors(G,ht,!0)}getInitialTranslation(){const G=this.parentScale;return[-K._internalPadding*G,-(K._internalPadding+t(this,b))*G]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(c.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,L)),this.editorDiv.addEventListener("focus",t(this,P)),this.editorDiv.addEventListener("blur",t(this,D)),this.editorDiv.addEventListener("input",t(this,u)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,m)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,L)),this.editorDiv.removeEventListener("focus",t(this,P)),this.editorDiv.removeEventListener("blur",t(this,D)),this.editorDiv.removeEventListener("input",t(this,u)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(G){this._focusEventsAllowed&&(super.focusin(G),G.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var G;if(this.width){V(this,Y,rs).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(G=this._initialOptions)!=null&&G.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const G=t(this,d),ht=nt(this,d,V(this,l,Ds).call(this).trimEnd());if(G===ht)return;const gt=Tt=>{if(nt(this,d,Tt),!Tt){this.remove();return}V(this,o,is).call(this),this._uiManager.rebuild(this),V(this,I,ye).call(this)};this.addCommands({cmd:()=>{gt(ht)},undo:()=>{gt(G)},mustExec:!1}),V(this,I,ye).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(G){this.enterInEditMode()}keydown(G){G.target===this.div&&G.key==="Enter"&&(this.enterInEditMode(),G.preventDefault())}editorDivKeydown(G){K._keyboardManager.exec(this,G)}editorDivFocus(G){this.isEditing=!0}editorDivBlur(G){this.isEditing=!1}editorDivInput(G){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let G,ht;this.width&&(G=this.x,ht=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,m)),this.enableEditing(),k.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Tt=>{var kt;return(kt=this.editorDiv)==null?void 0:kt.setAttribute("aria-label",Tt)}),k.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Tt=>{var kt;return(kt=this.editorDiv)==null?void 0:kt.setAttribute("default-content",Tt)}),this.editorDiv.contentEditable=!0;const{style:gt}=this.editorDiv;if(gt.fontSize=`calc(${t(this,b)}px * var(--scale-factor))`,gt.color=t(this,_),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,p.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Tt,kt]=this.parentDimensions;if(this.annotationElementId){const{position:T}=t(this,g);let[n,r]=this.getInitialTranslation();[n,r]=this.pageTranslationToScreen(n,r);const[i,h]=this.pageDimensions,[f,E]=this.pageTranslation;let O,H;switch(this.rotation){case 0:O=G+(T[0]-f)/i,H=ht+this.height-(T[1]-E)/h;break;case 90:O=G+(T[0]-f)/i,H=ht-(T[1]-E)/h,[n,r]=[r,-n];break;case 180:O=G-this.width+(T[0]-f)/i,H=ht-(T[1]-E)/h,[n,r]=[-n,-r];break;case 270:O=G+(T[0]-f-this.height*h)/i,H=ht+(T[1]-E-this.width*i)/h,[n,r]=[-r,n];break}this.setAt(O*Tt,H*kt,n,r)}else this.setAt(G*Tt,ht*kt,this.width*Tt,this.height*kt);V(this,o,is).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(G,ht,gt){let Tt=null;if(G instanceof M.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:T,fontColor:n},rect:r,rotation:i,id:h},textContent:f,textPosition:E,parent:{page:{pageNumber:O}}}=G;if(!f||f.length===0)return null;Tt=G={annotationType:c.AnnotationEditorType.FREETEXT,color:Array.from(n),fontSize:T,value:f.join(`
`),position:E,pageIndex:O-1,rect:r,rotation:i,id:h,deleted:!1}}const kt=super.deserialize(G,ht,gt);return nt(kt,b,G.fontSize),nt(kt,_,c.Util.makeHexColor(...G.color)),nt(kt,d,G.value),kt.annotationElementId=G.id||null,nt(kt,g,Tt),kt}serialize(G=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const ht=K._internalPadding*this.parentScale,gt=this.getRect(ht,ht),Tt=k.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,_)),kt={annotationType:c.AnnotationEditorType.FREETEXT,color:Tt,fontSize:t(this,b),value:t(this,d),pageIndex:this.pageIndex,rect:gt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return G?kt:this.annotationElementId&&!V(this,v,Os).call(this,kt)?null:(kt.id=this.annotationElementId,kt)}};D=new WeakMap,P=new WeakMap,u=new WeakMap,L=new WeakMap,_=new WeakMap,d=new WeakMap,m=new WeakMap,b=new WeakMap,g=new WeakMap,S=new WeakSet,Ms=function(G){const ht=Tt=>{this.editorDiv.style.fontSize=`calc(${Tt}px * var(--scale-factor))`,this.translate(0,-(Tt-t(this,b))*this.parentScale),nt(this,b,Tt),V(this,I,ye).call(this)},gt=t(this,b);this.addCommands({cmd:()=>{ht(G)},undo:()=>{ht(gt)},mustExec:!0,type:c.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},x=new WeakSet,Is=function(G){const ht=t(this,_);this.addCommands({cmd:()=>{nt(this,_,this.editorDiv.style.color=G)},undo:()=>{nt(this,_,this.editorDiv.style.color=ht)},mustExec:!0,type:c.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},l=new WeakSet,Ds=function(){const G=this.editorDiv.getElementsByTagName("div");if(G.length===0)return this.editorDiv.innerText;const ht=[];for(const gt of G)ht.push(gt.innerText.replace(/\r\n?|\n/,""));return ht.join(`
`)},I=new WeakSet,ye=function(){const[G,ht]=this.parentDimensions;let gt;if(this.isAttachedToDOM)gt=this.div.getBoundingClientRect();else{const{currentLayer:Tt,div:kt}=this,T=kt.style.display;kt.style.display="hidden",Tt.div.append(this.div),gt=kt.getBoundingClientRect(),kt.remove(),kt.style.display=T}this.rotation%180===this.parentRotation%180?(this.width=gt.width/G,this.height=gt.height/ht):(this.width=gt.height/G,this.height=gt.width/ht),this.fixAndSetPosition()},o=new WeakSet,is=function(){if(this.editorDiv.replaceChildren(),!!t(this,d))for(const G of t(this,d).split(`
`)){const ht=document.createElement("div");ht.append(G?document.createTextNode(G):document.createElement("br")),this.editorDiv.append(ht)}},v=new WeakSet,Os=function(G){const{value:ht,fontSize:gt,color:Tt,rect:kt,pageIndex:T}=t(this,g);return G.value!==ht||G.fontSize!==gt||G.rect.some((n,r)=>Math.abs(n-kt[r])>=1)||G.color.some((n,r)=>n!==Tt[r])||G.pageIndex!==T},Y=new WeakSet,rs=function(G=!1){if(!this.annotationElementId)return;if(V(this,I,ye).call(this),!G&&(this.width===0||this.height===0)){setTimeout(()=>V(this,Y,rs).call(this,!0),0);return}const ht=K._internalPadding*this.parentScale;t(this,g).rect=this.getRect(ht,ht)},yt(K,"_freeTextDefaultContent",""),yt(K,"_internalPadding",0),yt(K,"_defaultColor",null),yt(K,"_defaultFontSize",10),yt(K,"_type","freetext");let X=K;e.FreeTextEditor=X},(z,e,j)=>{var r,h,ce,E,Ls,H,it,st,ot,dt,vt,ft,Ft,Bt,Et,Dt,pt,et,tt,ut,wt,Pt,Wt,Ns,Ht,ke,Xt,as,Vt,os,Z,$,_t,bt,ee,te,Q,ls,Ot,Rt,Nt,Ut,Us,At,cs;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var c=j(1),p=j(6),k=j(3),M=j(30),X=j(31),D=j(32);const P=1e3,u=9,L=new WeakSet;function _(Lt){return{width:Lt[2]-Lt[0],height:Lt[3]-Lt[1]}}class d{static create(N){switch(N.data.annotationType){case c.AnnotationType.LINK:return new b(N);case c.AnnotationType.TEXT:return new g(N);case c.AnnotationType.WIDGET:switch(N.data.fieldType){case"Tx":return new C(N);case"Btn":return N.data.radioButton?new l(N):N.data.checkBox?new w(N):new a(N);case"Ch":return new I(N);case"Sig":return new x(N)}return new S(N);case c.AnnotationType.POPUP:return new A(N);case c.AnnotationType.FREETEXT:return new F(N);case c.AnnotationType.LINE:return new v(N);case c.AnnotationType.SQUARE:return new W(N);case c.AnnotationType.CIRCLE:return new Y(N);case c.AnnotationType.POLYLINE:return new R(N);case c.AnnotationType.CARET:return new at(N);case c.AnnotationType.INK:return new ct(N);case c.AnnotationType.POLYGON:return new K(N);case c.AnnotationType.HIGHLIGHT:return new G(N);case c.AnnotationType.UNDERLINE:return new ht(N);case c.AnnotationType.SQUIGGLY:return new gt(N);case c.AnnotationType.STRIKEOUT:return new Tt(N);case c.AnnotationType.STAMP:return new kt(N);case c.AnnotationType.FILEATTACHMENT:return new T(N);default:return new m(N)}}}const i=class i{constructor(N,{isRenderable:s=!1,ignoreBorder:y=!1,createQuadrilaterals:U=!1}={}){B(this,r,!1);this.isRenderable=s,this.data=N.data,this.layer=N.layer,this.linkService=N.linkService,this.downloadManager=N.downloadManager,this.imageResourcesPath=N.imageResourcesPath,this.renderForms=N.renderForms,this.svgFactory=N.svgFactory,this.annotationStorage=N.annotationStorage,this.enableScripting=N.enableScripting,this.hasJSActions=N.hasJSActions,this._fieldObjects=N.fieldObjects,this.parent=N.parent,s&&(this.container=this._createContainer(y)),U&&this._createQuadrilaterals()}static _hasPopupData({titleObj:N,contentsObj:s,richText:y}){return!!(N!=null&&N.str||s!=null&&s.str||y!=null&&y.str)}get hasPopupData(){return i._hasPopupData(this.data)}_createContainer(N){const{data:s,parent:{page:y,viewport:U}}=this,q=document.createElement("section");q.setAttribute("data-annotation-id",s.id),this instanceof S||(q.tabIndex=P),q.style.zIndex=this.parent.zIndex++,this.data.popupRef&&q.setAttribute("aria-haspopup","dialog"),s.noRotate&&q.classList.add("norotate");const{pageWidth:J,pageHeight:rt,pageX:mt,pageY:Ct}=U.rawDims;if(!s.rect||this instanceof A){const{rotation:jt}=s;return!s.hasOwnCanvas&&jt!==0&&this.setRotation(jt,q),q}const{width:xt,height:zt}=_(s.rect),Mt=c.Util.normalizeRect([s.rect[0],y.view[3]-s.rect[1]+y.view[1],s.rect[2],y.view[3]-s.rect[3]+y.view[1]]);if(!N&&s.borderStyle.width>0){q.style.borderWidth=`${s.borderStyle.width}px`;const jt=s.borderStyle.horizontalCornerRadius,$t=s.borderStyle.verticalCornerRadius;if(jt>0||$t>0){const Zt=`calc(${jt}px * var(--scale-factor)) / calc(${$t}px * var(--scale-factor))`;q.style.borderRadius=Zt}else if(this instanceof l){const Zt=`calc(${xt}px * var(--scale-factor)) / calc(${zt}px * var(--scale-factor))`;q.style.borderRadius=Zt}switch(s.borderStyle.style){case c.AnnotationBorderStyleType.SOLID:q.style.borderStyle="solid";break;case c.AnnotationBorderStyleType.DASHED:q.style.borderStyle="dashed";break;case c.AnnotationBorderStyleType.BEVELED:(0,c.warn)("Unimplemented border style: beveled");break;case c.AnnotationBorderStyleType.INSET:(0,c.warn)("Unimplemented border style: inset");break;case c.AnnotationBorderStyleType.UNDERLINE:q.style.borderBottomStyle="solid";break}const Jt=s.borderColor||null;Jt?(nt(this,r,!0),q.style.borderColor=c.Util.makeHexColor(Jt[0]|0,Jt[1]|0,Jt[2]|0)):q.style.borderWidth=0}q.style.left=`${100*(Mt[0]-mt)/J}%`,q.style.top=`${100*(Mt[1]-Ct)/rt}%`;const{rotation:It}=s;return s.hasOwnCanvas||It===0?(q.style.width=`${100*xt/J}%`,q.style.height=`${100*zt/rt}%`):this.setRotation(It,q),q}setRotation(N,s=this.container){if(!this.data.rect)return;const{pageWidth:y,pageHeight:U}=this.parent.viewport.rawDims,{width:q,height:J}=_(this.data.rect);let rt,mt;N%180===0?(rt=100*q/y,mt=100*J/U):(rt=100*J/y,mt=100*q/U),s.style.width=`${rt}%`,s.style.height=`${mt}%`,s.setAttribute("data-main-rotation",(360-N)%360)}get _commonActions(){const N=(s,y,U)=>{const q=U.detail[s],J=q[0],rt=q.slice(1);U.target.style[y]=M.ColorConverters[`${J}_HTML`](rt),this.annotationStorage.setValue(this.data.id,{[y]:M.ColorConverters[`${J}_rgb`](rt)})};return(0,c.shadow)(this,"_commonActions",{display:s=>{const{display:y}=s.detail,U=y%2===1;this.container.style.visibility=U?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:U,noPrint:y===1||y===2})},print:s=>{this.annotationStorage.setValue(this.data.id,{noPrint:!s.detail.print})},hidden:s=>{const{hidden:y}=s.detail;this.container.style.visibility=y?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:y,noView:y})},focus:s=>{setTimeout(()=>s.target.focus({preventScroll:!1}),0)},userName:s=>{s.target.title=s.detail.userName},readonly:s=>{s.target.disabled=s.detail.readonly},required:s=>{this._setRequired(s.target,s.detail.required)},bgColor:s=>{N("bgColor","backgroundColor",s)},fillColor:s=>{N("fillColor","backgroundColor",s)},fgColor:s=>{N("fgColor","color",s)},textColor:s=>{N("textColor","color",s)},borderColor:s=>{N("borderColor","borderColor",s)},strokeColor:s=>{N("strokeColor","borderColor",s)},rotation:s=>{const y=s.detail.rotation;this.setRotation(y),this.annotationStorage.setValue(this.data.id,{rotation:y})}})}_dispatchEventFromSandbox(N,s){const y=this._commonActions;for(const U of Object.keys(s.detail)){const q=N[U]||y[U];q==null||q(s)}}_setDefaultPropertiesFromJS(N){if(!this.enableScripting)return;const s=this.annotationStorage.getRawValue(this.data.id);if(!s)return;const y=this._commonActions;for(const[U,q]of Object.entries(s)){const J=y[U];if(J){const rt={detail:{[U]:q},target:N};J(rt),delete s[U]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:N}=this.data;if(!N)return;const[s,y,U,q]=this.data.rect;if(N.length===1){const[,{x:$t,y:Jt},{x:Zt,y:ne}]=N[0];if(U===$t&&q===Jt&&s===Zt&&y===ne)return}const{style:J}=this.container;let rt;if(t(this,r)){const{borderColor:$t,borderWidth:Jt}=J;J.borderWidth=0,rt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${$t}" stroke-width="${Jt}">`],this.container.classList.add("hasBorder")}const mt=U-s,Ct=q-y,{svgFactory:xt}=this,zt=xt.createElement("svg");zt.classList.add("quadrilateralsContainer"),zt.setAttribute("width",0),zt.setAttribute("height",0);const Mt=xt.createElement("defs");zt.append(Mt);const It=xt.createElement("clipPath"),jt=`clippath_${this.data.id}`;It.setAttribute("id",jt),It.setAttribute("clipPathUnits","objectBoundingBox"),Mt.append(It);for(const[,{x:$t,y:Jt},{x:Zt,y:ne}]of N){const se=xt.createElement("rect"),ie=(Zt-s)/mt,oe=(q-Jt)/Ct,le=($t-Zt)/mt,As=(Jt-ne)/Ct;se.setAttribute("x",ie),se.setAttribute("y",oe),se.setAttribute("width",le),se.setAttribute("height",As),It.append(se),rt==null||rt.push(`<rect vector-effect="non-scaling-stroke" x="${ie}" y="${oe}" width="${le}" height="${As}"/>`)}t(this,r)&&(rt.push("</g></svg>')"),J.backgroundImage=rt.join("")),this.container.append(zt),this.container.style.clipPath=`url(#${jt})`}_createPopup(){const{container:N,data:s}=this;N.setAttribute("aria-haspopup","dialog");const y=new A({data:{color:s.color,titleObj:s.titleObj,modificationDate:s.modificationDate,contentsObj:s.contentsObj,richText:s.richText,parentRect:s.rect,borderStyle:0,id:`popup_${s.id}`,rotation:s.rotation},parent:this.parent,elements:[this]});this.parent.div.append(y.render())}render(){(0,c.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(N,s=null){const y=[];if(this._fieldObjects){const U=this._fieldObjects[N];if(U)for(const{page:q,id:J,exportValues:rt}of U){if(q===-1||J===s)continue;const mt=typeof rt=="string"?rt:null,Ct=document.querySelector(`[data-element-id="${J}"]`);if(Ct&&!L.has(Ct)){(0,c.warn)(`_getElementsByName - element not allowed: ${J}`);continue}y.push({id:J,exportValue:mt,domElement:Ct})}return y}for(const U of document.getElementsByName(N)){const{exportValue:q}=U,J=U.getAttribute("data-element-id");J!==s&&L.has(U)&&y.push({id:J,exportValue:q,domElement:U})}return y}show(){var N;this.container&&(this.container.hidden=!1),(N=this.popup)==null||N.maybeShow()}hide(){var N;this.container&&(this.container.hidden=!0),(N=this.popup)==null||N.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const N=this.getElementsToTriggerPopup();if(Array.isArray(N))for(const s of N)s.classList.add("highlightArea");else N.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:N,data:{id:s}}=this;this.container.addEventListener("dblclick",()=>{var y;(y=this.linkService.eventBus)==null||y.dispatch("switchannotationeditormode",{source:this,mode:N,editId:s})})}};r=new WeakMap;let m=i;class b extends m{constructor(s,y=null){super(s,{isRenderable:!0,ignoreBorder:!!(y!=null&&y.ignoreBorder),createQuadrilaterals:!0});B(this,h);B(this,E);this.isTooltipOnly=s.data.isTooltipOnly}render(){const{data:s,linkService:y}=this,U=document.createElement("a");U.setAttribute("data-element-id",s.id);let q=!1;return s.url?(y.addLinkAttributes(U,s.url,s.newWindow),q=!0):s.action?(this._bindNamedAction(U,s.action),q=!0):s.attachment?(this._bindAttachment(U,s.attachment),q=!0):s.setOCGState?(V(this,E,Ls).call(this,U,s.setOCGState),q=!0):s.dest?(this._bindLink(U,s.dest),q=!0):(s.actions&&(s.actions.Action||s.actions["Mouse Up"]||s.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(U,s),q=!0),s.resetForm?(this._bindResetFormAction(U,s.resetForm),q=!0):this.isTooltipOnly&&!q&&(this._bindLink(U,""),q=!0)),this.container.classList.add("linkAnnotation"),q&&this.container.append(U),this.container}_bindLink(s,y){s.href=this.linkService.getDestinationHash(y),s.onclick=()=>(y&&this.linkService.goToDestination(y),!1),(y||y==="")&&V(this,h,ce).call(this)}_bindNamedAction(s,y){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeNamedAction(y),!1),V(this,h,ce).call(this)}_bindAttachment(s,y){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>{var U;return(U=this.downloadManager)==null||U.openOrDownloadData(this.container,y.content,y.filename),!1},V(this,h,ce).call(this)}_bindJSAction(s,y){s.href=this.linkService.getAnchorUrl("");const U=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const q of Object.keys(y.actions)){const J=U.get(q);J&&(s[J]=()=>{var rt;return(rt=this.linkService.eventBus)==null||rt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:y.id,name:q}}),!1})}s.onclick||(s.onclick=()=>!1),V(this,h,ce).call(this)}_bindResetFormAction(s,y){const U=s.onclick;if(U||(s.href=this.linkService.getAnchorUrl("")),V(this,h,ce).call(this),!this._fieldObjects){(0,c.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),U||(s.onclick=()=>!1);return}s.onclick=()=>{var zt;U==null||U();const{fields:q,refs:J,include:rt}=y,mt=[];if(q.length!==0||J.length!==0){const Mt=new Set(J);for(const It of q){const jt=this._fieldObjects[It]||[];for(const{id:$t}of jt)Mt.add($t)}for(const It of Object.values(this._fieldObjects))for(const jt of It)Mt.has(jt.id)===rt&&mt.push(jt)}else for(const Mt of Object.values(this._fieldObjects))mt.push(...Mt);const Ct=this.annotationStorage,xt=[];for(const Mt of mt){const{id:It}=Mt;switch(xt.push(It),Mt.type){case"text":{const $t=Mt.defaultValue||"";Ct.setValue(It,{value:$t});break}case"checkbox":case"radiobutton":{const $t=Mt.defaultValue===Mt.exportValues;Ct.setValue(It,{value:$t});break}case"combobox":case"listbox":{const $t=Mt.defaultValue||"";Ct.setValue(It,{value:$t});break}default:continue}const jt=document.querySelector(`[data-element-id="${It}"]`);if(jt){if(!L.has(jt)){(0,c.warn)(`_bindResetFormAction - element not allowed: ${It}`);continue}}else continue;jt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((zt=this.linkService.eventBus)==null||zt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:xt,name:"ResetForm"}})),!1}}}h=new WeakSet,ce=function(){this.container.setAttribute("data-internal-link","")},E=new WeakSet,Ls=function(s,y){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeSetOCGState(y),!1),V(this,h,ce).call(this)};class g extends m{constructor(N){super(N,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const N=document.createElement("img");return N.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",N.alt="[{{type}} Annotation]",N.dataset.l10nId="text_annotation_type",N.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(N),this.container}}class S extends m{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(N){var s;this.data.hasOwnCanvas&&(((s=N.previousSibling)==null?void 0:s.nodeName)==="CANVAS"&&(N.previousSibling.hidden=!0),N.hidden=!1)}_getKeyModifier(N){const{isWin:s,isMac:y}=c.FeatureTest.platform;return s&&N.ctrlKey||y&&N.metaKey}_setEventListener(N,s,y,U,q){y.includes("mouse")?N.addEventListener(y,J=>{var rt;(rt=this.linkService.eventBus)==null||rt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:q(J),shift:J.shiftKey,modifier:this._getKeyModifier(J)}})}):N.addEventListener(y,J=>{var rt;if(y==="blur"){if(!s.focused||!J.relatedTarget)return;s.focused=!1}else if(y==="focus"){if(s.focused)return;s.focused=!0}q&&((rt=this.linkService.eventBus)==null||rt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:q(J)}}))})}_setEventListeners(N,s,y,U){var q,J,rt;for(const[mt,Ct]of y)(Ct==="Action"||(q=this.data.actions)!=null&&q[Ct])&&((Ct==="Focus"||Ct==="Blur")&&(s||(s={focused:!1})),this._setEventListener(N,s,mt,Ct,U),Ct==="Focus"&&!((J=this.data.actions)!=null&&J.Blur)?this._setEventListener(N,s,"blur","Blur",null):Ct==="Blur"&&!((rt=this.data.actions)!=null&&rt.Focus)&&this._setEventListener(N,s,"focus","Focus",null))}_setBackgroundColor(N){const s=this.data.backgroundColor||null;N.style.backgroundColor=s===null?"transparent":c.Util.makeHexColor(s[0],s[1],s[2])}_setTextStyle(N){const s=["left","center","right"],{fontColor:y}=this.data.defaultAppearanceData,U=this.data.defaultAppearanceData.fontSize||u,q=N.style;let J;const rt=2,mt=Ct=>Math.round(10*Ct)/10;if(this.data.multiLine){const Ct=Math.abs(this.data.rect[3]-this.data.rect[1]-rt),xt=Math.round(Ct/(c.LINE_FACTOR*U))||1,zt=Ct/xt;J=Math.min(U,mt(zt/c.LINE_FACTOR))}else{const Ct=Math.abs(this.data.rect[3]-this.data.rect[1]-rt);J=Math.min(U,mt(Ct/c.LINE_FACTOR))}q.fontSize=`calc(${J}px * var(--scale-factor))`,q.color=c.Util.makeHexColor(y[0],y[1],y[2]),this.data.textAlignment!==null&&(q.textAlign=s[this.data.textAlignment])}_setRequired(N,s){s?N.setAttribute("required",!0):N.removeAttribute("required"),N.setAttribute("aria-required",s)}}class C extends S{constructor(N){const s=N.renderForms||!N.data.hasAppearance&&!!N.data.fieldValue;super(N,{isRenderable:s})}setPropertyOnSiblings(N,s,y,U){const q=this.annotationStorage;for(const J of this._getElementsByName(N.name,N.id))J.domElement&&(J.domElement[s]=y),q.setValue(J.id,{[U]:y})}render(){var U,q;const N=this.annotationStorage,s=this.data.id;this.container.classList.add("textWidgetAnnotation");let y=null;if(this.renderForms){const J=N.getValue(s,{value:this.data.fieldValue});let rt=J.value||"";const mt=N.getValue(s,{charLimit:this.data.maxLen}).charLimit;mt&&rt.length>mt&&(rt=rt.slice(0,mt));let Ct=J.formattedValue||((U=this.data.textContent)==null?void 0:U.join(`
`))||null;Ct&&this.data.comb&&(Ct=Ct.replaceAll(/\s+/g,""));const xt={userValue:rt,formattedValue:Ct,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(y=document.createElement("textarea"),y.textContent=Ct!=null?Ct:rt,this.data.doNotScroll&&(y.style.overflowY="hidden")):(y=document.createElement("input"),y.type="text",y.setAttribute("value",Ct!=null?Ct:rt),this.data.doNotScroll&&(y.style.overflowX="hidden")),this.data.hasOwnCanvas&&(y.hidden=!0),L.add(y),y.setAttribute("data-element-id",s),y.disabled=this.data.readOnly,y.name=this.data.fieldName,y.tabIndex=P,this._setRequired(y,this.data.required),mt&&(y.maxLength=mt),y.addEventListener("input",Mt=>{N.setValue(s,{value:Mt.target.value}),this.setPropertyOnSiblings(y,"value",Mt.target.value,"value"),xt.formattedValue=null}),y.addEventListener("resetform",Mt=>{var jt;const It=(jt=this.data.defaultFieldValue)!=null?jt:"";y.value=xt.userValue=It,xt.formattedValue=null});let zt=Mt=>{const{formattedValue:It}=xt;It!=null&&(Mt.target.value=It),Mt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){y.addEventListener("focus",It=>{if(xt.focused)return;const{target:jt}=It;xt.userValue&&(jt.value=xt.userValue),xt.lastCommittedValue=jt.value,xt.commitKey=1,xt.focused=!0}),y.addEventListener("updatefromsandbox",It=>{this.showElementAndHideCanvas(It.target);const jt={value($t){var Jt;xt.userValue=(Jt=$t.detail.value)!=null?Jt:"",N.setValue(s,{value:xt.userValue.toString()}),$t.target.value=xt.userValue},formattedValue($t){const{formattedValue:Jt}=$t.detail;xt.formattedValue=Jt,Jt!=null&&$t.target!==document.activeElement&&($t.target.value=Jt),N.setValue(s,{formattedValue:Jt})},selRange($t){$t.target.setSelectionRange(...$t.detail.selRange)},charLimit:$t=>{var se;const{charLimit:Jt}=$t.detail,{target:Zt}=$t;if(Jt===0){Zt.removeAttribute("maxLength");return}Zt.setAttribute("maxLength",Jt);let ne=xt.userValue;!ne||ne.length<=Jt||(ne=ne.slice(0,Jt),Zt.value=xt.userValue=ne,N.setValue(s,{value:ne}),(se=this.linkService.eventBus)==null||se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:ne,willCommit:!0,commitKey:1,selStart:Zt.selectionStart,selEnd:Zt.selectionEnd}}))}};this._dispatchEventFromSandbox(jt,It)}),y.addEventListener("keydown",It=>{var Jt;xt.commitKey=1;let jt=-1;if(It.key==="Escape"?jt=0:It.key==="Enter"&&!this.data.multiLine?jt=2:It.key==="Tab"&&(xt.commitKey=3),jt===-1)return;const{value:$t}=It.target;xt.lastCommittedValue!==$t&&(xt.lastCommittedValue=$t,xt.userValue=$t,(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:$t,willCommit:!0,commitKey:jt,selStart:It.target.selectionStart,selEnd:It.target.selectionEnd}}))});const Mt=zt;zt=null,y.addEventListener("blur",It=>{var $t;if(!xt.focused||!It.relatedTarget)return;xt.focused=!1;const{value:jt}=It.target;xt.userValue=jt,xt.lastCommittedValue!==jt&&(($t=this.linkService.eventBus)==null||$t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:jt,willCommit:!0,commitKey:xt.commitKey,selStart:It.target.selectionStart,selEnd:It.target.selectionEnd}})),Mt(It)}),(q=this.data.actions)!=null&&q.Keystroke&&y.addEventListener("beforeinput",It=>{var oe;xt.lastCommittedValue=null;const{data:jt,target:$t}=It,{value:Jt,selectionStart:Zt,selectionEnd:ne}=$t;let se=Zt,ie=ne;switch(It.inputType){case"deleteWordBackward":{const le=Jt.substring(0,Zt).match(/\w*[^\w]*$/);le&&(se-=le[0].length);break}case"deleteWordForward":{const le=Jt.substring(Zt).match(/^[^\w]*\w*/);le&&(ie+=le[0].length);break}case"deleteContentBackward":Zt===ne&&(se-=1);break;case"deleteContentForward":Zt===ne&&(ie+=1);break}It.preventDefault(),(oe=this.linkService.eventBus)==null||oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:Jt,change:jt||"",willCommit:!1,selStart:se,selEnd:ie}})}),this._setEventListeners(y,xt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],It=>It.target.value)}if(zt&&y.addEventListener("blur",zt),this.data.comb){const It=(this.data.rect[2]-this.data.rect[0])/mt;y.classList.add("comb"),y.style.letterSpacing=`calc(${It}px * var(--scale-factor) - 1ch)`}}else y=document.createElement("div"),y.textContent=this.data.fieldValue,y.style.verticalAlign="middle",y.style.display="table-cell";return this._setTextStyle(y),this._setBackgroundColor(y),this._setDefaultPropertiesFromJS(y),this.container.append(y),this.container}}class x extends S{constructor(N){super(N,{isRenderable:!!N.data.hasOwnCanvas})}}class w extends S{constructor(N){super(N,{isRenderable:N.renderForms})}render(){const N=this.annotationStorage,s=this.data,y=s.id;let U=N.getValue(y,{value:s.exportValue===s.fieldValue}).value;typeof U=="string"&&(U=U!=="Off",N.setValue(y,{value:U})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const q=document.createElement("input");return L.add(q),q.setAttribute("data-element-id",y),q.disabled=s.readOnly,this._setRequired(q,this.data.required),q.type="checkbox",q.name=s.fieldName,U&&q.setAttribute("checked",!0),q.setAttribute("exportValue",s.exportValue),q.tabIndex=P,q.addEventListener("change",J=>{const{name:rt,checked:mt}=J.target;for(const Ct of this._getElementsByName(rt,y)){const xt=mt&&Ct.exportValue===s.exportValue;Ct.domElement&&(Ct.domElement.checked=xt),N.setValue(Ct.id,{value:xt})}N.setValue(y,{value:mt})}),q.addEventListener("resetform",J=>{const rt=s.defaultFieldValue||"Off";J.target.checked=rt===s.exportValue}),this.enableScripting&&this.hasJSActions&&(q.addEventListener("updatefromsandbox",J=>{const rt={value(mt){mt.target.checked=mt.detail.value!=="Off",N.setValue(y,{value:mt.target.checked})}};this._dispatchEventFromSandbox(rt,J)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],J=>J.target.checked)),this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class l extends S{constructor(N){super(N,{isRenderable:N.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const N=this.annotationStorage,s=this.data,y=s.id;let U=N.getValue(y,{value:s.fieldValue===s.buttonValue}).value;typeof U=="string"&&(U=U!==s.buttonValue,N.setValue(y,{value:U}));const q=document.createElement("input");if(L.add(q),q.setAttribute("data-element-id",y),q.disabled=s.readOnly,this._setRequired(q,this.data.required),q.type="radio",q.name=s.fieldName,U&&q.setAttribute("checked",!0),q.tabIndex=P,q.addEventListener("change",J=>{const{name:rt,checked:mt}=J.target;for(const Ct of this._getElementsByName(rt,y))N.setValue(Ct.id,{value:!1});N.setValue(y,{value:mt})}),q.addEventListener("resetform",J=>{const rt=s.defaultFieldValue;J.target.checked=rt!=null&&rt===s.buttonValue}),this.enableScripting&&this.hasJSActions){const J=s.buttonValue;q.addEventListener("updatefromsandbox",rt=>{const mt={value:Ct=>{const xt=J===Ct.detail.value;for(const zt of this._getElementsByName(Ct.target.name)){const Mt=xt&&zt.id===y;zt.domElement&&(zt.domElement.checked=Mt),N.setValue(zt.id,{value:Mt})}}};this._dispatchEventFromSandbox(mt,rt)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],rt=>rt.target.checked)}return this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class a extends b{constructor(N){super(N,{ignoreBorder:N.data.hasAppearance})}render(){const N=super.render();N.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(N.title=this.data.alternativeText);const s=N.lastChild;return this.enableScripting&&this.hasJSActions&&s&&(this._setDefaultPropertiesFromJS(s),s.addEventListener("updatefromsandbox",y=>{this._dispatchEventFromSandbox({},y)})),N}}class I extends S{constructor(N){super(N,{isRenderable:N.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const N=this.annotationStorage,s=this.data.id,y=N.getValue(s,{value:this.data.fieldValue}),U=document.createElement("select");L.add(U),U.setAttribute("data-element-id",s),U.disabled=this.data.readOnly,this._setRequired(U,this.data.required),U.name=this.data.fieldName,U.tabIndex=P;let q=this.data.combo&&this.data.options.length>0;this.data.combo||(U.size=this.data.options.length,this.data.multiSelect&&(U.multiple=!0)),U.addEventListener("resetform",xt=>{const zt=this.data.defaultFieldValue;for(const Mt of U.options)Mt.selected=Mt.value===zt});for(const xt of this.data.options){const zt=document.createElement("option");zt.textContent=xt.displayValue,zt.value=xt.exportValue,y.value.includes(xt.exportValue)&&(zt.setAttribute("selected",!0),q=!1),U.append(zt)}let J=null;if(q){const xt=document.createElement("option");xt.value=" ",xt.setAttribute("hidden",!0),xt.setAttribute("selected",!0),U.prepend(xt),J=()=>{xt.remove(),U.removeEventListener("input",J),J=null},U.addEventListener("input",J)}const rt=xt=>{const zt=xt?"value":"textContent",{options:Mt,multiple:It}=U;return It?Array.prototype.filter.call(Mt,jt=>jt.selected).map(jt=>jt[zt]):Mt.selectedIndex===-1?null:Mt[Mt.selectedIndex][zt]};let mt=rt(!1);const Ct=xt=>{const zt=xt.target.options;return Array.prototype.map.call(zt,Mt=>({displayValue:Mt.textContent,exportValue:Mt.value}))};return this.enableScripting&&this.hasJSActions?(U.addEventListener("updatefromsandbox",xt=>{const zt={value(Mt){J==null||J();const It=Mt.detail.value,jt=new Set(Array.isArray(It)?It:[It]);for(const $t of U.options)$t.selected=jt.has($t.value);N.setValue(s,{value:rt(!0)}),mt=rt(!1)},multipleSelection(Mt){U.multiple=!0},remove(Mt){const It=U.options,jt=Mt.detail.remove;It[jt].selected=!1,U.remove(jt),It.length>0&&Array.prototype.findIndex.call(It,Jt=>Jt.selected)===-1&&(It[0].selected=!0),N.setValue(s,{value:rt(!0),items:Ct(Mt)}),mt=rt(!1)},clear(Mt){for(;U.length!==0;)U.remove(0);N.setValue(s,{value:null,items:[]}),mt=rt(!1)},insert(Mt){const{index:It,displayValue:jt,exportValue:$t}=Mt.detail.insert,Jt=U.children[It],Zt=document.createElement("option");Zt.textContent=jt,Zt.value=$t,Jt?Jt.before(Zt):U.append(Zt),N.setValue(s,{value:rt(!0),items:Ct(Mt)}),mt=rt(!1)},items(Mt){const{items:It}=Mt.detail;for(;U.length!==0;)U.remove(0);for(const jt of It){const{displayValue:$t,exportValue:Jt}=jt,Zt=document.createElement("option");Zt.textContent=$t,Zt.value=Jt,U.append(Zt)}U.options.length>0&&(U.options[0].selected=!0),N.setValue(s,{value:rt(!0),items:Ct(Mt)}),mt=rt(!1)},indices(Mt){const It=new Set(Mt.detail.indices);for(const jt of Mt.target.options)jt.selected=It.has(jt.index);N.setValue(s,{value:rt(!0)}),mt=rt(!1)},editable(Mt){Mt.target.disabled=!Mt.detail.editable}};this._dispatchEventFromSandbox(zt,xt)}),U.addEventListener("input",xt=>{var Mt;const zt=rt(!0);N.setValue(s,{value:zt}),xt.preventDefault(),(Mt=this.linkService.eventBus)==null||Mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:mt,changeEx:zt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(U,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],xt=>xt.target.value)):U.addEventListener("input",function(xt){N.setValue(s,{value:rt(!0)})}),this.data.combo&&this._setTextStyle(U),this._setBackgroundColor(U),this._setDefaultPropertiesFromJS(U),this.container.append(U),this.container}}class A extends m{constructor(N){const{data:s,elements:y}=N;super(N,{isRenderable:m._hasPopupData(s)}),this.elements=y}render(){this.container.classList.add("popupAnnotation");const N=new o({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),s=[];for(const y of this.elements)y.popup=N,s.push(y.data.id),y.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(y=>`${c.AnnotationPrefix}${y}`).join(",")),this.container}}class o{constructor({container:N,color:s,elements:y,titleObj:U,modificationDate:q,contentsObj:J,richText:rt,parent:mt,rect:Ct,parentRect:xt,open:zt}){B(this,Wt);B(this,Ht);B(this,Xt);B(this,Vt);B(this,H,null);B(this,it,V(this,Wt,Ns).bind(this));B(this,st,V(this,Vt,os).bind(this));B(this,ot,V(this,Xt,as).bind(this));B(this,dt,V(this,Ht,ke).bind(this));B(this,vt,null);B(this,ft,null);B(this,Ft,null);B(this,Bt,null);B(this,Et,null);B(this,Dt,null);B(this,pt,!1);B(this,et,null);B(this,tt,null);B(this,ut,null);B(this,wt,null);B(this,Pt,!1);var It;nt(this,ft,N),nt(this,wt,U),nt(this,Ft,J),nt(this,ut,rt),nt(this,Et,mt),nt(this,vt,s),nt(this,tt,Ct),nt(this,Dt,xt),nt(this,Bt,y);const Mt=p.PDFDateString.toDateObject(q);Mt&&nt(this,H,mt.l10n.get("annotation_date_string",{date:Mt.toLocaleDateString(),time:Mt.toLocaleTimeString()})),this.trigger=y.flatMap(jt=>jt.getElementsToTriggerPopup());for(const jt of this.trigger)jt.addEventListener("click",t(this,dt)),jt.addEventListener("mouseenter",t(this,ot)),jt.addEventListener("mouseleave",t(this,st)),jt.classList.add("popupTriggerArea");for(const jt of y)(It=jt.container)==null||It.addEventListener("keydown",t(this,it));t(this,ft).hidden=!0,zt&&V(this,Ht,ke).call(this)}render(){if(t(this,et))return;const{page:{view:N},viewport:{rawDims:{pageWidth:s,pageHeight:y,pageX:U,pageY:q}}}=t(this,Et),J=nt(this,et,document.createElement("div"));if(J.className="popup",t(this,vt)){const se=J.style.outlineColor=c.Util.makeHexColor(...t(this,vt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?J.style.backgroundColor=`color-mix(in srgb, ${se} 30%, white)`:J.style.backgroundColor=c.Util.makeHexColor(...t(this,vt).map(oe=>Math.floor(.7*(255-oe)+oe)))}const rt=document.createElement("span");rt.className="header";const mt=document.createElement("h1");if(rt.append(mt),{dir:mt.dir,str:mt.textContent}=t(this,wt),J.append(rt),t(this,H)){const se=document.createElement("span");se.classList.add("popupDate"),t(this,H).then(ie=>{se.textContent=ie}),rt.append(se)}const Ct=t(this,Ft),xt=t(this,ut);if(xt!=null&&xt.str&&(!(Ct!=null&&Ct.str)||Ct.str===xt.str))D.XfaLayer.render({xfaHtml:xt.html,intent:"richText",div:J}),J.lastChild.classList.add("richText","popupContent");else{const se=this._formatContents(Ct);J.append(se)}let zt=!!t(this,Dt),Mt=zt?t(this,Dt):t(this,tt);for(const se of t(this,Bt))if(!Mt||c.Util.intersect(se.data.rect,Mt)!==null){Mt=se.data.rect,zt=!0;break}const It=c.Util.normalizeRect([Mt[0],N[3]-Mt[1]+N[1],Mt[2],N[3]-Mt[3]+N[1]]),$t=zt?Mt[2]-Mt[0]+5:0,Jt=It[0]+$t,Zt=It[1],{style:ne}=t(this,ft);ne.left=`${100*(Jt-U)/s}%`,ne.top=`${100*(Zt-q)/y}%`,t(this,ft).append(J)}_formatContents({str:N,dir:s}){const y=document.createElement("p");y.classList.add("popupContent"),y.dir=s;const U=N.split(/(?:\r\n?|\n)/);for(let q=0,J=U.length;q<J;++q){const rt=U[q];y.append(document.createTextNode(rt)),q<J-1&&y.append(document.createElement("br"))}return y}forceHide(){nt(this,Pt,this.isVisible),t(this,Pt)&&(t(this,ft).hidden=!0)}maybeShow(){t(this,Pt)&&(nt(this,Pt,!1),t(this,ft).hidden=!1)}get isVisible(){return t(this,ft).hidden===!1}}H=new WeakMap,it=new WeakMap,st=new WeakMap,ot=new WeakMap,dt=new WeakMap,vt=new WeakMap,ft=new WeakMap,Ft=new WeakMap,Bt=new WeakMap,Et=new WeakMap,Dt=new WeakMap,pt=new WeakMap,et=new WeakMap,tt=new WeakMap,ut=new WeakMap,wt=new WeakMap,Pt=new WeakMap,Wt=new WeakSet,Ns=function(N){N.altKey||N.shiftKey||N.ctrlKey||N.metaKey||(N.key==="Enter"||N.key==="Escape"&&t(this,pt))&&V(this,Ht,ke).call(this)},Ht=new WeakSet,ke=function(){nt(this,pt,!t(this,pt)),t(this,pt)?(V(this,Xt,as).call(this),t(this,ft).addEventListener("click",t(this,dt)),t(this,ft).addEventListener("keydown",t(this,it))):(V(this,Vt,os).call(this),t(this,ft).removeEventListener("click",t(this,dt)),t(this,ft).removeEventListener("keydown",t(this,it)))},Xt=new WeakSet,as=function(){t(this,et)||this.render(),this.isVisible?t(this,pt)&&t(this,ft).classList.add("focused"):(t(this,ft).hidden=!1,t(this,ft).style.zIndex=parseInt(t(this,ft).style.zIndex)+1e3)},Vt=new WeakSet,os=function(){t(this,ft).classList.remove("focused"),!(t(this,pt)||!this.isVisible)&&(t(this,ft).hidden=!0,t(this,ft).style.zIndex=parseInt(t(this,ft).style.zIndex)-1e3)};class F extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0}),this.textContent=N.data.textContent,this.textPosition=N.data.textPosition,this.annotationEditorType=c.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const N=document.createElement("div");N.classList.add("annotationTextContent"),N.setAttribute("role","comment");for(const s of this.textContent){const y=document.createElement("span");y.textContent=s,N.append(y)}this.container.append(N)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=F;class v extends m{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});B(this,Z,null)}render(){this.container.classList.add("lineAnnotation");const s=this.data,{width:y,height:U}=_(s.rect),q=this.svgFactory.create(y,U,!0),J=nt(this,Z,this.svgFactory.createElement("svg:line"));return J.setAttribute("x1",s.rect[2]-s.lineCoordinates[0]),J.setAttribute("y1",s.rect[3]-s.lineCoordinates[1]),J.setAttribute("x2",s.rect[2]-s.lineCoordinates[2]),J.setAttribute("y2",s.rect[3]-s.lineCoordinates[3]),J.setAttribute("stroke-width",s.borderStyle.width||1),J.setAttribute("stroke","transparent"),J.setAttribute("fill","transparent"),q.append(J),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Z)}addHighlightArea(){this.container.classList.add("highlightArea")}}Z=new WeakMap;class W extends m{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});B(this,$,null)}render(){this.container.classList.add("squareAnnotation");const s=this.data,{width:y,height:U}=_(s.rect),q=this.svgFactory.create(y,U,!0),J=s.borderStyle.width,rt=nt(this,$,this.svgFactory.createElement("svg:rect"));return rt.setAttribute("x",J/2),rt.setAttribute("y",J/2),rt.setAttribute("width",y-J),rt.setAttribute("height",U-J),rt.setAttribute("stroke-width",J||1),rt.setAttribute("stroke","transparent"),rt.setAttribute("fill","transparent"),q.append(rt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,$)}addHighlightArea(){this.container.classList.add("highlightArea")}}$=new WeakMap;class Y extends m{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});B(this,_t,null)}render(){this.container.classList.add("circleAnnotation");const s=this.data,{width:y,height:U}=_(s.rect),q=this.svgFactory.create(y,U,!0),J=s.borderStyle.width,rt=nt(this,_t,this.svgFactory.createElement("svg:ellipse"));return rt.setAttribute("cx",y/2),rt.setAttribute("cy",U/2),rt.setAttribute("rx",y/2-J/2),rt.setAttribute("ry",U/2-J/2),rt.setAttribute("stroke-width",J||1),rt.setAttribute("stroke","transparent"),rt.setAttribute("fill","transparent"),q.append(rt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,_t)}addHighlightArea(){this.container.classList.add("highlightArea")}}_t=new WeakMap;class R extends m{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});B(this,bt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:y,height:U}=_(s.rect),q=this.svgFactory.create(y,U,!0);let J=[];for(const mt of s.vertices){const Ct=mt.x-s.rect[0],xt=s.rect[3]-mt.y;J.push(Ct+","+xt)}J=J.join(" ");const rt=nt(this,bt,this.svgFactory.createElement(this.svgElementName));return rt.setAttribute("points",J),rt.setAttribute("stroke-width",s.borderStyle.width||1),rt.setAttribute("stroke","transparent"),rt.setAttribute("fill","transparent"),q.append(rt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,bt)}addHighlightArea(){this.container.classList.add("highlightArea")}}bt=new WeakMap;class K extends R{constructor(N){super(N),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class at extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class ct extends m{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});B(this,ee,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=c.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:y,height:U}=_(s.rect),q=this.svgFactory.create(y,U,!0);for(const J of s.inkLists){let rt=[];for(const Ct of J){const xt=Ct.x-s.rect[0],zt=s.rect[3]-Ct.y;rt.push(`${xt},${zt}`)}rt=rt.join(" ");const mt=this.svgFactory.createElement(this.svgElementName);t(this,ee).push(mt),mt.setAttribute("points",rt),mt.setAttribute("stroke-width",s.borderStyle.width||1),mt.setAttribute("stroke","transparent"),mt.setAttribute("fill","transparent"),!s.popupRef&&this.hasPopupData&&this._createPopup(),q.append(mt)}return this.container.append(q),this.container}getElementsToTriggerPopup(){return t(this,ee)}addHighlightArea(){this.container.classList.add("highlightArea")}}ee=new WeakMap,e.InkAnnotationElement=ct;class G extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class ht extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class gt extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Tt extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class kt extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=kt;class T extends m{constructor(s){var q;super(s,{isRenderable:!0});B(this,Q);B(this,te,null);const{filename:y,content:U}=this.data.file;this.filename=(0,p.getFilenameFromUrl)(y,!0),this.content=U,(q=this.linkService.eventBus)==null||q.dispatch("fileattachmentannotation",{source:this,filename:y,content:U})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:s,data:y}=this;let U;y.hasAppearance||y.fillAlpha===0?U=document.createElement("div"):(U=document.createElement("img"),U.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(y.name)?"paperclip":"pushpin"}.svg`,y.fillAlpha&&y.fillAlpha<1&&(U.style=`filter: opacity(${Math.round(y.fillAlpha*100)}%);`)),U.addEventListener("dblclick",V(this,Q,ls).bind(this)),nt(this,te,U);const{isMac:q}=c.FeatureTest.platform;return s.addEventListener("keydown",J=>{J.key==="Enter"&&(q?J.metaKey:J.ctrlKey)&&V(this,Q,ls).call(this)}),!y.popupRef&&this.hasPopupData?this._createPopup():U.classList.add("popupTriggerArea"),s.append(U),s}getElementsToTriggerPopup(){return t(this,te)}addHighlightArea(){this.container.classList.add("highlightArea")}}te=new WeakMap,Q=new WeakSet,ls=function(){var s;(s=this.downloadManager)==null||s.openOrDownloadData(this.container,this.content,this.filename)};class n{constructor({div:N,accessibilityManager:s,annotationCanvasMap:y,l10n:U,page:q,viewport:J}){B(this,Ut);B(this,At);B(this,Ot,null);B(this,Rt,null);B(this,Nt,new Map);this.div=N,nt(this,Ot,s),nt(this,Rt,y),this.l10n=U,this.page=q,this.viewport=J,this.zIndex=0,this.l10n||(this.l10n=X.NullL10n)}async render(N){const{annotations:s}=N,y=this.div;(0,p.setLayerDimensions)(y,this.viewport);const U=new Map,q={data:null,layer:y,linkService:N.linkService,downloadManager:N.downloadManager,imageResourcesPath:N.imageResourcesPath||"",renderForms:N.renderForms!==!1,svgFactory:new p.DOMSVGFactory,annotationStorage:N.annotationStorage||new k.AnnotationStorage,enableScripting:N.enableScripting===!0,hasJSActions:N.hasJSActions,fieldObjects:N.fieldObjects,parent:this,elements:null};for(const J of s){if(J.noHTML)continue;const rt=J.annotationType===c.AnnotationType.POPUP;if(rt){const xt=U.get(J.id);if(!xt)continue;q.elements=xt}else{const{width:xt,height:zt}=_(J.rect);if(xt<=0||zt<=0)continue}q.data=J;const mt=d.create(q);if(!mt.isRenderable)continue;if(!rt&&J.popupRef){const xt=U.get(J.popupRef);xt?xt.push(mt):U.set(J.popupRef,[mt])}mt.annotationEditorType>0&&t(this,Nt).set(mt.data.id,mt);const Ct=mt.render();J.hidden&&(Ct.style.visibility="hidden"),V(this,Ut,Us).call(this,Ct,J.id)}V(this,At,cs).call(this),await this.l10n.translate(y)}update({viewport:N}){const s=this.div;this.viewport=N,(0,p.setLayerDimensions)(s,{rotation:N.rotation}),V(this,At,cs).call(this),s.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Nt).values())}getEditableAnnotation(N){return t(this,Nt).get(N)}}Ot=new WeakMap,Rt=new WeakMap,Nt=new WeakMap,Ut=new WeakSet,Us=function(N,s){var U;const y=N.firstChild||N;y.id=`${c.AnnotationPrefix}${s}`,this.div.append(N),(U=t(this,Ot))==null||U.moveElementInDOM(this.div,N,y,!1)},At=new WeakSet,cs=function(){if(!t(this,Rt))return;const N=this.div;for(const[s,y]of t(this,Rt)){const U=N.querySelector(`[data-annotation-id="${s}"]`);if(!U)continue;const{firstChild:q}=U;q?q.nodeName==="CANVAS"?q.replaceWith(y):q.before(y):U.append(y)}t(this,Rt).clear()},e.AnnotationLayer=n},(z,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function j(k){return Math.floor(Math.max(0,Math.min(1,k))*255).toString(16).padStart(2,"0")}function c(k){return Math.max(0,Math.min(255,255*k))}class p{static CMYK_G([M,X,D,P]){return["G",1-Math.min(1,.3*M+.59*D+.11*X+P)]}static G_CMYK([M]){return["CMYK",0,0,0,1-M]}static G_RGB([M]){return["RGB",M,M,M]}static G_rgb([M]){return M=c(M),[M,M,M]}static G_HTML([M]){const X=j(M);return`#${X}${X}${X}`}static RGB_G([M,X,D]){return["G",.3*M+.59*X+.11*D]}static RGB_rgb(M){return M.map(c)}static RGB_HTML(M){return`#${M.map(j).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([M,X,D,P]){return["RGB",1-Math.min(1,M+P),1-Math.min(1,D+P),1-Math.min(1,X+P)]}static CMYK_rgb([M,X,D,P]){return[c(1-Math.min(1,M+P)),c(1-Math.min(1,D+P)),c(1-Math.min(1,X+P))]}static CMYK_HTML(M){const X=this.CMYK_RGB(M).slice(1);return this.RGB_HTML(X)}static RGB_CMYK([M,X,D]){const P=1-M,u=1-X,L=1-D,_=Math.min(P,u,L);return["CMYK",P,u,L,_]}}e.ColorConverters=p},(z,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=c;const j={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};j.print_progress_percent="{{progress}}%";function c(M,X){switch(M){case"find_match_count":M=`find_match_count[${X.total===1?"one":"other"}]`;break;case"find_match_count_limit":M=`find_match_count_limit[${X.limit===1?"one":"other"}]`;break}return j[M]||""}function p(M,X){return X?M.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(D,P)=>P in X?X[P]:"{{"+P+"}}"):M}const k={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(M,X=null,D=c(M,X)){return p(D,X)},async translate(M){}};e.NullL10n=k},(z,e,j)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var c=j(25);class p{static setupStorage(M,X,D,P,u){const L=P.getValue(X,{value:null});switch(D.name){case"textarea":if(L.value!==null&&(M.textContent=L.value),u==="print")break;M.addEventListener("input",_=>{P.setValue(X,{value:_.target.value})});break;case"input":if(D.attributes.type==="radio"||D.attributes.type==="checkbox"){if(L.value===D.attributes.xfaOn?M.setAttribute("checked",!0):L.value===D.attributes.xfaOff&&M.removeAttribute("checked"),u==="print")break;M.addEventListener("change",_=>{P.setValue(X,{value:_.target.checked?_.target.getAttribute("xfaOn"):_.target.getAttribute("xfaOff")})})}else{if(L.value!==null&&M.setAttribute("value",L.value),u==="print")break;M.addEventListener("input",_=>{P.setValue(X,{value:_.target.value})})}break;case"select":if(L.value!==null){M.setAttribute("value",L.value);for(const _ of D.children)_.attributes.value===L.value?_.attributes.selected=!0:_.attributes.hasOwnProperty("selected")&&delete _.attributes.selected}M.addEventListener("input",_=>{const d=_.target.options,m=d.selectedIndex===-1?"":d[d.selectedIndex].value;P.setValue(X,{value:m})});break}}static setAttributes({html:M,element:X,storage:D=null,intent:P,linkService:u}){const{attributes:L}=X,_=M instanceof HTMLAnchorElement;L.type==="radio"&&(L.name=`${L.name}-${P}`);for(const[d,m]of Object.entries(L))if(m!=null)switch(d){case"class":m.length&&M.setAttribute(d,m.join(" "));break;case"dataId":break;case"id":M.setAttribute("data-element-id",m);break;case"style":Object.assign(M.style,m);break;case"textContent":M.textContent=m;break;default:(!_||d!=="href"&&d!=="newWindow")&&M.setAttribute(d,m)}_&&u.addLinkAttributes(M,L.href,L.newWindow),D&&L.dataId&&this.setupStorage(M,L.dataId,X,D)}static render(M){var b;const X=M.annotationStorage,D=M.linkService,P=M.xfaHtml,u=M.intent||"display",L=document.createElement(P.name);P.attributes&&this.setAttributes({html:L,element:P,intent:u,linkService:D});const _=[[P,-1,L]],d=M.div;if(d.append(L),M.viewport){const g=`matrix(${M.viewport.transform.join(",")})`;d.style.transform=g}u!=="richText"&&d.setAttribute("class","xfaLayer xfaFont");const m=[];for(;_.length>0;){const[g,S,C]=_.at(-1);if(S+1===g.children.length){_.pop();continue}const x=g.children[++_.at(-1)[1]];if(x===null)continue;const{name:w}=x;if(w==="#text"){const a=document.createTextNode(x.value);m.push(a),C.append(a);continue}const l=(b=x==null?void 0:x.attributes)!=null&&b.xmlns?document.createElementNS(x.attributes.xmlns,w):document.createElement(w);if(C.append(l),x.attributes&&this.setAttributes({html:l,element:x,storage:X,intent:u,linkService:D}),x.children&&x.children.length>0)_.push([x,-1,l]);else if(x.value){const a=document.createTextNode(x.value);c.XfaText.shouldBuildText(w)&&m.push(a),l.append(a)}}for(const g of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:m}}static update(M){const X=`matrix(${M.viewport.transform.join(",")})`;M.div.style.transform=X,M.div.hidden=!1}}e.XfaLayer=p},(z,e,j)=>{var P,u,L,_,d,m,b,g,S,C,x,w,l,a,I,Bs,o,js,v,Hs,Y,Ws,K,hs,ct,qs,ht,ds,Tt,Gs,T,zs,r,Xs,h,Vs,E,$s,H,ae,st,us,dt,Fe,ft,Me,Bt,fe,Dt,ps,et,Ie,ut,Ys,Pt,gs,qt,Ks,Yt,Js,Gt,ms,lt,De,$,pe;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var c=j(1),p=j(4),k=j(29),M=j(6),X=j(5);const bt=class bt extends p.AnnotationEditor{constructor(Q){super({...Q,name:"inkEditor"});B(this,I);B(this,o);B(this,v);B(this,Y);B(this,K);B(this,ct);B(this,ht);B(this,Tt);B(this,T);B(this,r);B(this,h);B(this,E);B(this,H);B(this,st);B(this,dt);B(this,ft);B(this,Bt);B(this,Dt);B(this,et);B(this,Yt);B(this,Gt);B(this,lt);B(this,$);B(this,P,0);B(this,u,0);B(this,L,this.canvasPointermove.bind(this));B(this,_,this.canvasPointerleave.bind(this));B(this,d,this.canvasPointerup.bind(this));B(this,m,this.canvasPointerdown.bind(this));B(this,b,new Path2D);B(this,g,!1);B(this,S,!1);B(this,C,!1);B(this,x,null);B(this,w,0);B(this,l,0);B(this,a,null);this.color=Q.color||null,this.thickness=Q.thickness||null,this.opacity=Q.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Q){p.AnnotationEditor.initialize(Q,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Q,St){switch(Q){case c.AnnotationEditorParamsType.INK_THICKNESS:bt._defaultThickness=St;break;case c.AnnotationEditorParamsType.INK_COLOR:bt._defaultColor=St;break;case c.AnnotationEditorParamsType.INK_OPACITY:bt._defaultOpacity=St/100;break}}updateParams(Q,St){switch(Q){case c.AnnotationEditorParamsType.INK_THICKNESS:V(this,I,Bs).call(this,St);break;case c.AnnotationEditorParamsType.INK_COLOR:V(this,o,js).call(this,St);break;case c.AnnotationEditorParamsType.INK_OPACITY:V(this,v,Hs).call(this,St);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.INK_THICKNESS,bt._defaultThickness],[c.AnnotationEditorParamsType.INK_COLOR,bt._defaultColor||p.AnnotationEditor._defaultLineColor],[c.AnnotationEditorParamsType.INK_OPACITY,Math.round(bt._defaultOpacity*100)]]}get propertiesToUpdate(){var Q;return[[c.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||bt._defaultThickness],[c.AnnotationEditorParamsType.INK_COLOR,this.color||bt._defaultColor||p.AnnotationEditor._defaultLineColor],[c.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((Q=this.opacity)!=null?Q:bt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(V(this,dt,Fe).call(this),V(this,ft,Me).call(this)),this.isAttachedToDOM||(this.parent.add(this),V(this,Bt,fe).call(this)),V(this,$,pe).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,x).disconnect(),nt(this,x,null),super.remove())}setParent(Q){!this.parent&&Q?this._uiManager.removeShouldRescale(this):this.parent&&Q===null&&this._uiManager.addShouldRescale(this),super.setParent(Q)}onScaleChanging(){const[Q,St]=this.parentDimensions,Ot=this.width*Q,Rt=this.height*St;this.setDimensions(Ot,Rt)}enableEditMode(){t(this,g)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,m)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,m)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,g)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),nt(this,g,!0),this.div.classList.add("disabled"),V(this,$,pe).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Q){this._focusEventsAllowed&&(super.focusin(Q),this.enableEditMode())}canvasPointerdown(Q){Q.button!==0||!this.isInEditMode()||t(this,g)||(this.setInForeground(),Q.preventDefault(),Q.type!=="mouse"&&this.div.focus(),V(this,ct,qs).call(this,Q.offsetX,Q.offsetY))}canvasPointermove(Q){Q.preventDefault(),V(this,ht,ds).call(this,Q.offsetX,Q.offsetY)}canvasPointerup(Q){Q.preventDefault(),V(this,st,us).call(this,Q)}canvasPointerleave(Q){V(this,st,us).call(this,Q)}get isResizable(){return!this.isEmpty()&&t(this,g)}render(){if(this.div)return this.div;let Q,St;this.width&&(Q=this.x,St=this.y),super.render(),p.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Qt=>{var At;return(At=this.div)==null?void 0:At.setAttribute("aria-label",Qt)});const[Ot,Rt,Nt,Ut]=V(this,Y,Ws).call(this);if(this.setAt(Ot,Rt,0,0),this.setDims(Nt,Ut),V(this,dt,Fe).call(this),this.width){const[Qt,At]=this.parentDimensions;this.setAspectRatio(this.width*Qt,this.height*At),this.setAt(Q*Qt,St*At,this.width*Qt,this.height*At),nt(this,C,!0),V(this,Bt,fe).call(this),this.setDims(this.width*Qt,this.height*At),V(this,H,ae).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return V(this,ft,Me).call(this),this.div}setDimensions(Q,St){const Ot=Math.round(Q),Rt=Math.round(St);if(t(this,w)===Ot&&t(this,l)===Rt)return;nt(this,w,Ot),nt(this,l,Rt),this.canvas.style.visibility="hidden";const[Nt,Ut]=this.parentDimensions;this.width=Q/Nt,this.height=St/Ut,this.fixAndSetPosition(),t(this,g)&&V(this,Dt,ps).call(this,Q,St),V(this,Bt,fe).call(this),V(this,H,ae).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Q,St,Ot){var q,J,rt;if(Q instanceof k.InkAnnotationElement)return null;const Rt=super.deserialize(Q,St,Ot);Rt.thickness=Q.thickness,Rt.color=c.Util.makeHexColor(...Q.color),Rt.opacity=Q.opacity;const[Nt,Ut]=Rt.pageDimensions,Qt=Rt.width*Nt,At=Rt.height*Ut,Kt=Rt.parentScale,Lt=Q.thickness/2;nt(Rt,g,!0),nt(Rt,w,Math.round(Qt)),nt(Rt,l,Math.round(At));const{paths:N,rect:s,rotation:y}=Q;for(let{bezier:mt}of N){mt=V(q=bt,qt,Ks).call(q,mt,s,y);const Ct=[];Rt.paths.push(Ct);let xt=Kt*(mt[0]-Lt),zt=Kt*(mt[1]-Lt);for(let It=2,jt=mt.length;It<jt;It+=6){const $t=Kt*(mt[It]-Lt),Jt=Kt*(mt[It+1]-Lt),Zt=Kt*(mt[It+2]-Lt),ne=Kt*(mt[It+3]-Lt),se=Kt*(mt[It+4]-Lt),ie=Kt*(mt[It+5]-Lt);Ct.push([[xt,zt],[$t,Jt],[Zt,ne],[se,ie]]),xt=se,zt=ie}const Mt=V(this,ut,Ys).call(this,Ct);Rt.bezierPath2D.push(Mt)}const U=V(J=Rt,Gt,ms).call(J);return nt(Rt,u,Math.max(p.AnnotationEditor.MIN_SIZE,U[2]-U[0])),nt(Rt,P,Math.max(p.AnnotationEditor.MIN_SIZE,U[3]-U[1])),V(rt=Rt,Dt,ps).call(rt,Qt,At),Rt}serialize(){if(this.isEmpty())return null;const Q=this.getRect(0,0),St=p.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:c.AnnotationEditorType.INK,color:St,thickness:this.thickness,opacity:this.opacity,paths:V(this,Yt,Js).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Q),pageIndex:this.pageIndex,rect:Q,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};P=new WeakMap,u=new WeakMap,L=new WeakMap,_=new WeakMap,d=new WeakMap,m=new WeakMap,b=new WeakMap,g=new WeakMap,S=new WeakMap,C=new WeakMap,x=new WeakMap,w=new WeakMap,l=new WeakMap,a=new WeakMap,I=new WeakSet,Bs=function(Q){const St=this.thickness;this.addCommands({cmd:()=>{this.thickness=Q,V(this,$,pe).call(this)},undo:()=>{this.thickness=St,V(this,$,pe).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},o=new WeakSet,js=function(Q){const St=this.color;this.addCommands({cmd:()=>{this.color=Q,V(this,H,ae).call(this)},undo:()=>{this.color=St,V(this,H,ae).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},v=new WeakSet,Hs=function(Q){Q/=100;const St=this.opacity;this.addCommands({cmd:()=>{this.opacity=Q,V(this,H,ae).call(this)},undo:()=>{this.opacity=St,V(this,H,ae).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Y=new WeakSet,Ws=function(){const{parentRotation:Q,parentDimensions:[St,Ot]}=this;switch(Q){case 90:return[0,Ot,Ot,St];case 180:return[St,Ot,St,Ot];case 270:return[St,0,Ot,St];default:return[0,0,St,Ot]}},K=new WeakSet,hs=function(){const{ctx:Q,color:St,opacity:Ot,thickness:Rt,parentScale:Nt,scaleFactor:Ut}=this;Q.lineWidth=Rt*Nt/Ut,Q.lineCap="round",Q.lineJoin="round",Q.miterLimit=10,Q.strokeStyle=`${St}${(0,X.opacityToHex)(Ot)}`},ct=new WeakSet,qs=function(Q,St){var Ot;this.canvas.addEventListener("contextmenu",M.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,_)),this.canvas.addEventListener("pointermove",t(this,L)),this.canvas.addEventListener("pointerup",t(this,d)),this.canvas.removeEventListener("pointerdown",t(this,m)),this.isEditing=!0,t(this,C)||(nt(this,C,!0),V(this,Bt,fe).call(this),this.thickness||(this.thickness=bt._defaultThickness),this.color||(this.color=bt._defaultColor||p.AnnotationEditor._defaultLineColor),(Ot=this.opacity)!=null||(this.opacity=bt._defaultOpacity)),this.currentPath.push([Q,St]),nt(this,S,!1),V(this,K,hs).call(this),nt(this,a,()=>{V(this,r,Xs).call(this),t(this,a)&&window.requestAnimationFrame(t(this,a))}),window.requestAnimationFrame(t(this,a))},ht=new WeakSet,ds=function(Q,St){const[Ot,Rt]=this.currentPath.at(-1);if(this.currentPath.length>1&&Q===Ot&&St===Rt)return;const Nt=this.currentPath;let Ut=t(this,b);if(Nt.push([Q,St]),nt(this,S,!0),Nt.length<=2){Ut.moveTo(...Nt[0]),Ut.lineTo(Q,St);return}Nt.length===3&&(nt(this,b,Ut=new Path2D),Ut.moveTo(...Nt[0])),V(this,h,Vs).call(this,Ut,...Nt.at(-3),...Nt.at(-2),Q,St)},Tt=new WeakSet,Gs=function(){if(this.currentPath.length===0)return;const Q=this.currentPath.at(-1);t(this,b).lineTo(...Q)},T=new WeakSet,zs=function(Q,St){nt(this,a,null),Q=Math.min(Math.max(Q,0),this.canvas.width),St=Math.min(Math.max(St,0),this.canvas.height),V(this,ht,ds).call(this,Q,St),V(this,Tt,Gs).call(this);let Ot;if(this.currentPath.length!==1)Ot=V(this,E,$s).call(this);else{const At=[Q,St];Ot=[[At,At.slice(),At.slice(),At]]}const Rt=t(this,b),Nt=this.currentPath;this.currentPath=[],nt(this,b,new Path2D);const Ut=()=>{this.allRawPaths.push(Nt),this.paths.push(Ot),this.bezierPath2D.push(Rt),this.rebuild()},Qt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(V(this,dt,Fe).call(this),V(this,ft,Me).call(this)),V(this,$,pe).call(this))};this.addCommands({cmd:Ut,undo:Qt,mustExec:!0})},r=new WeakSet,Xs=function(){if(!t(this,S))return;nt(this,S,!1);const Q=Math.ceil(this.thickness*this.parentScale),St=this.currentPath.slice(-3),Ot=St.map(Ut=>Ut[0]),Rt=St.map(Ut=>Ut[1]);Math.min(...Ot)-Q,Math.max(...Ot)+Q,Math.min(...Rt)-Q,Math.max(...Rt)+Q;const{ctx:Nt}=this;Nt.save(),Nt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Ut of this.bezierPath2D)Nt.stroke(Ut);Nt.stroke(t(this,b)),Nt.restore()},h=new WeakSet,Vs=function(Q,St,Ot,Rt,Nt,Ut,Qt){const At=(St+Rt)/2,Kt=(Ot+Nt)/2,Lt=(Rt+Ut)/2,N=(Nt+Qt)/2;Q.bezierCurveTo(At+2*(Rt-At)/3,Kt+2*(Nt-Kt)/3,Lt+2*(Rt-Lt)/3,N+2*(Nt-N)/3,Lt,N)},E=new WeakSet,$s=function(){const Q=this.currentPath;if(Q.length<=2)return[[Q[0],Q[0],Q.at(-1),Q.at(-1)]];const St=[];let Ot,[Rt,Nt]=Q[0];for(Ot=1;Ot<Q.length-2;Ot++){const[s,y]=Q[Ot],[U,q]=Q[Ot+1],J=(s+U)/2,rt=(y+q)/2,mt=[Rt+2*(s-Rt)/3,Nt+2*(y-Nt)/3],Ct=[J+2*(s-J)/3,rt+2*(y-rt)/3];St.push([[Rt,Nt],mt,Ct,[J,rt]]),[Rt,Nt]=[J,rt]}const[Ut,Qt]=Q[Ot],[At,Kt]=Q[Ot+1],Lt=[Rt+2*(Ut-Rt)/3,Nt+2*(Qt-Nt)/3],N=[At+2*(Ut-At)/3,Kt+2*(Qt-Kt)/3];return St.push([[Rt,Nt],Lt,N,[At,Kt]]),St},H=new WeakSet,ae=function(){if(this.isEmpty()){V(this,et,Ie).call(this);return}V(this,K,hs).call(this);const{canvas:Q,ctx:St}=this;St.setTransform(1,0,0,1,0,0),St.clearRect(0,0,Q.width,Q.height),V(this,et,Ie).call(this);for(const Ot of this.bezierPath2D)St.stroke(Ot)},st=new WeakSet,us=function(Q){this.canvas.removeEventListener("pointerleave",t(this,_)),this.canvas.removeEventListener("pointermove",t(this,L)),this.canvas.removeEventListener("pointerup",t(this,d)),this.canvas.addEventListener("pointerdown",t(this,m)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",M.noContextMenu)},10),V(this,T,zs).call(this,Q.offsetX,Q.offsetY),this.addToAnnotationStorage(),this.setInBackground()},dt=new WeakSet,Fe=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",p.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Q=>{var St;return(St=this.canvas)==null?void 0:St.setAttribute("aria-label",Q)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},ft=new WeakSet,Me=function(){nt(this,x,new ResizeObserver(Q=>{const St=Q[0].contentRect;St.width&&St.height&&this.setDimensions(St.width,St.height)})),t(this,x).observe(this.div)},Bt=new WeakSet,fe=function(){if(!t(this,C))return;const[Q,St]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Q),this.canvas.height=Math.ceil(this.height*St),V(this,et,Ie).call(this)},Dt=new WeakSet,ps=function(Q,St){const Ot=V(this,lt,De).call(this),Rt=(Q-Ot)/t(this,u),Nt=(St-Ot)/t(this,P);this.scaleFactor=Math.min(Rt,Nt)},et=new WeakSet,Ie=function(){const Q=V(this,lt,De).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Q,this.translationY*this.scaleFactor+Q)},ut=new WeakSet,Ys=function(Q){const St=new Path2D;for(let Ot=0,Rt=Q.length;Ot<Rt;Ot++){const[Nt,Ut,Qt,At]=Q[Ot];Ot===0&&St.moveTo(...Nt),St.bezierCurveTo(Ut[0],Ut[1],Qt[0],Qt[1],At[0],At[1])}return St},Pt=new WeakSet,gs=function(Q,St,Ot){const[Rt,Nt,Ut,Qt]=St;switch(Ot){case 0:for(let At=0,Kt=Q.length;At<Kt;At+=2)Q[At]+=Rt,Q[At+1]=Qt-Q[At+1];break;case 90:for(let At=0,Kt=Q.length;At<Kt;At+=2){const Lt=Q[At];Q[At]=Q[At+1]+Rt,Q[At+1]=Lt+Nt}break;case 180:for(let At=0,Kt=Q.length;At<Kt;At+=2)Q[At]=Ut-Q[At],Q[At+1]+=Nt;break;case 270:for(let At=0,Kt=Q.length;At<Kt;At+=2){const Lt=Q[At];Q[At]=Ut-Q[At+1],Q[At+1]=Qt-Lt}break;default:throw new Error("Invalid rotation")}return Q},qt=new WeakSet,Ks=function(Q,St,Ot){const[Rt,Nt,Ut,Qt]=St;switch(Ot){case 0:for(let At=0,Kt=Q.length;At<Kt;At+=2)Q[At]-=Rt,Q[At+1]=Qt-Q[At+1];break;case 90:for(let At=0,Kt=Q.length;At<Kt;At+=2){const Lt=Q[At];Q[At]=Q[At+1]-Nt,Q[At+1]=Lt-Rt}break;case 180:for(let At=0,Kt=Q.length;At<Kt;At+=2)Q[At]=Ut-Q[At],Q[At+1]-=Nt;break;case 270:for(let At=0,Kt=Q.length;At<Kt;At+=2){const Lt=Q[At];Q[At]=Qt-Q[At+1],Q[At+1]=Ut-Lt}break;default:throw new Error("Invalid rotation")}return Q},Yt=new WeakSet,Js=function(Q,St,Ot,Rt){var Kt,Lt;const Nt=[],Ut=this.thickness/2,Qt=Q*St+Ut,At=Q*Ot+Ut;for(const N of this.paths){const s=[],y=[];for(let U=0,q=N.length;U<q;U++){const[J,rt,mt,Ct]=N[U],xt=Q*J[0]+Qt,zt=Q*J[1]+At,Mt=Q*rt[0]+Qt,It=Q*rt[1]+At,jt=Q*mt[0]+Qt,$t=Q*mt[1]+At,Jt=Q*Ct[0]+Qt,Zt=Q*Ct[1]+At;U===0&&(s.push(xt,zt),y.push(xt,zt)),s.push(Mt,It,jt,$t,Jt,Zt),y.push(Mt,It),U===q-1&&y.push(Jt,Zt)}Nt.push({bezier:V(Kt=bt,Pt,gs).call(Kt,s,Rt,this.rotation),points:V(Lt=bt,Pt,gs).call(Lt,y,Rt,this.rotation)})}return Nt},Gt=new WeakSet,ms=function(){let Q=1/0,St=-1/0,Ot=1/0,Rt=-1/0;for(const Nt of this.paths)for(const[Ut,Qt,At,Kt]of Nt){const Lt=c.Util.bezierBoundingBox(...Ut,...Qt,...At,...Kt);Q=Math.min(Q,Lt[0]),Ot=Math.min(Ot,Lt[1]),St=Math.max(St,Lt[2]),Rt=Math.max(Rt,Lt[3])}return[Q,Ot,St,Rt]},lt=new WeakSet,De=function(){return t(this,g)?Math.ceil(this.thickness*this.parentScale):0},$=new WeakSet,pe=function(Q=!1){if(this.isEmpty())return;if(!t(this,g)){V(this,H,ae).call(this);return}const St=V(this,Gt,ms).call(this),Ot=V(this,lt,De).call(this);nt(this,u,Math.max(p.AnnotationEditor.MIN_SIZE,St[2]-St[0])),nt(this,P,Math.max(p.AnnotationEditor.MIN_SIZE,St[3]-St[1]));const Rt=Math.ceil(Ot+t(this,u)*this.scaleFactor),Nt=Math.ceil(Ot+t(this,P)*this.scaleFactor),[Ut,Qt]=this.parentDimensions;this.width=Rt/Ut,this.height=Nt/Qt,this.setAspectRatio(Rt,Nt);const At=this.translationX,Kt=this.translationY;this.translationX=-St[0],this.translationY=-St[1],V(this,Bt,fe).call(this),V(this,H,ae).call(this),nt(this,w,Rt),nt(this,l,Nt),this.setDims(Rt,Nt);const Lt=Q?Ot/this.scaleFactor/2:0;this.translate(At-this.translationX-Lt,Kt-this.translationY-Lt)},B(bt,ut),B(bt,Pt),B(bt,qt),yt(bt,"_defaultColor",null),yt(bt,"_defaultOpacity",1),yt(bt,"_defaultThickness",1),yt(bt,"_type","ink");let D=bt;e.InkEditor=D},(z,e,j)=>{var D,P,u,L,_,d,m,b,g,S,C,ve,w,Se,a,Oe,A,_s,F,Qs,W,Zs,R,bs,at,Le,G,tn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var c=j(1),p=j(4),k=j(6),M=j(29);const gt=class gt extends p.AnnotationEditor{constructor(T){super({...T,name:"stampEditor"});B(this,C);B(this,w);B(this,a);B(this,A);B(this,F);B(this,W);B(this,R);B(this,at);B(this,G);B(this,D,null);B(this,P,null);B(this,u,null);B(this,L,null);B(this,_,null);B(this,d,null);B(this,m,null);B(this,b,null);B(this,g,!1);B(this,S,!1);nt(this,L,T.bitmapUrl),nt(this,_,T.bitmapFile)}static initialize(T){p.AnnotationEditor.initialize(T)}static get supportedTypes(){const T=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,c.shadow)(this,"supportedTypes",T.map(n=>`image/${n}`))}static get supportedTypesStr(){return(0,c.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(T){return this.supportedTypes.includes(T)}static paste(T,n){n.pasteEditor(c.AnnotationEditorType.STAMP,{bitmapFile:T.getAsFile()})}remove(){var T,n;t(this,P)&&(nt(this,D,null),this._uiManager.imageManager.deleteId(t(this,P)),(T=t(this,d))==null||T.remove(),nt(this,d,null),(n=t(this,m))==null||n.disconnect(),nt(this,m,null)),super.remove()}rebuild(){if(!this.parent){t(this,P)&&V(this,a,Oe).call(this);return}super.rebuild(),this.div!==null&&(t(this,P)&&V(this,a,Oe).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,u)||t(this,D)||t(this,L)||t(this,_))}get isResizable(){return!0}render(){if(this.div)return this.div;let T,n;if(this.width&&(T=this.x,n=this.y),super.render(),this.div.hidden=!0,t(this,D)?V(this,A,_s).call(this):V(this,a,Oe).call(this),this.width){const[r,i]=this.parentDimensions;this.setAt(T*r,n*i,this.width*r,this.height*i)}return this.div}static deserialize(T,n,r){if(T instanceof M.StampAnnotationElement)return null;const i=super.deserialize(T,n,r),{rect:h,bitmapUrl:f,bitmapId:E,isSvg:O,accessibilityData:H}=T;E&&r.imageManager.isValidId(E)?nt(i,P,E):nt(i,L,f),nt(i,g,O);const[it,st]=i.pageDimensions;return i.width=(h[2]-h[0])/it,i.height=(h[3]-h[1])/st,H&&(i.altTextData=H),i}serialize(T=!1,n=null){if(this.isEmpty())return null;const r={annotationType:c.AnnotationEditorType.STAMP,bitmapId:t(this,P),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,g),structTreeParentId:this._structTreeParentId};if(T)return r.bitmapUrl=V(this,at,Le).call(this,!0),r.accessibilityData=this.altTextData,r;const{decorative:i,altText:h}=this.altTextData;if(!i&&h&&(r.accessibilityData={type:"Figure",alt:h}),n===null)return r;n.stamps||(n.stamps=new Map);const f=t(this,g)?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!n.stamps.has(t(this,P)))n.stamps.set(t(this,P),{area:f,serialized:r}),r.bitmap=V(this,at,Le).call(this,!1);else if(t(this,g)){const E=n.stamps.get(t(this,P));f>E.area&&(E.area=f,E.serialized.bitmap.close(),E.serialized.bitmap=V(this,at,Le).call(this,!1))}return r}};D=new WeakMap,P=new WeakMap,u=new WeakMap,L=new WeakMap,_=new WeakMap,d=new WeakMap,m=new WeakMap,b=new WeakMap,g=new WeakMap,S=new WeakMap,C=new WeakSet,ve=function(T,n=!1){if(!T){this.remove();return}nt(this,D,T.bitmap),n||(nt(this,P,T.id),nt(this,g,T.isSvg)),V(this,A,_s).call(this)},w=new WeakSet,Se=function(){nt(this,u,null),this._uiManager.enableWaiting(!1),t(this,d)&&this.div.focus()},a=new WeakSet,Oe=function(){if(t(this,P)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,P)).then(n=>V(this,C,ve).call(this,n,!0)).finally(()=>V(this,w,Se).call(this));return}if(t(this,L)){const n=t(this,L);nt(this,L,null),this._uiManager.enableWaiting(!0),nt(this,u,this._uiManager.imageManager.getFromUrl(n).then(r=>V(this,C,ve).call(this,r)).finally(()=>V(this,w,Se).call(this)));return}if(t(this,_)){const n=t(this,_);nt(this,_,null),this._uiManager.enableWaiting(!0),nt(this,u,this._uiManager.imageManager.getFromFile(n).then(r=>V(this,C,ve).call(this,r)).finally(()=>V(this,w,Se).call(this)));return}const T=document.createElement("input");T.type="file",T.accept=gt.supportedTypesStr,nt(this,u,new Promise(n=>{T.addEventListener("change",async()=>{if(!T.files||T.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(T.files[0]);V(this,C,ve).call(this,r)}n()}),T.addEventListener("cancel",()=>{this.remove(),n()})}).finally(()=>V(this,w,Se).call(this))),T.click()},A=new WeakSet,_s=function(){const{div:T}=this;let{width:n,height:r}=t(this,D);const[i,h]=this.pageDimensions,f=.75;if(this.width)n=this.width*i,r=this.height*h;else if(n>f*i||r>f*h){const it=Math.min(f*i/n,f*h/r);n*=it,r*=it}const[E,O]=this.parentDimensions;this.setDims(n*E/i,r*O/h),this._uiManager.enableWaiting(!1);const H=nt(this,d,document.createElement("canvas"));T.append(H),T.hidden=!1,V(this,R,bs).call(this,n,r),V(this,G,tn).call(this),t(this,S)||(this.parent.addUndoableEditor(this),nt(this,S,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},F=new WeakSet,Qs=function(T,n){var f;const[r,i]=this.parentDimensions;this.width=T/r,this.height=n/i,this.setDims(T,n),(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,b)!==null&&clearTimeout(t(this,b)),nt(this,b,setTimeout(()=>{nt(this,b,null),V(this,R,bs).call(this,T,n)},200))},W=new WeakSet,Zs=function(T,n){const{width:r,height:i}=t(this,D);let h=r,f=i,E=t(this,D);for(;h>2*T||f>2*n;){const O=h,H=f;h>2*T&&(h=h>=16384?Math.floor(h/2)-1:Math.ceil(h/2)),f>2*n&&(f=f>=16384?Math.floor(f/2)-1:Math.ceil(f/2));const it=new OffscreenCanvas(h,f);it.getContext("2d").drawImage(E,0,0,O,H,0,0,h,f),E=it.transferToImageBitmap()}return E},R=new WeakSet,bs=function(T,n){T=Math.ceil(T),n=Math.ceil(n);const r=t(this,d);if(!r||r.width===T&&r.height===n)return;r.width=T,r.height=n;const i=t(this,g)?t(this,D):V(this,W,Zs).call(this,T,n),h=r.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(i,0,0,i.width,i.height,0,0,T,n)},at=new WeakSet,Le=function(T){if(T){if(t(this,g)){const i=this._uiManager.imageManager.getSvgUrl(t(this,P));if(i)return i}const n=document.createElement("canvas");return{width:n.width,height:n.height}=t(this,D),n.getContext("2d").drawImage(t(this,D),0,0),n.toDataURL()}if(t(this,g)){const[n,r]=this.pageDimensions,i=Math.round(this.width*n*k.PixelsPerInch.PDF_TO_CSS_UNITS),h=Math.round(this.height*r*k.PixelsPerInch.PDF_TO_CSS_UNITS),f=new OffscreenCanvas(i,h);return f.getContext("2d").drawImage(t(this,D),0,0,t(this,D).width,t(this,D).height,0,0,i,h),f.transferToImageBitmap()}return structuredClone(t(this,D))},G=new WeakSet,tn=function(){nt(this,m,new ResizeObserver(T=>{const n=T[0].contentRect;n.width&&n.height&&V(this,F,Qs).call(this,n.width,n.height)})),t(this,m).observe(this.div)},yt(gt,"_type","stamp");let X=gt;e.StampEditor=X}],__webpack_module_cache__={};function __w_pdfjs_require__(z){var e=__webpack_module_cache__[z];if(e!==void 0)return e.exports;var j=__webpack_module_cache__[z]={exports:{}};return __webpack_modules__[z](j,j.exports,__w_pdfjs_require__),j.exports}var __webpack_exports__={};return(()=>{var z=__webpack_exports__;Object.defineProperty(z,"__esModule",{value:!0}),Object.defineProperty(z,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(z,"AnnotationEditorLayer",{enumerable:!0,get:function(){return k.AnnotationEditorLayer}}),Object.defineProperty(z,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(z,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(z,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return M.AnnotationEditorUIManager}}),Object.defineProperty(z,"AnnotationLayer",{enumerable:!0,get:function(){return X.AnnotationLayer}}),Object.defineProperty(z,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(z,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(z,"DOMSVGFactory",{enumerable:!0,get:function(){return c.DOMSVGFactory}}),Object.defineProperty(z,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(z,"GlobalWorkerOptions",{enumerable:!0,get:function(){return D.GlobalWorkerOptions}}),Object.defineProperty(z,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(z,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(z,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(z,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(z,"PDFDataRangeTransport",{enumerable:!0,get:function(){return j.PDFDataRangeTransport}}),Object.defineProperty(z,"PDFDateString",{enumerable:!0,get:function(){return c.PDFDateString}}),Object.defineProperty(z,"PDFWorker",{enumerable:!0,get:function(){return j.PDFWorker}}),Object.defineProperty(z,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(z,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(z,"PixelsPerInch",{enumerable:!0,get:function(){return c.PixelsPerInch}}),Object.defineProperty(z,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(z,"RenderingCancelledException",{enumerable:!0,get:function(){return c.RenderingCancelledException}}),Object.defineProperty(z,"SVGGraphics",{enumerable:!0,get:function(){return j.SVGGraphics}}),Object.defineProperty(z,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(z,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(z,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(z,"XfaLayer",{enumerable:!0,get:function(){return P.XfaLayer}}),Object.defineProperty(z,"build",{enumerable:!0,get:function(){return j.build}}),Object.defineProperty(z,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(z,"getDocument",{enumerable:!0,get:function(){return j.getDocument}}),Object.defineProperty(z,"getFilenameFromUrl",{enumerable:!0,get:function(){return c.getFilenameFromUrl}}),Object.defineProperty(z,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return c.getPdfFilenameFromUrl}}),Object.defineProperty(z,"getXfaPageViewport",{enumerable:!0,get:function(){return c.getXfaPageViewport}}),Object.defineProperty(z,"isDataScheme",{enumerable:!0,get:function(){return c.isDataScheme}}),Object.defineProperty(z,"isPdfFile",{enumerable:!0,get:function(){return c.isPdfFile}}),Object.defineProperty(z,"loadScript",{enumerable:!0,get:function(){return c.loadScript}}),Object.defineProperty(z,"noContextMenu",{enumerable:!0,get:function(){return c.noContextMenu}}),Object.defineProperty(z,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(z,"renderTextLayer",{enumerable:!0,get:function(){return p.renderTextLayer}}),Object.defineProperty(z,"setLayerDimensions",{enumerable:!0,get:function(){return c.setLayerDimensions}}),Object.defineProperty(z,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(z,"updateTextLayer",{enumerable:!0,get:function(){return p.updateTextLayer}}),Object.defineProperty(z,"version",{enumerable:!0,get:function(){return j.version}});var e=__w_pdfjs_require__(1),j=__w_pdfjs_require__(2),c=__w_pdfjs_require__(6),p=__w_pdfjs_require__(26),k=__w_pdfjs_require__(27),M=__w_pdfjs_require__(5),X=__w_pdfjs_require__(29),D=__w_pdfjs_require__(14),P=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$2);var pdfExports=pdf$2.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdf$1=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);export{pdf$1 as p};
