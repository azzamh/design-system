const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/interact.min.CbIEsjER.js","assets/chunks/commonjsHelpers.BosuxZz1.js","assets/chunks/pdf.CNlMMU4B.js","assets/chunks/framework.Co3D4XSo.js"])))=>i.map(i=>d[i]);
import{I as m,r as k,am as de,a0 as H,Z as X,d as z,o as A,c as G,m as u,p as e,A as te,ac as j,K as C,w as W,b as le,f as J,t as ae,a as N,l as re,y as F,a3 as ue,n as he,ad as U,T as fe}from"./framework.Co3D4XSo.js";import{v as oe}from"./index.DWN7eogZ.js";import{i as pe,h as q}from"./index.A5tb8alD.js";import{P as ve,c as ge,d as we,e as ye,_ as me,g as xe}from"./use-idle.CEx3eMhF.js";import{_ as _e}from"./Heading.vue_vue_type_script_setup_true_lang.DL075bXY.js";/* empty css                                                */import{w as ie,a as se}from"./theme.CHaQIT2p.js";import{u as be}from"./use-loading.DmK5UKm-.js";import{u as Q,a as Pe}from"./index.NNm-e4lN.js";import{p as I,c as De,b as Ee,s as ee}from"./index.BMhYW6jJ.js";const Se=Symbol("DropzoneContext");function ke(t,h){const d=m(!0),o=m(),a=k(),l=k();async function f(){if(w(),t.value){const{default:y}=await X(async()=>{const{default:n}=await import("./interact.min.CbIEsjER.js").then(g=>g.i);return{default:n}},__vite__mapDeps([0,1]));y.dynamicDrop(!0),o.value=y(h.value,{context:t.value}).dropzone({accept:".pdf-object",overlap:.95,enabled:d.value,checker(n,g,L,T,$,p,c){var v;return L&&(((v=t.value)==null?void 0:v.contains(c))||c.classList.contains("pdf-object--external"))},ondragenter(n){l.value=n.target,n.target.classList.add("hover")},ondragleave(n){n.target.classList.remove("hover")},ondrop(n){l.value=n.target,a.value=n.target,n.target.classList.remove("hover")}})}}function w(){o.value&&o.value.unset()}return pe(t,y=>{y.some(g=>g.type==="childList"&&g.target.matches(h.value))&&f()},{subtree:!0,childList:!0}),de(()=>{w()}),H(Se,{dropzone:a,hoverzone:l}),d}const Le="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='595'%20height='842'%20aria-labelledby='loading-aria'%20preserveAspectRatio='none'%20role='img'%20viewBox='0%200%20595%20842'%3e%3ctitle%20id='loading-aria'%3eLoading...%3c/title%3e%3crect%20width='100%25'%20height='100%25'%20x='0'%20y='0'%20clip-path='url(%23clip-path)'%20style='fill:url(%23fill)'/%3e%3cdefs%3e%3cclipPath%20id='clip-path'%3e%3crect%20width='191'%20height='14'%20x='44'%20y='64'%20rx='2.068'/%3e%3crect%20width='140'%20height='14'%20x='44'%20y='94'%20rx='2.068'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='152'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='182'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='212'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='242'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='272'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='302'%20rx='7'/%3e%3crect%20width='349'%20height='14'%20x='44'%20y='332'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='390'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='420'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='450'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='480'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='510'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='540'%20rx='7'/%3e%3crect%20width='183'%20height='14'%20x='44'%20y='570'%20rx='7'/%3e%3crect%20width='191'%20height='14'%20x='360'%20y='628'%20rx='2.068'/%3e%3crect%20width='140'%20height='14'%20x='411'%20y='678'%20rx='2.068'/%3e%3crect%20width='191'%20height='14'%20x='44'%20y='64'%20rx='2.068'/%3e%3crect%20width='140'%20height='14'%20x='44'%20y='94'%20rx='2.068'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='152'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='182'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='212'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='242'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='272'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='302'%20rx='7'/%3e%3crect%20width='349'%20height='14'%20x='44'%20y='332'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='390'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='420'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='450'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='480'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='510'%20rx='7'/%3e%3crect%20width='507'%20height='14'%20x='44'%20y='540'%20rx='7'/%3e%3crect%20width='183'%20height='14'%20x='44'%20y='570'%20rx='7'/%3e%3crect%20width='191'%20height='14'%20x='360'%20y='628'%20rx='2.068'/%3e%3crect%20width='140'%20height='14'%20x='411'%20y='678'%20rx='2.068'/%3e%3c/clipPath%3e%3clinearGradient%20id='fill'%3e%3cstop%20offset='.6'%20stop-color='%23E7E7E8'%20stop-opacity='1'%3e%3canimate%20attributeName='offset'%20dur='2s'%20keyTimes='0;%200.25;%201'%20repeatCount='indefinite'%20values='-2;%20-2;%201'/%3e%3c/stop%3e%3cstop%20offset='1.6'%20stop-color='%23CFCFD1'%20stop-opacity='1'%3e%3canimate%20attributeName='offset'%20dur='2s'%20keyTimes='0;%200.25;%201'%20repeatCount='indefinite'%20values='-1;%20-1;%202'/%3e%3c/stop%3e%3cstop%20offset='2.6'%20stop-color='%23E7E7E8'%20stop-opacity='1'%3e%3canimate%20attributeName='offset'%20dur='2s'%20keyTimes='0;%200.25;%201'%20repeatCount='indefinite'%20values='0;%200;%203'/%3e%3c/stop%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",Te={"data-testid":"pdf-loading",class:"pdf__loading"},Ce=["src"],Ne=z({__name:"PdfLoading",setup(t){return(h,d)=>(A(),G("div",Te,[u("img",{src:e(Le),width:"793",height:"1122"},null,8,Ce)]))}});let B,V;async function Z(){if(!B){const t=await X(()=>import("./pdf.CNlMMU4B.js"),__vite__mapDeps([2,3]));typeof window<"u"&&"Worker"in window&&(t.GlobalWorkerOptions.workerSrc=ie(`pdfjs-dist@${t.version}/build/pdf.worker.min.mjs`,se())),B=t}return B}async function K(){return await Z(),V||(V=await X(()=>import("./pdf_viewer.Ce7pA8gB.js"),[])),V}async function Ve(...t){return await Z(),B.getDocument(...t)}async function $e(){return ie(`pdfjs-dist@${await ne()}/cmaps/`,se())}async function ne(){return await Z(),B.version}async function Oe(){return await K(),new V.EventBus}async function Re(...t){return await K(),new V.PDFViewer(...t)}async function je(...t){return await K(),new V.PDFLinkService(...t)}const Be={"data-testid":"pdf-error",class:"pdf__error"},Me={class:"mt-7"},Ie=u("dt",null,"URL:",-1),Fe={class:"truncate"},ze=["href"],Ae=u("dt",null," Reason: ",-1),Ge=u("dt",null," PDFJS Version: ",-1),Je=z({__name:"PdfError",props:{url:{type:String,default:""},error:{type:Object,default:()=>({})}},setup(t){const h=k("");return te(async()=>{h.value=await ne()}),(d,o)=>j((A(),G("div",Be,[C(_e,{element:"h3"},{default:W(()=>[le(" Failed to load PDF ")]),_:1}),u("dl",Me,[Ie,u("dd",Fe,[u("a",{href:t.url,target:"_blank"},[u("code",null,J(t.url),1)],8,ze)]),Ae,u("dd",null,[u("code",null,J(t.error.message),1)]),Ge,u("dd",null,[u("code",null,J(e(h)),1)])])])),[[e(oe),1122/793]])}}),Ue=z({__name:"PdfObjects",props:{dropTarget:{type:String,default:".pdfViewer > .page"}},setup(t){const h=t,d=new Map,o=k(),a=ge(),l=ae(h,"dropTarget");return ke(o,l),H(ve,{...a,objects:d,root:o}),(f,w)=>(A(),G("div",{ref_key:"root",ref:o,class:"pdf-objects","data-testid":"pdf-objects"},[N(f.$slots,"default")],512))}});function We(t,h){const d=m(),o=m(),a=m(),l=m(),f=m(),w=re(()=>{var r,s;return(s=(r=d.value)==null?void 0:r.numPages)!=null?s:0}),y=Q(1,.1,2),n=Q(1,1,Pe(w,1)),g=be(),L=m(!1),T=m(),$=I(),p=I(),c=I(),v=I();async function O(r,s,b={}){g.value=!0,T.value=void 0;try{await R(),r&&(l.value=await Ve({url:r,password:s,cMapUrl:await $e(),cMapPacked:!0,disableStream:b.disableStream,disableRange:b.disableRange,httpHeaders:b.httpHeaders}),l.value.onProgress=p.trigger,d.value=await l.value.promise,a.value.setDocument(d.value),f.value.setDocument(d.value),$.trigger(d.value))}catch(x){x instanceof Error&&(T.value=x,c.trigger(x))}finally{g.value=!1}}async function R(){var r,s;l.value&&!l.value.destroyed&&(await l.value.destroy(),d.value=void 0,l.value=void 0,(r=a.value)==null||r.setDocument(null),(s=f.value)==null||s.setDocument(null))}async function _(){if(typeof navigator<"u"&&t.value&&h.value){const r=await Oe();r.on("pagesinit",()=>{var x,M;const s=(M=(x=h.value)==null?void 0:x.clientWidth)!=null?M:0,b=s>0&&s<793;a.value.currentScaleValue=b?"page-width":"1",a.value.currentPageNumber=n.value,L.value=!0,v.trigger(a.value)}),r.on("pagechanging",s=>{n.value=s.pageNumber}),r.on("scalechanging",s=>{y.value=s.scale}),o.value=r,f.value=await je({eventBus:o.value}),a.value=await Re({container:t.value,viewer:h.value,eventBus:o.value,linkService:f.value,removePageBorders:!0,annotationEditorMode:-1}),f.value.setViewer(a.value)}}return F([t,h],async([r,s])=>{a.value?r&&s&&(a.value.container=r,a.value.viewer=s,d.value&&a.value.setDocument(d.value),a.value.update()):await _()}),F(n,r=>{a.value&&r!==a.value.currentPageNumber&&(a.value.currentPageNumber=r)}),F(y,r=>{a.value&&r!==a.value.currentScale&&(a.value.currentScale=r)}),ue(async()=>{var r;await R(),(r=a.value)==null||r.cleanup()}),{page:n,scale:y,totalPage:w,loading:g,error:T,ready:L,openDoc:O,closeDoc:R,pdfDoc:d,pdfEventBus:o,pdfViewer:a,pdfLoadingTask:l,pdfLinkService:f,onLoaded:$.on,onError:c.on,onReady:v.on,onLoading:p.on}}const He=["data-page","data-scale"],Xe={class:"pdf__header"},Ze={class:"pdf__footer"},st=z({__name:"PdfViewer",props:{src:{type:String,default:""},page:{type:Number,default:1},scale:{type:Number,default:1},password:{type:String,default:void 0},layout:{type:String,default:"fixed"},ratio:{type:[Number,String],default:210/297},offsetTop:{type:[Number,String],default:0},config:{type:[Object],default:()=>({})}},emits:["ready","loaded","loading","error","error-password","update:page","update:scale"],setup(t,{expose:h,emit:d}){const o=t,a=d,l=k(),f=k(),w=k(),y=we(f),n=q(o,"page"),g=q(o,"scale"),L=De(ae(o,"offsetTop"),{nanToZero:!0}),T=ye(l,{offsetTop:L}),$=re(()=>{const i=[];return o.layout&&i.push(`pdf-viewer--layout-${o.layout}`),i}),{page:p,scale:c,totalPage:v,openDoc:O,closeDoc:R,pdfDoc:_,loading:r,error:s,onLoaded:b,onError:x,onReady:M,onLoading:ce}=We(f,w);Ee(()=>[o.src,o.password],([i,Y])=>{O(i,Y,o.config)},{debounce:500}),F(()=>o.layout,i=>{T.value=i==="fit"},{immediate:!0}),te(async()=>{o.src&&O(o.src,o.password,o.config)}),b(i=>{a("loaded",i)}),x(i=>{i.name==="PasswordException"&&a("error-password",i),a("error",i)}),M(i=>{a("ready",i)}),ce(i=>{a("loading",i)});function P(){c.value=Math.round(c.value/.1)*.1+.1}function D(){c.value=Math.round(c.value/.1)*.1-.1}function E(){p.value++}function S(){p.value--}return H(xe,{page:p,scale:c,totalPage:v,zoomIn:P,zoomOut:D,next:E,prev:S}),ee(p,n),ee(c,g),h({page:p,scale:c,root:l,container:f,viewer:w,loading:r,totalPage:v,zoomIn:P,zoomOut:D,next:E,prev:S,openDoc:O,closeDoc:R}),(i,Y)=>j((A(),G("div",{ref_key:"root",ref:l,"data-testid":"pdf-viewer",class:he(["pdf",e($)]),"data-page":e(p),"data-scale":e(c)},[u("div",Xe,[N(i.$slots,"header",{page:e(p),scale:e(c),totalPage:e(v),zoomIn:P,zoomOut:D,next:E,prev:S,doc:e(_)})]),C(Ue,{class:"pdf__wrapper"},{default:W(()=>[u("div",{ref_key:"container",ref:f,class:"pdf__container pdfContainer"},[j(C(Ne,null,null,512),[[U,e(r)||!t.src]]),j(C(Je,{url:t.src,error:e(s)},null,8,["url","error"]),[[U,!e(r)&&e(s)]]),u("div",{ref_key:"viewer",ref:w,class:"pdf__viewer pdfViewer"},null,512),N(i.$slots,"default",{page:e(p),scale:e(c),totalPage:e(v),zoomIn:P,zoomOut:D,next:E,prev:S,doc:e(_)})],512),N(i.$slots,"container",{page:e(p),scale:e(c),totalPage:e(v),zoomIn:P,zoomOut:D,next:E,prev:S,doc:e(_)}),C(fe,{name:"slide-up"},{default:W(()=>[j(C(me,null,null,512),[[U,t.src&&!e(y)&&!e(r)&&!e(s)]])]),_:1}),N(i.$slots,"body",{page:e(p),scale:e(c),totalPage:e(v),zoomIn:P,zoomOut:D,next:E,prev:S,doc:e(_)})]),_:3}),u("div",Ze,[N(i.$slots,"footer",{page:e(p),scale:e(c),totalPage:e(v),zoomIn:P,zoomOut:D,next:E,prev:S,doc:e(_)})])],10,He)),[[e(oe),t.layout==="fixed"?Number(t.ratio):0]])}});export{Se as D,st as _};
