var h=Object.defineProperty;var d=(n,e,t)=>e in n?h(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var r=(n,e,t)=>(d(n,typeof e!="symbol"?e+"":e,t),t);import{t as g,af as q,a7 as m,d as p,ag as o,J as l,N as v}from"./framework.8f224ebd.js";class w{constructor(){r(this,"queue");r(this,"running");this.queue=[],this.running=!1}enqueue(e){this.queue.push(e)}dequeue(){return this.queue.shift()}async add(e){return await new Promise((t,a)=>{const s={resolve:t,reject:a,run:e};this.enqueue(s),this.run()})}run(){if(this.queue.length>0&&!this.running){this.running=!0;const e=this.dequeue();e.run().then(e.resolve).catch(e.reject).finally(()=>{this.running=!1,this.run()})}}}let u,i;const f=new w;async function y(n,e){if(u||(u=g(new Map)),!i){const a=document.createElement("div"),s=q({name:"GlobalContainer",render:()=>[...u.value.values()].map(c=>m(c.component,{ref:c.ref}))});document.body.append(a),s.mount(a),a.id="global",i=s}let t=u.value.get(n);return t||(t={component:e,ref:p()},u.value.set(n,t),o(u),await l()),v(t.ref)}async function b(n){u&&i&&(u.value.delete(n),o(u),await l())}async function N(n){return await f.add(()=>y(n,n))}async function P(n){return await f.add(()=>b(n))}export{P as r,N as u};
