var Ms=Object.defineProperty;var Ds=(pt,h,et)=>h in pt?Ms(pt,h,{enumerable:!0,configurable:!0,writable:!0,value:et}):pt[h]=et;var $t=(pt,h,et)=>(Ds(pt,typeof h!="symbol"?h+"":h,et),et),xe=(pt,h,et)=>{if(!h.has(pt))throw TypeError("Cannot "+et)};var s=(pt,h,et)=>(xe(pt,h,"read from private field"),et?et.call(pt):h.get(pt)),W=(pt,h,et)=>{if(h.has(pt))throw TypeError("Cannot add the same private member more than once");h instanceof WeakSet?h.add(pt):h.set(pt,et)},lt=(pt,h,et,c)=>(xe(pt,h,"write to private field"),c?c.call(pt,et):h.set(pt,et),et);var be=(pt,h,et,c)=>({set _(P){lt(pt,h,P,et)},get _(){return s(pt,h,c)}}),Q=(pt,h,et)=>(xe(pt,h,"access private method"),et);import{g as getDefaultExportFromCjs}from"./commonjsHelpers.de833af9.js";import{r as require$$0}from"./vite-browser-external_commonjs-proxy.0726eb50.js";function _mergeNamespaces(pt,h){for(var et=0;et<h.length;et++){const c=h[et];if(typeof c!="string"&&!Array.isArray(c)){for(const P in c)if(P!=="default"&&!(P in pt)){const Z=Object.getOwnPropertyDescriptor(c,P);Z&&Object.defineProperty(pt,P,Z.get?Z:{enumerable:!0,get:()=>c[P]})}}}return Object.freeze(Object.defineProperty(pt,Symbol.toStringTag,{value:"Module"}))}function commonjsRequire(pt){throw new Error('Could not dynamically require "'+pt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$2={exports:{}};(function(module,exports){(function(h,et){module.exports=et()})(globalThis,()=>(()=>{var __webpack_modules__=[,(pt,h)=>{var Ft;Object.defineProperty(h,"__esModule",{value:!0}),h.VerbosityLevel=h.Util=h.UnknownErrorException=h.UnexpectedResponseException=h.TextRenderingMode=h.RenderingIntentFlag=h.PromiseCapability=h.PermissionFlag=h.PasswordResponses=h.PasswordException=h.PageActionEventType=h.OPS=h.MissingPDFException=h.MAX_IMAGE_SIZE_TO_CACHE=h.LINE_FACTOR=h.LINE_DESCENT_FACTOR=h.InvalidPDFException=h.ImageKind=h.IDENTITY_MATRIX=h.FormatError=h.FeatureTest=h.FONT_IDENTITY_MATRIX=h.DocumentActionEventType=h.CMapCompressionType=h.BaseException=h.BASELINE_FACTOR=h.AnnotationType=h.AnnotationReplyType=h.AnnotationMode=h.AnnotationFlag=h.AnnotationFieldFlag=h.AnnotationEditorType=h.AnnotationEditorPrefix=h.AnnotationEditorParamsType=h.AnnotationBorderStyleType=h.AnnotationActionEventType=h.AbortException=void 0,h.assert=q,h.bytesToString=B,h.createValidAbsoluteUrl=St,h.getModificationDate=mt,h.getVerbosityLevel=w,h.info=G,h.isArrayBuffer=z,h.isArrayEqual=ut,h.normalizeUnicode=jt,h.objectFromMap=rt,h.objectSize=nt,h.setVerbosityLevel=X,h.shadow=vt,h.string32=Y,h.stringToBytes=H,h.stringToPDFString=Tt,h.stringToUTF8String=bt,h.unreachable=ht,h.utf8StringToString=J,h.warn=it;const et=[1,0,0,1,0,0];h.IDENTITY_MATRIX=et;const c=[.001,0,0,.001,0,0];h.FONT_IDENTITY_MATRIX=c;const P=1e7;h.MAX_IMAGE_SIZE_TO_CACHE=P;const Z=1.35;h.LINE_FACTOR=Z;const V=.35;h.LINE_DESCENT_FACTOR=V;const ot=V/Z;h.BASELINE_FACTOR=ot;const tt={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};h.RenderingIntentFlag=tt;const x={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};h.AnnotationMode=x;const f="pdfjs_internal_editor_";h.AnnotationEditorPrefix=f;const M={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};h.AnnotationEditorType=M;const N={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};h.AnnotationEditorParamsType=N;const y={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};h.PermissionFlag=y;const D={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};h.TextRenderingMode=D;const r={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};h.ImageKind=r;const g={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};h.AnnotationType=g;const A={GROUP:"Group",REPLY:"R"};h.AnnotationReplyType=A;const S={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};h.AnnotationFlag=S;const m={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};h.AnnotationFieldFlag=m;const d={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};h.AnnotationBorderStyleType=d;const E={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};h.AnnotationActionEventType=E;const n={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};h.DocumentActionEventType=n;const t={O:"PageOpen",C:"PageClose"};h.PageActionEventType=t;const e={ERRORS:0,WARNINGS:1,INFOS:5};h.VerbosityLevel=e;const l={NONE:0,BINARY:1};h.CMapCompressionType=l;const p={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};h.OPS=p;const F={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};h.PasswordResponses=F;let O=e.WARNINGS;function X(v){Number.isInteger(v)&&(O=v)}function w(){return O}function G(v){O>=e.INFOS&&console.log(`Info: ${v}`)}function it(v){O>=e.WARNINGS&&console.log(`Warning: ${v}`)}function ht(v){throw new Error(v)}function q(v,C){v||ht(C)}function st(v){switch(v==null?void 0:v.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function St(v,C=null,L=null){if(!v)return null;try{if(L&&typeof v=="string"){if(L.addDefaultProtocol&&v.startsWith("www.")){const kt=v.match(/\./g);(kt==null?void 0:kt.length)>=2&&(v=`http://${v}`)}if(L.tryConvertEncoding)try{v=bt(v)}catch(kt){}}const at=C?new URL(v,C):new URL(v);if(st(at))return at}catch(at){}return null}function vt(v,C,L,at=!1){return Object.defineProperty(v,C,{value:L,enumerable:!at,configurable:!0,writable:!1}),L}const yt=function(){function C(L,at){this.constructor===C&&ht("Cannot initialize BaseException."),this.message=L,this.name=at}return C.prototype=new Error,C.constructor=C,C}();h.BaseException=yt;class Dt extends yt{constructor(C,L){super(C,"PasswordException"),this.code=L}}h.PasswordException=Dt;class j extends yt{constructor(C,L){super(C,"UnknownErrorException"),this.details=L}}h.UnknownErrorException=j;class o extends yt{constructor(C){super(C,"InvalidPDFException")}}h.InvalidPDFException=o;class a extends yt{constructor(C){super(C,"MissingPDFException")}}h.MissingPDFException=a;class _ extends yt{constructor(C,L){super(C,"UnexpectedResponseException"),this.status=L}}h.UnexpectedResponseException=_;class R extends yt{constructor(C){super(C,"FormatError")}}h.FormatError=R;class I extends yt{constructor(C){super(C,"AbortException")}}h.AbortException=I;function B(v){(typeof v!="object"||(v==null?void 0:v.length)===void 0)&&ht("Invalid argument for bytesToString");const C=v.length,L=8192;if(C<L)return String.fromCharCode.apply(null,v);const at=[];for(let kt=0;kt<C;kt+=L){const Lt=Math.min(kt+L,C),Ut=v.subarray(kt,Lt);at.push(String.fromCharCode.apply(null,Ut))}return at.join("")}function H(v){typeof v!="string"&&ht("Invalid argument for stringToBytes");const C=v.length,L=new Uint8Array(C);for(let at=0;at<C;++at)L[at]=v.charCodeAt(at)&255;return L}function Y(v){return String.fromCharCode(v>>24&255,v>>16&255,v>>8&255,v&255)}function nt(v){return Object.keys(v).length}function rt(v){const C=Object.create(null);for(const[L,at]of v)C[L]=at;return C}function ct(){const v=new Uint8Array(4);return v[0]=1,new Uint32Array(v.buffer,0,1)[0]===1}function dt(){try{return new Function(""),!0}catch(v){return!1}}class Et{static get isLittleEndian(){return vt(this,"isLittleEndian",ct())}static get isEvalSupported(){return vt(this,"isEvalSupported",dt())}static get isOffscreenCanvasSupported(){return vt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?vt(this,"platform",{isWin:!1,isMac:!1}):vt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}h.FeatureTest=Et;const ft=[...Array(256).keys()].map(v=>v.toString(16).padStart(2,"0"));class xt{static makeHexColor(C,L,at){return`#${ft[C]}${ft[L]}${ft[at]}`}static scaleMinMax(C,L){let at;C[0]?(C[0]<0&&(at=L[0],L[0]=L[1],L[1]=at),L[0]*=C[0],L[1]*=C[0],C[3]<0&&(at=L[2],L[2]=L[3],L[3]=at),L[2]*=C[3],L[3]*=C[3]):(at=L[0],L[0]=L[2],L[2]=at,at=L[1],L[1]=L[3],L[3]=at,C[1]<0&&(at=L[2],L[2]=L[3],L[3]=at),L[2]*=C[1],L[3]*=C[1],C[2]<0&&(at=L[0],L[0]=L[1],L[1]=at),L[0]*=C[2],L[1]*=C[2]),L[0]+=C[4],L[1]+=C[4],L[2]+=C[5],L[3]+=C[5]}static transform(C,L){return[C[0]*L[0]+C[2]*L[1],C[1]*L[0]+C[3]*L[1],C[0]*L[2]+C[2]*L[3],C[1]*L[2]+C[3]*L[3],C[0]*L[4]+C[2]*L[5]+C[4],C[1]*L[4]+C[3]*L[5]+C[5]]}static applyTransform(C,L){const at=C[0]*L[0]+C[1]*L[2]+L[4],kt=C[0]*L[1]+C[1]*L[3]+L[5];return[at,kt]}static applyInverseTransform(C,L){const at=L[0]*L[3]-L[1]*L[2],kt=(C[0]*L[3]-C[1]*L[2]+L[2]*L[5]-L[4]*L[3])/at,Lt=(-C[0]*L[1]+C[1]*L[0]+L[4]*L[1]-L[5]*L[0])/at;return[kt,Lt]}static getAxialAlignedBoundingBox(C,L){const at=this.applyTransform(C,L),kt=this.applyTransform(C.slice(2,4),L),Lt=this.applyTransform([C[0],C[3]],L),Ut=this.applyTransform([C[2],C[1]],L);return[Math.min(at[0],kt[0],Lt[0],Ut[0]),Math.min(at[1],kt[1],Lt[1],Ut[1]),Math.max(at[0],kt[0],Lt[0],Ut[0]),Math.max(at[1],kt[1],Lt[1],Ut[1])]}static inverseTransform(C){const L=C[0]*C[3]-C[1]*C[2];return[C[3]/L,-C[1]/L,-C[2]/L,C[0]/L,(C[2]*C[5]-C[4]*C[3])/L,(C[4]*C[1]-C[5]*C[0])/L]}static singularValueDecompose2dScale(C){const L=[C[0],C[2],C[1],C[3]],at=C[0]*L[0]+C[1]*L[2],kt=C[0]*L[1]+C[1]*L[3],Lt=C[2]*L[0]+C[3]*L[2],Ut=C[2]*L[1]+C[3]*L[3],Wt=(at+Ut)/2,Jt=Math.sqrt((at+Ut)**2-4*(at*Ut-Lt*kt))/2,Xt=Wt+Jt||1,Yt=Wt-Jt||1;return[Math.sqrt(Xt),Math.sqrt(Yt)]}static normalizeRect(C){const L=C.slice(0);return C[0]>C[2]&&(L[0]=C[2],L[2]=C[0]),C[1]>C[3]&&(L[1]=C[3],L[3]=C[1]),L}static intersect(C,L){const at=Math.max(Math.min(C[0],C[2]),Math.min(L[0],L[2])),kt=Math.min(Math.max(C[0],C[2]),Math.max(L[0],L[2]));if(at>kt)return null;const Lt=Math.max(Math.min(C[1],C[3]),Math.min(L[1],L[3])),Ut=Math.min(Math.max(C[1],C[3]),Math.max(L[1],L[3]));return Lt>Ut?null:[at,Lt,kt,Ut]}static bezierBoundingBox(C,L,at,kt,Lt,Ut,Wt,Jt){const Xt=[],Yt=[[],[]];let Mt,T,u,i,b,k,U,K;for(let Ct=0;Ct<2;++Ct){if(Ct===0?(T=6*C-12*at+6*Lt,Mt=-3*C+9*at-9*Lt+3*Wt,u=3*at-3*C):(T=6*L-12*kt+6*Ut,Mt=-3*L+9*kt-9*Ut+3*Jt,u=3*kt-3*L),Math.abs(Mt)<1e-12){if(Math.abs(T)<1e-12)continue;i=-u/T,0<i&&i<1&&Xt.push(i);continue}U=T*T-4*u*Mt,K=Math.sqrt(U),!(U<0)&&(b=(-T+K)/(2*Mt),0<b&&b<1&&Xt.push(b),k=(-T-K)/(2*Mt),0<k&&k<1&&Xt.push(k))}let gt=Xt.length,_t;const $=gt;for(;gt--;)i=Xt[gt],_t=1-i,Yt[0][gt]=_t*_t*_t*C+3*_t*_t*i*at+3*_t*i*i*Lt+i*i*i*Wt,Yt[1][gt]=_t*_t*_t*L+3*_t*_t*i*kt+3*_t*i*i*Ut+i*i*i*Jt;return Yt[0][$]=C,Yt[1][$]=L,Yt[0][$+1]=Wt,Yt[1][$+1]=Jt,Yt[0].length=Yt[1].length=$+2,[Math.min(...Yt[0]),Math.min(...Yt[1]),Math.max(...Yt[0]),Math.max(...Yt[1])]}}h.Util=xt;const It=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Tt(v){if(v[0]>="ï"){let L;if(v[0]==="þ"&&v[1]==="ÿ"?L="utf-16be":v[0]==="ÿ"&&v[1]==="þ"?L="utf-16le":v[0]==="ï"&&v[1]==="»"&&v[2]==="¿"&&(L="utf-8"),L)try{const at=new TextDecoder(L,{fatal:!0}),kt=H(v);return at.decode(kt)}catch(at){it(`stringToPDFString: "${at}".`)}}const C=[];for(let L=0,at=v.length;L<at;L++){const kt=It[v.charCodeAt(L)];C.push(kt?String.fromCharCode(kt):v.charAt(L))}return C.join("")}function bt(v){return decodeURIComponent(escape(v))}function J(v){return unescape(encodeURIComponent(v))}function z(v){return typeof v=="object"&&(v==null?void 0:v.byteLength)!==void 0}function ut(v,C){if(v.length!==C.length)return!1;for(let L=0,at=v.length;L<at;L++)if(v[L]!==C[L])return!1;return!0}function mt(v=new Date){return[v.getUTCFullYear().toString(),(v.getUTCMonth()+1).toString().padStart(2,"0"),v.getUTCDate().toString().padStart(2,"0"),v.getUTCHours().toString().padStart(2,"0"),v.getUTCMinutes().toString().padStart(2,"0"),v.getUTCSeconds().toString().padStart(2,"0")].join("")}class wt{constructor(){W(this,Ft,!1);this.promise=new Promise((C,L)=>{this.resolve=at=>{lt(this,Ft,!0),C(at)},this.reject=at=>{lt(this,Ft,!0),L(at)}})}get settled(){return s(this,Ft)}}Ft=new WeakMap,h.PromiseCapability=wt;let Rt=null,Nt=null;function jt(v){return Rt||(Rt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Nt=new Map([["ﬅ","ſt"]])),v.replaceAll(Rt,(C,L,at)=>L?L.normalize("NFKC"):Nt.get(at))}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var pt,et,c,P,ne,V,_e,tt,x,f,M,N,y,D,r,ke,A,S,Fe,d,E;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_is_node.isNodeJS?__w_pdfjs_require__(20).NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_is_node.isNodeJS?__w_pdfjs_require__(20).NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_is_node.isNodeJS?__w_pdfjs_require__(20).NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_is_node.isNodeJS?__w_pdfjs_require__(20).NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:t}=__w_pdfjs_require__(21);createPDFNetworkStream=e=>new t(e)}else{const{PDFNetworkStream:t}=__w_pdfjs_require__(24),{PDFFetchStream:e}=__w_pdfjs_require__(25);createPDFNetworkStream=l=>(0,_display_utils.isValidFetchUrl)(l.url)?new e(l):new t(l)}function getDocument(t){var wt,Rt;if(typeof t=="string"||t instanceof URL?t={url:t}:(0,_util.isArrayBuffer)(t)&&(t={data:t}),typeof t!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!t.url&&!t.data&&!t.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const e=new PDFDocumentLoadingTask,{docId:l}=e,p=t.url?getUrlProp(t.url):null,F=t.data?getDataProp(t.data):null,O=t.httpHeaders||null,X=t.withCredentials===!0,w=(wt=t.password)!=null?wt:null,G=t.range instanceof PDFDataRangeTransport?t.range:null,it=Number.isInteger(t.rangeChunkSize)&&t.rangeChunkSize>0?t.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let ht=t.worker instanceof PDFWorker?t.worker:null;const q=t.verbosity,st=typeof t.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(t.docBaseUrl)?t.docBaseUrl:null,St=typeof t.cMapUrl=="string"?t.cMapUrl:null,vt=t.cMapPacked!==!1,yt=t.CMapReaderFactory||DefaultCMapReaderFactory,Dt=typeof t.standardFontDataUrl=="string"?t.standardFontDataUrl:null,j=t.StandardFontDataFactory||DefaultStandardFontDataFactory,o=t.stopAtErrors!==!0,a=Number.isInteger(t.maxImageSize)&&t.maxImageSize>-1?t.maxImageSize:-1,_=t.isEvalSupported!==!1,R=typeof t.isOffscreenCanvasSupported=="boolean"?t.isOffscreenCanvasSupported:!_is_node.isNodeJS,I=Number.isInteger(t.canvasMaxAreaInBytes)?t.canvasMaxAreaInBytes:-1,B=typeof t.disableFontFace=="boolean"?t.disableFontFace:_is_node.isNodeJS,H=t.fontExtraProperties===!0,Y=t.enableXfa===!0,nt=t.ownerDocument||globalThis.document,rt=t.disableRange===!0,ct=t.disableStream===!0,dt=t.disableAutoFetch===!0,Et=t.pdfBug===!0,ft=G?G.length:(Rt=t.length)!=null?Rt:NaN,xt=typeof t.useSystemFonts=="boolean"?t.useSystemFonts:!_is_node.isNodeJS&&!B,It=typeof t.useWorkerFetch=="boolean"?t.useWorkerFetch:yt===_display_utils.DOMCMapReaderFactory&&j===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(St,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(Dt,document.baseURI),Tt=t.canvasFactory||new DefaultCanvasFactory({ownerDocument:nt}),bt=t.filterFactory||new DefaultFilterFactory({docId:l,ownerDocument:nt}),J=null;(0,_util.setVerbosityLevel)(q);const z={canvasFactory:Tt,filterFactory:bt};if(It||(z.cMapReaderFactory=new yt({baseUrl:St,isCompressed:vt}),z.standardFontDataFactory=new j({baseUrl:Dt})),!ht){const Nt={verbosity:q,port:_worker_options.GlobalWorkerOptions.workerPort};ht=Nt.port?PDFWorker.fromPort(Nt):new PDFWorker(Nt),e._worker=ht}const ut={docId:l,apiVersion:"3.8.162",data:F,password:w,disableAutoFetch:dt,rangeChunkSize:it,length:ft,docBaseUrl:st,enableXfa:Y,evaluatorOptions:{maxImageSize:a,disableFontFace:B,ignoreErrors:o,isEvalSupported:_,isOffscreenCanvasSupported:R,canvasMaxAreaInBytes:I,fontExtraProperties:H,useSystemFonts:xt,cMapUrl:It?St:null,standardFontDataUrl:It?Dt:null}},mt={ignoreErrors:o,isEvalSupported:_,disableFontFace:B,fontExtraProperties:H,enableXfa:Y,ownerDocument:nt,disableAutoFetch:dt,pdfBug:Et,styleElement:J};return ht.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const Nt=_fetchDocument(ht,ut),jt=new Promise(function(Ft){let v;G?v=new _transport_stream.PDFDataTransportStream({length:ft,initialData:G.initialData,progressiveDone:G.progressiveDone,contentDispositionFilename:G.contentDispositionFilename,disableRange:rt,disableStream:ct},G):F||(v=createPDFNetworkStream({url:p,length:ft,httpHeaders:O,withCredentials:X,rangeChunkSize:it,disableRange:rt,disableStream:ct})),Ft(v)});return Promise.all([Nt,jt]).then(function([Ft,v]){if(e.destroyed)throw new Error("Loading aborted");const C=new _message_handler.MessageHandler(l,Ft,ht.port),L=new WorkerTransport(C,e,v,mt,z);e._transport=L,C.send("Ready",null)})}).catch(e._capability.reject),e}async function _fetchDocument(t,e){if(t.destroyed)throw new Error("Worker was destroyed");const l=await t.messageHandler.sendWithPromise("GetDocRequest",e,e.data?[e.data.buffer]:null);if(t.destroyed)throw new Error("Worker was destroyed");return l}function getUrlProp(t){if(t instanceof URL)return t.href;try{return new URL(t,window.location).href}catch(e){if(_is_node.isNodeJS&&typeof t=="string")return t}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(t){if(_is_node.isNodeJS&&typeof Buffer<"u"&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if(typeof t=="string")return(0,_util.stringToBytes)(t);if(typeof t=="object"&&!isNaN(t==null?void 0:t.length)||(0,_util.isArrayBuffer)(t))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const h=class h{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${be(h,pt)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e;this.destroyed=!0,await((e=this._transport)==null?void 0:e.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};pt=new WeakMap,W(h,pt,0);let PDFDocumentLoadingTask=h;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,l,p=!1,F=null){this.length=e,this.initialData=l,this.progressiveDone=p,this.contentDispositionFilename=F,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,l){for(const p of this._rangeListeners)p(e,l)}onDataProgress(e,l){this._readyCapability.promise.then(()=>{for(const p of this._progressListeners)p(e,l)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const l of this._progressiveReadListeners)l(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,l){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,l){this._pdfInfo=e,this._transport=l}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,l,p,F=!1){W(this,P);W(this,V);W(this,et,null);W(this,c,!1);this._pageIndex=e,this._pageInfo=l,this._transport=p,this._stats=F?new _display_utils.StatTimer:null,this._pdfBug=F,this.commonObjs=p.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:l=this.rotate,offsetX:p=0,offsetY:F=0,dontFlip:O=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:l,offsetX:p,offsetY:F,dontFlip:O})}getAnnotations({intent:e="display"}={}){const l=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,l.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:l,intent:p="display",annotationMode:F=_util.AnnotationMode.ENABLE,transform:O=null,background:X=null,optionalContentConfigPromise:w=null,annotationCanvasMap:G=null,pageColors:it=null,printAnnotationStorage:ht=null}){var j,o;(j=this._stats)==null||j.time("Overall");const q=this._transport.getRenderingIntent(p,F,ht);lt(this,c,!1),Q(this,V,_e).call(this),w||(w=this._transport.getOptionalContentConfig());let st=this._intentStates.get(q.cacheKey);st||(st=Object.create(null),this._intentStates.set(q.cacheKey,st)),st.streamReaderCancelTimeout&&(clearTimeout(st.streamReaderCancelTimeout),st.streamReaderCancelTimeout=null);const St=!!(q.renderingIntent&_util.RenderingIntentFlag.PRINT);st.displayReadyCapability||(st.displayReadyCapability=new _util.PromiseCapability,st.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(o=this._stats)==null||o.time("Page Request"),this._pumpOperatorList(q));const vt=a=>{var _,R;st.renderTasks.delete(yt),(this._maybeCleanupAfterRender||St)&&lt(this,c,!0),Q(this,P,ne).call(this,!St),a?(yt.capability.reject(a),this._abortOperatorList({intentState:st,reason:a instanceof Error?a:new Error(a)})):yt.capability.resolve(),(_=this._stats)==null||_.timeEnd("Rendering"),(R=this._stats)==null||R.timeEnd("Overall")},yt=new InternalRenderTask({callback:vt,params:{canvasContext:e,viewport:l,transform:O,background:X},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:G,operatorList:st.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!St,pdfBug:this._pdfBug,pageColors:it});(st.renderTasks||(st.renderTasks=new Set)).add(yt);const Dt=yt.task;return Promise.all([st.displayReadyCapability.promise,w]).then(([a,_])=>{var R;if(this.destroyed){vt();return}(R=this._stats)==null||R.time("Rendering"),yt.initializeGraphics({transparency:a,optionalContentConfig:_}),yt.operatorListChanged()}).catch(vt),Dt}getOperatorList({intent:e="display",annotationMode:l=_util.AnnotationMode.ENABLE,printAnnotationStorage:p=null}={}){var G;function F(){X.operatorList.lastChunk&&(X.opListReadCapability.resolve(X.operatorList),X.renderTasks.delete(w))}const O=this._transport.getRenderingIntent(e,l,p,!0);let X=this._intentStates.get(O.cacheKey);X||(X=Object.create(null),this._intentStates.set(O.cacheKey,X));let w;return X.opListReadCapability||(w=Object.create(null),w.operatorListChanged=F,X.opListReadCapability=new _util.PromiseCapability,(X.renderTasks||(X.renderTasks=new Set)).add(w),X.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(G=this._stats)==null||G.time("Page Request"),this._pumpOperatorList(O)),X.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:l=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:l===!0},{highWaterMark:100,size(F){return F.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(p=>_xfa_text.XfaText.textContent(p));const l=this.streamTextContent(e);return new Promise(function(p,F){function O(){X.read().then(function({value:G,done:it}){if(it){p(w);return}Object.assign(w.styles,G.styles),w.items.push(...G.items),O()},F)}const X=l.getReader(),w={items:[],styles:Object.create(null)};O()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const l of this._intentStates.values())if(this._abortOperatorList({intentState:l,reason:new Error("Page was destroyed."),force:!0}),!l.opListReadCapability)for(const p of l.renderTasks)e.push(p.completed),p.cancel();return this.objs.clear(),lt(this,c,!1),Q(this,V,_e).call(this),Promise.all(e)}cleanup(e=!1){lt(this,c,!0);const l=Q(this,P,ne).call(this,!1);return e&&l&&this._stats&&(this._stats=new _display_utils.StatTimer),l}_startRenderPage(e,l){var F,O;const p=this._intentStates.get(l);p&&((F=this._stats)==null||F.timeEnd("Page Request"),(O=p.displayReadyCapability)==null||O.resolve(e))}_renderPageChunk(e,l){for(let p=0,F=e.length;p<F;p++)l.operatorList.fnArray.push(e.fnArray[p]),l.operatorList.argsArray.push(e.argsArray[p]);l.operatorList.lastChunk=e.lastChunk,l.operatorList.separateAnnots=e.separateAnnots;for(const p of l.renderTasks)p.operatorListChanged();e.lastChunk&&Q(this,P,ne).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:l,annotationStorageSerializable:p}){const{map:F,transfers:O}=p,w=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:l,annotationStorage:F},O).getReader(),G=this._intentStates.get(l);G.streamReader=w;const it=()=>{w.read().then(({value:ht,done:q})=>{if(q){G.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(ht,G),it())},ht=>{if(G.streamReader=null,!this._transport.destroyed){if(G.operatorList){G.operatorList.lastChunk=!0;for(const q of G.renderTasks)q.operatorListChanged();Q(this,P,ne).call(this,!0)}if(G.displayReadyCapability)G.displayReadyCapability.reject(ht);else if(G.opListReadCapability)G.opListReadCapability.reject(ht);else throw ht}})};it()}_abortOperatorList({intentState:e,reason:l,force:p=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!p){if(e.renderTasks.size>0)return;if(l instanceof _display_utils.RenderingCancelledException){let F=RENDERING_CANCELLED_TIMEOUT;l.extraDelay>0&&l.extraDelay<1e3&&(F+=l.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:l,force:!0})},F);return}}if(e.streamReader.cancel(new _util.AbortException(l.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[F,O]of this._intentStates)if(O===e){this._intentStates.delete(F);break}this.cleanup()}}}get stats(){return this._stats}}et=new WeakMap,c=new WeakMap,P=new WeakSet,ne=function(e=!1){if(Q(this,V,_e).call(this),!s(this,c)||this.destroyed)return!1;if(e)return lt(this,et,setTimeout(()=>{lt(this,et,null),Q(this,P,ne).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:l,operatorList:p}of this._intentStates.values())if(l.size>0||!p.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),lt(this,c,!1),!0},V=new WeakSet,_e=function(){s(this,et)&&(clearTimeout(s(this,et)),lt(this,et,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){W(this,tt,new Set);W(this,x,Promise.resolve())}postMessage(e,l){const p={data:structuredClone(e,l?{transfer:l}:null)};s(this,x).then(()=>{for(const F of s(this,tt))F.call(this,p)})}addEventListener(e,l){s(this,tt).add(l)}removeEventListener(e,l){s(this,tt).delete(l)}terminate(){s(this,tt).clear()}}tt=new WeakMap,x=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const t=(f=document==null?void 0:document.currentScript)==null?void 0:f.src;t&&(PDFWorkerUtil.fallbackWorkerSrc=t.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(t,e){let l;try{if(l=new URL(t),!l.origin||l.origin==="null")return!1}catch(F){return!1}const p=new URL(e,l);return l.origin===p.origin},PDFWorkerUtil.createCDNWrapper=function(t){const e=`importScripts("${t}");`;return URL.createObjectURL(new Blob([e]))}}const _PDFWorker=class _PDFWorker{constructor({name:t=null,port:e=null,verbosity:l=(0,_util.getVerbosityLevel)()}={}){if(e&&s(_PDFWorker,M).has(e))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=t,this.destroyed=!1,this.verbosity=l,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,e){s(_PDFWorker,M).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new _message_handler.MessageHandler("main","worker",t),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:t}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,t)||(t=PDFWorkerUtil.createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t),l=new _message_handler.MessageHandler("main","worker",e),p=()=>{e.removeEventListener("error",F),l.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},F=()=>{this._webWorker||p()};e.addEventListener("error",F),l.on("test",X=>{if(e.removeEventListener("error",F),this.destroyed){p();return}X?(this._messageHandler=l,this._port=e,this._webWorker=e,this._readyCapability.resolve(),l.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),l.destroy(),e.terminate())}),l.on("ready",X=>{if(e.removeEventListener("error",F),this.destroyed){p();return}try{O()}catch(w){this._setupFakeWorker()}});const O=()=>{const X=new Uint8Array;l.send("test",X,[X.buffer])};O();return}catch(e){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const l=`fake${PDFWorkerUtil.fakeWorkerId++}`,p=new _message_handler.MessageHandler(l+"_worker",l,e);t.setup(p,e);const F=new _message_handler.MessageHandler(l,l+"_worker",e);this._messageHandler=F,this._readyCapability.resolve(),F.send("configure",{verbosity:this.verbosity})}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),s(_PDFWorker,M).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return s(this,M).has(t.port)?s(this,M).get(t.port):new _PDFWorker(t)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch(e){return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};M=new WeakMap,W(_PDFWorker,M,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(e,l,p,F,O){W(this,r);W(this,N,new Map);W(this,y,new Map);W(this,D,new Map);this.messageHandler=e,this.loadingTask=l,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:F.ownerDocument,styleElement:F.styleElement}),this._params=F,this.canvasFactory=O.canvasFactory,this.filterFactory=O.filterFactory,this.cMapReaderFactory=O.cMapReaderFactory,this.standardFontDataFactory=O.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=p,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(e,l=_util.AnnotationMode.ENABLE,p=null,F=!1){let O=_util.RenderingIntentFlag.DISPLAY,X=_annotation_storage.SerializableEmpty;switch(e){case"any":O=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":O=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(l){case _util.AnnotationMode.DISABLE:O+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:O+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:O+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,X=(O&_util.RenderingIntentFlag.PRINT&&p instanceof _annotation_storage.PrintAnnotationStorage?p:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${l}`)}return F&&(O+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:O,cacheKey:`${O}_${X.hash}`,annotationStorageSerializable:X}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const p of s(this,y).values())e.push(p._destroy());s(this,y).clear(),s(this,D).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const l=this.messageHandler.sendWithPromise("Terminate",null);return e.push(l),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),s(this,N).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:l}=this;e.on("GetReader",(p,F)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=O=>{this._lastProgress={loaded:O.loaded,total:O.total}},F.onPull=()=>{this._fullReader.read().then(function({value:O,done:X}){if(X){F.close();return}(0,_util.assert)(O instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),F.enqueue(new Uint8Array(O),1,[O])}).catch(O=>{F.error(O)})},F.onCancel=O=>{this._fullReader.cancel(O),F.ready.catch(X=>{if(!this.destroyed)throw X})}}),e.on("ReaderHeadersReady",p=>{const F=new _util.PromiseCapability,O=this._fullReader;return O.headersReady.then(()=>{var X;(!O.isStreamingSupported||!O.isRangeSupported)&&(this._lastProgress&&((X=l.onProgress)==null||X.call(l,this._lastProgress)),O.onProgress=w=>{var G;(G=l.onProgress)==null||G.call(l,{loaded:w.loaded,total:w.total})}),F.resolve({isStreamingSupported:O.isStreamingSupported,isRangeSupported:O.isRangeSupported,contentLength:O.contentLength})},F.reject),F.promise}),e.on("GetRangeReader",(p,F)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const O=this._networkStream.getRangeReader(p.begin,p.end);if(!O){F.close();return}F.onPull=()=>{O.read().then(function({value:X,done:w}){if(w){F.close();return}(0,_util.assert)(X instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),F.enqueue(new Uint8Array(X),1,[X])}).catch(X=>{F.error(X)})},F.onCancel=X=>{O.cancel(X),F.ready.catch(w=>{if(!this.destroyed)throw w})}}),e.on("GetDoc",({pdfInfo:p})=>{this._numPages=p.numPages,this._htmlForXfa=p.htmlForXfa,delete p.htmlForXfa,l._capability.resolve(new PDFDocumentProxy(p,this))}),e.on("DocException",function(p){let F;switch(p.name){case"PasswordException":F=new _util.PasswordException(p.message,p.code);break;case"InvalidPDFException":F=new _util.InvalidPDFException(p.message);break;case"MissingPDFException":F=new _util.MissingPDFException(p.message);break;case"UnexpectedResponseException":F=new _util.UnexpectedResponseException(p.message,p.status);break;case"UnknownErrorException":F=new _util.UnknownErrorException(p.message,p.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}l._capability.reject(F)}),e.on("PasswordRequest",p=>{if(this._passwordCapability=new _util.PromiseCapability,l.onPassword){const F=O=>{O instanceof Error?this._passwordCapability.reject(O):this._passwordCapability.resolve({password:O})};try{l.onPassword(F,p.code)}catch(O){this._passwordCapability.reject(O)}}else this._passwordCapability.reject(new _util.PasswordException(p.message,p.code));return this._passwordCapability.promise}),e.on("DataLoaded",p=>{var F;(F=l.onProgress)==null||F.call(l,{loaded:p.length,total:p.length}),this.downloadInfoCapability.resolve(p)}),e.on("StartRenderPage",p=>{if(this.destroyed)return;s(this,y).get(p.pageIndex)._startRenderPage(p.transparency,p.cacheKey)}),e.on("commonobj",([p,F,O])=>{var X;if(!this.destroyed&&!this.commonObjs.has(p))switch(F){case"Font":const w=this._params;if("error"in O){const ht=O.error;(0,_util.warn)(`Error during font loading: ${ht}`),this.commonObjs.resolve(p,ht);break}const G=w.pdfBug&&((X=globalThis.FontInspector)!=null&&X.enabled)?(ht,q)=>globalThis.FontInspector.fontAdded(ht,q):null,it=new _font_loader.FontFaceObject(O,{isEvalSupported:w.isEvalSupported,disableFontFace:w.disableFontFace,ignoreErrors:w.ignoreErrors,inspectFont:G});this.fontLoader.bind(it).catch(ht=>e.sendWithPromise("FontFallback",{id:p})).finally(()=>{!w.fontExtraProperties&&it.data&&(it.data=null),this.commonObjs.resolve(p,it)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(p,O);break;default:throw new Error(`Got unknown common object type ${F}`)}}),e.on("obj",([p,F,O,X])=>{var G;if(this.destroyed)return;const w=s(this,y).get(F);if(!w.objs.has(p))switch(O){case"Image":if(w.objs.resolve(p,X),X){let it;if(X.bitmap){const{width:ht,height:q}=X;it=ht*q*4}else it=((G=X.data)==null?void 0:G.length)||0;it>_util.MAX_IMAGE_SIZE_TO_CACHE&&(w._maybeCleanupAfterRender=!0)}break;case"Pattern":w.objs.resolve(p,X);break;default:throw new Error(`Got unknown object type ${O}`)}}),e.on("DocProgress",p=>{var F;this.destroyed||(F=l.onProgress)==null||F.call(l,{loaded:p.loaded,total:p.total})}),e.on("FetchBuiltInCMap",p=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(p):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",p=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(p):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var p,F;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfers:l}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:(F=(p=this._fullReader)==null?void 0:p.filename)!=null?F:null},l).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const l=e-1,p=s(this,D).get(l);if(p)return p;const F=this.messageHandler.sendWithPromise("GetPage",{pageIndex:l}).then(O=>{if(this.destroyed)throw new Error("Transport destroyed");const X=new PDFPageProxy(l,O,this,this._params.pdfBug);return s(this,y).set(l,X),X});return s(this,D).set(l,F),F}getPageIndex(e){return typeof e!="object"||e===null||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,l){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:l})}getFieldObjects(){return Q(this,r,ke).call(this,"GetFieldObjects")}hasJSActions(){return Q(this,r,ke).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",l=s(this,N).get(e);if(l)return l;const p=this.messageHandler.sendWithPromise(e,null).then(F=>{var O,X,w,G;return{info:F[0],metadata:F[1]?new _metadata.Metadata(F[1]):null,contentDispositionFilename:(X=(O=this._fullReader)==null?void 0:O.filename)!=null?X:null,contentLength:(G=(w=this._fullReader)==null?void 0:w.contentLength)!=null?G:null}});return s(this,N).set(e,p),p}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const l of s(this,y).values())if(!l.cleanup())throw new Error(`startCleanup: Page ${l.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),s(this,N).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:e,enableXfa:l}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e,enableXfa:l})}}N=new WeakMap,y=new WeakMap,D=new WeakMap,r=new WeakSet,ke=function(e,l=null){const p=s(this,N).get(e);if(p)return p;const F=this.messageHandler.sendWithPromise(e,l);return s(this,N).set(e,F),F};class PDFObjects{constructor(){W(this,S);W(this,A,Object.create(null))}get(e,l=null){if(l){const F=Q(this,S,Fe).call(this,e);return F.capability.promise.then(()=>l(F.data)),null}const p=s(this,A)[e];if(!(p!=null&&p.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${e}.`);return p.data}has(e){const l=s(this,A)[e];return(l==null?void 0:l.capability.settled)||!1}resolve(e,l=null){const p=Q(this,S,Fe).call(this,e);p.data=l,p.capability.resolve()}clear(){var e;for(const l in s(this,A)){const{data:p}=s(this,A)[l];(e=p==null?void 0:p.bitmap)==null||e.close()}lt(this,A,Object.create(null))}}A=new WeakMap,S=new WeakSet,Fe=function(e){const l=s(this,A)[e];return l||(s(this,A)[e]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(e){W(this,d,null);lt(this,d,e),this.onContinue=null}get promise(){return s(this,d).capability.promise}cancel(e=0){s(this,d).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=s(this,d).operatorList;if(!e)return!1;const{annotationCanvasMap:l}=s(this,d);return e.form||e.canvas&&(l==null?void 0:l.size)>0}}d=new WeakMap,exports.RenderTask=RenderTask;const n=class n{constructor({callback:e,params:l,objs:p,commonObjs:F,annotationCanvasMap:O,operatorList:X,pageIndex:w,canvasFactory:G,filterFactory:it,useRequestAnimationFrame:ht=!1,pdfBug:q=!1,pageColors:st=null}){this.callback=e,this.params=l,this.objs=p,this.commonObjs=F,this.annotationCanvasMap=O,this.operatorListIdx=null,this.operatorList=X,this._pageIndex=w,this.canvasFactory=G,this.filterFactory=it,this._pdfBug=q,this.pageColors=st,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=ht===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=l.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:l}){var w,G;if(this.cancelled)return;if(this._canvas){if(s(n,E).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");s(n,E).add(this._canvas)}this._pdfBug&&((w=globalThis.StepperManager)!=null&&w.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:p,viewport:F,transform:O,background:X}=this.params;this.gfx=new _canvas.CanvasGraphics(p,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:l},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:O,viewport:F,transparency:e,background:X}),this.operatorListIdx=0,this.graphicsReady=!0,(G=this.graphicsReadyCallback)==null||G.call(this)}cancel(e=null,l=0){var p;this.running=!1,this.cancelled=!0,(p=this.gfx)==null||p.endDrawing(),this._canvas&&s(n,E).delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,l))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&s(n,E).delete(this._canvas),this.callback())))}};E=new WeakMap,W(n,E,new WeakSet);let InternalRenderTask=n;const version="3.8.162";exports.version=version;const build="2c74323e3";exports.build=build},(pt,h,et)=>{var x,f,M,ns,y;Object.defineProperty(h,"__esModule",{value:!0}),h.SerializableEmpty=h.PrintAnnotationStorage=h.AnnotationStorage=void 0;var c=et(1),P=et(4),Z=et(8);const V=Object.freeze({map:null,hash:"",transfers:void 0});h.SerializableEmpty=V;class ot{constructor(){W(this,M);W(this,x,!1);W(this,f,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(r,g){const A=s(this,f).get(r);return A===void 0?g:Object.assign(g,A)}getRawValue(r){return s(this,f).get(r)}remove(r){if(s(this,f).delete(r),s(this,f).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const g of s(this,f).values())if(g instanceof P.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(r,g){const A=s(this,f).get(r);let S=!1;if(A!==void 0)for(const[m,d]of Object.entries(g))A[m]!==d&&(S=!0,A[m]=d);else S=!0,s(this,f).set(r,g);S&&Q(this,M,ns).call(this),g instanceof P.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(g.constructor._type)}has(r){return s(this,f).has(r)}getAll(){return s(this,f).size>0?(0,c.objectFromMap)(s(this,f)):null}setAll(r){for(const[g,A]of Object.entries(r))this.setValue(g,A)}get size(){return s(this,f).size}resetModified(){s(this,x)&&(lt(this,x,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new tt(this)}get serializable(){if(s(this,f).size===0)return V;const r=new Map,g=new Z.MurmurHash3_64,A=[];for(const[S,m]of s(this,f)){const d=m instanceof P.AnnotationEditor?m.serialize():m;d&&(r.set(S,d),g.update(`${S}:${JSON.stringify(d)}`),d.bitmap&&A.push(d.bitmap))}return r.size>0?{map:r,hash:g.hexdigest(),transfers:A}:V}}x=new WeakMap,f=new WeakMap,M=new WeakSet,ns=function(){s(this,x)||(lt(this,x,!0),typeof this.onSetModified=="function"&&this.onSetModified())},h.AnnotationStorage=ot;class tt extends ot{constructor(g){super();W(this,y,void 0);const{map:A,hash:S,transfers:m}=g.serializable,d=structuredClone(A,m?{transfer:m}:null);lt(this,y,{map:d,hash:S,transfers:m})}get print(){(0,c.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return s(this,y)}}y=new WeakMap,h.PrintAnnotationStorage=tt},(pt,h,et)=>{var ot,tt,x,f,M,N;Object.defineProperty(h,"__esModule",{value:!0}),h.AnnotationEditor=void 0;var c=et(5),P=et(1);const y=class y{constructor(r){W(this,ot,this.focusin.bind(this));W(this,tt,this.focusout.bind(this));W(this,x,!1);W(this,f,!1);W(this,M,!1);$t(this,"_uiManager",null);W(this,N,y._zIndex++);this.constructor===y&&(0,P.unreachable)("Cannot initialize AnnotationEditor."),this.parent=r.parent,this.id=r.id,this.width=this.height=null,this.pageIndex=r.parent.pageIndex,this.name=r.name,this.div=null,this._uiManager=r.uiManager,this.annotationElementId=null;const{rotation:g,rawDims:{pageWidth:A,pageHeight:S,pageX:m,pageY:d}}=this.parent.viewport;this.rotation=g,this.pageRotation=(360+g-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[A,S],this.pageTranslation=[m,d];const[E,n]=this.parentDimensions;this.x=r.x/E,this.y=r.y/n,this.isAttachedToDOM=!1,this.deleted=!1}static get _defaultLineColor(){return(0,P.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(r){const g=new V({id:r.parent.getNextId(),parent:r.parent,uiManager:r._uiManager});g.annotationElementId=r.annotationElementId,g.deleted=!0,g._uiManager.addToAnnotationStorage(g)}addCommands(r){this._uiManager.addCommands(r)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=s(this,N)}setParent(r){r!==null&&(this.pageIndex=r.pageIndex,this.pageDimensions=r.pageDimensions),this.parent=r}focusin(r){s(this,x)?lt(this,x,!1):this.parent.setSelected(this)}focusout(r){var A;if(!this.isAttachedToDOM)return;const g=r.relatedTarget;g!=null&&g.closest(`#${this.id}`)||(r.preventDefault(),(A=this.parent)!=null&&A.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(r){const g=this.parent.div.getBoundingClientRect();this.startX=r.clientX-g.x,this.startY=r.clientY-g.y,r.dataTransfer.setData("text/plain",this.id),r.dataTransfer.effectAllowed="move"}setAt(r,g,A,S){const[m,d]=this.parentDimensions;[A,S]=this.screenToPageTranslation(A,S),this.x=(r+A)/m,this.y=(g+S)/d,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(r,g){const[A,S]=this.parentDimensions;[r,g]=this.screenToPageTranslation(r,g),this.x+=r/A,this.y+=g/S,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(r,g){switch(this.parentRotation){case 90:return[g,-r];case 180:return[-r,-g];case 270:return[-g,r];default:return[r,g]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:r}=this._uiManager.viewParameters,[g,A]=this.pageDimensions;return[g*r,A*r]}setDims(r,g){const[A,S]=this.parentDimensions;this.div.style.width=`${100*r/A}%`,this.div.style.height=`${100*g/S}%`}fixDims(){const{style:r}=this.div,{height:g,width:A}=r,S=A.endsWith("%"),m=g.endsWith("%");if(S&&m)return;const[d,E]=this.parentDimensions;S||(r.width=`${100*parseFloat(A)/d}%`),m||(r.height=`${100*parseFloat(g)/E}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",s(this,ot)),this.div.addEventListener("focusout",s(this,tt));const[r,g]=this.getInitialTranslation();return this.translate(r,g),(0,c.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(r){const{isMac:g}=P.FeatureTest.platform;if(r.button!==0||r.ctrlKey&&g){r.preventDefault();return}r.ctrlKey&&!g||r.shiftKey||r.metaKey&&g?this.parent.toggleSelected(this):this.parent.setSelected(this),lt(this,x,!0)}getRect(r,g){const A=this.parentScale,[S,m]=this.pageDimensions,[d,E]=this.pageTranslation,n=r/A,t=g/A,e=this.x*S,l=this.y*m,p=this.width*S,F=this.height*m;switch(this.rotation){case 0:return[e+n+d,m-l-t-F+E,e+n+p+d,m-l-t+E];case 90:return[e+t+d,m-l+n+E,e+t+F+d,m-l+n+p+E];case 180:return[e-n-p+d,m-l+t+E,e-n+d,m-l+t+F+E];case 270:return[e-t-F+d,m-l-n-p+E,e-t+d,m-l-n+E];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(r,g){const[A,S,m,d]=r,E=m-A,n=d-S;switch(this.rotation){case 0:return[A,g-d,E,n];case 90:return[A,g-S,n,E];case 180:return[m,g-S,E,n];case 270:return[m,g-d,n,E];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){lt(this,M,!0)}disableEditMode(){lt(this,M,!1)}isInEditMode(){return s(this,M)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var r,g;(r=this.div)==null||r.addEventListener("focusin",s(this,ot)),(g=this.div)==null||g.addEventListener("focusout",s(this,tt))}serialize(r=!1){(0,P.unreachable)("An editor must be serializable")}static deserialize(r,g,A){const S=new this.prototype.constructor({parent:g,id:g.getNextId(),uiManager:A});S.rotation=r.rotation;const[m,d]=S.pageDimensions,[E,n,t,e]=S.getRectInCurrentCoords(r.rect,d);return S.x=E/m,S.y=n/d,S.width=t/m,S.height=e/d,S}remove(){this.div.removeEventListener("focusin",s(this,ot)),this.div.removeEventListener("focusout",s(this,tt)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var r;(r=this.div)==null||r.classList.add("selectedEditor")}unselect(){var r;(r=this.div)==null||r.classList.remove("selectedEditor")}updateParams(r,g){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return s(this,f)}set isEditing(r){lt(this,f,r),r?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};ot=new WeakMap,tt=new WeakMap,x=new WeakMap,f=new WeakMap,M=new WeakMap,N=new WeakMap,$t(y,"_colorManager",new c.ColorManager),$t(y,"_zIndex",1);let Z=y;h.AnnotationEditor=Z;class V extends Z{constructor(r){super(r),this.annotationElementId=r.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(pt,h,et)=>{var N,y,D,r,g,A,is,d,E,n,t,e,l,p,F,O,X,w,G,it,ht,q,st,St,vt,yt,Dt,j,o,a,_,R,rs,B,Re,Y,as,rt,os,dt,Qt,ft,ce,It,ls,bt,cs,z,Me,mt,he,Rt,De;Object.defineProperty(h,"__esModule",{value:!0}),h.KeyboardManager=h.CommandManager=h.ColorManager=h.AnnotationEditorUIManager=void 0,h.bindEvents=Z,h.opacityToHex=V;var c=et(1),P=et(6);function Z(Ft,v,C){for(const L of C)v.addEventListener(L,Ft[L].bind(Ft))}function V(Ft){return Math.round(Math.min(255,Math.max(1,255*Ft))).toString(16).padStart(2,"0")}class ot{constructor(){W(this,N,0)}getId(){return`${c.AnnotationEditorPrefix}${be(this,N)._++}`}}N=new WeakMap;class tt{constructor(v=128){W(this,y,[]);W(this,D,!1);W(this,r,void 0);W(this,g,-1);lt(this,r,v)}add({cmd:v,undo:C,mustExec:L,type:at=NaN,overwriteIfSameType:kt=!1,keepUndo:Lt=!1}){if(L&&v(),s(this,D))return;const Ut={cmd:v,undo:C,type:at};if(s(this,g)===-1){s(this,y).length>0&&(s(this,y).length=0),lt(this,g,0),s(this,y).push(Ut);return}if(kt&&s(this,y)[s(this,g)].type===at){Lt&&(Ut.undo=s(this,y)[s(this,g)].undo),s(this,y)[s(this,g)]=Ut;return}const Wt=s(this,g)+1;Wt===s(this,r)?s(this,y).splice(0,1):(lt(this,g,Wt),Wt<s(this,y).length&&s(this,y).splice(Wt)),s(this,y).push(Ut)}undo(){s(this,g)!==-1&&(lt(this,D,!0),s(this,y)[s(this,g)].undo(),lt(this,D,!1),lt(this,g,s(this,g)-1))}redo(){s(this,g)<s(this,y).length-1&&(lt(this,g,s(this,g)+1),lt(this,D,!0),s(this,y)[s(this,g)].cmd(),lt(this,D,!1))}hasSomethingToUndo(){return s(this,g)!==-1}hasSomethingToRedo(){return s(this,g)<s(this,y).length-1}destroy(){lt(this,y,null)}}y=new WeakMap,D=new WeakMap,r=new WeakMap,g=new WeakMap,h.CommandManager=tt;class x{constructor(v){W(this,A);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:C}=c.FeatureTest.platform;for(const[L,at,kt=!1]of v)for(const Lt of L){const Ut=Lt.startsWith("mac+");C&&Ut?(this.callbacks.set(Lt.slice(4),{callback:at,bubbles:kt}),this.allKeys.add(Lt.split("+").at(-1))):!C&&!Ut&&(this.callbacks.set(Lt,{callback:at,bubbles:kt}),this.allKeys.add(Lt.split("+").at(-1)))}}exec(v,C){if(!this.allKeys.has(C.key))return;const L=this.callbacks.get(Q(this,A,is).call(this,C));if(!L)return;const{callback:at,bubbles:kt}=L;at.bind(v)(),kt||(C.stopPropagation(),C.preventDefault())}}A=new WeakSet,is=function(v){v.altKey&&this.buffer.push("alt"),v.ctrlKey&&this.buffer.push("ctrl"),v.metaKey&&this.buffer.push("meta"),v.shiftKey&&this.buffer.push("shift"),this.buffer.push(v.key);const C=this.buffer.join("+");return this.buffer.length=0,C},h.KeyboardManager=x;const m=class m{get _colors(){const v=new Map([["CanvasText",null],["Canvas",null]]);return(0,P.getColorValues)(v),(0,c.shadow)(this,"_colors",v)}convert(v){const C=(0,P.getRGB)(v);if(!window.matchMedia("(forced-colors: active)").matches)return C;for(const[L,at]of this._colors)if(at.every((kt,Lt)=>kt===C[Lt]))return m._colorsMapping.get(L);return C}getHexCode(v){const C=this._colors.get(v);return C?c.Util.makeHexColor(...C):v}};$t(m,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let f=m;h.ColorManager=f;const jt=class jt{constructor(v,C,L){W(this,R);W(this,B);W(this,Y);W(this,rt);W(this,dt);W(this,ft);W(this,It);W(this,bt);W(this,z);W(this,mt);W(this,Rt);W(this,d,null);W(this,E,new Map);W(this,n,new Map);W(this,t,null);W(this,e,new tt);W(this,l,0);W(this,p,new Set);W(this,F,null);W(this,O,new Set);W(this,X,null);W(this,w,new ot);W(this,G,!1);W(this,it,c.AnnotationEditorType.NONE);W(this,ht,new Set);W(this,q,this.copy.bind(this));W(this,st,this.cut.bind(this));W(this,St,this.paste.bind(this));W(this,vt,this.keydown.bind(this));W(this,yt,this.onEditingAction.bind(this));W(this,Dt,this.onPageChanging.bind(this));W(this,j,this.onScaleChanging.bind(this));W(this,o,this.onRotationChanging.bind(this));W(this,a,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});W(this,_,null);lt(this,_,v),lt(this,X,C),s(this,X)._on("editingaction",s(this,yt)),s(this,X)._on("pagechanging",s(this,Dt)),s(this,X)._on("scalechanging",s(this,j)),s(this,X)._on("rotationchanging",s(this,o)),lt(this,t,L),this.viewParameters={realScale:P.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){return(0,c.shadow)(this,"_keyboardManager",new x([[["ctrl+a","mac+meta+a"],jt.prototype.selectAll],[["ctrl+z","mac+meta+z"],jt.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],jt.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],jt.prototype.delete],[["Escape","mac+Escape"],jt.prototype.unselectAll]]))}destroy(){Q(this,B,Re).call(this),s(this,X)._off("editingaction",s(this,yt)),s(this,X)._off("pagechanging",s(this,Dt)),s(this,X)._off("scalechanging",s(this,j)),s(this,X)._off("rotationchanging",s(this,o));for(const v of s(this,n).values())v.destroy();s(this,n).clear(),s(this,E).clear(),s(this,O).clear(),lt(this,d,null),s(this,ht).clear(),s(this,e).destroy()}onPageChanging({pageNumber:v}){lt(this,l,v-1)}focusMainContainer(){s(this,_).focus()}addShouldRescale(v){s(this,O).add(v)}removeShouldRescale(v){s(this,O).delete(v)}onScaleChanging({scale:v}){this.commitOrRemove(),this.viewParameters.realScale=v*P.PixelsPerInch.PDF_TO_CSS_UNITS;for(const C of s(this,O))C.onScaleChanging()}onRotationChanging({pagesRotation:v}){this.commitOrRemove(),this.viewParameters.rotation=v}addToAnnotationStorage(v){!v.isEmpty()&&s(this,t)&&!s(this,t).has(v.id)&&s(this,t).setValue(v.id,v)}copy(v){if(v.preventDefault(),s(this,d)&&s(this,d).commitOrRemove(),!this.hasSelection)return;const C=[];for(const L of s(this,ht)){const at=L.serialize(!0);at&&C.push(at)}C.length!==0&&v.clipboardData.setData("application/pdfjs",JSON.stringify(C))}cut(v){this.copy(v),this.delete()}paste(v){v.preventDefault();let C=v.clipboardData.getData("application/pdfjs");if(!C)return;try{C=JSON.parse(C)}catch(at){(0,c.warn)(`paste: "${at.message}".`);return}if(!Array.isArray(C))return;this.unselectAll();const L=s(this,n).get(s(this,l));try{const at=[];for(const Ut of C){const Wt=L.deserialize(Ut);if(!Wt)return;at.push(Wt)}const kt=()=>{for(const Ut of at)Q(this,z,Me).call(this,Ut);Q(this,Rt,De).call(this,at)},Lt=()=>{for(const Ut of at)Ut.remove()};this.addCommands({cmd:kt,undo:Lt,mustExec:!0})}catch(at){(0,c.warn)(`paste: "${at.message}".`)}}keydown(v){var C;(C=this.getActive())!=null&&C.shouldGetKeyboardEvents()||jt._keyboardManager.exec(this,v)}onEditingAction(v){["undo","redo","delete","selectAll"].includes(v.name)&&this[v.name]()}setEditingState(v){v?(Q(this,R,rs).call(this),Q(this,Y,as).call(this),Q(this,dt,Qt).call(this,{isEditing:s(this,it)!==c.AnnotationEditorType.NONE,isEmpty:Q(this,mt,he).call(this),hasSomethingToUndo:s(this,e).hasSomethingToUndo(),hasSomethingToRedo:s(this,e).hasSomethingToRedo(),hasSelectedEditor:!1})):(Q(this,B,Re).call(this),Q(this,rt,os).call(this),Q(this,dt,Qt).call(this,{isEditing:!1}))}registerEditorTypes(v){if(!s(this,F)){lt(this,F,v);for(const C of s(this,F))Q(this,ft,ce).call(this,C.defaultPropertiesToUpdate)}}getId(){return s(this,w).getId()}get currentLayer(){return s(this,n).get(s(this,l))}get currentPageIndex(){return s(this,l)}addLayer(v){s(this,n).set(v.pageIndex,v),s(this,G)?v.enable():v.disable()}removeLayer(v){s(this,n).delete(v.pageIndex)}updateMode(v){if(lt(this,it,v),v===c.AnnotationEditorType.NONE)this.setEditingState(!1),Q(this,bt,cs).call(this);else{this.setEditingState(!0),Q(this,It,ls).call(this);for(const C of s(this,n).values())C.updateMode(v)}}updateToolbar(v){v!==s(this,it)&&s(this,X).dispatch("switchannotationeditormode",{source:this,mode:v})}updateParams(v,C){if(s(this,F)){for(const L of s(this,ht))L.updateParams(v,C);for(const L of s(this,F))L.updateDefaultParams(v,C)}}getEditors(v){const C=[];for(const L of s(this,E).values())L.pageIndex===v&&C.push(L);return C}getEditor(v){return s(this,E).get(v)}addEditor(v){s(this,E).set(v.id,v)}removeEditor(v){var C;s(this,E).delete(v.id),this.unselect(v),(!v.annotationElementId||!s(this,p).has(v.annotationElementId))&&((C=s(this,t))==null||C.remove(v.id))}addDeletedAnnotationElement(v){s(this,p).add(v.annotationElementId),v.deleted=!0}isDeletedAnnotationElement(v){return s(this,p).has(v)}removeDeletedAnnotationElement(v){s(this,p).delete(v.annotationElementId),v.deleted=!1}setActiveEditor(v){s(this,d)!==v&&(lt(this,d,v),v&&Q(this,ft,ce).call(this,v.propertiesToUpdate))}toggleSelected(v){if(s(this,ht).has(v)){s(this,ht).delete(v),v.unselect(),Q(this,dt,Qt).call(this,{hasSelectedEditor:this.hasSelection});return}s(this,ht).add(v),v.select(),Q(this,ft,ce).call(this,v.propertiesToUpdate),Q(this,dt,Qt).call(this,{hasSelectedEditor:!0})}setSelected(v){for(const C of s(this,ht))C!==v&&C.unselect();s(this,ht).clear(),s(this,ht).add(v),v.select(),Q(this,ft,ce).call(this,v.propertiesToUpdate),Q(this,dt,Qt).call(this,{hasSelectedEditor:!0})}isSelected(v){return s(this,ht).has(v)}unselect(v){v.unselect(),s(this,ht).delete(v),Q(this,dt,Qt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return s(this,ht).size!==0}undo(){s(this,e).undo(),Q(this,dt,Qt).call(this,{hasSomethingToUndo:s(this,e).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Q(this,mt,he).call(this)})}redo(){s(this,e).redo(),Q(this,dt,Qt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:s(this,e).hasSomethingToRedo(),isEmpty:Q(this,mt,he).call(this)})}addCommands(v){s(this,e).add(v),Q(this,dt,Qt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Q(this,mt,he).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const v=[...s(this,ht)],C=()=>{for(const at of v)at.remove()},L=()=>{for(const at of v)Q(this,z,Me).call(this,at)};this.addCommands({cmd:C,undo:L,mustExec:!0})}commitOrRemove(){var v;(v=s(this,d))==null||v.commitOrRemove()}selectAll(){for(const v of s(this,ht))v.commit();Q(this,Rt,De).call(this,s(this,E).values())}unselectAll(){if(s(this,d)){s(this,d).commitOrRemove();return}if(s(this,ht).size!==0){for(const v of s(this,ht))v.unselect();s(this,ht).clear(),Q(this,dt,Qt).call(this,{hasSelectedEditor:!1})}}isActive(v){return s(this,d)===v}getActive(){return s(this,d)}getMode(){return s(this,it)}};d=new WeakMap,E=new WeakMap,n=new WeakMap,t=new WeakMap,e=new WeakMap,l=new WeakMap,p=new WeakMap,F=new WeakMap,O=new WeakMap,X=new WeakMap,w=new WeakMap,G=new WeakMap,it=new WeakMap,ht=new WeakMap,q=new WeakMap,st=new WeakMap,St=new WeakMap,vt=new WeakMap,yt=new WeakMap,Dt=new WeakMap,j=new WeakMap,o=new WeakMap,a=new WeakMap,_=new WeakMap,R=new WeakSet,rs=function(){s(this,_).addEventListener("keydown",s(this,vt))},B=new WeakSet,Re=function(){s(this,_).removeEventListener("keydown",s(this,vt))},Y=new WeakSet,as=function(){document.addEventListener("copy",s(this,q)),document.addEventListener("cut",s(this,st)),document.addEventListener("paste",s(this,St))},rt=new WeakSet,os=function(){document.removeEventListener("copy",s(this,q)),document.removeEventListener("cut",s(this,st)),document.removeEventListener("paste",s(this,St))},dt=new WeakSet,Qt=function(v){Object.entries(v).some(([L,at])=>s(this,a)[L]!==at)&&s(this,X).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(s(this,a),v)})},ft=new WeakSet,ce=function(v){s(this,X).dispatch("annotationeditorparamschanged",{source:this,details:v})},It=new WeakSet,ls=function(){if(!s(this,G)){lt(this,G,!0);for(const v of s(this,n).values())v.enable()}},bt=new WeakSet,cs=function(){if(this.unselectAll(),s(this,G)){lt(this,G,!1);for(const v of s(this,n).values())v.disable()}},z=new WeakSet,Me=function(v){const C=s(this,n).get(v.pageIndex);C?C.addOrRebuild(v):this.addEditor(v)},mt=new WeakSet,he=function(){if(s(this,E).size===0)return!0;if(s(this,E).size===1)for(const v of s(this,E).values())return v.isEmpty();return!1},Rt=new WeakSet,De=function(v){s(this,ht).clear();for(const C of v)C.isEmpty()||(s(this,ht).add(C),C.select());Q(this,dt,Qt).call(this,{hasSelectedEditor:!0})};let M=jt;h.AnnotationEditorUIManager=M},(pt,h,et)=>{var ht,q,st,St,vt,yt,Dt,j,o,a,_,R,ie,B,re,Y,Oe,rt,Ae,dt,ye,ft,de,It,ue;Object.defineProperty(h,"__esModule",{value:!0}),h.StatTimer=h.RenderingCancelledException=h.PixelsPerInch=h.PageViewport=h.PDFDateString=h.DOMStandardFontDataFactory=h.DOMSVGFactory=h.DOMFilterFactory=h.DOMCanvasFactory=h.DOMCMapReaderFactory=h.AnnotationPrefix=void 0,h.deprecated=t,h.getColorValues=O,h.getCurrentTransform=X,h.getCurrentTransformInverse=w,h.getFilenameFromUrl=S,h.getPdfFilenameFromUrl=m,h.getRGB=F,h.getXfaPageViewport=p,h.isDataScheme=g,h.isPdfFile=A,h.isValidFetchUrl=E,h.loadScript=n,h.setLayerDimensions=G;var c=et(7),P=et(1);const Z="http://www.w3.org/2000/svg",V="pdfjs_internal_id_";h.AnnotationPrefix=V;const it=class it{};$t(it,"CSS",96),$t(it,"PDF",72),$t(it,"PDF_TO_CSS_UNITS",it.CSS/it.PDF);let ot=it;h.PixelsPerInch=ot;class tt extends c.BaseFilterFactory{constructor({docId:z,ownerDocument:ut=globalThis.document}={}){super();W(this,R);W(this,B);W(this,Y);W(this,rt);W(this,dt);W(this,ft);W(this,It);W(this,ht,void 0);W(this,q,void 0);W(this,st,void 0);W(this,St,void 0);W(this,vt,void 0);W(this,yt,void 0);W(this,Dt,void 0);W(this,j,void 0);W(this,o,void 0);W(this,a,void 0);W(this,_,0);lt(this,st,z),lt(this,St,ut)}addFilter(z){if(!z)return"none";let ut=s(this,R,ie).get(z);if(ut)return ut;let mt,wt,Rt,Nt;if(z.length===1){const C=z[0],L=new Array(256);for(let at=0;at<256;at++)L[at]=C[at]/255;Nt=mt=wt=Rt=L.join(",")}else{const[C,L,at]=z,kt=new Array(256),Lt=new Array(256),Ut=new Array(256);for(let Wt=0;Wt<256;Wt++)kt[Wt]=C[Wt]/255,Lt[Wt]=L[Wt]/255,Ut[Wt]=at[Wt]/255;mt=kt.join(","),wt=Lt.join(","),Rt=Ut.join(","),Nt=`${mt}${wt}${Rt}`}if(ut=s(this,R,ie).get(Nt),ut)return s(this,R,ie).set(z,ut),ut;const jt=`g_${s(this,st)}_transfer_map_${be(this,_)._++}`,Ft=`url(#${jt})`;s(this,R,ie).set(z,Ft),s(this,R,ie).set(Nt,Ft);const v=Q(this,rt,Ae).call(this,jt);return Q(this,ft,de).call(this,mt,wt,Rt,v),Ft}addHCMFilter(z,ut){var L;const mt=`${z}-${ut}`;if(s(this,yt)===mt)return s(this,Dt);if(lt(this,yt,mt),lt(this,Dt,"none"),(L=s(this,vt))==null||L.remove(),!z||!ut)return s(this,Dt);const wt=Q(this,It,ue).call(this,z);z=P.Util.makeHexColor(...wt);const Rt=Q(this,It,ue).call(this,ut);if(ut=P.Util.makeHexColor(...Rt),s(this,B,re).style.color="",z==="#000000"&&ut==="#ffffff"||z===ut)return s(this,Dt);const Nt=new Array(256);for(let at=0;at<=255;at++){const kt=at/255;Nt[at]=kt<=.03928?kt/12.92:((kt+.055)/1.055)**2.4}const jt=Nt.join(","),Ft=`g_${s(this,st)}_hcm_filter`,v=lt(this,j,Q(this,rt,Ae).call(this,Ft));Q(this,ft,de).call(this,jt,jt,jt,v),Q(this,Y,Oe).call(this,v);const C=(at,kt)=>{const Lt=wt[at]/255,Ut=Rt[at]/255,Wt=new Array(kt+1);for(let Jt=0;Jt<=kt;Jt++)Wt[Jt]=Lt+Jt/kt*(Ut-Lt);return Wt.join(",")};return Q(this,ft,de).call(this,C(0,5),C(1,5),C(2,5),v),lt(this,Dt,`url(#${Ft})`),s(this,Dt)}addHighlightHCMFilter(z,ut,mt,wt){var Ut;const Rt=`${z}-${ut}-${mt}-${wt}`;if(s(this,o)===Rt)return s(this,a);if(lt(this,o,Rt),lt(this,a,"none"),(Ut=s(this,j))==null||Ut.remove(),!z||!ut)return s(this,a);const[Nt,jt]=[z,ut].map(Q(this,It,ue).bind(this));let Ft=Math.round(.2126*Nt[0]+.7152*Nt[1]+.0722*Nt[2]),v=Math.round(.2126*jt[0]+.7152*jt[1]+.0722*jt[2]),[C,L]=[mt,wt].map(Q(this,It,ue).bind(this));v<Ft&&([Ft,v,C,L]=[v,Ft,L,C]),s(this,B,re).style.color="";const at=(Wt,Jt,Xt)=>{const Yt=new Array(256),Mt=(v-Ft)/Xt,T=Wt/255,u=(Jt-Wt)/(255*Xt);let i=0;for(let b=0;b<=Xt;b++){const k=Math.round(Ft+b*Mt),U=T+b*u;for(let K=i;K<=k;K++)Yt[K]=U;i=k+1}for(let b=i;b<256;b++)Yt[b]=Yt[i-1];return Yt.join(",")},kt=`g_${s(this,st)}_hcm_highlight_filter`,Lt=lt(this,j,Q(this,rt,Ae).call(this,kt));return Q(this,Y,Oe).call(this,Lt),Q(this,ft,de).call(this,at(C[0],L[0],5),at(C[1],L[1],5),at(C[2],L[2],5),Lt),lt(this,a,`url(#${kt})`),s(this,a)}destroy(z=!1){z&&(s(this,Dt)||s(this,a))||(s(this,q)&&(s(this,q).parentNode.parentNode.remove(),lt(this,q,null)),s(this,ht)&&(s(this,ht).clear(),lt(this,ht,null)),lt(this,_,0))}}ht=new WeakMap,q=new WeakMap,st=new WeakMap,St=new WeakMap,vt=new WeakMap,yt=new WeakMap,Dt=new WeakMap,j=new WeakMap,o=new WeakMap,a=new WeakMap,_=new WeakMap,R=new WeakSet,ie=function(){return s(this,ht)||lt(this,ht,new Map)},B=new WeakSet,re=function(){if(!s(this,q)){const z=s(this,St).createElement("div"),{style:ut}=z;ut.visibility="hidden",ut.contain="strict",ut.width=ut.height=0,ut.position="absolute",ut.top=ut.left=0,ut.zIndex=-1;const mt=s(this,St).createElementNS(Z,"svg");mt.setAttribute("width",0),mt.setAttribute("height",0),lt(this,q,s(this,St).createElementNS(Z,"defs")),z.append(mt),mt.append(s(this,q)),s(this,St).body.append(z)}return s(this,q)},Y=new WeakSet,Oe=function(z){const ut=s(this,St).createElementNS(Z,"feColorMatrix");ut.setAttribute("type","matrix"),ut.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),z.append(ut)},rt=new WeakSet,Ae=function(z){const ut=s(this,St).createElementNS(Z,"filter");return ut.setAttribute("color-interpolation-filters","sRGB"),ut.setAttribute("id",z),s(this,B,re).append(ut),ut},dt=new WeakSet,ye=function(z,ut,mt){const wt=s(this,St).createElementNS(Z,ut);wt.setAttribute("type","discrete"),wt.setAttribute("tableValues",mt),z.append(wt)},ft=new WeakSet,de=function(z,ut,mt,wt){const Rt=s(this,St).createElementNS(Z,"feComponentTransfer");wt.append(Rt),Q(this,dt,ye).call(this,Rt,"feFuncR",z),Q(this,dt,ye).call(this,Rt,"feFuncG",ut),Q(this,dt,ye).call(this,Rt,"feFuncB",mt)},It=new WeakSet,ue=function(z){return s(this,B,re).style.color=z,F(getComputedStyle(s(this,B,re)).getPropertyValue("color"))},h.DOMFilterFactory=tt;class x extends c.BaseCanvasFactory{constructor({ownerDocument:J=globalThis.document}={}){super(),this._document=J}_createCanvas(J,z){const ut=this._document.createElement("canvas");return ut.width=J,ut.height=z,ut}}h.DOMCanvasFactory=x;async function f(bt,J=!1){if(E(bt,document.baseURI)){const z=await fetch(bt);if(!z.ok)throw new Error(z.statusText);return J?new Uint8Array(await z.arrayBuffer()):(0,P.stringToBytes)(await z.text())}return new Promise((z,ut)=>{const mt=new XMLHttpRequest;mt.open("GET",bt,!0),J&&(mt.responseType="arraybuffer"),mt.onreadystatechange=()=>{if(mt.readyState===XMLHttpRequest.DONE){if(mt.status===200||mt.status===0){let wt;if(J&&mt.response?wt=new Uint8Array(mt.response):!J&&mt.responseText&&(wt=(0,P.stringToBytes)(mt.responseText)),wt){z(wt);return}}ut(new Error(mt.statusText))}},mt.send(null)})}class M extends c.BaseCMapReaderFactory{_fetchData(J,z){return f(J,this.isCompressed).then(ut=>({cMapData:ut,compressionType:z}))}}h.DOMCMapReaderFactory=M;class N extends c.BaseStandardFontDataFactory{_fetchData(J){return f(J,!0)}}h.DOMStandardFontDataFactory=N;class y extends c.BaseSVGFactory{_createSVG(J){return document.createElementNS(Z,J)}}h.DOMSVGFactory=y;class D{constructor({viewBox:J,scale:z,rotation:ut,offsetX:mt=0,offsetY:wt=0,dontFlip:Rt=!1}){this.viewBox=J,this.scale=z,this.rotation=ut,this.offsetX=mt,this.offsetY=wt;const Nt=(J[2]+J[0])/2,jt=(J[3]+J[1])/2;let Ft,v,C,L;switch(ut%=360,ut<0&&(ut+=360),ut){case 180:Ft=-1,v=0,C=0,L=1;break;case 90:Ft=0,v=1,C=1,L=0;break;case 270:Ft=0,v=-1,C=-1,L=0;break;case 0:Ft=1,v=0,C=0,L=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Rt&&(C=-C,L=-L);let at,kt,Lt,Ut;Ft===0?(at=Math.abs(jt-J[1])*z+mt,kt=Math.abs(Nt-J[0])*z+wt,Lt=(J[3]-J[1])*z,Ut=(J[2]-J[0])*z):(at=Math.abs(Nt-J[0])*z+mt,kt=Math.abs(jt-J[1])*z+wt,Lt=(J[2]-J[0])*z,Ut=(J[3]-J[1])*z),this.transform=[Ft*z,v*z,C*z,L*z,at-Ft*z*Nt-C*z*jt,kt-v*z*Nt-L*z*jt],this.width=Lt,this.height=Ut}get rawDims(){const{viewBox:J}=this;return(0,P.shadow)(this,"rawDims",{pageWidth:J[2]-J[0],pageHeight:J[3]-J[1],pageX:J[0],pageY:J[1]})}clone({scale:J=this.scale,rotation:z=this.rotation,offsetX:ut=this.offsetX,offsetY:mt=this.offsetY,dontFlip:wt=!1}={}){return new D({viewBox:this.viewBox.slice(),scale:J,rotation:z,offsetX:ut,offsetY:mt,dontFlip:wt})}convertToViewportPoint(J,z){return P.Util.applyTransform([J,z],this.transform)}convertToViewportRectangle(J){const z=P.Util.applyTransform([J[0],J[1]],this.transform),ut=P.Util.applyTransform([J[2],J[3]],this.transform);return[z[0],z[1],ut[0],ut[1]]}convertToPdfPoint(J,z){return P.Util.applyInverseTransform([J,z],this.transform)}}h.PageViewport=D;class r extends P.BaseException{constructor(J,z=0){super(J,"RenderingCancelledException"),this.extraDelay=z}}h.RenderingCancelledException=r;function g(bt){const J=bt.length;let z=0;for(;z<J&&bt[z].trim()==="";)z++;return bt.substring(z,z+5).toLowerCase()==="data:"}function A(bt){return typeof bt=="string"&&/\.pdf$/i.test(bt)}function S(bt,J=!1){return J||([bt]=bt.split(/[#?]/,1)),bt.substring(bt.lastIndexOf("/")+1)}function m(bt,J="document.pdf"){if(typeof bt!="string")return J;if(g(bt))return(0,P.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),J;const z=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,ut=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,mt=z.exec(bt);let wt=ut.exec(mt[1])||ut.exec(mt[2])||ut.exec(mt[3]);if(wt&&(wt=wt[0],wt.includes("%")))try{wt=ut.exec(decodeURIComponent(wt))[0]}catch(Rt){}return wt||J}class d{constructor(){$t(this,"started",Object.create(null));$t(this,"times",[])}time(J){J in this.started&&(0,P.warn)(`Timer is already running for ${J}`),this.started[J]=Date.now()}timeEnd(J){J in this.started||(0,P.warn)(`Timer has not been started for ${J}`),this.times.push({name:J,start:this.started[J],end:Date.now()}),delete this.started[J]}toString(){const J=[];let z=0;for(const{name:ut}of this.times)z=Math.max(ut.length,z);for(const{name:ut,start:mt,end:wt}of this.times)J.push(`${ut.padEnd(z)} ${wt-mt}ms
`);return J.join("")}}h.StatTimer=d;function E(bt,J){try{const{protocol:z}=J?new URL(bt,J):new URL(bt);return z==="http:"||z==="https:"}catch(z){return!1}}function n(bt,J=!1){return new Promise((z,ut)=>{const mt=document.createElement("script");mt.src=bt,mt.onload=function(wt){J&&mt.remove(),z(wt)},mt.onerror=function(){ut(new Error(`Cannot load script at: ${mt.src}`))},(document.head||document.documentElement).append(mt)})}function t(bt){console.log("Deprecated API usage: "+bt)}let e;class l{static toDateObject(J){if(!J||typeof J!="string")return null;e||(e=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const z=e.exec(J);if(!z)return null;const ut=parseInt(z[1],10);let mt=parseInt(z[2],10);mt=mt>=1&&mt<=12?mt-1:0;let wt=parseInt(z[3],10);wt=wt>=1&&wt<=31?wt:1;let Rt=parseInt(z[4],10);Rt=Rt>=0&&Rt<=23?Rt:0;let Nt=parseInt(z[5],10);Nt=Nt>=0&&Nt<=59?Nt:0;let jt=parseInt(z[6],10);jt=jt>=0&&jt<=59?jt:0;const Ft=z[7]||"Z";let v=parseInt(z[8],10);v=v>=0&&v<=23?v:0;let C=parseInt(z[9],10)||0;return C=C>=0&&C<=59?C:0,Ft==="-"?(Rt+=v,Nt+=C):Ft==="+"&&(Rt-=v,Nt-=C),new Date(Date.UTC(ut,mt,wt,Rt,Nt,jt))}}h.PDFDateString=l;function p(bt,{scale:J=1,rotation:z=0}){const{width:ut,height:mt}=bt.attributes.style,wt=[0,0,parseInt(ut),parseInt(mt)];return new D({viewBox:wt,scale:J,rotation:z})}function F(bt){if(bt.startsWith("#")){const J=parseInt(bt.slice(1),16);return[(J&16711680)>>16,(J&65280)>>8,J&255]}return bt.startsWith("rgb(")?bt.slice(4,-1).split(",").map(J=>parseInt(J)):bt.startsWith("rgba(")?bt.slice(5,-1).split(",").map(J=>parseInt(J)).slice(0,3):((0,P.warn)(`Not a valid color format: "${bt}"`),[0,0,0])}function O(bt){const J=document.createElement("span");J.style.visibility="hidden",document.body.append(J);for(const z of bt.keys()){J.style.color=z;const ut=window.getComputedStyle(J).color;bt.set(z,F(ut))}J.remove()}function X(bt){const{a:J,b:z,c:ut,d:mt,e:wt,f:Rt}=bt.getTransform();return[J,z,ut,mt,wt,Rt]}function w(bt){const{a:J,b:z,c:ut,d:mt,e:wt,f:Rt}=bt.getTransform().invertSelf();return[J,z,ut,mt,wt,Rt]}function G(bt,J,z=!1,ut=!0){if(J instanceof D){const{pageWidth:mt,pageHeight:wt}=J.rawDims,{style:Rt}=bt,Nt=`calc(var(--scale-factor) * ${mt}px)`,jt=`calc(var(--scale-factor) * ${wt}px)`;!z||J.rotation%180===0?(Rt.width=Nt,Rt.height=jt):(Rt.width=jt,Rt.height=Nt)}ut&&bt.setAttribute("data-main-rotation",J.rotation)}},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.BaseStandardFontDataFactory=h.BaseSVGFactory=h.BaseFilterFactory=h.BaseCanvasFactory=h.BaseCMapReaderFactory=void 0;var c=et(1);class P{constructor(){this.constructor===P&&(0,c.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(f){return"none"}addHCMFilter(f,M){return"none"}addHighlightHCMFilter(f,M,N,y){return"none"}destroy(f=!1){}}h.BaseFilterFactory=P;class Z{constructor(){this.constructor===Z&&(0,c.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,M){if(f<=0||M<=0)throw new Error("Invalid canvas size");const N=this._createCanvas(f,M);return{canvas:N,context:N.getContext("2d")}}reset(f,M,N){if(!f.canvas)throw new Error("Canvas is not specified");if(M<=0||N<=0)throw new Error("Invalid canvas size");f.canvas.width=M,f.canvas.height=N}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,M){(0,c.unreachable)("Abstract method `_createCanvas` called.")}}h.BaseCanvasFactory=Z;class V{constructor({baseUrl:f=null,isCompressed:M=!0}){this.constructor===V&&(0,c.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=M}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const M=this.baseUrl+f+(this.isCompressed?".bcmap":""),N=this.isCompressed?c.CMapCompressionType.BINARY:c.CMapCompressionType.NONE;return this._fetchData(M,N).catch(y=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${M}`)})}_fetchData(f,M){(0,c.unreachable)("Abstract method `_fetchData` called.")}}h.BaseCMapReaderFactory=V;class ot{constructor({baseUrl:f=null}){this.constructor===ot&&(0,c.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const M=`${this.baseUrl}${f}`;return this._fetchData(M).catch(N=>{throw new Error(`Unable to load font data at: ${M}`)})}_fetchData(f){(0,c.unreachable)("Abstract method `_fetchData` called.")}}h.BaseStandardFontDataFactory=ot;class tt{constructor(){this.constructor===tt&&(0,c.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,M,N=!1){if(f<=0||M<=0)throw new Error("Invalid SVG dimensions");const y=this._createSVG("svg:svg");return y.setAttribute("version","1.1"),N||(y.setAttribute("width",`${f}px`),y.setAttribute("height",`${M}px`)),y.setAttribute("preserveAspectRatio","none"),y.setAttribute("viewBox",`0 0 ${f} ${M}`),y}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,c.unreachable)("Abstract method `_createSVG` called.")}}h.BaseSVGFactory=tt},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.MurmurHash3_64=void 0;var c=et(1);const P=3285377520,Z=4294901760,V=65535;class ot{constructor(x){this.h1=x?x&4294967295:P,this.h2=x?x&4294967295:P}update(x){let f,M;if(typeof x=="string"){f=new Uint8Array(x.length*2),M=0;for(let t=0,e=x.length;t<e;t++){const l=x.charCodeAt(t);l<=255?f[M++]=l:(f[M++]=l>>>8,f[M++]=l&255)}}else if((0,c.isArrayBuffer)(x))f=x.slice(),M=f.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const N=M>>2,y=M-N*4,D=new Uint32Array(f.buffer,0,N);let r=0,g=0,A=this.h1,S=this.h2;const m=3432918353,d=461845907,E=m&V,n=d&V;for(let t=0;t<N;t++)t&1?(r=D[t],r=r*m&Z|r*E&V,r=r<<15|r>>>17,r=r*d&Z|r*n&V,A^=r,A=A<<13|A>>>19,A=A*5+3864292196):(g=D[t],g=g*m&Z|g*E&V,g=g<<15|g>>>17,g=g*d&Z|g*n&V,S^=g,S=S<<13|S>>>19,S=S*5+3864292196);switch(r=0,y){case 3:r^=f[N*4+2]<<16;case 2:r^=f[N*4+1]<<8;case 1:r^=f[N*4],r=r*m&Z|r*E&V,r=r<<15|r>>>17,r=r*d&Z|r*n&V,N&1?A^=r:S^=r}this.h1=A,this.h2=S}hexdigest(){let x=this.h1,f=this.h2;return x^=f>>>1,x=x*3981806797&Z|x*36045&V,f=f*4283543511&Z|((f<<16|x>>>16)*2950163797&Z)>>>16,x^=f>>>1,x=x*444984403&Z|x*60499&V,f=f*3301882366&Z|((f<<16|x>>>16)*3120437893&Z)>>>16,x^=f>>>1,(x>>>0).toString(16).padStart(8,"0")+(f>>>0).toString(16).padStart(8,"0")}}h.MurmurHash3_64=ot},(pt,h,et)=>{var ot;Object.defineProperty(h,"__esModule",{value:!0}),h.FontLoader=h.FontFaceObject=void 0;var c=et(1),P=et(10);class Z{constructor({ownerDocument:x=globalThis.document,styleElement:f=null}){W(this,ot,new Set);this._document=x,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(x){this.nativeFontFaces.add(x),this._document.fonts.add(x)}removeNativeFontFace(x){this.nativeFontFaces.delete(x),this._document.fonts.delete(x)}insertRule(x){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const f=this.styleElement.sheet;f.insertRule(x,f.cssRules.length)}clear(){for(const x of this.nativeFontFaces)this._document.fonts.delete(x);this.nativeFontFaces.clear(),s(this,ot).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(x){if(!(!x||s(this,ot).has(x.loadedName))){if((0,c.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:f,src:M,style:N}=x,y=new FontFace(f,M,N);this.addNativeFontFace(y);try{await y.load(),s(this,ot).add(f)}catch(D){(0,c.warn)(`Cannot load system font: ${x.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(y)}return}(0,c.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(x){if(x.attached||x.missingFile&&!x.systemFontInfo)return;if(x.attached=!0,x.systemFontInfo){await this.loadSystemFont(x.systemFontInfo);return}if(this.isFontLoadingAPISupported){const M=x.createNativeFontFace();if(M){this.addNativeFontFace(M);try{await M.loaded}catch(N){throw(0,c.warn)(`Failed to load font '${M.family}': '${N}'.`),x.disableFontFace=!0,N}}return}const f=x.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(M=>{const N=this._queueLoadingCallback(M);this._prepareFontLoadEvent(x,N)})}}get isFontLoadingAPISupported(){var f;const x=!!((f=this._document)!=null&&f.fonts);return(0,c.shadow)(this,"isFontLoadingAPISupported",x)}get isSyncFontLoadingSupported(){let x=!1;return(P.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(x=!0),(0,c.shadow)(this,"isSyncFontLoadingSupported",x)}_queueLoadingCallback(x){function f(){for((0,c.assert)(!N.done,"completeRequest() cannot be called twice."),N.done=!0;M.length>0&&M[0].done;){const y=M.shift();setTimeout(y.callback,0)}}const{loadingRequests:M}=this,N={done:!1,complete:f,callback:x};return M.push(N),N}get _loadTestFont(){const x=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,c.shadow)(this,"_loadTestFont",x)}_prepareFontLoadEvent(x,f){function M(O,X){return O.charCodeAt(X)<<24|O.charCodeAt(X+1)<<16|O.charCodeAt(X+2)<<8|O.charCodeAt(X+3)&255}function N(O,X,w,G){const it=O.substring(0,X),ht=O.substring(X+w);return it+G+ht}let y,D;const r=this._document.createElement("canvas");r.width=1,r.height=1;const g=r.getContext("2d");let A=0;function S(O,X){if(++A>30){(0,c.warn)("Load test font never loaded."),X();return}if(g.font="30px "+O,g.fillText(".",0,20),g.getImageData(0,0,1,1).data[3]>0){X();return}setTimeout(S.bind(null,O,X))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=N(d,976,m.length,m);const n=16,t=1482184792;let e=M(d,n);for(y=0,D=m.length-3;y<D;y+=4)e=e-t+M(m,y)|0;y<m.length&&(e=e-t+M(m+"XXX",y)|0),d=N(d,n,4,(0,c.string32)(e));const l=`url(data:font/opentype;base64,${btoa(d)});`,p=`@font-face {font-family:"${m}";src:${l}}`;this.insertRule(p);const F=this._document.createElement("div");F.style.visibility="hidden",F.style.width=F.style.height="10px",F.style.position="absolute",F.style.top=F.style.left="0px";for(const O of[x.loadedName,m]){const X=this._document.createElement("span");X.textContent="Hi",X.style.fontFamily=O,F.append(X)}this._document.body.append(F),S(m,()=>{F.remove(),f.complete()})}}ot=new WeakMap,h.FontLoader=Z;class V{constructor(x,{isEvalSupported:f=!0,disableFontFace:M=!1,ignoreErrors:N=!1,inspectFont:y=null}){this.compiledGlyphs=Object.create(null);for(const D in x)this[D]=x[D];this.isEvalSupported=f!==!1,this.disableFontFace=M===!0,this.ignoreErrors=N===!0,this._inspectFont=y}createNativeFontFace(){var f;if(!this.data||this.disableFontFace)return null;let x;if(!this.cssFontInfo)x=new FontFace(this.loadedName,this.data,{});else{const M={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(M.style=`oblique ${this.cssFontInfo.italicAngle}deg`),x=new FontFace(this.cssFontInfo.fontFamily,this.data,M)}return(f=this._inspectFont)==null||f.call(this,this),x}createFontFaceRule(){var N;if(!this.data||this.disableFontFace)return null;const x=(0,c.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(x)});`;let M;if(!this.cssFontInfo)M=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let y=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(y+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),M=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${y}src:${f}}`}return(N=this._inspectFont)==null||N.call(this,this,f),M}getPathGenerator(x,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let M;try{M=x.get(this.loadedName+"_path_"+f)}catch(N){if(!this.ignoreErrors)throw N;return(0,c.warn)(`getPathGenerator - ignoring character: "${N}".`),this.compiledGlyphs[f]=function(y,D){}}if(this.isEvalSupported&&c.FeatureTest.isEvalSupported){const N=[];for(const y of M){const D=y.args!==void 0?y.args.join(","):"";N.push("c.",y.cmd,"(",D,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",N.join(""))}return this.compiledGlyphs[f]=function(N,y){for(const D of M)D.cmd==="scale"&&(D.args=[y,-y]),N[D.cmd].apply(N,D.args)}}}h.FontFaceObject=V},(pt,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.isNodeJS=void 0;const et=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");h.isNodeJS=et},(pt,h,et)=>{var st,Ie,vt,Le;Object.defineProperty(h,"__esModule",{value:!0}),h.CanvasGraphics=void 0;var c=et(1),P=et(6),Z=et(12),V=et(13),ot=et(10);const tt=16,x=100,f=4096,M=15,N=10,y=1e3,D=16;function r(j,o){if(j._removeMirroring)throw new Error("Context is already forwarding operations.");j.__originalSave=j.save,j.__originalRestore=j.restore,j.__originalRotate=j.rotate,j.__originalScale=j.scale,j.__originalTranslate=j.translate,j.__originalTransform=j.transform,j.__originalSetTransform=j.setTransform,j.__originalResetTransform=j.resetTransform,j.__originalClip=j.clip,j.__originalMoveTo=j.moveTo,j.__originalLineTo=j.lineTo,j.__originalBezierCurveTo=j.bezierCurveTo,j.__originalRect=j.rect,j.__originalClosePath=j.closePath,j.__originalBeginPath=j.beginPath,j._removeMirroring=()=>{j.save=j.__originalSave,j.restore=j.__originalRestore,j.rotate=j.__originalRotate,j.scale=j.__originalScale,j.translate=j.__originalTranslate,j.transform=j.__originalTransform,j.setTransform=j.__originalSetTransform,j.resetTransform=j.__originalResetTransform,j.clip=j.__originalClip,j.moveTo=j.__originalMoveTo,j.lineTo=j.__originalLineTo,j.bezierCurveTo=j.__originalBezierCurveTo,j.rect=j.__originalRect,j.closePath=j.__originalClosePath,j.beginPath=j.__originalBeginPath,delete j._removeMirroring},j.save=function(){o.save(),this.__originalSave()},j.restore=function(){o.restore(),this.__originalRestore()},j.translate=function(_,R){o.translate(_,R),this.__originalTranslate(_,R)},j.scale=function(_,R){o.scale(_,R),this.__originalScale(_,R)},j.transform=function(_,R,I,B,H,Y){o.transform(_,R,I,B,H,Y),this.__originalTransform(_,R,I,B,H,Y)},j.setTransform=function(_,R,I,B,H,Y){o.setTransform(_,R,I,B,H,Y),this.__originalSetTransform(_,R,I,B,H,Y)},j.resetTransform=function(){o.resetTransform(),this.__originalResetTransform()},j.rotate=function(_){o.rotate(_),this.__originalRotate(_)},j.clip=function(_){o.clip(_),this.__originalClip(_)},j.moveTo=function(a,_){o.moveTo(a,_),this.__originalMoveTo(a,_)},j.lineTo=function(a,_){o.lineTo(a,_),this.__originalLineTo(a,_)},j.bezierCurveTo=function(a,_,R,I,B,H){o.bezierCurveTo(a,_,R,I,B,H),this.__originalBezierCurveTo(a,_,R,I,B,H)},j.rect=function(a,_,R,I){o.rect(a,_,R,I),this.__originalRect(a,_,R,I)},j.closePath=function(){o.closePath(),this.__originalClosePath()},j.beginPath=function(){o.beginPath(),this.__originalBeginPath()}}class g{constructor(o){this.canvasFactory=o,this.cache=Object.create(null)}getCanvas(o,a,_){let R;return this.cache[o]!==void 0?(R=this.cache[o],this.canvasFactory.reset(R,a,_)):(R=this.canvasFactory.create(a,_),this.cache[o]=R),R}delete(o){delete this.cache[o]}clear(){for(const o in this.cache){const a=this.cache[o];this.canvasFactory.destroy(a),delete this.cache[o]}}}function A(j,o,a,_,R,I,B,H,Y,nt){const[rt,ct,dt,Et,ft,xt]=(0,P.getCurrentTransform)(j);if(ct===0&&dt===0){const bt=B*rt+ft,J=Math.round(bt),z=H*Et+xt,ut=Math.round(z),mt=(B+Y)*rt+ft,wt=Math.abs(Math.round(mt)-J)||1,Rt=(H+nt)*Et+xt,Nt=Math.abs(Math.round(Rt)-ut)||1;return j.setTransform(Math.sign(rt),0,0,Math.sign(Et),J,ut),j.drawImage(o,a,_,R,I,0,0,wt,Nt),j.setTransform(rt,ct,dt,Et,ft,xt),[wt,Nt]}if(rt===0&&Et===0){const bt=H*dt+ft,J=Math.round(bt),z=B*ct+xt,ut=Math.round(z),mt=(H+nt)*dt+ft,wt=Math.abs(Math.round(mt)-J)||1,Rt=(B+Y)*ct+xt,Nt=Math.abs(Math.round(Rt)-ut)||1;return j.setTransform(0,Math.sign(ct),Math.sign(dt),0,J,ut),j.drawImage(o,a,_,R,I,0,0,Nt,wt),j.setTransform(rt,ct,dt,Et,ft,xt),[Nt,wt]}j.drawImage(o,a,_,R,I,B,H,Y,nt);const It=Math.hypot(rt,ct),Tt=Math.hypot(dt,Et);return[It*Y,Tt*nt]}function S(j){const{width:o,height:a}=j;if(o>y||a>y)return null;const _=1e3,R=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),I=o+1;let B=new Uint8Array(I*(a+1)),H,Y,nt;const rt=o+7&-8;let ct=new Uint8Array(rt*a),dt=0;for(const Tt of j.data){let bt=128;for(;bt>0;)ct[dt++]=Tt&bt?0:255,bt>>=1}let Et=0;for(dt=0,ct[dt]!==0&&(B[0]=1,++Et),Y=1;Y<o;Y++)ct[dt]!==ct[dt+1]&&(B[Y]=ct[dt]?2:1,++Et),dt++;for(ct[dt]!==0&&(B[Y]=2,++Et),H=1;H<a;H++){dt=H*rt,nt=H*I,ct[dt-rt]!==ct[dt]&&(B[nt]=ct[dt]?1:8,++Et);let Tt=(ct[dt]?4:0)+(ct[dt-rt]?8:0);for(Y=1;Y<o;Y++)Tt=(Tt>>2)+(ct[dt+1]?4:0)+(ct[dt-rt+1]?8:0),R[Tt]&&(B[nt+Y]=R[Tt],++Et),dt++;if(ct[dt-rt]!==ct[dt]&&(B[nt+Y]=ct[dt]?2:4,++Et),Et>_)return null}for(dt=rt*(a-1),nt=H*I,ct[dt]!==0&&(B[nt]=8,++Et),Y=1;Y<o;Y++)ct[dt]!==ct[dt+1]&&(B[nt+Y]=ct[dt]?4:8,++Et),dt++;if(ct[dt]!==0&&(B[nt+Y]=4,++Et),Et>_)return null;const ft=new Int32Array([0,I,-1,0,-I,0,0,0,1]),xt=new Path2D;for(H=0;Et&&H<=a;H++){let Tt=H*I;const bt=Tt+o;for(;Tt<bt&&!B[Tt];)Tt++;if(Tt===bt)continue;xt.moveTo(Tt%I,H);const J=Tt;let z=B[Tt];do{const ut=ft[z];do Tt+=ut;while(!B[Tt]);const mt=B[Tt];mt!==5&&mt!==10?(z=mt,B[Tt]=0):(z=mt&51*z>>4,B[Tt]&=z>>2|z<<2),xt.lineTo(Tt%I,Tt/I|0),B[Tt]||--Et}while(J!==Tt);--H}return ct=null,B=null,function(Tt){Tt.save(),Tt.scale(1/o,-1/a),Tt.translate(0,-a),Tt.fill(xt),Tt.beginPath(),Tt.restore()}}class m{constructor(o,a){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=c.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=c.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,o,a])}clone(){const o=Object.create(this);return o.clipBox=this.clipBox.slice(),o}setCurrentPoint(o,a){this.x=o,this.y=a}updatePathMinMax(o,a,_){[a,_]=c.Util.applyTransform([a,_],o),this.minX=Math.min(this.minX,a),this.minY=Math.min(this.minY,_),this.maxX=Math.max(this.maxX,a),this.maxY=Math.max(this.maxY,_)}updateRectMinMax(o,a){const _=c.Util.applyTransform(a,o),R=c.Util.applyTransform(a.slice(2),o);this.minX=Math.min(this.minX,_[0],R[0]),this.minY=Math.min(this.minY,_[1],R[1]),this.maxX=Math.max(this.maxX,_[0],R[0]),this.maxY=Math.max(this.maxY,_[1],R[1])}updateScalingPathMinMax(o,a){c.Util.scaleMinMax(o,a),this.minX=Math.min(this.minX,a[0]),this.maxX=Math.max(this.maxX,a[1]),this.minY=Math.min(this.minY,a[2]),this.maxY=Math.max(this.maxY,a[3])}updateCurvePathMinMax(o,a,_,R,I,B,H,Y,nt,rt){const ct=c.Util.bezierBoundingBox(a,_,R,I,B,H,Y,nt);if(rt){rt[0]=Math.min(rt[0],ct[0],ct[2]),rt[1]=Math.max(rt[1],ct[0],ct[2]),rt[2]=Math.min(rt[2],ct[1],ct[3]),rt[3]=Math.max(rt[3],ct[1],ct[3]);return}this.updateRectMinMax(o,ct)}getPathBoundingBox(o=Z.PathType.FILL,a=null){const _=[this.minX,this.minY,this.maxX,this.maxY];if(o===Z.PathType.STROKE){a||(0,c.unreachable)("Stroke bounding box must include transform.");const R=c.Util.singularValueDecompose2dScale(a),I=R[0]*this.lineWidth/2,B=R[1]*this.lineWidth/2;_[0]-=I,_[1]-=B,_[2]+=I,_[3]+=B}return _}updateClipFromPath(){const o=c.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(o||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(o){this.clipBox=o,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(o=Z.PathType.FILL,a=null){return c.Util.intersect(this.clipBox,this.getPathBoundingBox(o,a))}}function d(j,o){if(typeof ImageData<"u"&&o instanceof ImageData){j.putImageData(o,0,0);return}const a=o.height,_=o.width,R=a%D,I=(a-R)/D,B=R===0?I:I+1,H=j.createImageData(_,D);let Y=0,nt;const rt=o.data,ct=H.data;let dt,Et,ft,xt;if(o.kind===c.ImageKind.GRAYSCALE_1BPP){const It=rt.byteLength,Tt=new Uint32Array(ct.buffer,0,ct.byteLength>>2),bt=Tt.length,J=_+7>>3,z=4294967295,ut=c.FeatureTest.isLittleEndian?4278190080:255;for(dt=0;dt<B;dt++){for(ft=dt<I?D:R,nt=0,Et=0;Et<ft;Et++){const mt=It-Y;let wt=0;const Rt=mt>J?_:mt*8-7,Nt=Rt&-8;let jt=0,Ft=0;for(;wt<Nt;wt+=8)Ft=rt[Y++],Tt[nt++]=Ft&128?z:ut,Tt[nt++]=Ft&64?z:ut,Tt[nt++]=Ft&32?z:ut,Tt[nt++]=Ft&16?z:ut,Tt[nt++]=Ft&8?z:ut,Tt[nt++]=Ft&4?z:ut,Tt[nt++]=Ft&2?z:ut,Tt[nt++]=Ft&1?z:ut;for(;wt<Rt;wt++)jt===0&&(Ft=rt[Y++],jt=128),Tt[nt++]=Ft&jt?z:ut,jt>>=1}for(;nt<bt;)Tt[nt++]=0;j.putImageData(H,0,dt*D)}}else if(o.kind===c.ImageKind.RGBA_32BPP){for(Et=0,xt=_*D*4,dt=0;dt<I;dt++)ct.set(rt.subarray(Y,Y+xt)),Y+=xt,j.putImageData(H,0,Et),Et+=D;dt<B&&(xt=_*R*4,ct.set(rt.subarray(Y,Y+xt)),j.putImageData(H,0,Et))}else if(o.kind===c.ImageKind.RGB_24BPP)for(ft=D,xt=_*ft,dt=0;dt<B;dt++){for(dt>=I&&(ft=R,xt=_*ft),nt=0,Et=xt;Et--;)ct[nt++]=rt[Y++],ct[nt++]=rt[Y++],ct[nt++]=rt[Y++],ct[nt++]=255;j.putImageData(H,0,dt*D)}else throw new Error(`bad image kind: ${o.kind}`)}function E(j,o){if(o.bitmap){j.drawImage(o.bitmap,0,0);return}const a=o.height,_=o.width,R=a%D,I=(a-R)/D,B=R===0?I:I+1,H=j.createImageData(_,D);let Y=0;const nt=o.data,rt=H.data;for(let ct=0;ct<B;ct++){const dt=ct<I?D:R;({srcPos:Y}=(0,V.convertBlackAndWhiteToRGBA)({src:nt,srcPos:Y,dest:rt,width:_,height:dt,nonBlackColor:0})),j.putImageData(H,0,ct*D)}}function n(j,o){const a=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const _ of a)j[_]!==void 0&&(o[_]=j[_]);j.setLineDash!==void 0&&(o.setLineDash(j.getLineDash()),o.lineDashOffset=j.lineDashOffset)}function t(j){j.strokeStyle=j.fillStyle="#000000",j.fillRule="nonzero",j.globalAlpha=1,j.lineWidth=1,j.lineCap="butt",j.lineJoin="miter",j.miterLimit=10,j.globalCompositeOperation="source-over",j.font="10px sans-serif",j.setLineDash!==void 0&&(j.setLineDash([]),j.lineDashOffset=0),ot.isNodeJS||(j.filter="none")}function e(j,o,a,_){const R=j.length;for(let I=3;I<R;I+=4){const B=j[I];if(B===0)j[I-3]=o,j[I-2]=a,j[I-1]=_;else if(B<255){const H=255-B;j[I-3]=j[I-3]*B+o*H>>8,j[I-2]=j[I-2]*B+a*H>>8,j[I-1]=j[I-1]*B+_*H>>8}}}function l(j,o,a){const _=j.length,R=1/255;for(let I=3;I<_;I+=4){const B=a?a[j[I]]:j[I];o[I]=o[I]*B*R|0}}function p(j,o,a){const _=j.length;for(let R=3;R<_;R+=4){const I=j[R-3]*77+j[R-2]*152+j[R-1]*28;o[R]=a?o[R]*a[I>>8]>>8:o[R]*I>>16}}function F(j,o,a,_,R,I,B,H,Y,nt,rt){const ct=!!I,dt=ct?I[0]:0,Et=ct?I[1]:0,ft=ct?I[2]:0;let xt;R==="Luminosity"?xt=p:xt=l;const Tt=Math.min(_,Math.ceil(1048576/a));for(let bt=0;bt<_;bt+=Tt){const J=Math.min(Tt,_-bt),z=j.getImageData(H-nt,bt+(Y-rt),a,J),ut=o.getImageData(H,bt+Y,a,J);ct&&e(z.data,dt,Et,ft),xt(z.data,ut.data,B),o.putImageData(ut,H,bt+Y)}}function O(j,o,a,_){const R=_[0],I=_[1],B=_[2]-R,H=_[3]-I;B===0||H===0||(F(o.context,a,B,H,o.subtype,o.backdrop,o.transferMap,R,I,o.offsetX,o.offsetY),j.save(),j.globalAlpha=1,j.globalCompositeOperation="source-over",j.setTransform(1,0,0,1,0,0),j.drawImage(a.canvas,0,0),j.restore())}function X(j,o){const a=c.Util.singularValueDecompose2dScale(j);a[0]=Math.fround(a[0]),a[1]=Math.fround(a[1]);const _=Math.fround((globalThis.devicePixelRatio||1)*P.PixelsPerInch.PDF_TO_CSS_UNITS);return o!==void 0?o:a[0]<=_||a[1]<=_}const w=["butt","round","square"],G=["miter","round","bevel"],it={},ht={},Dt=class Dt{constructor(o,a,_,R,I,{optionalContentConfig:B,markedContentStack:H=null},Y,nt){W(this,st);W(this,vt);this.ctx=o,this.current=new m(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=a,this.objs=_,this.canvasFactory=R,this.filterFactory=I,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=H||[],this.optionalContentConfig=B,this.cachedCanvases=new g(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Y,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=nt,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(o,a=null){return typeof o=="string"?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):a}beginDrawing({transform:o,viewport:a,transparency:_=!1,background:R=null}){const I=this.ctx.canvas.width,B=this.ctx.canvas.height,H=this.ctx.fillStyle;if(this.ctx.fillStyle=R||"#ffffff",this.ctx.fillRect(0,0,I,B),this.ctx.fillStyle=H,_){const Y=this.cachedCanvases.getCanvas("transparent",I,B);this.compositeCtx=this.ctx,this.transparentCanvas=Y.canvas,this.ctx=Y.context,this.ctx.save(),this.ctx.transform(...(0,P.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),t(this.ctx),o&&(this.ctx.transform(...o),this.outputScaleX=o[0],this.outputScaleY=o[0]),this.ctx.transform(...a.transform),this.viewportScale=a.scale,this.baseTransform=(0,P.getCurrentTransform)(this.ctx)}executeOperatorList(o,a,_,R){const I=o.argsArray,B=o.fnArray;let H=a||0;const Y=I.length;if(Y===H)return H;const nt=Y-H>N&&typeof _=="function",rt=nt?Date.now()+M:0;let ct=0;const dt=this.commonObjs,Et=this.objs;let ft;for(;;){if(R!==void 0&&H===R.nextBreakPoint)return R.breakIt(H,_),H;if(ft=B[H],ft!==c.OPS.dependency)this[ft].apply(this,I[H]);else for(const xt of I[H]){const It=xt.startsWith("g_")?dt:Et;if(!It.has(xt))return It.get(xt,_),H}if(H++,H===Y)return H;if(nt&&++ct>N){if(Date.now()>rt)return _(),H;ct=0}}}endDrawing(){Q(this,st,Ie).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const o of this._cachedBitmapsMap.values()){for(const a of o.values())typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement&&(a.width=a.height=0);o.clear()}this._cachedBitmapsMap.clear(),Q(this,vt,Le).call(this)}_scaleImage(o,a){const _=o.width,R=o.height;let I=Math.max(Math.hypot(a[0],a[1]),1),B=Math.max(Math.hypot(a[2],a[3]),1),H=_,Y=R,nt="prescale1",rt,ct;for(;I>2&&H>1||B>2&&Y>1;){let dt=H,Et=Y;I>2&&H>1&&(dt=H>=16384?Math.floor(H/2)-1||1:Math.ceil(H/2),I/=H/dt),B>2&&Y>1&&(Et=Y>=16384?Math.floor(Y/2)-1||1:Math.ceil(Y)/2,B/=Y/Et),rt=this.cachedCanvases.getCanvas(nt,dt,Et),ct=rt.context,ct.clearRect(0,0,dt,Et),ct.drawImage(o,0,0,H,Y,0,0,dt,Et),o=rt.canvas,H=dt,Y=Et,nt=nt==="prescale1"?"prescale2":"prescale1"}return{img:o,paintWidth:H,paintHeight:Y}}_createMaskCanvas(o){const a=this.ctx,{width:_,height:R}=o,I=this.current.fillColor,B=this.current.patternFill,H=(0,P.getCurrentTransform)(a);let Y,nt,rt,ct;if((o.bitmap||o.data)&&o.count>1){const wt=o.bitmap||o.data.buffer;nt=JSON.stringify(B?H:[H.slice(0,4),I]),Y=this._cachedBitmapsMap.get(wt),Y||(Y=new Map,this._cachedBitmapsMap.set(wt,Y));const Rt=Y.get(nt);if(Rt&&!B){const Nt=Math.round(Math.min(H[0],H[2])+H[4]),jt=Math.round(Math.min(H[1],H[3])+H[5]);return{canvas:Rt,offsetX:Nt,offsetY:jt}}rt=Rt}rt||(ct=this.cachedCanvases.getCanvas("maskCanvas",_,R),E(ct.context,o));let dt=c.Util.transform(H,[1/_,0,0,-1/R,0,0]);dt=c.Util.transform(dt,[1,0,0,1,0,-R]);const Et=c.Util.applyTransform([0,0],dt),ft=c.Util.applyTransform([_,R],dt),xt=c.Util.normalizeRect([Et[0],Et[1],ft[0],ft[1]]),It=Math.round(xt[2]-xt[0])||1,Tt=Math.round(xt[3]-xt[1])||1,bt=this.cachedCanvases.getCanvas("fillCanvas",It,Tt),J=bt.context,z=Math.min(Et[0],ft[0]),ut=Math.min(Et[1],ft[1]);J.translate(-z,-ut),J.transform(...dt),rt||(rt=this._scaleImage(ct.canvas,(0,P.getCurrentTransformInverse)(J)),rt=rt.img,Y&&B&&Y.set(nt,rt)),J.imageSmoothingEnabled=X((0,P.getCurrentTransform)(J),o.interpolate),A(J,rt,0,0,rt.width,rt.height,0,0,_,R),J.globalCompositeOperation="source-in";const mt=c.Util.transform((0,P.getCurrentTransformInverse)(J),[1,0,0,1,-z,-ut]);return J.fillStyle=B?I.getPattern(a,this,mt,Z.PathType.FILL):I,J.fillRect(0,0,_,R),Y&&!B&&(this.cachedCanvases.delete("fillCanvas"),Y.set(nt,bt.canvas)),{canvas:bt.canvas,offsetX:Math.round(z),offsetY:Math.round(ut)}}setLineWidth(o){o!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=o,this.ctx.lineWidth=o}setLineCap(o){this.ctx.lineCap=w[o]}setLineJoin(o){this.ctx.lineJoin=G[o]}setMiterLimit(o){this.ctx.miterLimit=o}setDash(o,a){const _=this.ctx;_.setLineDash!==void 0&&(_.setLineDash(o),_.lineDashOffset=a)}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(const[a,_]of o)switch(a){case"LW":this.setLineWidth(_);break;case"LC":this.setLineCap(_);break;case"LJ":this.setLineJoin(_);break;case"ML":this.setMiterLimit(_);break;case"D":this.setDash(_[0],_[1]);break;case"RI":this.setRenderingIntent(_);break;case"FL":this.setFlatness(_);break;case"Font":this.setFont(_[0],_[1]);break;case"CA":this.current.strokeAlpha=_;break;case"ca":this.current.fillAlpha=_,this.ctx.globalAlpha=_;break;case"BM":this.ctx.globalCompositeOperation=_;break;case"SMask":this.current.activeSMask=_?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(_);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const o=this.inSMaskMode;this.current.activeSMask&&!o?this.beginSMaskMode():!this.current.activeSMask&&o&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const o=this.ctx.canvas.width,a=this.ctx.canvas.height,_="smaskGroupAt"+this.groupLevel,R=this.cachedCanvases.getCanvas(_,o,a);this.suspendedCtx=this.ctx,this.ctx=R.context;const I=this.ctx;I.setTransform(...(0,P.getCurrentTransform)(this.suspendedCtx)),n(this.suspendedCtx,I),r(I,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),n(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(o){if(!this.current.activeSMask)return;o?(o[0]=Math.floor(o[0]),o[1]=Math.floor(o[1]),o[2]=Math.ceil(o[2]),o[3]=Math.ceil(o[3])):o=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const a=this.current.activeSMask,_=this.suspendedCtx;O(_,a,this.ctx,o),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(n(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const o=this.current;this.stateStack.push(o),this.current=o.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),n(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(o,a,_,R,I,B){this.ctx.transform(o,a,_,R,I,B),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(o,a,_){const R=this.ctx,I=this.current;let B=I.x,H=I.y,Y,nt;const rt=(0,P.getCurrentTransform)(R),ct=rt[0]===0&&rt[3]===0||rt[1]===0&&rt[2]===0,dt=ct?_.slice(0):null;for(let Et=0,ft=0,xt=o.length;Et<xt;Et++)switch(o[Et]|0){case c.OPS.rectangle:B=a[ft++],H=a[ft++];const It=a[ft++],Tt=a[ft++],bt=B+It,J=H+Tt;R.moveTo(B,H),It===0||Tt===0?R.lineTo(bt,J):(R.lineTo(bt,H),R.lineTo(bt,J),R.lineTo(B,J)),ct||I.updateRectMinMax(rt,[B,H,bt,J]),R.closePath();break;case c.OPS.moveTo:B=a[ft++],H=a[ft++],R.moveTo(B,H),ct||I.updatePathMinMax(rt,B,H);break;case c.OPS.lineTo:B=a[ft++],H=a[ft++],R.lineTo(B,H),ct||I.updatePathMinMax(rt,B,H);break;case c.OPS.curveTo:Y=B,nt=H,B=a[ft+4],H=a[ft+5],R.bezierCurveTo(a[ft],a[ft+1],a[ft+2],a[ft+3],B,H),I.updateCurvePathMinMax(rt,Y,nt,a[ft],a[ft+1],a[ft+2],a[ft+3],B,H,dt),ft+=6;break;case c.OPS.curveTo2:Y=B,nt=H,R.bezierCurveTo(B,H,a[ft],a[ft+1],a[ft+2],a[ft+3]),I.updateCurvePathMinMax(rt,Y,nt,B,H,a[ft],a[ft+1],a[ft+2],a[ft+3],dt),B=a[ft+2],H=a[ft+3],ft+=4;break;case c.OPS.curveTo3:Y=B,nt=H,B=a[ft+2],H=a[ft+3],R.bezierCurveTo(a[ft],a[ft+1],B,H,B,H),I.updateCurvePathMinMax(rt,Y,nt,a[ft],a[ft+1],B,H,B,H,dt),ft+=4;break;case c.OPS.closePath:R.closePath();break}ct&&I.updateScalingPathMinMax(rt,dt),I.setCurrentPoint(B,H)}closePath(){this.ctx.closePath()}stroke(o=!0){const a=this.ctx,_=this.current.strokeColor;a.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof _=="object"&&(_!=null&&_.getPattern)?(a.save(),a.strokeStyle=_.getPattern(a,this,(0,P.getCurrentTransformInverse)(a),Z.PathType.STROKE),this.rescaleAndStroke(!1),a.restore()):this.rescaleAndStroke(!0)),o&&this.consumePath(this.current.getClippedPathBoundingBox()),a.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(o=!0){const a=this.ctx,_=this.current.fillColor,R=this.current.patternFill;let I=!1;R&&(a.save(),a.fillStyle=_.getPattern(a,this,(0,P.getCurrentTransformInverse)(a),Z.PathType.FILL),I=!0);const B=this.current.getClippedPathBoundingBox();this.contentVisible&&B!==null&&(this.pendingEOFill?(a.fill("evenodd"),this.pendingEOFill=!1):a.fill()),I&&a.restore(),o&&this.consumePath(B)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=it}eoClip(){this.pendingClip=ht}beginText(){this.current.textMatrix=c.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const o=this.pendingTextPaths,a=this.ctx;if(o===void 0){a.beginPath();return}a.save(),a.beginPath();for(const _ of o)a.setTransform(..._.transform),a.translate(_.x,_.y),_.addToPath(a,_.fontSize);a.restore(),a.clip(),a.beginPath(),delete this.pendingTextPaths}setCharSpacing(o){this.current.charSpacing=o}setWordSpacing(o){this.current.wordSpacing=o}setHScale(o){this.current.textHScale=o/100}setLeading(o){this.current.leading=-o}setFont(o,a){var rt;const _=this.commonObjs.get(o),R=this.current;if(!_)throw new Error(`Can't find font for ${o}`);if(R.fontMatrix=_.fontMatrix||c.FONT_IDENTITY_MATRIX,(R.fontMatrix[0]===0||R.fontMatrix[3]===0)&&(0,c.warn)("Invalid font matrix for font "+o),a<0?(a=-a,R.fontDirection=-1):R.fontDirection=1,this.current.font=_,this.current.fontSize=a,_.isType3Font)return;const I=_.loadedName||"sans-serif",B=((rt=_.systemFontInfo)==null?void 0:rt.css)||`"${I}", ${_.fallbackName}`;let H="normal";_.black?H="900":_.bold&&(H="bold");const Y=_.italic?"italic":"normal";let nt=a;a<tt?nt=tt:a>x&&(nt=x),this.current.fontSizeScale=a/nt,this.ctx.font=`${Y} ${H} ${nt}px ${B}`}setTextRenderingMode(o){this.current.textRenderingMode=o}setTextRise(o){this.current.textRise=o}moveText(o,a){this.current.x=this.current.lineX+=o,this.current.y=this.current.lineY+=a}setLeadingMoveText(o,a){this.setLeading(-a),this.moveText(o,a)}setTextMatrix(o,a,_,R,I,B){this.current.textMatrix=[o,a,_,R,I,B],this.current.textMatrixScale=Math.hypot(o,a),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(o,a,_,R){const I=this.ctx,B=this.current,H=B.font,Y=B.textRenderingMode,nt=B.fontSize/B.fontSizeScale,rt=Y&c.TextRenderingMode.FILL_STROKE_MASK,ct=!!(Y&c.TextRenderingMode.ADD_TO_PATH_FLAG),dt=B.patternFill&&!H.missingFile;let Et;(H.disableFontFace||ct||dt)&&(Et=H.getPathGenerator(this.commonObjs,o)),H.disableFontFace||dt?(I.save(),I.translate(a,_),I.beginPath(),Et(I,nt),R&&I.setTransform(...R),(rt===c.TextRenderingMode.FILL||rt===c.TextRenderingMode.FILL_STROKE)&&I.fill(),(rt===c.TextRenderingMode.STROKE||rt===c.TextRenderingMode.FILL_STROKE)&&I.stroke(),I.restore()):((rt===c.TextRenderingMode.FILL||rt===c.TextRenderingMode.FILL_STROKE)&&I.fillText(o,a,_),(rt===c.TextRenderingMode.STROKE||rt===c.TextRenderingMode.FILL_STROKE)&&I.strokeText(o,a,_)),ct&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,P.getCurrentTransform)(I),x:a,y:_,fontSize:nt,addToPath:Et})}get isFontSubpixelAAEnabled(){const{context:o}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);o.scale(1.5,1),o.fillText("I",0,10);const a=o.getImageData(0,0,10,10).data;let _=!1;for(let R=3;R<a.length;R+=4)if(a[R]>0&&a[R]<255){_=!0;break}return(0,c.shadow)(this,"isFontSubpixelAAEnabled",_)}showText(o){const a=this.current,_=a.font;if(_.isType3Font)return this.showType3Text(o);const R=a.fontSize;if(R===0)return;const I=this.ctx,B=a.fontSizeScale,H=a.charSpacing,Y=a.wordSpacing,nt=a.fontDirection,rt=a.textHScale*nt,ct=o.length,dt=_.vertical,Et=dt?1:-1,ft=_.defaultVMetrics,xt=R*a.fontMatrix[0],It=a.textRenderingMode===c.TextRenderingMode.FILL&&!_.disableFontFace&&!a.patternFill;I.save(),I.transform(...a.textMatrix),I.translate(a.x,a.y+a.textRise),nt>0?I.scale(rt,-1):I.scale(rt,1);let Tt;if(a.patternFill){I.save();const mt=a.fillColor.getPattern(I,this,(0,P.getCurrentTransformInverse)(I),Z.PathType.FILL);Tt=(0,P.getCurrentTransform)(I),I.restore(),I.fillStyle=mt}let bt=a.lineWidth;const J=a.textMatrixScale;if(J===0||bt===0){const mt=a.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;(mt===c.TextRenderingMode.STROKE||mt===c.TextRenderingMode.FILL_STROKE)&&(bt=this.getSinglePixelWidth())}else bt/=J;if(B!==1&&(I.scale(B,B),bt/=B),I.lineWidth=bt,_.isInvalidPDFjsFont){const mt=[];let wt=0;for(const Rt of o)mt.push(Rt.unicode),wt+=Rt.width;I.fillText(mt.join(""),0,0),a.x+=wt*xt*rt,I.restore(),this.compose();return}let z=0,ut;for(ut=0;ut<ct;++ut){const mt=o[ut];if(typeof mt=="number"){z+=Et*mt*R/1e3;continue}let wt=!1;const Rt=(mt.isSpace?Y:0)+H,Nt=mt.fontChar,jt=mt.accent;let Ft,v,C=mt.width;if(dt){const at=mt.vmetric||ft,kt=-(mt.vmetric?at[1]:C*.5)*xt,Lt=at[2]*xt;C=at?-at[0]:C,Ft=kt/B,v=(z+Lt)/B}else Ft=z/B,v=0;if(_.remeasure&&C>0){const at=I.measureText(Nt).width*1e3/R*B;if(C<at&&this.isFontSubpixelAAEnabled){const kt=C/at;wt=!0,I.save(),I.scale(kt,1),Ft/=kt}else C!==at&&(Ft+=(C-at)/2e3*R/B)}if(this.contentVisible&&(mt.isInFont||_.missingFile)){if(It&&!jt)I.fillText(Nt,Ft,v);else if(this.paintChar(Nt,Ft,v,Tt),jt){const at=Ft+R*jt.offset.x/B,kt=v-R*jt.offset.y/B;this.paintChar(jt.fontChar,at,kt,Tt)}}let L;dt?L=C*xt-Rt*nt:L=C*xt+Rt*nt,z+=L,wt&&I.restore()}dt?a.y-=z:a.x+=z*rt,I.restore(),this.compose()}showType3Text(o){const a=this.ctx,_=this.current,R=_.font,I=_.fontSize,B=_.fontDirection,H=R.vertical?1:-1,Y=_.charSpacing,nt=_.wordSpacing,rt=_.textHScale*B,ct=_.fontMatrix||c.FONT_IDENTITY_MATRIX,dt=o.length,Et=_.textRenderingMode===c.TextRenderingMode.INVISIBLE;let ft,xt,It,Tt;if(!(Et||I===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,a.save(),a.transform(..._.textMatrix),a.translate(_.x,_.y),a.scale(rt,B),ft=0;ft<dt;++ft){if(xt=o[ft],typeof xt=="number"){Tt=H*xt*I/1e3,this.ctx.translate(Tt,0),_.x+=Tt*rt;continue}const bt=(xt.isSpace?nt:0)+Y,J=R.charProcOperatorList[xt.operatorListId];if(!J){(0,c.warn)(`Type3 character "${xt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=xt,this.save(),a.scale(I,I),a.transform(...ct),this.executeOperatorList(J),this.restore()),It=c.Util.applyTransform([xt.width,0],ct)[0]*I+bt,a.translate(It,0),_.x+=It*rt}a.restore(),this.processingType3=null}}setCharWidth(o,a){}setCharWidthAndBounds(o,a,_,R,I,B){this.ctx.rect(_,R,I-_,B-R),this.ctx.clip(),this.endPath()}getColorN_Pattern(o){let a;if(o[0]==="TilingPattern"){const _=o[1],R=this.baseTransform||(0,P.getCurrentTransform)(this.ctx),I={createCanvasGraphics:B=>new Dt(B,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};a=new Z.TilingPattern(o,_,this.ctx,I,R)}else a=this._getPattern(o[1],o[2]);return a}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(o,a,_){const R=c.Util.makeHexColor(o,a,_);this.ctx.strokeStyle=R,this.current.strokeColor=R}setFillRGBColor(o,a,_){const R=c.Util.makeHexColor(o,a,_);this.ctx.fillStyle=R,this.current.fillColor=R,this.current.patternFill=!1}_getPattern(o,a=null){let _;return this.cachedPatterns.has(o)?_=this.cachedPatterns.get(o):(_=(0,Z.getShadingPattern)(this.getObject(o)),this.cachedPatterns.set(o,_)),a&&(_.matrix=a),_}shadingFill(o){if(!this.contentVisible)return;const a=this.ctx;this.save();const _=this._getPattern(o);a.fillStyle=_.getPattern(a,this,(0,P.getCurrentTransformInverse)(a),Z.PathType.SHADING);const R=(0,P.getCurrentTransformInverse)(a);if(R){const{width:I,height:B}=a.canvas,[H,Y,nt,rt]=c.Util.getAxialAlignedBoundingBox([0,0,I,B],R);this.ctx.fillRect(H,Y,nt-H,rt-Y)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,c.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,c.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(o,a){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(o)&&o.length===6&&this.transform(...o),this.baseTransform=(0,P.getCurrentTransform)(this.ctx),a)){const _=a[2]-a[0],R=a[3]-a[1];this.ctx.rect(a[0],a[1],_,R),this.current.updateRectMinMax((0,P.getCurrentTransform)(this.ctx),a),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(o){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const a=this.ctx;o.isolated||(0,c.info)("TODO: Support non-isolated groups."),o.knockout&&(0,c.warn)("Knockout groups not supported.");const _=(0,P.getCurrentTransform)(a);if(o.matrix&&a.transform(...o.matrix),!o.bbox)throw new Error("Bounding box is required.");let R=c.Util.getAxialAlignedBoundingBox(o.bbox,(0,P.getCurrentTransform)(a));const I=[0,0,a.canvas.width,a.canvas.height];R=c.Util.intersect(R,I)||[0,0,0,0];const B=Math.floor(R[0]),H=Math.floor(R[1]);let Y=Math.max(Math.ceil(R[2])-B,1),nt=Math.max(Math.ceil(R[3])-H,1),rt=1,ct=1;Y>f&&(rt=Y/f,Y=f),nt>f&&(ct=nt/f,nt=f),this.current.startNewPathAndClipBox([0,0,Y,nt]);let dt="groupAt"+this.groupLevel;o.smask&&(dt+="_smask_"+this.smaskCounter++%2);const Et=this.cachedCanvases.getCanvas(dt,Y,nt),ft=Et.context;ft.scale(1/rt,1/ct),ft.translate(-B,-H),ft.transform(..._),o.smask?this.smaskStack.push({canvas:Et.canvas,context:ft,offsetX:B,offsetY:H,scaleX:rt,scaleY:ct,subtype:o.smask.subtype,backdrop:o.smask.backdrop,transferMap:o.smask.transferMap||null,startTransformInverse:null}):(a.setTransform(1,0,0,1,0,0),a.translate(B,H),a.scale(rt,ct),a.save()),n(a,ft),this.ctx=ft,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(a),this.groupLevel++}endGroup(o){if(!this.contentVisible)return;this.groupLevel--;const a=this.ctx,_=this.groupStack.pop();if(this.ctx=_,this.ctx.imageSmoothingEnabled=!1,o.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const R=(0,P.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...R);const I=c.Util.getAxialAlignedBoundingBox([0,0,a.canvas.width,a.canvas.height],R);this.ctx.drawImage(a.canvas,0,0),this.ctx.restore(),this.compose(I)}}beginAnnotation(o,a,_,R,I){if(Q(this,st,Ie).call(this),t(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(a)&&a.length===4){const B=a[2]-a[0],H=a[3]-a[1];if(I&&this.annotationCanvasMap){_=_.slice(),_[4]-=a[0],_[5]-=a[1],a=a.slice(),a[0]=a[1]=0,a[2]=B,a[3]=H;const[Y,nt]=c.Util.singularValueDecompose2dScale((0,P.getCurrentTransform)(this.ctx)),{viewportScale:rt}=this,ct=Math.ceil(B*this.outputScaleX*rt),dt=Math.ceil(H*this.outputScaleY*rt);this.annotationCanvas=this.canvasFactory.create(ct,dt);const{canvas:Et,context:ft}=this.annotationCanvas;this.annotationCanvasMap.set(o,Et),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ft,this.ctx.save(),this.ctx.setTransform(Y,0,0,-nt,0,H*nt),t(this.ctx)}else t(this.ctx),this.ctx.rect(a[0],a[1],B,H),this.ctx.clip(),this.endPath()}this.current=new m(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(..._),this.transform(...R)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Q(this,vt,Le).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(o){if(!this.contentVisible)return;const a=o.count;o=this.getObject(o.data,o),o.count=a;const _=this.ctx,R=this.processingType3;if(R&&(R.compiled===void 0&&(R.compiled=S(o)),R.compiled)){R.compiled(_);return}const I=this._createMaskCanvas(o),B=I.canvas;_.save(),_.setTransform(1,0,0,1,0,0),_.drawImage(B,I.offsetX,I.offsetY),_.restore(),this.compose()}paintImageMaskXObjectRepeat(o,a,_=0,R=0,I,B){if(!this.contentVisible)return;o=this.getObject(o.data,o);const H=this.ctx;H.save();const Y=(0,P.getCurrentTransform)(H);H.transform(a,_,R,I,0,0);const nt=this._createMaskCanvas(o);H.setTransform(1,0,0,1,nt.offsetX-Y[4],nt.offsetY-Y[5]);for(let rt=0,ct=B.length;rt<ct;rt+=2){const dt=c.Util.transform(Y,[a,_,R,I,B[rt],B[rt+1]]),[Et,ft]=c.Util.applyTransform([0,0],dt);H.drawImage(nt.canvas,Et,ft)}H.restore(),this.compose()}paintImageMaskXObjectGroup(o){if(!this.contentVisible)return;const a=this.ctx,_=this.current.fillColor,R=this.current.patternFill;for(const I of o){const{data:B,width:H,height:Y,transform:nt}=I,rt=this.cachedCanvases.getCanvas("maskCanvas",H,Y),ct=rt.context;ct.save();const dt=this.getObject(B,I);E(ct,dt),ct.globalCompositeOperation="source-in",ct.fillStyle=R?_.getPattern(ct,this,(0,P.getCurrentTransformInverse)(a),Z.PathType.FILL):_,ct.fillRect(0,0,H,Y),ct.restore(),a.save(),a.transform(...nt),a.scale(1,-1),A(a,rt.canvas,0,0,H,Y,0,-1,1,1),a.restore()}this.compose()}paintImageXObject(o){if(!this.contentVisible)return;const a=this.getObject(o);if(!a){(0,c.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(a)}paintImageXObjectRepeat(o,a,_,R){if(!this.contentVisible)return;const I=this.getObject(o);if(!I){(0,c.warn)("Dependent image isn't ready yet");return}const B=I.width,H=I.height,Y=[];for(let nt=0,rt=R.length;nt<rt;nt+=2)Y.push({transform:[a,0,0,_,R[nt],R[nt+1]],x:0,y:0,w:B,h:H});this.paintInlineImageXObjectGroup(I,Y)}applyTransferMapsToCanvas(o){return this.current.transferMaps!=="none"&&(o.filter=this.current.transferMaps,o.drawImage(o.canvas,0,0),o.filter="none"),o.canvas}applyTransferMapsToBitmap(o){if(this.current.transferMaps==="none")return o.bitmap;const{bitmap:a,width:_,height:R}=o,I=this.cachedCanvases.getCanvas("inlineImage",_,R),B=I.context;return B.filter=this.current.transferMaps,B.drawImage(a,0,0),B.filter="none",I.canvas}paintInlineImageXObject(o){if(!this.contentVisible)return;const a=o.width,_=o.height,R=this.ctx;this.save(),ot.isNodeJS||(R.filter="none"),R.scale(1/a,-1/_);let I;if(o.bitmap)I=this.applyTransferMapsToBitmap(o);else if(typeof HTMLElement=="function"&&o instanceof HTMLElement||!o.data)I=o;else{const Y=this.cachedCanvases.getCanvas("inlineImage",a,_).context;d(Y,o),I=this.applyTransferMapsToCanvas(Y)}const B=this._scaleImage(I,(0,P.getCurrentTransformInverse)(R));R.imageSmoothingEnabled=X((0,P.getCurrentTransform)(R),o.interpolate),A(R,B.img,0,0,B.paintWidth,B.paintHeight,0,-_,a,_),this.compose(),this.restore()}paintInlineImageXObjectGroup(o,a){if(!this.contentVisible)return;const _=this.ctx;let R;if(o.bitmap)R=o.bitmap;else{const I=o.width,B=o.height,Y=this.cachedCanvases.getCanvas("inlineImage",I,B).context;d(Y,o),R=this.applyTransferMapsToCanvas(Y)}for(const I of a)_.save(),_.transform(...I.transform),_.scale(1,-1),A(_,R,I.x,I.y,I.w,I.h,0,-1,1,1),_.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(o){}markPointProps(o,a){}beginMarkedContent(o){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(o,a){o==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(a)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(o){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(o);const _=this.ctx;this.pendingClip&&(a||(this.pendingClip===ht?_.clip("evenodd"):_.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),_.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const o=(0,P.getCurrentTransform)(this.ctx);if(o[1]===0&&o[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(o[0]),Math.abs(o[3]));else{const a=Math.abs(o[0]*o[3]-o[2]*o[1]),_=Math.hypot(o[0],o[2]),R=Math.hypot(o[1],o[3]);this._cachedGetSinglePixelWidth=Math.max(_,R)/a}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:o}=this.current,{a,b:_,c:R,d:I}=this.ctx.getTransform();let B,H;if(_===0&&R===0){const Y=Math.abs(a),nt=Math.abs(I);if(Y===nt)if(o===0)B=H=1/Y;else{const rt=Y*o;B=H=rt<1?1/rt:1}else if(o===0)B=1/Y,H=1/nt;else{const rt=Y*o,ct=nt*o;B=rt<1?1/rt:1,H=ct<1?1/ct:1}}else{const Y=Math.abs(a*I-_*R),nt=Math.hypot(a,_),rt=Math.hypot(R,I);if(o===0)B=rt/Y,H=nt/Y;else{const ct=o*Y;B=rt>ct?rt/ct:1,H=nt>ct?nt/ct:1}}this._cachedScaleForStroking[0]=B,this._cachedScaleForStroking[1]=H}return this._cachedScaleForStroking}rescaleAndStroke(o){const{ctx:a}=this,{lineWidth:_}=this.current,[R,I]=this.getScaleForStroking();if(a.lineWidth=_||1,R===1&&I===1){a.stroke();return}const B=a.getLineDash();if(o&&a.save(),a.scale(R,I),B.length>0){const H=Math.max(R,I);a.setLineDash(B.map(Y=>Y/H)),a.lineDashOffset/=H}a.stroke(),o&&a.restore()}isContentVisible(){for(let o=this.markedContentStack.length-1;o>=0;o--)if(!this.markedContentStack[o].visible)return!1;return!0}};st=new WeakSet,Ie=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},vt=new WeakSet,Le=function(){if(this.pageColors){const o=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(o!=="none"){const a=this.ctx.filter;this.ctx.filter=o,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=a}}};let q=Dt;h.CanvasGraphics=q;for(const j in c.OPS)q.prototype[j]!==void 0&&(q.prototype[c.OPS[j]]=q.prototype[j])},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.TilingPattern=h.PathType=void 0,h.getShadingPattern=y;var c=et(1),P=et(6);const Z={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};h.PathType=Z;function V(A,S){if(!S)return;const m=S[2]-S[0],d=S[3]-S[1],E=new Path2D;E.rect(S[0],S[1],m,d),A.clip(E)}class ot{constructor(){this.constructor===ot&&(0,c.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,c.unreachable)("Abstract method `getPattern` called.")}}class tt extends ot{constructor(S){super(),this._type=S[1],this._bbox=S[2],this._colorStops=S[3],this._p0=S[4],this._p1=S[5],this._r0=S[6],this._r1=S[7],this.matrix=null}_createGradient(S){let m;this._type==="axial"?m=S.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(m=S.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const d of this._colorStops)m.addColorStop(d[0],d[1]);return m}getPattern(S,m,d,E){let n;if(E===Z.STROKE||E===Z.FILL){const t=m.current.getClippedPathBoundingBox(E,(0,P.getCurrentTransform)(S))||[0,0,0,0],e=Math.ceil(t[2]-t[0])||1,l=Math.ceil(t[3]-t[1])||1,p=m.cachedCanvases.getCanvas("pattern",e,l,!0),F=p.context;F.clearRect(0,0,F.canvas.width,F.canvas.height),F.beginPath(),F.rect(0,0,F.canvas.width,F.canvas.height),F.translate(-t[0],-t[1]),d=c.Util.transform(d,[1,0,0,1,t[0],t[1]]),F.transform(...m.baseTransform),this.matrix&&F.transform(...this.matrix),V(F,this._bbox),F.fillStyle=this._createGradient(F),F.fill(),n=S.createPattern(p.canvas,"no-repeat");const O=new DOMMatrix(d);n.setTransform(O)}else V(S,this._bbox),n=this._createGradient(S);return n}}function x(A,S,m,d,E,n,t,e){const l=S.coords,p=S.colors,F=A.data,O=A.width*4;let X;l[m+1]>l[d+1]&&(X=m,m=d,d=X,X=n,n=t,t=X),l[d+1]>l[E+1]&&(X=d,d=E,E=X,X=t,t=e,e=X),l[m+1]>l[d+1]&&(X=m,m=d,d=X,X=n,n=t,t=X);const w=(l[m]+S.offsetX)*S.scaleX,G=(l[m+1]+S.offsetY)*S.scaleY,it=(l[d]+S.offsetX)*S.scaleX,ht=(l[d+1]+S.offsetY)*S.scaleY,q=(l[E]+S.offsetX)*S.scaleX,st=(l[E+1]+S.offsetY)*S.scaleY;if(G>=st)return;const St=p[n],vt=p[n+1],yt=p[n+2],Dt=p[t],j=p[t+1],o=p[t+2],a=p[e],_=p[e+1],R=p[e+2],I=Math.round(G),B=Math.round(st);let H,Y,nt,rt,ct,dt,Et,ft;for(let xt=I;xt<=B;xt++){if(xt<ht){let z;xt<G?z=0:z=(G-xt)/(G-ht),H=w-(w-it)*z,Y=St-(St-Dt)*z,nt=vt-(vt-j)*z,rt=yt-(yt-o)*z}else{let z;xt>st?z=1:ht===st?z=0:z=(ht-xt)/(ht-st),H=it-(it-q)*z,Y=Dt-(Dt-a)*z,nt=j-(j-_)*z,rt=o-(o-R)*z}let It;xt<G?It=0:xt>st?It=1:It=(G-xt)/(G-st),ct=w-(w-q)*It,dt=St-(St-a)*It,Et=vt-(vt-_)*It,ft=yt-(yt-R)*It;const Tt=Math.round(Math.min(H,ct)),bt=Math.round(Math.max(H,ct));let J=O*xt+Tt*4;for(let z=Tt;z<=bt;z++)It=(H-z)/(H-ct),It<0?It=0:It>1&&(It=1),F[J++]=Y-(Y-dt)*It|0,F[J++]=nt-(nt-Et)*It|0,F[J++]=rt-(rt-ft)*It|0,F[J++]=255}}function f(A,S,m){const d=S.coords,E=S.colors;let n,t;switch(S.type){case"lattice":const e=S.verticesPerRow,l=Math.floor(d.length/e)-1,p=e-1;for(n=0;n<l;n++){let F=n*e;for(let O=0;O<p;O++,F++)x(A,m,d[F],d[F+1],d[F+e],E[F],E[F+1],E[F+e]),x(A,m,d[F+e+1],d[F+1],d[F+e],E[F+e+1],E[F+1],E[F+e])}break;case"triangles":for(n=0,t=d.length;n<t;n+=3)x(A,m,d[n],d[n+1],d[n+2],E[n],E[n+1],E[n+2]);break;default:throw new Error("illegal figure")}}class M extends ot{constructor(S){super(),this._coords=S[2],this._colors=S[3],this._figures=S[4],this._bounds=S[5],this._bbox=S[7],this._background=S[8],this.matrix=null}_createMeshCanvas(S,m,d){const e=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),p=Math.ceil(this._bounds[2])-e,F=Math.ceil(this._bounds[3])-l,O=Math.min(Math.ceil(Math.abs(p*S[0]*1.1)),3e3),X=Math.min(Math.ceil(Math.abs(F*S[1]*1.1)),3e3),w=p/O,G=F/X,it={coords:this._coords,colors:this._colors,offsetX:-e,offsetY:-l,scaleX:1/w,scaleY:1/G},ht=O+2*2,q=X+2*2,st=d.getCanvas("mesh",ht,q,!1),St=st.context,vt=St.createImageData(O,X);if(m){const Dt=vt.data;for(let j=0,o=Dt.length;j<o;j+=4)Dt[j]=m[0],Dt[j+1]=m[1],Dt[j+2]=m[2],Dt[j+3]=255}for(const Dt of this._figures)f(vt,Dt,it);return St.putImageData(vt,2,2),{canvas:st.canvas,offsetX:e-2*w,offsetY:l-2*G,scaleX:w,scaleY:G}}getPattern(S,m,d,E){V(S,this._bbox);let n;if(E===Z.SHADING)n=c.Util.singularValueDecompose2dScale((0,P.getCurrentTransform)(S));else if(n=c.Util.singularValueDecompose2dScale(m.baseTransform),this.matrix){const e=c.Util.singularValueDecompose2dScale(this.matrix);n=[n[0]*e[0],n[1]*e[1]]}const t=this._createMeshCanvas(n,E===Z.SHADING?null:this._background,m.cachedCanvases);return E!==Z.SHADING&&(S.setTransform(...m.baseTransform),this.matrix&&S.transform(...this.matrix)),S.translate(t.offsetX,t.offsetY),S.scale(t.scaleX,t.scaleY),S.createPattern(t.canvas,"no-repeat")}}class N extends ot{getPattern(){return"hotpink"}}function y(A){switch(A[0]){case"RadialAxial":return new tt(A);case"Mesh":return new M(A);case"Dummy":return new N}throw new Error(`Unknown IR type: ${A[0]}`)}const D={COLORED:1,UNCOLORED:2},g=class g{constructor(S,m,d,E,n){this.operatorList=S[2],this.matrix=S[3]||[1,0,0,1,0,0],this.bbox=S[4],this.xstep=S[5],this.ystep=S[6],this.paintType=S[7],this.tilingType=S[8],this.color=m,this.ctx=d,this.canvasGraphicsFactory=E,this.baseTransform=n}createPatternCanvas(S){const m=this.operatorList,d=this.bbox,E=this.xstep,n=this.ystep,t=this.paintType,e=this.tilingType,l=this.color,p=this.canvasGraphicsFactory;(0,c.info)("TilingType: "+e);const F=d[0],O=d[1],X=d[2],w=d[3],G=c.Util.singularValueDecompose2dScale(this.matrix),it=c.Util.singularValueDecompose2dScale(this.baseTransform),ht=[G[0]*it[0],G[1]*it[1]],q=this.getSizeAndScale(E,this.ctx.canvas.width,ht[0]),st=this.getSizeAndScale(n,this.ctx.canvas.height,ht[1]),St=S.cachedCanvases.getCanvas("pattern",q.size,st.size,!0),vt=St.context,yt=p.createCanvasGraphics(vt);yt.groupLevel=S.groupLevel,this.setFillAndStrokeStyleToContext(yt,t,l);let Dt=F,j=O,o=X,a=w;return F<0&&(Dt=0,o+=Math.abs(F)),O<0&&(j=0,a+=Math.abs(O)),vt.translate(-(q.scale*Dt),-(st.scale*j)),yt.transform(q.scale,0,0,st.scale,0,0),vt.save(),this.clipBbox(yt,Dt,j,o,a),yt.baseTransform=(0,P.getCurrentTransform)(yt.ctx),yt.executeOperatorList(m),yt.endDrawing(),{canvas:St.canvas,scaleX:q.scale,scaleY:st.scale,offsetX:Dt,offsetY:j}}getSizeAndScale(S,m,d){S=Math.abs(S);const E=Math.max(g.MAX_PATTERN_SIZE,m);let n=Math.ceil(S*d);return n>=E?n=E:d=n/S,{scale:d,size:n}}clipBbox(S,m,d,E,n){const t=E-m,e=n-d;S.ctx.rect(m,d,t,e),S.current.updateRectMinMax((0,P.getCurrentTransform)(S.ctx),[m,d,E,n]),S.clip(),S.endPath()}setFillAndStrokeStyleToContext(S,m,d){const E=S.ctx,n=S.current;switch(m){case D.COLORED:const t=this.ctx;E.fillStyle=t.fillStyle,E.strokeStyle=t.strokeStyle,n.fillColor=t.fillStyle,n.strokeColor=t.strokeStyle;break;case D.UNCOLORED:const e=c.Util.makeHexColor(d[0],d[1],d[2]);E.fillStyle=e,E.strokeStyle=e,n.fillColor=e,n.strokeColor=e;break;default:throw new c.FormatError(`Unsupported paint type: ${m}`)}}getPattern(S,m,d,E){let n=d;E!==Z.SHADING&&(n=c.Util.transform(n,m.baseTransform),this.matrix&&(n=c.Util.transform(n,this.matrix)));const t=this.createPatternCanvas(m);let e=new DOMMatrix(n);e=e.translate(t.offsetX,t.offsetY),e=e.scale(1/t.scaleX,1/t.scaleY);const l=S.createPattern(t.canvas,"repeat");return l.setTransform(e),l}};$t(g,"MAX_PATTERN_SIZE",3e3);let r=g;h.TilingPattern=r},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.convertBlackAndWhiteToRGBA=Z,h.convertToRGBA=P,h.grayToRGBA=ot;var c=et(1);function P(tt){switch(tt.kind){case c.ImageKind.GRAYSCALE_1BPP:return Z(tt);case c.ImageKind.RGB_24BPP:return V(tt)}return null}function Z({src:tt,srcPos:x=0,dest:f,width:M,height:N,nonBlackColor:y=4294967295,inverseDecode:D=!1}){const r=c.FeatureTest.isLittleEndian?4278190080:255,[g,A]=D?[y,r]:[r,y],S=M>>3,m=M&7,d=tt.length;f=new Uint32Array(f.buffer);let E=0;for(let n=0;n<N;n++){for(const e=x+S;x<e;x++){const l=x<d?tt[x]:255;f[E++]=l&128?A:g,f[E++]=l&64?A:g,f[E++]=l&32?A:g,f[E++]=l&16?A:g,f[E++]=l&8?A:g,f[E++]=l&4?A:g,f[E++]=l&2?A:g,f[E++]=l&1?A:g}if(m===0)continue;const t=x<d?tt[x++]:255;for(let e=0;e<m;e++)f[E++]=t&1<<7-e?A:g}return{srcPos:x,destPos:E}}function V({src:tt,srcPos:x=0,dest:f,destPos:M=0,width:N,height:y}){let D=0;const r=tt.length>>2,g=new Uint32Array(tt.buffer,x,r);if(c.FeatureTest.isLittleEndian){for(;D<r-2;D+=3,M+=4){const A=g[D],S=g[D+1],m=g[D+2];f[M]=A|4278190080,f[M+1]=A>>>24|S<<8|4278190080,f[M+2]=S>>>16|m<<16|4278190080,f[M+3]=m>>>8|4278190080}for(let A=D*4,S=tt.length;A<S;A+=3)f[M++]=tt[A]|tt[A+1]<<8|tt[A+2]<<16|4278190080}else{for(;D<r-2;D+=3,M+=4){const A=g[D],S=g[D+1],m=g[D+2];f[M]=A|255,f[M+1]=A<<24|S>>>8|255,f[M+2]=S<<16|m>>>16|255,f[M+3]=m<<8|255}for(let A=D*4,S=tt.length;A<S;A+=3)f[M++]=tt[A]<<24|tt[A+1]<<16|tt[A+2]<<8|255}return{srcPos:x,destPos:M}}function ot(tt,x){if(c.FeatureTest.isLittleEndian)for(let f=0,M=tt.length;f<M;f++)x[f]=tt[f]*65793|4278190080;else for(let f=0,M=tt.length;f<M;f++)x[f]=tt[f]*16843008|255}},(pt,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.GlobalWorkerOptions=void 0;const et=Object.create(null);h.GlobalWorkerOptions=et,et.workerPort=null,et.workerSrc=""},(pt,h,et)=>{var tt,hs,f,ds,N,ve;Object.defineProperty(h,"__esModule",{value:!0}),h.MessageHandler=void 0;var c=et(1);const P={UNKNOWN:0,DATA:1,ERROR:2},Z={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function V(D){switch(D instanceof Error||typeof D=="object"&&D!==null||(0,c.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),D.name){case"AbortException":return new c.AbortException(D.message);case"MissingPDFException":return new c.MissingPDFException(D.message);case"PasswordException":return new c.PasswordException(D.message,D.code);case"UnexpectedResponseException":return new c.UnexpectedResponseException(D.message,D.status);case"UnknownErrorException":return new c.UnknownErrorException(D.message,D.details);default:return new c.UnknownErrorException(D.message,D.toString())}}class ot{constructor(r,g,A){W(this,tt);W(this,f);W(this,N);this.sourceName=r,this.targetName=g,this.comObj=A,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=S=>{const m=S.data;if(m.targetName!==this.sourceName)return;if(m.stream){Q(this,f,ds).call(this,m);return}if(m.callback){const E=m.callbackId,n=this.callbackCapabilities[E];if(!n)throw new Error(`Cannot resolve callback ${E}`);if(delete this.callbackCapabilities[E],m.callback===P.DATA)n.resolve(m.data);else if(m.callback===P.ERROR)n.reject(V(m.reason));else throw new Error("Unexpected callback case");return}const d=this.actionHandler[m.action];if(!d)throw new Error(`Unknown action from worker: ${m.action}`);if(m.callbackId){const E=this.sourceName,n=m.sourceName;new Promise(function(t){t(d(m.data))}).then(function(t){A.postMessage({sourceName:E,targetName:n,callback:P.DATA,callbackId:m.callbackId,data:t})},function(t){A.postMessage({sourceName:E,targetName:n,callback:P.ERROR,callbackId:m.callbackId,reason:V(t)})});return}if(m.streamId){Q(this,tt,hs).call(this,m);return}d(m.data)},A.addEventListener("message",this._onComObjOnMessage)}on(r,g){const A=this.actionHandler;if(A[r])throw new Error(`There is already an actionName called "${r}"`);A[r]=g}send(r,g,A){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,data:g},A)}sendWithPromise(r,g,A){const S=this.callbackId++,m=new c.PromiseCapability;this.callbackCapabilities[S]=m;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,callbackId:S,data:g},A)}catch(d){m.reject(d)}return m.promise}sendWithStream(r,g,A,S){const m=this.streamId++,d=this.sourceName,E=this.targetName,n=this.comObj;return new ReadableStream({start:t=>{const e=new c.PromiseCapability;return this.streamControllers[m]={controller:t,startCall:e,pullCall:null,cancelCall:null,isClosed:!1},n.postMessage({sourceName:d,targetName:E,action:r,streamId:m,data:g,desiredSize:t.desiredSize},S),e.promise},pull:t=>{const e=new c.PromiseCapability;return this.streamControllers[m].pullCall=e,n.postMessage({sourceName:d,targetName:E,stream:Z.PULL,streamId:m,desiredSize:t.desiredSize}),e.promise},cancel:t=>{(0,c.assert)(t instanceof Error,"cancel must have a valid reason");const e=new c.PromiseCapability;return this.streamControllers[m].cancelCall=e,this.streamControllers[m].isClosed=!0,n.postMessage({sourceName:d,targetName:E,stream:Z.CANCEL,streamId:m,reason:V(t)}),e.promise}},A)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}tt=new WeakSet,hs=function(r){const g=r.streamId,A=this.sourceName,S=r.sourceName,m=this.comObj,d=this,E=this.actionHandler[r.action],n={enqueue(t,e=1,l){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=e,p>0&&this.desiredSize<=0&&(this.sinkCapability=new c.PromiseCapability,this.ready=this.sinkCapability.promise),m.postMessage({sourceName:A,targetName:S,stream:Z.ENQUEUE,streamId:g,chunk:t},l)},close(){this.isCancelled||(this.isCancelled=!0,m.postMessage({sourceName:A,targetName:S,stream:Z.CLOSE,streamId:g}),delete d.streamSinks[g])},error(t){(0,c.assert)(t instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,m.postMessage({sourceName:A,targetName:S,stream:Z.ERROR,streamId:g,reason:V(t)}))},sinkCapability:new c.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:r.desiredSize,ready:null};n.sinkCapability.resolve(),n.ready=n.sinkCapability.promise,this.streamSinks[g]=n,new Promise(function(t){t(E(r.data,n))}).then(function(){m.postMessage({sourceName:A,targetName:S,stream:Z.START_COMPLETE,streamId:g,success:!0})},function(t){m.postMessage({sourceName:A,targetName:S,stream:Z.START_COMPLETE,streamId:g,reason:V(t)})})},f=new WeakSet,ds=function(r){const g=r.streamId,A=this.sourceName,S=r.sourceName,m=this.comObj,d=this.streamControllers[g],E=this.streamSinks[g];switch(r.stream){case Z.START_COMPLETE:r.success?d.startCall.resolve():d.startCall.reject(V(r.reason));break;case Z.PULL_COMPLETE:r.success?d.pullCall.resolve():d.pullCall.reject(V(r.reason));break;case Z.PULL:if(!E){m.postMessage({sourceName:A,targetName:S,stream:Z.PULL_COMPLETE,streamId:g,success:!0});break}E.desiredSize<=0&&r.desiredSize>0&&E.sinkCapability.resolve(),E.desiredSize=r.desiredSize,new Promise(function(n){var t;n((t=E.onPull)==null?void 0:t.call(E))}).then(function(){m.postMessage({sourceName:A,targetName:S,stream:Z.PULL_COMPLETE,streamId:g,success:!0})},function(n){m.postMessage({sourceName:A,targetName:S,stream:Z.PULL_COMPLETE,streamId:g,reason:V(n)})});break;case Z.ENQUEUE:if((0,c.assert)(d,"enqueue should have stream controller"),d.isClosed)break;d.controller.enqueue(r.chunk);break;case Z.CLOSE:if((0,c.assert)(d,"close should have stream controller"),d.isClosed)break;d.isClosed=!0,d.controller.close(),Q(this,N,ve).call(this,d,g);break;case Z.ERROR:(0,c.assert)(d,"error should have stream controller"),d.controller.error(V(r.reason)),Q(this,N,ve).call(this,d,g);break;case Z.CANCEL_COMPLETE:r.success?d.cancelCall.resolve():d.cancelCall.reject(V(r.reason)),Q(this,N,ve).call(this,d,g);break;case Z.CANCEL:if(!E)break;new Promise(function(n){var t;n((t=E.onCancel)==null?void 0:t.call(E,V(r.reason)))}).then(function(){m.postMessage({sourceName:A,targetName:S,stream:Z.CANCEL_COMPLETE,streamId:g,success:!0})},function(n){m.postMessage({sourceName:A,targetName:S,stream:Z.CANCEL_COMPLETE,streamId:g,reason:V(n)})}),E.sinkCapability.reject(V(r.reason)),E.isCancelled=!0,delete this.streamSinks[g];break;default:throw new Error("Unexpected stream case")}},N=new WeakSet,ve=async function(r,g){var A,S,m;await Promise.allSettled([(A=r.startCall)==null?void 0:A.promise,(S=r.pullCall)==null?void 0:S.promise,(m=r.cancelCall)==null?void 0:m.promise]),delete this.streamControllers[g]},h.MessageHandler=ot},(pt,h,et)=>{var Z,V;Object.defineProperty(h,"__esModule",{value:!0}),h.Metadata=void 0;var c=et(1);class P{constructor({parsedData:tt,rawData:x}){W(this,Z,void 0);W(this,V,void 0);lt(this,Z,tt),lt(this,V,x)}getRaw(){return s(this,V)}get(tt){var x;return(x=s(this,Z).get(tt))!=null?x:null}getAll(){return(0,c.objectFromMap)(s(this,Z))}has(tt){return s(this,Z).has(tt)}}Z=new WeakMap,V=new WeakMap,h.Metadata=P},(pt,h,et)=>{var tt,x,f,M,N,y,Ne;Object.defineProperty(h,"__esModule",{value:!0}),h.OptionalContentConfig=void 0;var c=et(1),P=et(8);const Z=Symbol("INTERNAL");class V{constructor(g,A){W(this,tt,!0);this.name=g,this.intent=A}get visible(){return s(this,tt)}_setVisible(g,A){g!==Z&&(0,c.unreachable)("Internal method `_setVisible` called."),lt(this,tt,A)}}tt=new WeakMap;class ot{constructor(g){W(this,y);W(this,x,null);W(this,f,new Map);W(this,M,null);W(this,N,null);if(this.name=null,this.creator=null,g!==null){this.name=g.name,this.creator=g.creator,lt(this,N,g.order);for(const A of g.groups)s(this,f).set(A.id,new V(A.name,A.intent));if(g.baseState==="OFF")for(const A of s(this,f).values())A._setVisible(Z,!1);for(const A of g.on)s(this,f).get(A)._setVisible(Z,!0);for(const A of g.off)s(this,f).get(A)._setVisible(Z,!1);lt(this,M,this.getHash())}}isVisible(g){if(s(this,f).size===0)return!0;if(!g)return(0,c.warn)("Optional content group not defined."),!0;if(g.type==="OCG")return s(this,f).has(g.id)?s(this,f).get(g.id).visible:((0,c.warn)(`Optional content group not found: ${g.id}`),!0);if(g.type==="OCMD"){if(g.expression)return Q(this,y,Ne).call(this,g.expression);if(!g.policy||g.policy==="AnyOn"){for(const A of g.ids){if(!s(this,f).has(A))return(0,c.warn)(`Optional content group not found: ${A}`),!0;if(s(this,f).get(A).visible)return!0}return!1}else if(g.policy==="AllOn"){for(const A of g.ids){if(!s(this,f).has(A))return(0,c.warn)(`Optional content group not found: ${A}`),!0;if(!s(this,f).get(A).visible)return!1}return!0}else if(g.policy==="AnyOff"){for(const A of g.ids){if(!s(this,f).has(A))return(0,c.warn)(`Optional content group not found: ${A}`),!0;if(!s(this,f).get(A).visible)return!0}return!1}else if(g.policy==="AllOff"){for(const A of g.ids){if(!s(this,f).has(A))return(0,c.warn)(`Optional content group not found: ${A}`),!0;if(s(this,f).get(A).visible)return!1}return!0}return(0,c.warn)(`Unknown optional content policy ${g.policy}.`),!0}return(0,c.warn)(`Unknown group type ${g.type}.`),!0}setVisibility(g,A=!0){if(!s(this,f).has(g)){(0,c.warn)(`Optional content group not found: ${g}`);return}s(this,f).get(g)._setVisible(Z,!!A),lt(this,x,null)}get hasInitialVisibility(){return this.getHash()===s(this,M)}getOrder(){return s(this,f).size?s(this,N)?s(this,N).slice():[...s(this,f).keys()]:null}getGroups(){return s(this,f).size>0?(0,c.objectFromMap)(s(this,f)):null}getGroup(g){return s(this,f).get(g)||null}getHash(){if(s(this,x)!==null)return s(this,x);const g=new P.MurmurHash3_64;for(const[A,S]of s(this,f))g.update(`${A}:${S.visible}`);return lt(this,x,g.hexdigest())}}x=new WeakMap,f=new WeakMap,M=new WeakMap,N=new WeakMap,y=new WeakSet,Ne=function(g){const A=g.length;if(A<2)return!0;const S=g[0];for(let m=1;m<A;m++){const d=g[m];let E;if(Array.isArray(d))E=Q(this,y,Ne).call(this,d);else if(s(this,f).has(d))E=s(this,f).get(d).visible;else return(0,c.warn)(`Optional content group not found: ${d}`),!0;switch(S){case"And":if(!E)return!1;break;case"Or":if(E)return!0;break;case"Not":return!E;default:return!0}}return S==="And"},h.OptionalContentConfig=ot},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.PDFDataTransportStream=void 0;var c=et(1),P=et(6);class Z{constructor({length:x,initialData:f,progressiveDone:M=!1,contentDispositionFilename:N=null,disableRange:y=!1,disableStream:D=!1},r){if((0,c.assert)(r,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=M,this._contentDispositionFilename=N,(f==null?void 0:f.length)>0){const g=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;this._queuedChunks.push(g)}this._pdfDataRangeTransport=r,this._isStreamingSupported=!D,this._isRangeSupported=!y,this._contentLength=x,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((g,A)=>{this._onReceiveData({begin:g,chunk:A})}),this._pdfDataRangeTransport.addProgressListener((g,A)=>{this._onProgress({loaded:g,total:A})}),this._pdfDataRangeTransport.addProgressiveReadListener(g=>{this._onReceiveData({chunk:g})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:x,chunk:f}){const M=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;if(x===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(M):this._queuedChunks.push(M);else{const N=this._rangeReaders.some(function(y){return y._begin!==x?!1:(y._enqueue(M),!0)});(0,c.assert)(N,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var x,f;return(f=(x=this._fullRequestReader)==null?void 0:x._loaded)!=null?f:0}_onProgress(x){var f,M,N,y;x.total===void 0?(M=(f=this._rangeReaders[0])==null?void 0:f.onProgress)==null||M.call(f,{loaded:x.loaded}):(y=(N=this._fullRequestReader)==null?void 0:N.onProgress)==null||y.call(N,{loaded:x.loaded,total:x.total})}_onProgressiveDone(){var x;(x=this._fullRequestReader)==null||x.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(x){const f=this._rangeReaders.indexOf(x);f>=0&&this._rangeReaders.splice(f,1)}getFullReader(){(0,c.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const x=this._queuedChunks;return this._queuedChunks=null,new V(this,x,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(x,f){if(f<=this._progressiveDataLength)return null;const M=new ot(this,x,f);return this._pdfDataRangeTransport.requestDataRange(x,f),this._rangeReaders.push(M),M}cancelAllRequests(x){var f;(f=this._fullRequestReader)==null||f.cancel(x);for(const M of this._rangeReaders.slice(0))M.cancel(x);this._pdfDataRangeTransport.abort()}}h.PDFDataTransportStream=Z;class V{constructor(x,f,M=!1,N=null){this._stream=x,this._done=M||!1,this._filename=(0,P.isPdfFile)(N)?N:null,this._queuedChunks=f||[],this._loaded=0;for(const y of this._queuedChunks)this._loaded+=y.byteLength;this._requests=[],this._headersReady=Promise.resolve(),x._fullRequestReader=this,this.onProgress=null}_enqueue(x){this._done||(this._requests.length>0?this._requests.shift().resolve({value:x,done:!1}):this._queuedChunks.push(x),this._loaded+=x.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const x=new c.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ot{constructor(x,f,M){this._stream=x,this._begin=f,this._end=M,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(x){if(!this._done){if(this._requests.length===0)this._queuedChunk=x;else{this._requests.shift().resolve({value:x,done:!1});for(const M of this._requests)M.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const f=this._queuedChunk;return this._queuedChunk=null,{value:f,done:!1}}if(this._done)return{value:void 0,done:!0};const x=new c.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(pt,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.XfaText=void 0;class et{static textContent(P){const Z=[],V={items:Z,styles:Object.create(null)};function ot(tt){var M;if(!tt)return;let x=null;const f=tt.name;if(f==="#text")x=tt.value;else if(et.shouldBuildText(f))(M=tt==null?void 0:tt.attributes)!=null&&M.textContent?x=tt.attributes.textContent:tt.value&&(x=tt.value);else return;if(x!==null&&Z.push({str:x}),!!tt.children)for(const N of tt.children)ot(N)}return ot(P),V}static shouldBuildText(P){return!(P==="textarea"||P==="input"||P==="option"||P==="select")}}h.XfaText=et},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.NodeStandardFontDataFactory=h.NodeFilterFactory=h.NodeCanvasFactory=h.NodeCMapReaderFactory=void 0;var c=et(7);const P=function(x){return new Promise((f,M)=>{require$$0.readFile(x,(y,D)=>{if(y||!D){M(new Error(y));return}f(new Uint8Array(D))})})};class Z extends c.BaseFilterFactory{}h.NodeFilterFactory=Z;class V extends c.BaseCanvasFactory{_createCanvas(f,M){return require$$0.createCanvas(f,M)}}h.NodeCanvasFactory=V;class ot extends c.BaseCMapReaderFactory{_fetchData(f,M){return P(f).then(N=>({cMapData:N,compressionType:M}))}}h.NodeCMapReaderFactory=ot;class tt extends c.BaseStandardFontDataFactory{_fetchData(f){return P(f)}}h.NodeStandardFontDataFactory=tt},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.PDFNodeStream=void 0;var c=et(1),P=et(22);const Z=require$$0,V=require$$0,ot=require$$0,tt=require$$0,x=/^file:\/\/\/[a-zA-Z]:\//;function f(m){const d=tt.parse(m);return d.protocol==="file:"||d.host?d:/^[a-z]:[/\\]/i.test(m)?tt.parse(`file:///${m}`):(d.host||(d.protocol="file:"),d)}class M{constructor(d){this.source=d,this.url=f(d.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&d.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var d,E;return(E=(d=this._fullRequestReader)==null?void 0:d._loaded)!=null?E:0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new A(this):new r(this),this._fullRequestReader}getRangeReader(d,E){if(E<=this._progressiveDataLength)return null;const n=this.isFsUrl?new S(this,d,E):new g(this,d,E);return this._rangeRequestReaders.push(n),n}cancelAllRequests(d){var E;(E=this._fullRequestReader)==null||E.cancel(d);for(const n of this._rangeRequestReaders.slice(0))n.cancel(d)}}h.PDFNodeStream=M;class N{constructor(d){this._url=d.url,this._done=!1,this._storedError=null,this.onProgress=null;const E=d.source;this._contentLength=E.length,this._loaded=0,this._filename=null,this._disableRange=E.disableRange||!1,this._rangeChunkSize=E.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!E.disableStream,this._isRangeSupported=!E.disableRange,this._readableStream=null,this._readCapability=new c.PromiseCapability,this._headersCapability=new c.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const d=this._readableStream.read();return d===null?(this._readCapability=new c.PromiseCapability,this.read()):(this._loaded+=d.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(d).buffer,done:!1})}cancel(d){if(!this._readableStream){this._error(d);return}this._readableStream.destroy(d)}_error(d){this._storedError=d,this._readCapability.resolve()}_setReadableStream(d){this._readableStream=d,d.on("readable",()=>{this._readCapability.resolve()}),d.on("end",()=>{d.destroy(),this._done=!0,this._readCapability.resolve()}),d.on("error",E=>{this._error(E)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new c.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class y{constructor(d){this._url=d.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new c.PromiseCapability;const E=d.source;this._isStreamingSupported=!E.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const d=this._readableStream.read();return d===null?(this._readCapability=new c.PromiseCapability,this.read()):(this._loaded+=d.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(d).buffer,done:!1})}cancel(d){if(!this._readableStream){this._error(d);return}this._readableStream.destroy(d)}_error(d){this._storedError=d,this._readCapability.resolve()}_setReadableStream(d){this._readableStream=d,d.on("readable",()=>{this._readCapability.resolve()}),d.on("end",()=>{d.destroy(),this._done=!0,this._readCapability.resolve()}),d.on("error",E=>{this._error(E)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function D(m,d){return{protocol:m.protocol,auth:m.auth,host:m.hostname,port:m.port,path:m.path,method:"GET",headers:d}}class r extends N{constructor(d){super(d);const E=n=>{if(n.statusCode===404){const p=new c.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=p,this._headersCapability.reject(p);return}this._headersCapability.resolve(),this._setReadableStream(n);const t=p=>this._readableStream.headers[p.toLowerCase()],{allowRangeRequests:e,suggestedLength:l}=(0,P.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:d.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=e,this._contentLength=l||this._contentLength,this._filename=(0,P.extractFilenameFromHeader)(t)};this._request=null,this._url.protocol==="http:"?this._request=V.request(D(this._url,d.httpHeaders),E):this._request=ot.request(D(this._url,d.httpHeaders),E),this._request.on("error",n=>{this._storedError=n,this._headersCapability.reject(n)}),this._request.end()}}class g extends y{constructor(d,E,n){super(d),this._httpHeaders={};for(const e in d.httpHeaders){const l=d.httpHeaders[e];l!==void 0&&(this._httpHeaders[e]=l)}this._httpHeaders.Range=`bytes=${E}-${n-1}`;const t=e=>{if(e.statusCode===404){const l=new c.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=l;return}this._setReadableStream(e)};this._request=null,this._url.protocol==="http:"?this._request=V.request(D(this._url,this._httpHeaders),t):this._request=ot.request(D(this._url,this._httpHeaders),t),this._request.on("error",e=>{this._storedError=e}),this._request.end()}}class A extends N{constructor(d){super(d);let E=decodeURIComponent(this._url.path);x.test(this._url.href)&&(E=E.replace(/^\//,"")),Z.lstat(E,(n,t)=>{if(n){n.code==="ENOENT"&&(n=new c.MissingPDFException(`Missing PDF "${E}".`)),this._storedError=n,this._headersCapability.reject(n);return}this._contentLength=t.size,this._setReadableStream(Z.createReadStream(E)),this._headersCapability.resolve()})}}class S extends y{constructor(d,E,n){super(d);let t=decodeURIComponent(this._url.path);x.test(this._url.href)&&(t=t.replace(/^\//,"")),this._setReadableStream(Z.createReadStream(t,{start:E,end:n-1}))}}},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.createResponseStatusError=tt,h.extractFilenameFromHeader=ot,h.validateRangeRequestCapabilities=V,h.validateResponseStatus=x;var c=et(1),P=et(23),Z=et(6);function V({getResponseHeader:f,isHttp:M,rangeChunkSize:N,disableRange:y}){const D={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(f("Content-Length"),10);return!Number.isInteger(r)||(D.suggestedLength=r,r<=2*N)||y||!M||f("Accept-Ranges")!=="bytes"||(f("Content-Encoding")||"identity")!=="identity"||(D.allowRangeRequests=!0),D}function ot(f){const M=f("Content-Disposition");if(M){let N=(0,P.getFilenameFromContentDispositionHeader)(M);if(N.includes("%"))try{N=decodeURIComponent(N)}catch(y){}if((0,Z.isPdfFile)(N))return N}return null}function tt(f,M){return f===404||f===0&&M.startsWith("file:")?new c.MissingPDFException('Missing PDF "'+M+'".'):new c.UnexpectedResponseException(`Unexpected server response (${f}) while retrieving PDF "${M}".`,f)}function x(f){return f===200||f===206}},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.getFilenameFromContentDispositionHeader=P;var c=et(1);function P(Z){let V=!0,ot=tt("filename\\*","i").exec(Z);if(ot){ot=ot[1];let r=N(ot);return r=unescape(r),r=y(r),r=D(r),f(r)}if(ot=M(Z),ot){const r=D(ot);return f(r)}if(ot=tt("filename","i").exec(Z),ot){ot=ot[1];let r=N(ot);return r=D(r),f(r)}function tt(r,g){return new RegExp("(?:^|;)\\s*"+r+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function x(r,g){if(r){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const A=new TextDecoder(r,{fatal:!0}),S=(0,c.stringToBytes)(g);g=A.decode(S),V=!1}catch(A){}}return g}function f(r){return V&&/[\x80-\xff]/.test(r)&&(r=x("utf-8",r),V&&(r=x("iso-8859-1",r))),r}function M(r){const g=[];let A;const S=tt("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(A=S.exec(r))!==null;){let[,d,E,n]=A;if(d=parseInt(d,10),d in g){if(d===0)break;continue}g[d]=[E,n]}const m=[];for(let d=0;d<g.length&&d in g;++d){let[E,n]=g[d];n=N(n),E&&(n=unescape(n),d===0&&(n=y(n))),m.push(n)}return m.join("")}function N(r){if(r.startsWith('"')){const g=r.slice(1).split('\\"');for(let A=0;A<g.length;++A){const S=g[A].indexOf('"');S!==-1&&(g[A]=g[A].slice(0,S),g.length=A+1),g[A]=g[A].replaceAll(/\\(.)/g,"$1")}r=g.join('"')}return r}function y(r){const g=r.indexOf("'");if(g===-1)return r;const A=r.slice(0,g),m=r.slice(g+1).replace(/^[^']*'/,"");return x(A,m)}function D(r){return!r.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(r)?r:r.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,A,S,m){if(S==="q"||S==="Q")return m=m.replaceAll("_"," "),m=m.replaceAll(/=([0-9a-fA-F]{2})/g,function(d,E){return String.fromCharCode(parseInt(E,16))}),x(A,m);try{m=atob(m)}catch(d){}return x(A,m)})}return""}},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.PDFNetworkStream=void 0;var c=et(1),P=et(22);const Z=200,V=206;function ot(N){const y=N.response;return typeof y!="string"?y:(0,c.stringToBytes)(y).buffer}class tt{constructor(y,D={}){this.url=y,this.isHttp=/^https?:/i.test(y),this.httpHeaders=this.isHttp&&D.httpHeaders||Object.create(null),this.withCredentials=D.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(y,D,r){const g={begin:y,end:D};for(const A in r)g[A]=r[A];return this.request(g)}requestFull(y){return this.request(y)}request(y){const D=new XMLHttpRequest,r=this.currXhrId++,g=this.pendingRequests[r]={xhr:D};D.open("GET",this.url),D.withCredentials=this.withCredentials;for(const A in this.httpHeaders){const S=this.httpHeaders[A];S!==void 0&&D.setRequestHeader(A,S)}return this.isHttp&&"begin"in y&&"end"in y?(D.setRequestHeader("Range",`bytes=${y.begin}-${y.end-1}`),g.expectedStatus=V):g.expectedStatus=Z,D.responseType="arraybuffer",y.onError&&(D.onerror=function(A){y.onError(D.status)}),D.onreadystatechange=this.onStateChange.bind(this,r),D.onprogress=this.onProgress.bind(this,r),g.onHeadersReceived=y.onHeadersReceived,g.onDone=y.onDone,g.onError=y.onError,g.onProgress=y.onProgress,D.send(null),r}onProgress(y,D){var g;const r=this.pendingRequests[y];r&&((g=r.onProgress)==null||g.call(r,D))}onStateChange(y,D){var d,E,n;const r=this.pendingRequests[y];if(!r)return;const g=r.xhr;if(g.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),g.readyState!==4||!(y in this.pendingRequests))return;if(delete this.pendingRequests[y],g.status===0&&this.isHttp){(d=r.onError)==null||d.call(r,g.status);return}const A=g.status||Z;if(!(A===Z&&r.expectedStatus===V)&&A!==r.expectedStatus){(E=r.onError)==null||E.call(r,g.status);return}const m=ot(g);if(A===V){const t=g.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(t);r.onDone({begin:parseInt(e[1],10),chunk:m})}else m?r.onDone({begin:0,chunk:m}):(n=r.onError)==null||n.call(r,g.status)}getRequestXhr(y){return this.pendingRequests[y].xhr}isPendingRequest(y){return y in this.pendingRequests}abortRequest(y){const D=this.pendingRequests[y].xhr;delete this.pendingRequests[y],D.abort()}}class x{constructor(y){this._source=y,this._manager=new tt(y.url,{httpHeaders:y.httpHeaders,withCredentials:y.withCredentials}),this._rangeChunkSize=y.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(y){const D=this._rangeRequestReaders.indexOf(y);D>=0&&this._rangeRequestReaders.splice(D,1)}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new f(this._manager,this._source),this._fullRequestReader}getRangeReader(y,D){const r=new M(this._manager,y,D);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(y){var D;(D=this._fullRequestReader)==null||D.cancel(y);for(const r of this._rangeRequestReaders.slice(0))r.cancel(y)}}h.PDFNetworkStream=x;class f{constructor(y,D){this._manager=y;const r={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=D.url,this._fullRequestId=y.requestFull(r),this._headersReceivedCapability=new c.PromiseCapability,this._disableRange=D.disableRange||!1,this._contentLength=D.length,this._rangeChunkSize=D.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const y=this._fullRequestId,D=this._manager.getRequestXhr(y),r=S=>D.getResponseHeader(S),{allowRangeRequests:g,suggestedLength:A}=(0,P.validateRangeRequestCapabilities)({getResponseHeader:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});g&&(this._isRangeSupported=!0),this._contentLength=A||this._contentLength,this._filename=(0,P.extractFilenameFromHeader)(r),this._isRangeSupported&&this._manager.abortRequest(y),this._headersReceivedCapability.resolve()}_onDone(y){if(y&&(this._requests.length>0?this._requests.shift().resolve({value:y.chunk,done:!1}):this._cachedChunks.push(y.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(y){this._storedError=(0,P.createResponseStatusError)(y,this._url),this._headersReceivedCapability.reject(this._storedError);for(const D of this._requests)D.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(y){var D;(D=this.onProgress)==null||D.call(this,{loaded:y.loaded,total:y.lengthComputable?y.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=new c.PromiseCapability;return this._requests.push(y),y.promise}cancel(y){this._done=!0,this._headersReceivedCapability.reject(y);for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class M{constructor(y,D,r){this._manager=y;const g={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=y.url,this._requestId=y.requestRange(D,r,g),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var y;(y=this.onClosed)==null||y.call(this,this)}_onDone(y){const D=y.chunk;this._requests.length>0?this._requests.shift().resolve({value:D,done:!1}):this._queuedChunk=D,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(y){this._storedError=(0,P.createResponseStatusError)(y,this._url);for(const D of this._requests)D.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(y){var D;this.isStreamingSupported||(D=this.onProgress)==null||D.call(this,{loaded:y.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const D=this._queuedChunk;return this._queuedChunk=null,{value:D,done:!1}}if(this._done)return{value:void 0,done:!0};const y=new c.PromiseCapability;return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.PDFFetchStream=void 0;var c=et(1),P=et(22);function Z(M,N,y){return{method:"GET",headers:M,signal:y.signal,mode:"cors",credentials:N?"include":"same-origin",redirect:"follow"}}function V(M){const N=new Headers;for(const y in M){const D=M[y];D!==void 0&&N.append(y,D)}return N}function ot(M){return M instanceof Uint8Array?M.buffer:M instanceof ArrayBuffer?M:((0,c.warn)(`getArrayBuffer - unexpected data format: ${M}`),new Uint8Array(M).buffer)}class tt{constructor(N){this.source=N,this.isHttp=/^https?:/i.test(N.url),this.httpHeaders=this.isHttp&&N.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var N,y;return(y=(N=this._fullRequestReader)==null?void 0:N._loaded)!=null?y:0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new x(this),this._fullRequestReader}getRangeReader(N,y){if(y<=this._progressiveDataLength)return null;const D=new f(this,N,y);return this._rangeRequestReaders.push(D),D}cancelAllRequests(N){var y;(y=this._fullRequestReader)==null||y.cancel(N);for(const D of this._rangeRequestReaders.slice(0))D.cancel(N)}}h.PDFFetchStream=tt;class x{constructor(N){this._stream=N,this._reader=null,this._loaded=0,this._filename=null;const y=N.source;this._withCredentials=y.withCredentials||!1,this._contentLength=y.length,this._headersCapability=new c.PromiseCapability,this._disableRange=y.disableRange||!1,this._rangeChunkSize=y.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._headers=V(this._stream.httpHeaders);const D=y.url;fetch(D,Z(this._headers,this._withCredentials,this._abortController)).then(r=>{if(!(0,P.validateResponseStatus)(r.status))throw(0,P.createResponseStatusError)(r.status,D);this._reader=r.body.getReader(),this._headersCapability.resolve();const g=m=>r.headers.get(m),{allowRangeRequests:A,suggestedLength:S}=(0,P.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=S||this._contentLength,this._filename=(0,P.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new c.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var D;await this._headersCapability.promise;const{value:N,done:y}=await this._reader.read();return y?{value:N,done:y}:(this._loaded+=N.byteLength,(D=this.onProgress)==null||D.call(this,{loaded:this._loaded,total:this._contentLength}),{value:ot(N),done:!1})}cancel(N){var y;(y=this._reader)==null||y.cancel(N),this._abortController.abort()}}class f{constructor(N,y,D){this._stream=N,this._reader=null,this._loaded=0;const r=N.source;this._withCredentials=r.withCredentials||!1,this._readCapability=new c.PromiseCapability,this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController,this._headers=V(this._stream.httpHeaders),this._headers.append("Range",`bytes=${y}-${D-1}`);const g=r.url;fetch(g,Z(this._headers,this._withCredentials,this._abortController)).then(A=>{if(!(0,P.validateResponseStatus)(A.status))throw(0,P.createResponseStatusError)(A.status,g);this._readCapability.resolve(),this._reader=A.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var D;await this._readCapability.promise;const{value:N,done:y}=await this._reader.read();return y?{value:N,done:y}:(this._loaded+=N.byteLength,(D=this.onProgress)==null||D.call(this,{loaded:this._loaded}),{value:ot(N),done:!1})}cancel(N){var y;(y=this._reader)==null||y.cancel(N),this._abortController.abort()}}},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.TextLayerRenderTask=void 0,h.renderTextLayer=r,h.updateTextLayer=g;var c=et(1),P=et(6);const Z=1e5,V=30,ot=.8,tt=new Map;function x(A,S){let m;if(S&&c.FeatureTest.isOffscreenCanvasSupported)m=new OffscreenCanvas(A,A).getContext("2d",{alpha:!1});else{const d=document.createElement("canvas");d.width=d.height=A,m=d.getContext("2d",{alpha:!1})}return m}function f(A,S){const m=tt.get(A);if(m)return m;const d=x(V,S);d.font=`${V}px ${A}`;const E=d.measureText("");let n=E.fontBoundingBoxAscent,t=Math.abs(E.fontBoundingBoxDescent);if(n){const l=n/(n+t);return tt.set(A,l),d.canvas.width=d.canvas.height=0,l}d.strokeStyle="red",d.clearRect(0,0,V,V),d.strokeText("g",0,0);let e=d.getImageData(0,0,V,V).data;t=0;for(let l=e.length-1-3;l>=0;l-=4)if(e[l]>0){t=Math.ceil(l/4/V);break}d.clearRect(0,0,V,V),d.strokeText("A",0,V),e=d.getImageData(0,0,V,V).data,n=0;for(let l=0,p=e.length;l<p;l+=4)if(e[l]>0){n=V-Math.floor(l/4/V);break}if(d.canvas.width=d.canvas.height=0,n){const l=n/(n+t);return tt.set(A,l),l}return tt.set(A,ot),ot}function M(A,S,m){const d=document.createElement("span"),E={angle:0,canvasWidth:0,hasText:S.str!=="",hasEOL:S.hasEOL,fontSize:0};A._textDivs.push(d);const n=c.Util.transform(A._transform,S.transform);let t=Math.atan2(n[1],n[0]);const e=m[S.fontName];e.vertical&&(t+=Math.PI/2);const l=Math.hypot(n[2],n[3]),p=l*f(e.fontFamily,A._isOffscreenCanvasSupported);let F,O;t===0?(F=n[4],O=n[5]-p):(F=n[4]+p*Math.sin(t),O=n[5]-p*Math.cos(t));const X="calc(var(--scale-factor)*",w=d.style;A._container===A._rootContainer?(w.left=`${(100*F/A._pageWidth).toFixed(2)}%`,w.top=`${(100*O/A._pageHeight).toFixed(2)}%`):(w.left=`${X}${F.toFixed(2)}px)`,w.top=`${X}${O.toFixed(2)}px)`),w.fontSize=`${X}${l.toFixed(2)}px)`,w.fontFamily=e.fontFamily,E.fontSize=l,d.setAttribute("role","presentation"),d.textContent=S.str,d.dir=S.dir,A._fontInspectorEnabled&&(d.dataset.fontName=S.fontName),t!==0&&(E.angle=t*(180/Math.PI));let G=!1;if(S.str.length>1)G=!0;else if(S.str!==" "&&S.transform[0]!==S.transform[3]){const it=Math.abs(S.transform[0]),ht=Math.abs(S.transform[3]);it!==ht&&Math.max(it,ht)/Math.min(it,ht)>1.5&&(G=!0)}G&&(E.canvasWidth=e.vertical?S.height:S.width),A._textDivProperties.set(d,E),A._isReadableStream&&A._layoutText(d)}function N(A){const{div:S,scale:m,properties:d,ctx:E,prevFontSize:n,prevFontFamily:t}=A,{style:e}=S;let l="";if(d.canvasWidth!==0&&d.hasText){const{fontFamily:p}=e,{canvasWidth:F,fontSize:O}=d;(n!==O||t!==p)&&(E.font=`${O*m}px ${p}`,A.prevFontSize=O,A.prevFontFamily=p);const{width:X}=E.measureText(S.textContent);X>0&&(l=`scaleX(${F*m/X})`)}d.angle!==0&&(l=`rotate(${d.angle}deg) ${l}`),l.length>0&&(e.transform=l)}function y(A){if(A._canceled)return;const S=A._textDivs,m=A._capability;if(S.length>Z){m.resolve();return}if(!A._isReadableStream)for(const E of S)A._layoutText(E);m.resolve()}class D{constructor({textContentSource:S,container:m,viewport:d,textDivs:E,textDivProperties:n,textContentItemsStr:t,isOffscreenCanvasSupported:e}){var X;this._textContentSource=S,this._isReadableStream=S instanceof ReadableStream,this._container=this._rootContainer=m,this._textDivs=E||[],this._textContentItemsStr=t||[],this._isOffscreenCanvasSupported=e,this._fontInspectorEnabled=!!((X=globalThis.FontInspector)!=null&&X.enabled),this._reader=null,this._textDivProperties=n||new WeakMap,this._canceled=!1,this._capability=new c.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:d.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:x(0,e)};const{pageWidth:l,pageHeight:p,pageX:F,pageY:O}=d.rawDims;this._transform=[1,0,0,-1,-F,O+p],this._pageWidth=l,this._pageHeight=p,(0,P.setLayerDimensions)(m,d),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new c.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new c.AbortException("TextLayer task cancelled."))}_processItems(S,m){for(const d of S){if(d.str===void 0){if(d.type==="beginMarkedContentProps"||d.type==="beginMarkedContent"){const E=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),d.id!==null&&this._container.setAttribute("id",`${d.id}`),E.append(this._container)}else d.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(d.str),M(this,d,m)}}_layoutText(S){const m=this._layoutTextParams.properties=this._textDivProperties.get(S);if(this._layoutTextParams.div=S,N(this._layoutTextParams),m.hasText&&this._container.append(S),m.hasEOL){const d=document.createElement("br");d.setAttribute("role","presentation"),this._container.append(d)}}_render(){const S=new c.PromiseCapability;let m=Object.create(null);if(this._isReadableStream){const d=()=>{this._reader.read().then(({value:E,done:n})=>{if(n){S.resolve();return}Object.assign(m,E.styles),this._processItems(E.items,m),d()},S.reject)};this._reader=this._textContentSource.getReader(),d()}else if(this._textContentSource){const{items:d,styles:E}=this._textContentSource;this._processItems(d,E),S.resolve()}else throw new Error('No "textContentSource" parameter specified.');S.promise.then(()=>{m=null,y(this)},this._capability.reject)}}h.TextLayerRenderTask=D;function r(A){!A.textContentSource&&(A.textContent||A.textContentStream)&&((0,P.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),A.textContentSource=A.textContent||A.textContentStream);const{container:S,viewport:m}=A,d=getComputedStyle(S),E=d.getPropertyValue("visibility"),n=parseFloat(d.getPropertyValue("--scale-factor"));E==="visible"&&(!n||Math.abs(n-m.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const t=new D(A);return t._render(),t}function g({container:A,viewport:S,textDivs:m,textDivProperties:d,isOffscreenCanvasSupported:E,mustRotate:n=!0,mustRescale:t=!0}){if(n&&(0,P.setLayerDimensions)(A,{rotation:S.rotation}),t){const e=x(0,E),p={prevFontSize:null,prevFontFamily:null,div:null,scale:S.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:e};for(const F of m)p.properties=d.get(F),p.div=F,N(p)}}},(pt,h,et)=>{var f,M,N,y,D,r,g,A,S,m,d,je,n,us,e,Be,p,Ue;Object.defineProperty(h,"__esModule",{value:!0}),h.AnnotationEditorLayer=void 0;var c=et(1),P=et(4),Z=et(5),V=et(28),ot=et(33),tt=et(6);const O=class O{constructor(w){W(this,d);W(this,n);W(this,e);W(this,p);W(this,f,void 0);W(this,M,!1);W(this,N,null);W(this,y,this.pointerup.bind(this));W(this,D,this.pointerdown.bind(this));W(this,r,new Map);W(this,g,!1);W(this,A,!1);W(this,S,!1);W(this,m,void 0);O._initialized||(O._initialized=!0,V.FreeTextEditor.initialize(w.l10n),ot.InkEditor.initialize(w.l10n)),w.uiManager.registerEditorTypes([V.FreeTextEditor,ot.InkEditor]),lt(this,m,w.uiManager),this.pageIndex=w.pageIndex,this.div=w.div,lt(this,f,w.accessibilityManager),lt(this,N,w.annotationLayer),this.viewport=w.viewport,s(this,m).addLayer(this)}get isEmpty(){return s(this,r).size===0}updateToolbar(w){s(this,m).updateToolbar(w)}updateMode(w=s(this,m).getMode()){Q(this,p,Ue).call(this),w===c.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),s(this,m).unselectAll(),w!==c.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",w===c.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",w===c.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(w){if(!w&&s(this,m).getMode()!==c.AnnotationEditorType.INK)return;if(!w){for(const it of s(this,r).values())if(it.isEmpty()){it.setInBackground();return}}Q(this,e,Be).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(w){s(this,m).setEditingState(w)}addCommands(w){s(this,m).addCommands(w)}enable(){this.div.style.pointerEvents="auto";const w=new Set;for(const it of s(this,r).values())it.enableEditing(),it.annotationElementId&&w.add(it.annotationElementId);if(!s(this,N))return;const G=s(this,N).getEditableAnnotations();for(const it of G){if(it.hide(),s(this,m).isDeletedAnnotationElement(it.data.id)||w.has(it.data.id))continue;const ht=this.deserialize(it);ht&&(this.addOrRebuild(ht),ht.enableEditing())}}disable(){var G;lt(this,S,!0),this.div.style.pointerEvents="none";const w=new Set;for(const it of s(this,r).values()){if(it.disableEditing(),!it.annotationElementId||it.serialize()!==null){w.add(it.annotationElementId);continue}(G=this.getEditableAnnotation(it.annotationElementId))==null||G.show(),it.remove()}if(s(this,N)){const it=s(this,N).getEditableAnnotations();for(const ht of it){const{id:q}=ht.data;w.has(q)||s(this,m).isDeletedAnnotationElement(q)||ht.show()}}Q(this,p,Ue).call(this),this.isEmpty&&(this.div.hidden=!0),lt(this,S,!1)}getEditableAnnotation(w){var G;return((G=s(this,N))==null?void 0:G.getEditableAnnotation(w))||null}setActiveEditor(w){s(this,m).getActive()!==w&&s(this,m).setActiveEditor(w)}enableClick(){this.div.addEventListener("pointerdown",s(this,D)),this.div.addEventListener("pointerup",s(this,y))}disableClick(){this.div.removeEventListener("pointerdown",s(this,D)),this.div.removeEventListener("pointerup",s(this,y))}attach(w){s(this,r).set(w.id,w);const{annotationElementId:G}=w;G&&s(this,m).isDeletedAnnotationElement(G)&&s(this,m).removeDeletedAnnotationElement(w)}detach(w){var G;s(this,r).delete(w.id),(G=s(this,f))==null||G.removePointerInTextLayer(w.contentDiv),!s(this,S)&&w.annotationElementId&&s(this,m).addDeletedAnnotationElement(w)}remove(w){this.detach(w),s(this,m).removeEditor(w),w.div.style.display="none",setTimeout(()=>{w.div.style.display="",w.div.remove(),w.isAttachedToDOM=!1,document.activeElement===document.body&&s(this,m).focusMainContainer()},0),s(this,A)||this.addInkEditorIfNeeded(!1)}add(w){if(Q(this,d,je).call(this,w),s(this,m).addEditor(w),this.attach(w),!w.isAttachedToDOM){const G=w.render();this.div.append(G),w.isAttachedToDOM=!0}this.moveEditorInDOM(w),w.onceAdded(),s(this,m).addToAnnotationStorage(w)}moveEditorInDOM(w){var G;(G=s(this,f))==null||G.moveElementInDOM(this.div,w.div,w.contentDiv,!0)}addOrRebuild(w){w.needsToBeRebuilt()?w.rebuild():this.add(w)}getNextId(){return s(this,m).getId()}deserialize(w){var G;switch((G=w.annotationType)!=null?G:w.annotationEditorType){case c.AnnotationEditorType.FREETEXT:return V.FreeTextEditor.deserialize(w,this,s(this,m));case c.AnnotationEditorType.INK:return ot.InkEditor.deserialize(w,this,s(this,m))}return null}setSelected(w){s(this,m).setSelected(w)}toggleSelected(w){s(this,m).toggleSelected(w)}isSelected(w){return s(this,m).isSelected(w)}unselect(w){s(this,m).unselect(w)}pointerup(w){const{isMac:G}=c.FeatureTest.platform;if(!(w.button!==0||w.ctrlKey&&G)&&w.target===this.div&&s(this,g)){if(lt(this,g,!1),!s(this,M)){lt(this,M,!0);return}Q(this,e,Be).call(this,w)}}pointerdown(w){const{isMac:G}=c.FeatureTest.platform;if(w.button!==0||w.ctrlKey&&G||w.target!==this.div)return;lt(this,g,!0);const it=s(this,m).getActive();lt(this,M,!it||it.isEmpty())}drop(w){const G=w.dataTransfer.getData("text/plain"),it=s(this,m).getEditor(G);if(!it)return;w.preventDefault(),w.dataTransfer.dropEffect="move",Q(this,d,je).call(this,it);const ht=this.div.getBoundingClientRect(),q=w.clientX-ht.x,st=w.clientY-ht.y;it.translate(q-it.startX,st-it.startY),this.moveEditorInDOM(it),it.div.focus()}dragover(w){w.preventDefault()}destroy(){var w,G;((w=s(this,m).getActive())==null?void 0:w.parent)===this&&s(this,m).setActiveEditor(null);for(const it of s(this,r).values())(G=s(this,f))==null||G.removePointerInTextLayer(it.contentDiv),it.setParent(null),it.isAttachedToDOM=!1,it.div.remove();this.div=null,s(this,r).clear(),s(this,m).removeLayer(this)}render({viewport:w}){this.viewport=w,(0,tt.setLayerDimensions)(this.div,w),(0,Z.bindEvents)(this,this.div,["dragover","drop"]);for(const G of s(this,m).getEditors(this.pageIndex))this.add(G);this.updateMode()}update({viewport:w}){s(this,m).commitOrRemove(),this.viewport=w,(0,tt.setLayerDimensions)(this.div,{rotation:w.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:w,pageHeight:G}=this.viewport.rawDims;return[w,G]}};f=new WeakMap,M=new WeakMap,N=new WeakMap,y=new WeakMap,D=new WeakMap,r=new WeakMap,g=new WeakMap,A=new WeakMap,S=new WeakMap,m=new WeakMap,d=new WeakSet,je=function(w){var G;w.parent!==this&&(w.annotationElementId&&(s(this,m).addDeletedAnnotationElement(w.annotationElementId),P.AnnotationEditor.deleteAnnotationElement(w),w.annotationElementId=null),this.attach(w),(G=w.parent)==null||G.detach(w),w.setParent(this),w.div&&w.isAttachedToDOM&&(w.div.remove(),this.div.append(w.div)))},n=new WeakSet,us=function(w){switch(s(this,m).getMode()){case c.AnnotationEditorType.FREETEXT:return new V.FreeTextEditor(w);case c.AnnotationEditorType.INK:return new ot.InkEditor(w)}return null},e=new WeakSet,Be=function(w){const G=this.getNextId(),it=Q(this,n,us).call(this,{parent:this,id:G,x:w.offsetX,y:w.offsetY,uiManager:s(this,m)});return it&&this.add(it),it},p=new WeakSet,Ue=function(){lt(this,A,!0);for(const w of s(this,r).values())w.isEmpty()&&w.remove();lt(this,A,!1)},$t(O,"_initialized",!1);let x=O;h.AnnotationEditorLayer=x},(pt,h,et)=>{var tt,x,f,M,N,y,D,r,g,A,fs,m,ps,E,gs,t,fe,l,He,F,ms,X,We;Object.defineProperty(h,"__esModule",{value:!0}),h.FreeTextEditor=void 0;var c=et(1),P=et(5),Z=et(4),V=et(29);const G=class G extends Z.AnnotationEditor{constructor(q){super({...q,name:"freeTextEditor"});W(this,A);W(this,m);W(this,E);W(this,t);W(this,l);W(this,F);W(this,X);W(this,tt,this.editorDivBlur.bind(this));W(this,x,this.editorDivFocus.bind(this));W(this,f,this.editorDivInput.bind(this));W(this,M,this.editorDivKeydown.bind(this));W(this,N,void 0);W(this,y,"");W(this,D,`${this.id}-editor`);W(this,r,void 0);W(this,g,null);lt(this,N,q.color||G._defaultColor||Z.AnnotationEditor._defaultLineColor),lt(this,r,q.fontSize||G._defaultFontSize)}static get _keyboardManager(){return(0,c.shadow)(this,"_keyboardManager",new P.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],G.prototype.commitOrRemove,!0],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],G.prototype.commitOrRemove]]))}static initialize(q){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(St=>[St,q.get(St)]));const st=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(st.getPropertyValue("--freetext-padding"))}static updateDefaultParams(q,st){switch(q){case c.AnnotationEditorParamsType.FREETEXT_SIZE:G._defaultFontSize=st;break;case c.AnnotationEditorParamsType.FREETEXT_COLOR:G._defaultColor=st;break}}updateParams(q,st){switch(q){case c.AnnotationEditorParamsType.FREETEXT_SIZE:Q(this,A,fs).call(this,st);break;case c.AnnotationEditorParamsType.FREETEXT_COLOR:Q(this,m,ps).call(this,st);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.FREETEXT_SIZE,G._defaultFontSize],[c.AnnotationEditorParamsType.FREETEXT_COLOR,G._defaultColor||Z.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[c.AnnotationEditorParamsType.FREETEXT_SIZE,s(this,r)],[c.AnnotationEditorParamsType.FREETEXT_COLOR,s(this,N)]]}getInitialTranslation(){const q=this.parentScale;return[-G._internalPadding*q,-(G._internalPadding+s(this,r))*q]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(c.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",s(this,M)),this.editorDiv.addEventListener("focus",s(this,x)),this.editorDiv.addEventListener("blur",s(this,tt)),this.editorDiv.addEventListener("input",s(this,f)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",s(this,D)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",s(this,M)),this.editorDiv.removeEventListener("focus",s(this,x)),this.editorDiv.removeEventListener("blur",s(this,tt)),this.editorDiv.removeEventListener("input",s(this,f)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(q){super.focusin(q),q.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){if(this.width){Q(this,X,We).call(this);return}this.enableEditMode(),this.editorDiv.focus()}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const q=s(this,y),st=lt(this,y,Q(this,E,gs).call(this).trimEnd());if(q===st)return;const St=vt=>{if(lt(this,y,vt),!vt){this.remove();return}Q(this,l,He).call(this),this.rebuild(),Q(this,t,fe).call(this)};this.addCommands({cmd:()=>{St(st)},undo:()=>{St(q)},mustExec:!1}),Q(this,t,fe).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(q){this.enableEditMode(),this.editorDiv.focus()}keydown(q){q.target===this.div&&q.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(q){G._keyboardManager.exec(this,q)}editorDivFocus(q){this.isEditing=!0}editorDivBlur(q){this.isEditing=!1}editorDivInput(q){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let q,st;this.width&&(q=this.x,st=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",s(this,D)),this.enableEditing(),G._l10nPromise.get("editor_free_text2_aria_label").then(vt=>{var yt;return(yt=this.editorDiv)==null?void 0:yt.setAttribute("aria-label",vt)}),G._l10nPromise.get("free_text2_default_content").then(vt=>{var yt;return(yt=this.editorDiv)==null?void 0:yt.setAttribute("default-content",vt)}),this.editorDiv.contentEditable=!0;const{style:St}=this.editorDiv;if(St.fontSize=`calc(${s(this,r)}px * var(--scale-factor))`,St.color=s(this,N),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,P.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[vt,yt]=this.parentDimensions;if(this.annotationElementId){const[Dt]=this.getInitialTranslation();this.setAt(q*vt,st*yt,Dt,Dt)}else this.setAt(q*vt,st*yt,this.width*vt,this.height*yt);Q(this,l,He).call(this),this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(q,st,St){let vt=null;if(q instanceof V.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Dt,fontColor:j},rect:o,rotation:a,id:_},textContent:R,parent:{page:{pageNumber:I}}}=q;if(!R||R.length===0)return null;vt=q={annotationType:c.AnnotationEditorType.FREETEXT,color:Array.from(j),fontSize:Dt,value:R.join(`
`),pageIndex:I-1,rect:o,rotation:a,id:_,deleted:!1}}const yt=super.deserialize(q,st,St);return lt(yt,r,q.fontSize),lt(yt,N,c.Util.makeHexColor(...q.color)),lt(yt,y,q.value),yt.annotationElementId=q.id||null,lt(yt,g,vt),yt}serialize(q=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const st=G._internalPadding*this.parentScale,St=this.getRect(st,st),vt=Z.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:s(this,N)),yt={annotationType:c.AnnotationEditorType.FREETEXT,color:vt,fontSize:s(this,r),value:s(this,y),pageIndex:this.pageIndex,rect:St,rotation:this.rotation};return q?yt:this.annotationElementId&&!Q(this,F,ms).call(this,yt)?null:(yt.id=this.annotationElementId,yt)}};tt=new WeakMap,x=new WeakMap,f=new WeakMap,M=new WeakMap,N=new WeakMap,y=new WeakMap,D=new WeakMap,r=new WeakMap,g=new WeakMap,A=new WeakSet,fs=function(q){const st=vt=>{this.editorDiv.style.fontSize=`calc(${vt}px * var(--scale-factor))`,this.translate(0,-(vt-s(this,r))*this.parentScale),lt(this,r,vt),Q(this,t,fe).call(this)},St=s(this,r);this.addCommands({cmd:()=>{st(q)},undo:()=>{st(St)},mustExec:!0,type:c.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},m=new WeakSet,ps=function(q){const st=s(this,N);this.addCommands({cmd:()=>{lt(this,N,this.editorDiv.style.color=q)},undo:()=>{lt(this,N,this.editorDiv.style.color=st)},mustExec:!0,type:c.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},E=new WeakSet,gs=function(){const q=this.editorDiv.getElementsByTagName("div");if(q.length===0)return this.editorDiv.innerText;const st=[];for(const St of q)st.push(St.innerText.replace(/\r\n?|\n/,""));return st.join(`
`)},t=new WeakSet,fe=function(){const[q,st]=this.parentDimensions;let St;if(this.isAttachedToDOM)St=this.div.getBoundingClientRect();else{const{currentLayer:vt,div:yt}=this,Dt=yt.style.display;yt.style.display="hidden",vt.div.append(this.div),St=yt.getBoundingClientRect(),yt.remove(),yt.style.display=Dt}this.width=St.width/q,this.height=St.height/st},l=new WeakSet,He=function(){if(this.editorDiv.replaceChildren(),!!s(this,y))for(const q of s(this,y).split(`
`)){const st=document.createElement("div");st.append(q?document.createTextNode(q):document.createElement("br")),this.editorDiv.append(st)}},F=new WeakSet,ms=function(q){const{value:st,fontSize:St,color:vt,rect:yt,pageIndex:Dt}=s(this,g);return q.value!==st||q.fontSize!==St||q.rect.some((j,o)=>Math.abs(j-yt[o])>=1)||q.color.some((j,o)=>j!==vt[o])||q.pageIndex!==Dt},X=new WeakSet,We=function(q=!1){if(!this.annotationElementId)return;if(Q(this,t,fe).call(this),!q&&(this.width===0||this.height===0)){setTimeout(()=>Q(this,X,We).call(this,!0),0);return}const st=G._internalPadding*this.parentScale;s(this,g).rect=this.getRect(st,st)},$t(G,"_freeTextDefaultContent",""),$t(G,"_l10nPromise"),$t(G,"_internalPadding",0),$t(G,"_defaultColor",null),$t(G,"_defaultFontSize",10),$t(G,"_type","freetext");let ot=G;h.FreeTextEditor=ot},(pt,h,et)=>{var j,se,a,bs,R,I,B,H,Y,nt,rt,ct,dt,Et,ft,xt,It,Tt,bt,J,z,Ge,mt,qe,Rt,ze,jt,Ft,v,C,L,at,kt,Lt,Ut,Wt,Xe,Xt,Ve;Object.defineProperty(h,"__esModule",{value:!0}),h.InkAnnotationElement=h.FreeTextAnnotationElement=h.AnnotationLayer=void 0;var c=et(1),P=et(6),Z=et(3),V=et(30),ot=et(31);const tt=1e3,x=9,f=new WeakSet;function M(Mt){return{width:Mt[2]-Mt[0],height:Mt[3]-Mt[1]}}class N{static create(T){switch(T.data.annotationType){case c.AnnotationType.LINK:return new D(T);case c.AnnotationType.TEXT:return new r(T);case c.AnnotationType.WIDGET:switch(T.data.fieldType){case"Tx":return new A(T);case"Btn":return T.data.radioButton?new d(T):T.data.checkBox?new m(T):new E(T);case"Ch":return new n(T);case"Sig":return new S(T)}return new g(T);case c.AnnotationType.POPUP:return new t(T);case c.AnnotationType.FREETEXT:return new l(T);case c.AnnotationType.LINE:return new p(T);case c.AnnotationType.SQUARE:return new F(T);case c.AnnotationType.CIRCLE:return new O(T);case c.AnnotationType.POLYLINE:return new X(T);case c.AnnotationType.CARET:return new G(T);case c.AnnotationType.INK:return new it(T);case c.AnnotationType.POLYGON:return new w(T);case c.AnnotationType.HIGHLIGHT:return new ht(T);case c.AnnotationType.UNDERLINE:return new q(T);case c.AnnotationType.SQUIGGLY:return new st(T);case c.AnnotationType.STRIKEOUT:return new St(T);case c.AnnotationType.STAMP:return new vt(T);case c.AnnotationType.FILEATTACHMENT:return new yt(T);default:return new y(T)}}}class y{constructor(T,{isRenderable:u=!1,ignoreBorder:i=!1,createQuadrilaterals:b=!1}={}){this.isRenderable=u,this.data=T.data,this.layer=T.layer,this.linkService=T.linkService,this.downloadManager=T.downloadManager,this.imageResourcesPath=T.imageResourcesPath,this.renderForms=T.renderForms,this.svgFactory=T.svgFactory,this.annotationStorage=T.annotationStorage,this.enableScripting=T.enableScripting,this.hasJSActions=T.hasJSActions,this._fieldObjects=T.fieldObjects,this.parent=T.parent,u&&(this.container=this._createContainer(i)),b&&(this.quadrilaterals=this._createQuadrilaterals(i))}_createContainer(T){const{data:u,parent:{page:i,viewport:b}}=this,k=document.createElement("section");k.setAttribute("data-annotation-id",u.id),k.style.zIndex=this.parent.zIndex++,this.data.popupRef&&k.setAttribute("aria-haspopup","dialog"),u.noRotate&&k.classList.add("norotate");const{pageWidth:U,pageHeight:K,pageX:gt,pageY:_t}=b.rawDims;if(!u.rect||this instanceof t){const{rotation:Ot}=u;return!u.hasOwnCanvas&&Ot!==0&&this.setRotation(Ot,k),k}const{width:$,height:Ct}=M(u.rect),At=c.Util.normalizeRect([u.rect[0],i.view[3]-u.rect[1]+i.view[1],u.rect[2],i.view[3]-u.rect[3]+i.view[1]]);if(!T&&u.borderStyle.width>0){k.style.borderWidth=`${u.borderStyle.width}px`;const Ot=u.borderStyle.horizontalCornerRadius,Bt=u.borderStyle.verticalCornerRadius;if(Ot>0||Bt>0){const Gt=`calc(${Ot}px * var(--scale-factor)) / calc(${Bt}px * var(--scale-factor))`;k.style.borderRadius=Gt}else if(this instanceof d){const Gt=`calc(${$}px * var(--scale-factor)) / calc(${Ct}px * var(--scale-factor))`;k.style.borderRadius=Gt}switch(u.borderStyle.style){case c.AnnotationBorderStyleType.SOLID:k.style.borderStyle="solid";break;case c.AnnotationBorderStyleType.DASHED:k.style.borderStyle="dashed";break;case c.AnnotationBorderStyleType.BEVELED:(0,c.warn)("Unimplemented border style: beveled");break;case c.AnnotationBorderStyleType.INSET:(0,c.warn)("Unimplemented border style: inset");break;case c.AnnotationBorderStyleType.UNDERLINE:k.style.borderBottomStyle="solid";break}const Ht=u.borderColor||null;Ht?k.style.borderColor=c.Util.makeHexColor(Ht[0]|0,Ht[1]|0,Ht[2]|0):k.style.borderWidth=0}k.style.left=`${100*(At[0]-gt)/U}%`,k.style.top=`${100*(At[1]-_t)/K}%`;const{rotation:Pt}=u;return u.hasOwnCanvas||Pt===0?(k.style.width=`${100*$/U}%`,k.style.height=`${100*Ct/K}%`):this.setRotation(Pt,k),k}setRotation(T,u=this.container){const{pageWidth:i,pageHeight:b}=this.parent.viewport.rawDims,{width:k,height:U}=M(this.data.rect);let K,gt;T%180===0?(K=100*k/i,gt=100*U/b):(K=100*U/i,gt=100*k/b),u.style.width=`${K}%`,u.style.height=`${gt}%`,u.setAttribute("data-main-rotation",(360-T)%360)}get _commonActions(){const T=(u,i,b)=>{const k=b.detail[u];b.target.style[i]=V.ColorConverters[`${k[0]}_HTML`](k.slice(1))};return(0,c.shadow)(this,"_commonActions",{display:u=>{const i=u.detail.display%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:i,print:u.detail.display===0||u.detail.display===3})},print:u=>{this.annotationStorage.setValue(this.data.id,{print:u.detail.print})},hidden:u=>{this.container.style.visibility=u.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:u.detail.hidden})},focus:u=>{setTimeout(()=>u.target.focus({preventScroll:!1}),0)},userName:u=>{u.target.title=u.detail.userName},readonly:u=>{u.detail.readonly?u.target.setAttribute("readonly",""):u.target.removeAttribute("readonly")},required:u=>{this._setRequired(u.target,u.detail.required)},bgColor:u=>{T("bgColor","backgroundColor",u)},fillColor:u=>{T("fillColor","backgroundColor",u)},fgColor:u=>{T("fgColor","color",u)},textColor:u=>{T("textColor","color",u)},borderColor:u=>{T("borderColor","borderColor",u)},strokeColor:u=>{T("strokeColor","borderColor",u)},rotation:u=>{const i=u.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(T,u){const i=this._commonActions;for(const b of Object.keys(u.detail)){const k=T[b]||i[b];k==null||k(u)}}_setDefaultPropertiesFromJS(T){if(!this.enableScripting)return;const u=this.annotationStorage.getRawValue(this.data.id);if(!u)return;const i=this._commonActions;for(const[b,k]of Object.entries(u)){const U=i[b];if(U){const K={detail:{[b]:k},target:T};U(K),delete u[b]}}}_createQuadrilaterals(T=!1){if(!this.data.quadPoints)return null;const u=[],i=this.data.rect;let b=null;for(const k of this.data.quadPoints)this.data.rect=[k[2].x,k[2].y,k[1].x,k[1].y],u.push(this._createContainer(T)),b||(b=this.data.rect);return this.data.rect=i,this.firstQuadRect=b,u}_createPopup(){const{container:T,data:u}=this;T.setAttribute("aria-haspopup","dialog");const i=new t({data:{color:u.color,titleObj:u.titleObj,modificationDate:u.modificationDate,contentsObj:u.contentsObj,richText:u.richText,parentRect:this.firstQuadRect||u.rect,borderStyle:0,id:`popup_${u.id}`,rotation:u.rotation},parent:this.parent,elements:[this]});this.parent.div.append(i.render())}_renderQuadrilaterals(T){for(const u of this.quadrilaterals)u.classList.add(T);return this.quadrilaterals}render(){(0,c.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(T,u=null){const i=[];if(this._fieldObjects){const b=this._fieldObjects[T];if(b)for(const{page:k,id:U,exportValues:K}of b){if(k===-1||U===u)continue;const gt=typeof K=="string"?K:null,_t=document.querySelector(`[data-element-id="${U}"]`);if(_t&&!f.has(_t)){(0,c.warn)(`_getElementsByName - element not allowed: ${U}`);continue}i.push({id:U,exportValue:gt,domElement:_t})}return i}for(const b of document.getElementsByName(T)){const{exportValue:k}=b,U=b.getAttribute("data-element-id");U!==u&&f.has(b)&&i.push({id:U,exportValue:k,domElement:b})}return i}show(){var T;this.container&&(this.container.hidden=!1),(T=this.popup)==null||T.maybeShow()}hide(){var T;this.container&&(this.container.hidden=!0),(T=this.popup)==null||T.forceHide()}getElementsToTriggerPopup(){return this.quadrilaterals||this.container}addHighlightArea(){const T=this.getElementsToTriggerPopup();if(Array.isArray(T))for(const u of T)u.classList.add("highlightArea");else T.classList.add("highlightArea")}}class D extends y{constructor(u,i=null){super(u,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});W(this,j);W(this,a);this.isTooltipOnly=u.data.isTooltipOnly}render(){const{data:u,linkService:i}=this,b=document.createElement("a");b.setAttribute("data-element-id",u.id);let k=!1;return u.url?(i.addLinkAttributes(b,u.url,u.newWindow),k=!0):u.action?(this._bindNamedAction(b,u.action),k=!0):u.attachment?(this._bindAttachment(b,u.attachment),k=!0):u.setOCGState?(Q(this,a,bs).call(this,b,u.setOCGState),k=!0):u.dest?(this._bindLink(b,u.dest),k=!0):(u.actions&&(u.actions.Action||u.actions["Mouse Up"]||u.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(b,u),k=!0),u.resetForm?(this._bindResetFormAction(b,u.resetForm),k=!0):this.isTooltipOnly&&!k&&(this._bindLink(b,""),k=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((U,K)=>{const gt=K===0?b:b.cloneNode();return U.append(gt),U}):(this.container.classList.add("linkAnnotation"),k&&this.container.append(b),this.container)}_bindLink(u,i){u.href=this.linkService.getDestinationHash(i),u.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&Q(this,j,se).call(this)}_bindNamedAction(u,i){u.href=this.linkService.getAnchorUrl(""),u.onclick=()=>(this.linkService.executeNamedAction(i),!1),Q(this,j,se).call(this)}_bindAttachment(u,i){u.href=this.linkService.getAnchorUrl(""),u.onclick=()=>{var b;return(b=this.downloadManager)==null||b.openOrDownloadData(this.container,i.content,i.filename),!1},Q(this,j,se).call(this)}_bindJSAction(u,i){u.href=this.linkService.getAnchorUrl("");const b=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const k of Object.keys(i.actions)){const U=b.get(k);U&&(u[U]=()=>{var K;return(K=this.linkService.eventBus)==null||K.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:k}}),!1})}u.onclick||(u.onclick=()=>!1),Q(this,j,se).call(this)}_bindResetFormAction(u,i){const b=u.onclick;if(b||(u.href=this.linkService.getAnchorUrl("")),Q(this,j,se).call(this),!this._fieldObjects){(0,c.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),b||(u.onclick=()=>!1);return}u.onclick=()=>{var Ct;b==null||b();const{fields:k,refs:U,include:K}=i,gt=[];if(k.length!==0||U.length!==0){const At=new Set(U);for(const Pt of k){const Ot=this._fieldObjects[Pt]||[];for(const{id:Bt}of Ot)At.add(Bt)}for(const Pt of Object.values(this._fieldObjects))for(const Ot of Pt)At.has(Ot.id)===K&&gt.push(Ot)}else for(const At of Object.values(this._fieldObjects))gt.push(...At);const _t=this.annotationStorage,$=[];for(const At of gt){const{id:Pt}=At;switch($.push(Pt),At.type){case"text":{const Bt=At.defaultValue||"";_t.setValue(Pt,{value:Bt});break}case"checkbox":case"radiobutton":{const Bt=At.defaultValue===At.exportValues;_t.setValue(Pt,{value:Bt});break}case"combobox":case"listbox":{const Bt=At.defaultValue||"";_t.setValue(Pt,{value:Bt});break}default:continue}const Ot=document.querySelector(`[data-element-id="${Pt}"]`);if(Ot){if(!f.has(Ot)){(0,c.warn)(`_bindResetFormAction - element not allowed: ${Pt}`);continue}}else continue;Ot.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Ct=this.linkService.eventBus)==null||Ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:$,name:"ResetForm"}})),!1}}}j=new WeakSet,se=function(){this.container.setAttribute("data-internal-link","")},a=new WeakSet,bs=function(u,i){u.href=this.linkService.getAnchorUrl(""),u.onclick=()=>(this.linkService.executeSetOCGState(i),!1),Q(this,j,se).call(this)};class r extends y{constructor(T){var i,b,k;const u=!!(T.data.popupRef||(i=T.data.titleObj)!=null&&i.str||(b=T.data.contentsObj)!=null&&b.str||(k=T.data.richText)!=null&&k.str);super(T,{isRenderable:u})}render(){this.container.classList.add("textAnnotation");const T=document.createElement("img");return T.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",T.alt="[{{type}} Annotation]",T.dataset.l10nId="text_annotation_type",T.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.popupRef||this._createPopup(),this.container.append(T),this.container}}class g extends y{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(T){var u;this.data.hasOwnCanvas&&(((u=T.previousSibling)==null?void 0:u.nodeName)==="CANVAS"&&(T.previousSibling.hidden=!0),T.hidden=!1)}_getKeyModifier(T){const{isWin:u,isMac:i}=c.FeatureTest.platform;return u&&T.ctrlKey||i&&T.metaKey}_setEventListener(T,u,i,b){u.includes("mouse")?T.addEventListener(u,k=>{var U;(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:b(k),shift:k.shiftKey,modifier:this._getKeyModifier(k)}})}):T.addEventListener(u,k=>{var U;(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:b(k)}})})}_setEventListeners(T,u,i){var b;for(const[k,U]of u)(U==="Action"||(b=this.data.actions)!=null&&b[U])&&this._setEventListener(T,k,U,i)}_setBackgroundColor(T){const u=this.data.backgroundColor||null;T.style.backgroundColor=u===null?"transparent":c.Util.makeHexColor(u[0],u[1],u[2])}_setTextStyle(T){const u=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,b=this.data.defaultAppearanceData.fontSize||x,k=T.style;let U;const K=2,gt=_t=>Math.round(10*_t)/10;if(this.data.multiLine){const _t=Math.abs(this.data.rect[3]-this.data.rect[1]-K),$=Math.round(_t/(c.LINE_FACTOR*b))||1,Ct=_t/$;U=Math.min(b,gt(Ct/c.LINE_FACTOR))}else{const _t=Math.abs(this.data.rect[3]-this.data.rect[1]-K);U=Math.min(b,gt(_t/c.LINE_FACTOR))}k.fontSize=`calc(${U}px * var(--scale-factor))`,k.color=c.Util.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(k.textAlign=u[this.data.textAlignment])}_setRequired(T,u){u?T.setAttribute("required",!0):T.removeAttribute("required"),T.setAttribute("aria-required",u)}}class A extends g{constructor(T){const u=T.renderForms||!T.data.hasAppearance&&!!T.data.fieldValue;super(T,{isRenderable:u})}setPropertyOnSiblings(T,u,i,b){const k=this.annotationStorage;for(const U of this._getElementsByName(T.name,T.id))U.domElement&&(U.domElement[u]=i),k.setValue(U.id,{[b]:i})}render(){var b,k;const T=this.annotationStorage,u=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const U=T.getValue(u,{value:this.data.fieldValue});let K=U.value||"";const gt=T.getValue(u,{charLimit:this.data.maxLen}).charLimit;gt&&K.length>gt&&(K=K.slice(0,gt));let _t=U.formattedValue||((b=this.data.textContent)==null?void 0:b.join(`
`))||null;_t&&this.data.comb&&(_t=_t.replaceAll(/\s+/g,""));const $={userValue:K,formattedValue:_t,lastCommittedValue:null,commitKey:1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=_t!=null?_t:K,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",_t!=null?_t:K),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),f.add(i),i.setAttribute("data-element-id",u),i.disabled=this.data.readOnly,i.name=this.data.baseFieldName||this.data.fieldName,i.tabIndex=tt,this._setRequired(i,this.data.required),gt&&(i.maxLength=gt),i.addEventListener("input",At=>{T.setValue(u,{value:At.target.value}),this.setPropertyOnSiblings(i,"value",At.target.value,"value"),$.formattedValue=null}),i.addEventListener("resetform",At=>{var Ot;const Pt=(Ot=this.data.defaultFieldValue)!=null?Ot:"";i.value=$.userValue=Pt,$.formattedValue=null});let Ct=At=>{const{formattedValue:Pt}=$;Pt!=null&&(At.target.value=Pt),At.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",Pt=>{const{target:Ot}=Pt;$.userValue&&(Ot.value=$.userValue),$.lastCommittedValue=Ot.value,$.commitKey=1}),i.addEventListener("updatefromsandbox",Pt=>{this.showElementAndHideCanvas(Pt.target);const Ot={value(Bt){var Ht;$.userValue=(Ht=Bt.detail.value)!=null?Ht:"",T.setValue(u,{value:$.userValue.toString()}),Bt.target.value=$.userValue},formattedValue(Bt){const{formattedValue:Ht}=Bt.detail;$.formattedValue=Ht,Ht!=null&&Bt.target!==document.activeElement&&(Bt.target.value=Ht),T.setValue(u,{formattedValue:Ht})},selRange(Bt){Bt.target.setSelectionRange(...Bt.detail.selRange)},charLimit:Bt=>{var qt;const{charLimit:Ht}=Bt.detail,{target:Gt}=Bt;if(Ht===0){Gt.removeAttribute("maxLength");return}Gt.setAttribute("maxLength",Ht);let zt=$.userValue;!zt||zt.length<=Ht||(zt=zt.slice(0,Ht),Gt.value=$.userValue=zt,T.setValue(u,{value:zt}),(qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:zt,willCommit:!0,commitKey:1,selStart:Gt.selectionStart,selEnd:Gt.selectionEnd}}))}};this._dispatchEventFromSandbox(Ot,Pt)}),i.addEventListener("keydown",Pt=>{var Ht;$.commitKey=1;let Ot=-1;if(Pt.key==="Escape"?Ot=0:Pt.key==="Enter"&&!this.data.multiLine?Ot=2:Pt.key==="Tab"&&($.commitKey=3),Ot===-1)return;const{value:Bt}=Pt.target;$.lastCommittedValue!==Bt&&($.lastCommittedValue=Bt,$.userValue=Bt,(Ht=this.linkService.eventBus)==null||Ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:Bt,willCommit:!0,commitKey:Ot,selStart:Pt.target.selectionStart,selEnd:Pt.target.selectionEnd}}))});const At=Ct;Ct=null,i.addEventListener("blur",Pt=>{var Bt;if(!Pt.relatedTarget)return;const{value:Ot}=Pt.target;$.userValue=Ot,$.lastCommittedValue!==Ot&&((Bt=this.linkService.eventBus)==null||Bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:Ot,willCommit:!0,commitKey:$.commitKey,selStart:Pt.target.selectionStart,selEnd:Pt.target.selectionEnd}})),At(Pt)}),(k=this.data.actions)!=null&&k.Keystroke&&i.addEventListener("beforeinput",Pt=>{var Kt;$.lastCommittedValue=null;const{data:Ot,target:Bt}=Pt,{value:Ht,selectionStart:Gt,selectionEnd:zt}=Bt;let qt=Gt,Vt=zt;switch(Pt.inputType){case"deleteWordBackward":{const Zt=Ht.substring(0,Gt).match(/\w*[^\w]*$/);Zt&&(qt-=Zt[0].length);break}case"deleteWordForward":{const Zt=Ht.substring(Gt).match(/^[^\w]*\w*/);Zt&&(Vt+=Zt[0].length);break}case"deleteContentBackward":Gt===zt&&(qt-=1);break;case"deleteContentForward":Gt===zt&&(Vt+=1);break}Pt.preventDefault(),(Kt=this.linkService.eventBus)==null||Kt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:Ht,change:Ot||"",willCommit:!1,selStart:qt,selEnd:Vt}})}),this._setEventListeners(i,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Pt=>Pt.target.value)}if(Ct&&i.addEventListener("blur",Ct),this.data.comb){const Pt=(this.data.rect[2]-this.data.rect[0])/gt;i.classList.add("comb"),i.style.letterSpacing=`calc(${Pt}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell";return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class S extends g{constructor(T){super(T,{isRenderable:!!T.data.hasOwnCanvas})}}class m extends g{constructor(T){super(T,{isRenderable:T.renderForms})}render(){const T=this.annotationStorage,u=this.data,i=u.id;let b=T.getValue(i,{value:u.exportValue===u.fieldValue}).value;typeof b=="string"&&(b=b!=="Off",T.setValue(i,{value:b})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const k=document.createElement("input");return f.add(k),k.setAttribute("data-element-id",i),k.disabled=u.readOnly,this._setRequired(k,this.data.required),k.type="checkbox",k.name=u.baseFieldName||u.fieldName,b&&k.setAttribute("checked",!0),k.setAttribute("exportValue",u.exportValue),k.tabIndex=tt,k.addEventListener("change",U=>{const{name:K,checked:gt}=U.target;for(const _t of this._getElementsByName(K,i)){const $=gt&&_t.exportValue===u.exportValue;_t.domElement&&(_t.domElement.checked=$),T.setValue(_t.id,{value:$})}T.setValue(i,{value:gt})}),k.addEventListener("resetform",U=>{const K=u.defaultFieldValue||"Off";U.target.checked=K===u.exportValue}),this.enableScripting&&this.hasJSActions&&(k.addEventListener("updatefromsandbox",U=>{const K={value(gt){gt.target.checked=gt.detail.value!=="Off",T.setValue(i,{value:gt.target.checked})}};this._dispatchEventFromSandbox(K,U)}),this._setEventListeners(k,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],U=>U.target.checked)),this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class d extends g{constructor(T){super(T,{isRenderable:T.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const T=this.annotationStorage,u=this.data,i=u.id;let b=T.getValue(i,{value:u.fieldValue===u.buttonValue}).value;typeof b=="string"&&(b=b!==u.buttonValue,T.setValue(i,{value:b}));const k=document.createElement("input");if(f.add(k),k.setAttribute("data-element-id",i),k.disabled=u.readOnly,this._setRequired(k,this.data.required),k.type="radio",k.name=u.baseFieldName||u.fieldName,b&&k.setAttribute("checked",!0),k.tabIndex=tt,k.addEventListener("change",U=>{const{name:K,checked:gt}=U.target;for(const _t of this._getElementsByName(K,i))T.setValue(_t.id,{value:!1});T.setValue(i,{value:gt})}),k.addEventListener("resetform",U=>{const K=u.defaultFieldValue;U.target.checked=K!=null&&K===u.buttonValue}),this.enableScripting&&this.hasJSActions){const U=u.buttonValue;k.addEventListener("updatefromsandbox",K=>{const gt={value:_t=>{const $=U===_t.detail.value;for(const Ct of this._getElementsByName(_t.target.name)){const At=$&&Ct.id===i;Ct.domElement&&(Ct.domElement.checked=At),T.setValue(Ct.id,{value:At})}}};this._dispatchEventFromSandbox(gt,K)}),this._setEventListeners(k,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],K=>K.target.checked)}return this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class E extends D{constructor(T){super(T,{ignoreBorder:T.data.hasAppearance})}render(){const T=super.render();T.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(T.title=this.data.alternativeText);const u=T.lastChild;return this.enableScripting&&this.hasJSActions&&u&&(this._setDefaultPropertiesFromJS(u),u.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),T}}class n extends g{constructor(T){super(T,{isRenderable:T.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const T=this.annotationStorage,u=this.data.id,i=T.getValue(u,{value:this.data.fieldValue}),b=document.createElement("select");f.add(b),b.setAttribute("data-element-id",u),b.disabled=this.data.readOnly,this._setRequired(b,this.data.required),b.name=this.data.baseFieldName||this.data.fieldName,b.tabIndex=tt;let k=this.data.combo&&this.data.options.length>0;this.data.combo||(b.size=this.data.options.length,this.data.multiSelect&&(b.multiple=!0)),b.addEventListener("resetform",$=>{const Ct=this.data.defaultFieldValue;for(const At of b.options)At.selected=At.value===Ct});for(const $ of this.data.options){const Ct=document.createElement("option");Ct.textContent=$.displayValue,Ct.value=$.exportValue,i.value.includes($.exportValue)&&(Ct.setAttribute("selected",!0),k=!1),b.append(Ct)}let U=null;if(k){const $=document.createElement("option");$.value=" ",$.setAttribute("hidden",!0),$.setAttribute("selected",!0),b.prepend($),U=()=>{$.remove(),b.removeEventListener("input",U),U=null},b.addEventListener("input",U)}const K=$=>{const Ct=$?"value":"textContent",{options:At,multiple:Pt}=b;return Pt?Array.prototype.filter.call(At,Ot=>Ot.selected).map(Ot=>Ot[Ct]):At.selectedIndex===-1?null:At[At.selectedIndex][Ct]};let gt=K(!1);const _t=$=>{const Ct=$.target.options;return Array.prototype.map.call(Ct,At=>({displayValue:At.textContent,exportValue:At.value}))};return this.enableScripting&&this.hasJSActions?(b.addEventListener("updatefromsandbox",$=>{const Ct={value(At){U==null||U();const Pt=At.detail.value,Ot=new Set(Array.isArray(Pt)?Pt:[Pt]);for(const Bt of b.options)Bt.selected=Ot.has(Bt.value);T.setValue(u,{value:K(!0)}),gt=K(!1)},multipleSelection(At){b.multiple=!0},remove(At){const Pt=b.options,Ot=At.detail.remove;Pt[Ot].selected=!1,b.remove(Ot),Pt.length>0&&Array.prototype.findIndex.call(Pt,Ht=>Ht.selected)===-1&&(Pt[0].selected=!0),T.setValue(u,{value:K(!0),items:_t(At)}),gt=K(!1)},clear(At){for(;b.length!==0;)b.remove(0);T.setValue(u,{value:null,items:[]}),gt=K(!1)},insert(At){const{index:Pt,displayValue:Ot,exportValue:Bt}=At.detail.insert,Ht=b.children[Pt],Gt=document.createElement("option");Gt.textContent=Ot,Gt.value=Bt,Ht?Ht.before(Gt):b.append(Gt),T.setValue(u,{value:K(!0),items:_t(At)}),gt=K(!1)},items(At){const{items:Pt}=At.detail;for(;b.length!==0;)b.remove(0);for(const Ot of Pt){const{displayValue:Bt,exportValue:Ht}=Ot,Gt=document.createElement("option");Gt.textContent=Bt,Gt.value=Ht,b.append(Gt)}b.options.length>0&&(b.options[0].selected=!0),T.setValue(u,{value:K(!0),items:_t(At)}),gt=K(!1)},indices(At){const Pt=new Set(At.detail.indices);for(const Ot of At.target.options)Ot.selected=Pt.has(Ot.index);T.setValue(u,{value:K(!0)}),gt=K(!1)},editable(At){At.target.disabled=!At.detail.editable}};this._dispatchEventFromSandbox(Ct,$)}),b.addEventListener("input",$=>{var At;const Ct=K(!0);T.setValue(u,{value:Ct}),$.preventDefault(),(At=this.linkService.eventBus)==null||At.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:gt,changeEx:Ct,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(b,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],$=>$.target.value)):b.addEventListener("input",function($){T.setValue(u,{value:K(!0)})}),this.data.combo&&this._setTextStyle(b),this._setBackgroundColor(b),this._setDefaultPropertiesFromJS(b),this.container.append(b),this.container}}class t extends y{constructor(T){var k,U,K;const{data:u,elements:i}=T,b=!!((k=u.titleObj)!=null&&k.str||(U=u.contentsObj)!=null&&U.str||(K=u.richText)!=null&&K.str);super(T,{isRenderable:b}),this.elements=i}render(){this.container.classList.add("popupAnnotation");const T=new e({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),u=[];for(const i of this.elements)i.popup=T,u.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",u.join(",")),this.container}}class e{constructor({container:T,color:u,elements:i,titleObj:b,modificationDate:k,contentsObj:U,richText:K,parent:gt,rect:_t,parentRect:$,open:Ct}){W(this,z);W(this,mt);W(this,Rt);W(this,R,null);W(this,I,Q(this,Rt,ze).bind(this));W(this,B,Q(this,mt,qe).bind(this));W(this,H,Q(this,z,Ge).bind(this));W(this,Y,null);W(this,nt,null);W(this,rt,null);W(this,ct,null);W(this,dt,null);W(this,Et,null);W(this,ft,!1);W(this,xt,null);W(this,It,null);W(this,Tt,null);W(this,bt,null);W(this,J,!1);lt(this,nt,T),lt(this,bt,b),lt(this,rt,U),lt(this,Tt,K),lt(this,dt,gt),lt(this,Y,u),lt(this,It,_t),lt(this,Et,$),lt(this,ct,i);const At=P.PDFDateString.toDateObject(k);At&&lt(this,R,gt.l10n.get("annotation_date_string",{date:At.toLocaleDateString(),time:At.toLocaleTimeString()})),this.trigger=i.flatMap(Pt=>Pt.getElementsToTriggerPopup());for(const Pt of this.trigger)Pt.addEventListener("click",s(this,H)),Pt.addEventListener("mouseenter",s(this,B)),Pt.addEventListener("mouseleave",s(this,I));s(this,nt).hidden=!0,Ct&&Q(this,z,Ge).call(this)}render(){if(s(this,xt))return;const{page:{view:T},viewport:{rawDims:{pageWidth:u,pageHeight:i,pageX:b,pageY:k}}}=s(this,dt),U=lt(this,xt,document.createElement("div"));if(U.className="popup",s(this,Y)){const qt=U.style.outlineColor=c.Util.makeHexColor(...s(this,Y));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?U.style.backgroundColor=`color-mix(in srgb, ${qt} 30%, white)`:U.style.backgroundColor=c.Util.makeHexColor(...s(this,Y).map(Kt=>Math.floor(.7*(255-Kt)+Kt)))}const K=document.createElement("span");K.className="header";const gt=document.createElement("h1");if(K.append(gt),{dir:gt.dir,str:gt.textContent}=s(this,bt),U.append(K),s(this,R)){const qt=document.createElement("span");qt.classList.add("popupDate"),s(this,R).then(Vt=>{qt.textContent=Vt}),K.append(qt)}const _t=s(this,rt),$=s(this,Tt);if($!=null&&$.str&&(!(_t!=null&&_t.str)||_t.str===$.str))ot.XfaLayer.render({xfaHtml:$.html,intent:"richText",div:U}),U.lastChild.classList.add("richText","popupContent");else{const qt=this._formatContents(_t);U.append(qt)}let Ct=!!s(this,Et),At=Ct?s(this,Et):s(this,It);for(const qt of s(this,ct))if(!At||c.Util.intersect(qt.data.rect,At)!==null){At=qt.data.rect,Ct=!0;break}const Pt=c.Util.normalizeRect([At[0],T[3]-At[1]+T[1],At[2],T[3]-At[3]+T[1]]),Ot=5,Bt=Ct?At[2]-At[0]+Ot:0,Ht=Pt[0]+Bt,Gt=Pt[1],{style:zt}=s(this,nt);zt.left=`${100*(Ht-b)/u}%`,zt.top=`${100*(Gt-k)/i}%`,s(this,nt).append(U)}_formatContents({str:T,dir:u}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=u;const b=T.split(/(?:\r\n?|\n)/);for(let k=0,U=b.length;k<U;++k){const K=b[k];i.append(document.createTextNode(K)),k<U-1&&i.append(document.createElement("br"))}return i}forceHide(){lt(this,J,this.isVisible),s(this,J)&&(s(this,nt).hidden=!0)}maybeShow(){s(this,J)&&(lt(this,J,!1),s(this,nt).hidden=!1)}get isVisible(){return s(this,nt).hidden===!1}}R=new WeakMap,I=new WeakMap,B=new WeakMap,H=new WeakMap,Y=new WeakMap,nt=new WeakMap,rt=new WeakMap,ct=new WeakMap,dt=new WeakMap,Et=new WeakMap,ft=new WeakMap,xt=new WeakMap,It=new WeakMap,Tt=new WeakMap,bt=new WeakMap,J=new WeakMap,z=new WeakSet,Ge=function(){lt(this,ft,!s(this,ft)),s(this,ft)?(Q(this,mt,qe).call(this),s(this,nt).addEventListener("click",s(this,H))):(Q(this,Rt,ze).call(this),s(this,nt).removeEventListener("click",s(this,H)))},mt=new WeakSet,qe=function(){s(this,xt)||this.render(),this.isVisible?s(this,ft)&&s(this,nt).classList.add("focused"):(s(this,nt).hidden=!1,s(this,nt).style.zIndex=parseInt(s(this,nt).style.zIndex)+1e3)},Rt=new WeakSet,ze=function(){s(this,nt).classList.remove("focused"),!s(this,ft)&&(s(this,nt).hidden=!0,s(this,nt).style.zIndex=parseInt(s(this,nt).style.zIndex)-1e3)};class l extends y{constructor(T){var i,b,k;const u=!!(T.data.popupRef||(i=T.data.titleObj)!=null&&i.str||(b=T.data.contentsObj)!=null&&b.str||(k=T.data.richText)!=null&&k.str);super(T,{isRenderable:u,ignoreBorder:!0}),this.textContent=T.data.textContent,this.annotationEditorType=c.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const T=document.createElement("div");T.classList.add("annotationTextContent"),T.setAttribute("role","comment");for(const u of this.textContent){const i=document.createElement("span");i.textContent=u,T.append(i)}this.container.append(T)}return this.data.popupRef||this._createPopup(),this.container}}h.FreeTextAnnotationElement=l;class p extends y{constructor(u){var b,k,U;const i=!!(u.data.popupRef||(b=u.data.titleObj)!=null&&b.str||(k=u.data.contentsObj)!=null&&k.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:i,ignoreBorder:!0});W(this,jt,null)}render(){this.container.classList.add("lineAnnotation");const u=this.data,{width:i,height:b}=M(u.rect),k=this.svgFactory.create(i,b,!0),U=lt(this,jt,this.svgFactory.createElement("svg:line"));return U.setAttribute("x1",u.rect[2]-u.lineCoordinates[0]),U.setAttribute("y1",u.rect[3]-u.lineCoordinates[1]),U.setAttribute("x2",u.rect[2]-u.lineCoordinates[2]),U.setAttribute("y2",u.rect[3]-u.lineCoordinates[3]),U.setAttribute("stroke-width",u.borderStyle.width||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),k.append(U),this.container.append(k),u.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return s(this,jt)}addHighlightArea(){this.container.classList.add("highlightArea")}}jt=new WeakMap;class F extends y{constructor(u){var b,k,U;const i=!!(u.data.popupRef||(b=u.data.titleObj)!=null&&b.str||(k=u.data.contentsObj)!=null&&k.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:i,ignoreBorder:!0});W(this,Ft,null)}render(){this.container.classList.add("squareAnnotation");const u=this.data,{width:i,height:b}=M(u.rect),k=this.svgFactory.create(i,b,!0),U=u.borderStyle.width,K=lt(this,Ft,this.svgFactory.createElement("svg:rect"));return K.setAttribute("x",U/2),K.setAttribute("y",U/2),K.setAttribute("width",i-U),K.setAttribute("height",b-U),K.setAttribute("stroke-width",U||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),k.append(K),this.container.append(k),u.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return s(this,Ft)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ft=new WeakMap;class O extends y{constructor(u){var b,k,U;const i=!!(u.data.popupRef||(b=u.data.titleObj)!=null&&b.str||(k=u.data.contentsObj)!=null&&k.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:i,ignoreBorder:!0});W(this,v,null)}render(){this.container.classList.add("circleAnnotation");const u=this.data,{width:i,height:b}=M(u.rect),k=this.svgFactory.create(i,b,!0),U=u.borderStyle.width,K=lt(this,v,this.svgFactory.createElement("svg:ellipse"));return K.setAttribute("cx",i/2),K.setAttribute("cy",b/2),K.setAttribute("rx",i/2-U/2),K.setAttribute("ry",b/2-U/2),K.setAttribute("stroke-width",U||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),k.append(K),this.container.append(k),u.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return s(this,v)}addHighlightArea(){this.container.classList.add("highlightArea")}}v=new WeakMap;class X extends y{constructor(u){var b,k,U;const i=!!(u.data.popupRef||(b=u.data.titleObj)!=null&&b.str||(k=u.data.contentsObj)!=null&&k.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:i,ignoreBorder:!0});W(this,C,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const u=this.data,{width:i,height:b}=M(u.rect),k=this.svgFactory.create(i,b,!0);let U=[];for(const gt of u.vertices){const _t=gt.x-u.rect[0],$=u.rect[3]-gt.y;U.push(_t+","+$)}U=U.join(" ");const K=lt(this,C,this.svgFactory.createElement(this.svgElementName));return K.setAttribute("points",U),K.setAttribute("stroke-width",u.borderStyle.width||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),k.append(K),this.container.append(k),u.popupRef||this._createPopup(K,u),this.container}getElementsToTriggerPopup(){return s(this,C)}addHighlightArea(){this.container.classList.add("highlightArea")}}C=new WeakMap;class w extends X{constructor(T){super(T),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class G extends y{constructor(T){var i,b,k;const u=!!(T.data.popupRef||(i=T.data.titleObj)!=null&&i.str||(b=T.data.contentsObj)!=null&&b.str||(k=T.data.richText)!=null&&k.str);super(T,{isRenderable:u,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.popupRef||this._createPopup(),this.container}}class it extends y{constructor(u){var b,k,U;const i=!!(u.data.popupRef||(b=u.data.titleObj)!=null&&b.str||(k=u.data.contentsObj)!=null&&k.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:i,ignoreBorder:!0});W(this,L,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=c.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const u=this.data,{width:i,height:b}=M(u.rect),k=this.svgFactory.create(i,b,!0);for(const U of u.inkLists){let K=[];for(const _t of U){const $=_t.x-u.rect[0],Ct=u.rect[3]-_t.y;K.push(`${$},${Ct}`)}K=K.join(" ");const gt=this.svgFactory.createElement(this.svgElementName);s(this,L).push(gt),gt.setAttribute("points",K),gt.setAttribute("stroke-width",u.borderStyle.width||1),gt.setAttribute("stroke","transparent"),gt.setAttribute("fill","transparent"),u.popupRef||this._createPopup(gt,u),k.append(gt)}return this.container.append(k),this.container}getElementsToTriggerPopup(){return s(this,L)}addHighlightArea(){this.container.classList.add("highlightArea")}}L=new WeakMap,h.InkAnnotationElement=it;class ht extends y{constructor(T){var i,b,k;const u=!!(T.data.popupRef||(i=T.data.titleObj)!=null&&i.str||(b=T.data.contentsObj)!=null&&b.str||(k=T.data.richText)!=null&&k.str);super(T,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class q extends y{constructor(T){var i,b,k;const u=!!(T.data.popupRef||(i=T.data.titleObj)!=null&&i.str||(b=T.data.contentsObj)!=null&&b.str||(k=T.data.richText)!=null&&k.str);super(T,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class st extends y{constructor(T){var i,b,k;const u=!!(T.data.popupRef||(i=T.data.titleObj)!=null&&i.str||(b=T.data.contentsObj)!=null&&b.str||(k=T.data.richText)!=null&&k.str);super(T,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class St extends y{constructor(T){var i,b,k;const u=!!(T.data.popupRef||(i=T.data.titleObj)!=null&&i.str||(b=T.data.contentsObj)!=null&&b.str||(k=T.data.richText)!=null&&k.str);super(T,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class vt extends y{constructor(T){var i,b,k;const u=!!(T.data.popupRef||(i=T.data.titleObj)!=null&&i.str||(b=T.data.contentsObj)!=null&&b.str||(k=T.data.richText)!=null&&k.str);super(T,{isRenderable:u,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.popupRef||this._createPopup(),this.container}}class yt extends y{constructor(u){var k;super(u,{isRenderable:!0});W(this,at,null);const{filename:i,content:b}=this.data.file;this.filename=(0,P.getFilenameFromUrl)(i,!0),this.content=b,(k=this.linkService.eventBus)==null||k.dispatch("fileattachmentannotation",{source:this,filename:i,content:b})}render(){var i,b;this.container.classList.add("fileAttachmentAnnotation");let u;return this.data.hasAppearance?u=document.createElement("div"):(u=document.createElement("img"),u.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),u.classList.add("popupTriggerArea"),u.addEventListener("dblclick",this._download.bind(this)),lt(this,at,u),!this.data.popupRef&&((i=this.data.titleObj)!=null&&i.str||(b=this.data.contentsObj)!=null&&b.str||this.data.richText)&&this._createPopup(),this.container.append(u),this.container}getElementsToTriggerPopup(){return s(this,at)}addHighlightArea(){this.container.classList.add("highlightArea")}_download(){var u;(u=this.downloadManager)==null||u.openOrDownloadData(this.container,this.content,this.filename)}}at=new WeakMap;class Dt{constructor({div:T,accessibilityManager:u,annotationCanvasMap:i,l10n:b,page:k,viewport:U}){W(this,Wt);W(this,Xt);W(this,kt,null);W(this,Lt,null);W(this,Ut,new Map);this.div=T,lt(this,kt,u),lt(this,Lt,i),this.l10n=b,this.page=k,this.viewport=U,this.zIndex=0;const{NullL10n:K}=et(32);this.l10n||(this.l10n=K)}async render(T){const{annotations:u}=T,i=this.div;(0,P.setLayerDimensions)(i,this.viewport);const b=new Map,k={data:null,layer:i,linkService:T.linkService,downloadManager:T.downloadManager,imageResourcesPath:T.imageResourcesPath||"",renderForms:T.renderForms!==!1,svgFactory:new P.DOMSVGFactory,annotationStorage:T.annotationStorage||new Z.AnnotationStorage,enableScripting:T.enableScripting===!0,hasJSActions:T.hasJSActions,fieldObjects:T.fieldObjects,parent:this,elements:null};for(const U of u){if(U.noHTML)continue;const K=U.annotationType===c.AnnotationType.POPUP;if(K){const $=b.get(U.id);if(!$)continue;k.elements=$}else{const{width:$,height:Ct}=M(U.rect);if($<=0||Ct<=0)continue}k.data=U;const gt=N.create(k);if(!gt.isRenderable)continue;if(!K&&U.popupRef){const $=b.get(U.popupRef);$?$.push(gt):b.set(U.popupRef,[gt])}gt.annotationEditorType>0&&s(this,Ut).set(gt.data.id,gt);const _t=gt.render();if(U.hidden&&(_t.style.visibility="hidden"),Array.isArray(_t))for(const $ of _t)Q(this,Wt,Xe).call(this,$,U.id);else Q(this,Wt,Xe).call(this,_t,U.id)}Q(this,Xt,Ve).call(this),await this.l10n.translate(i)}update({viewport:T}){const u=this.div;this.viewport=T,(0,P.setLayerDimensions)(u,{rotation:T.rotation}),Q(this,Xt,Ve).call(this),u.hidden=!1}getEditableAnnotations(){return Array.from(s(this,Ut).values())}getEditableAnnotation(T){return s(this,Ut).get(T)}}kt=new WeakMap,Lt=new WeakMap,Ut=new WeakMap,Wt=new WeakSet,Xe=function(T,u){var b;const i=T.firstChild||T;i.id=`${P.AnnotationPrefix}${u}`,this.div.append(T),(b=s(this,kt))==null||b.moveElementInDOM(this.div,T,i,!1)},Xt=new WeakSet,Ve=function(){if(!s(this,Lt))return;const T=this.div;for(const[u,i]of s(this,Lt)){const b=T.querySelector(`[data-annotation-id="${u}"]`);if(!b)continue;const{firstChild:k}=b;k?k.nodeName==="CANVAS"?k.replaceWith(i):k.before(i):b.append(i)}s(this,Lt).clear()},h.AnnotationLayer=Dt},(pt,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.ColorConverters=void 0;function et(P){return Math.floor(Math.max(0,Math.min(1,P))*255).toString(16).padStart(2,"0")}class c{static CMYK_G([Z,V,ot,tt]){return["G",1-Math.min(1,.3*Z+.59*ot+.11*V+tt)]}static G_CMYK([Z]){return["CMYK",0,0,0,1-Z]}static G_RGB([Z]){return["RGB",Z,Z,Z]}static G_HTML([Z]){const V=et(Z);return`#${V}${V}${V}`}static RGB_G([Z,V,ot]){return["G",.3*Z+.59*V+.11*ot]}static RGB_HTML([Z,V,ot]){const tt=et(Z),x=et(V),f=et(ot);return`#${tt}${x}${f}`}static T_HTML(){return"#00000000"}static CMYK_RGB([Z,V,ot,tt]){return["RGB",1-Math.min(1,Z+tt),1-Math.min(1,ot+tt),1-Math.min(1,V+tt)]}static CMYK_HTML(Z){const V=this.CMYK_RGB(Z).slice(1);return this.RGB_HTML(V)}static RGB_CMYK([Z,V,ot]){const tt=1-Z,x=1-V,f=1-ot,M=Math.min(tt,x,f);return["CMYK",tt,x,f,M]}}h.ColorConverters=c},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.XfaLayer=void 0;var c=et(19);class P{static setupStorage(V,ot,tt,x,f){const M=x.getValue(ot,{value:null});switch(tt.name){case"textarea":if(M.value!==null&&(V.textContent=M.value),f==="print")break;V.addEventListener("input",N=>{x.setValue(ot,{value:N.target.value})});break;case"input":if(tt.attributes.type==="radio"||tt.attributes.type==="checkbox"){if(M.value===tt.attributes.xfaOn?V.setAttribute("checked",!0):M.value===tt.attributes.xfaOff&&V.removeAttribute("checked"),f==="print")break;V.addEventListener("change",N=>{x.setValue(ot,{value:N.target.checked?N.target.getAttribute("xfaOn"):N.target.getAttribute("xfaOff")})})}else{if(M.value!==null&&V.setAttribute("value",M.value),f==="print")break;V.addEventListener("input",N=>{x.setValue(ot,{value:N.target.value})})}break;case"select":if(M.value!==null)for(const N of tt.children)N.attributes.value===M.value&&(N.attributes.selected=!0);V.addEventListener("input",N=>{const y=N.target.options,D=y.selectedIndex===-1?"":y[y.selectedIndex].value;x.setValue(ot,{value:D})});break}}static setAttributes({html:V,element:ot,storage:tt=null,intent:x,linkService:f}){const{attributes:M}=ot,N=V instanceof HTMLAnchorElement;M.type==="radio"&&(M.name=`${M.name}-${x}`);for(const[y,D]of Object.entries(M))if(D!=null)switch(y){case"class":D.length&&V.setAttribute(y,D.join(" "));break;case"dataId":break;case"id":V.setAttribute("data-element-id",D);break;case"style":Object.assign(V.style,D);break;case"textContent":V.textContent=D;break;default:(!N||y!=="href"&&y!=="newWindow")&&V.setAttribute(y,D)}N&&f.addLinkAttributes(V,M.href,M.newWindow),tt&&M.dataId&&this.setupStorage(V,M.dataId,ot,tt)}static render(V){var r;const ot=V.annotationStorage,tt=V.linkService,x=V.xfaHtml,f=V.intent||"display",M=document.createElement(x.name);x.attributes&&this.setAttributes({html:M,element:x,intent:f,linkService:tt});const N=[[x,-1,M]],y=V.div;if(y.append(M),V.viewport){const g=`matrix(${V.viewport.transform.join(",")})`;y.style.transform=g}f!=="richText"&&y.setAttribute("class","xfaLayer xfaFont");const D=[];for(;N.length>0;){const[g,A,S]=N.at(-1);if(A+1===g.children.length){N.pop();continue}const m=g.children[++N.at(-1)[1]];if(m===null)continue;const{name:d}=m;if(d==="#text"){const n=document.createTextNode(m.value);D.push(n),S.append(n);continue}let E;if((r=m==null?void 0:m.attributes)!=null&&r.xmlns?E=document.createElementNS(m.attributes.xmlns,d):E=document.createElement(d),S.append(E),m.attributes&&this.setAttributes({html:E,element:m,storage:ot,intent:f,linkService:tt}),m.children&&m.children.length>0)N.push([m,-1,E]);else if(m.value){const n=document.createTextNode(m.value);c.XfaText.shouldBuildText(d)&&D.push(n),E.append(n)}}for(const g of y.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:D}}static update(V){const ot=`matrix(${V.viewport.transform.join(",")})`;V.div.style.transform=ot,V.div.hidden=!1}}h.XfaLayer=P},(pt,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.NullL10n=void 0,h.getL10nFallback=c;const et={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image"};et.print_progress_percent="{{progress}}%";function c(V,ot){switch(V){case"find_match_count":V=`find_match_count[${ot.total===1?"one":"other"}]`;break;case"find_match_count_limit":V=`find_match_count_limit[${ot.limit===1?"one":"other"}]`;break}return et[V]||""}function P(V,ot){return ot?V.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(tt,x)=>x in ot?ot[x]:"{{"+x+"}}"):V}const Z={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(V,ot=null,tt=c(V,ot)){return P(tt,ot)},async translate(V){}};h.NullL10n=Z},(pt,h,et)=>{var x,f,M,N,y,D,r,g,A,S,m,d,E,n,t,e,l,_s,F,As,X,ys,G,vs,ht,$e,st,Ss,vt,Ye,Dt,Es,o,Cs,_,Ts,I,ws,H,Ps,nt,ee,ct,Ke,Et,Se,xt,Ee,Tt,ae,J,Je,ut,Ce,wt,xs,Nt,Qe,Ft,ks,C,Fs,at,Ze,Lt,Te,Wt,oe,Xt,ts;Object.defineProperty(h,"__esModule",{value:!0}),h.InkEditor=void 0;var c=et(1),P=et(4),Z=et(29),V=et(5);const ot=16,Mt=class Mt extends P.AnnotationEditor{constructor(i){super({...i,name:"inkEditor"});W(this,l);W(this,F);W(this,X);W(this,G);W(this,ht);W(this,st);W(this,vt);W(this,Dt);W(this,o);W(this,_);W(this,I);W(this,H);W(this,nt);W(this,ct);W(this,Et);W(this,xt);W(this,Tt);W(this,J);W(this,ut);W(this,C);W(this,at);W(this,Lt);W(this,Wt);W(this,Xt);W(this,x,0);W(this,f,0);W(this,M,0);W(this,N,this.canvasContextMenu.bind(this));W(this,y,this.canvasPointermove.bind(this));W(this,D,this.canvasPointerleave.bind(this));W(this,r,this.canvasPointerup.bind(this));W(this,g,this.canvasPointerdown.bind(this));W(this,A,new Path2D);W(this,S,!1);W(this,m,!1);W(this,d,!1);W(this,E,null);W(this,n,0);W(this,t,0);W(this,e,null);this.color=i.color||null,this.thickness=i.thickness||null,this.opacity=i.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(i){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(b=>[b,i.get(b)]))}static updateDefaultParams(i,b){switch(i){case c.AnnotationEditorParamsType.INK_THICKNESS:Mt._defaultThickness=b;break;case c.AnnotationEditorParamsType.INK_COLOR:Mt._defaultColor=b;break;case c.AnnotationEditorParamsType.INK_OPACITY:Mt._defaultOpacity=b/100;break}}updateParams(i,b){switch(i){case c.AnnotationEditorParamsType.INK_THICKNESS:Q(this,l,_s).call(this,b);break;case c.AnnotationEditorParamsType.INK_COLOR:Q(this,F,As).call(this,b);break;case c.AnnotationEditorParamsType.INK_OPACITY:Q(this,X,ys).call(this,b);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.INK_THICKNESS,Mt._defaultThickness],[c.AnnotationEditorParamsType.INK_COLOR,Mt._defaultColor||P.AnnotationEditor._defaultLineColor],[c.AnnotationEditorParamsType.INK_OPACITY,Math.round(Mt._defaultOpacity*100)]]}get propertiesToUpdate(){var i;return[[c.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Mt._defaultThickness],[c.AnnotationEditorParamsType.INK_COLOR,this.color||Mt._defaultColor||P.AnnotationEditor._defaultLineColor],[c.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((i=this.opacity)!=null?i:Mt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(Q(this,Et,Se).call(this),Q(this,xt,Ee).call(this)),this.isAttachedToDOM||(this.parent.add(this),Q(this,Tt,ae).call(this)),Q(this,Wt,oe).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,s(this,E).disconnect(),lt(this,E,null),super.remove())}setParent(i){!this.parent&&i?this._uiManager.removeShouldRescale(this):this.parent&&i===null&&this._uiManager.addShouldRescale(this),super.setParent(i)}onScaleChanging(){const[i,b]=this.parentDimensions,k=this.width*i,U=this.height*b;this.setDimensions(k,U)}enableEditMode(){s(this,S)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",s(this,g)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",s(this,g)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){s(this,S)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),lt(this,S,!0),this.div.classList.add("disabled"),Q(this,Wt,oe).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(i){super.focusin(i),this.enableEditMode()}canvasPointerdown(i){i.button!==0||!this.isInEditMode()||s(this,S)||(this.setInForeground(),i.preventDefault(),i.type!=="mouse"&&this.div.focus(),Q(this,st,Ss).call(this,i.offsetX,i.offsetY))}canvasContextMenu(i){i.preventDefault()}canvasPointermove(i){i.preventDefault(),Q(this,vt,Ye).call(this,i.offsetX,i.offsetY)}canvasPointerup(i){i.preventDefault(),Q(this,ct,Ke).call(this,i)}canvasPointerleave(i){Q(this,ct,Ke).call(this,i)}render(){if(this.div)return this.div;let i,b;this.width&&(i=this.x,b=this.y),super.render(),Mt._l10nPromise.get("editor_ink2_aria_label").then(_t=>{var $;return($=this.div)==null?void 0:$.setAttribute("aria-label",_t)});const[k,U,K,gt]=Q(this,G,vs).call(this);if(this.setAt(k,U,0,0),this.setDims(K,gt),Q(this,Et,Se).call(this),this.width){const[_t,$]=this.parentDimensions;this.setAt(i*_t,b*$,this.width*_t,this.height*$),lt(this,d,!0),Q(this,Tt,ae).call(this),this.setDims(this.width*_t,this.height*$),Q(this,nt,ee).call(this),Q(this,Xt,ts).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Q(this,xt,Ee).call(this),this.div}setDimensions(i,b){const k=Math.round(i),U=Math.round(b);if(s(this,n)===k&&s(this,t)===U)return;lt(this,n,k),lt(this,t,U),this.canvas.style.visibility="hidden",s(this,x)&&Math.abs(s(this,x)-i/b)>.01&&(b=Math.ceil(i/s(this,x)),this.setDims(i,b));const[K,gt]=this.parentDimensions;this.width=i/K,this.height=b/gt,s(this,S)&&Q(this,J,Je).call(this,i,b),Q(this,Tt,ae).call(this),Q(this,nt,ee).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(i,b,k){var Gt,zt,qt;if(i instanceof Z.InkAnnotationElement)return null;const U=super.deserialize(i,b,k);U.thickness=i.thickness,U.color=c.Util.makeHexColor(...i.color),U.opacity=i.opacity;const[K,gt]=U.pageDimensions,_t=U.width*K,$=U.height*gt,Ct=U.parentScale,At=i.thickness/2;lt(U,x,_t/$),lt(U,S,!0),lt(U,n,Math.round(_t)),lt(U,t,Math.round($));const{paths:Pt,rect:Ot,rotation:Bt}=i;for(let{bezier:Vt}of Pt){Vt=Q(Gt=Mt,Ft,ks).call(Gt,Vt,Ot,Bt);const Kt=[];U.paths.push(Kt);let Zt=Ct*(Vt[0]-At),le=Ct*(Vt[1]-At);for(let te=2,we=Vt.length;te<we;te+=6){const Pe=Ct*(Vt[te]-At),ge=Ct*(Vt[te+1]-At),me=Ct*(Vt[te+2]-At),Rs=Ct*(Vt[te+3]-At),es=Ct*(Vt[te+4]-At),ss=Ct*(Vt[te+5]-At);Kt.push([[Zt,le],[Pe,ge],[me,Rs],[es,ss]]),Zt=es,le=ss}const pe=Q(this,wt,xs).call(this,Kt);U.bezierPath2D.push(pe)}const Ht=Q(zt=U,at,Ze).call(zt);return lt(U,M,Math.max(ot,Ht[2]-Ht[0])),lt(U,f,Math.max(ot,Ht[3]-Ht[1])),Q(qt=U,J,Je).call(qt,_t,$),U}serialize(){if(this.isEmpty())return null;const i=this.getRect(0,0),b=P.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:c.AnnotationEditorType.INK,color:b,thickness:this.thickness,opacity:this.opacity,paths:Q(this,C,Fs).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,i),pageIndex:this.pageIndex,rect:i,rotation:this.rotation}}};x=new WeakMap,f=new WeakMap,M=new WeakMap,N=new WeakMap,y=new WeakMap,D=new WeakMap,r=new WeakMap,g=new WeakMap,A=new WeakMap,S=new WeakMap,m=new WeakMap,d=new WeakMap,E=new WeakMap,n=new WeakMap,t=new WeakMap,e=new WeakMap,l=new WeakSet,_s=function(i){const b=this.thickness;this.addCommands({cmd:()=>{this.thickness=i,Q(this,Wt,oe).call(this)},undo:()=>{this.thickness=b,Q(this,Wt,oe).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},F=new WeakSet,As=function(i){const b=this.color;this.addCommands({cmd:()=>{this.color=i,Q(this,nt,ee).call(this)},undo:()=>{this.color=b,Q(this,nt,ee).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},X=new WeakSet,ys=function(i){i/=100;const b=this.opacity;this.addCommands({cmd:()=>{this.opacity=i,Q(this,nt,ee).call(this)},undo:()=>{this.opacity=b,Q(this,nt,ee).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},G=new WeakSet,vs=function(){const{parentRotation:i,parentDimensions:[b,k]}=this;switch(i){case 90:return[0,k,k,b];case 180:return[b,k,b,k];case 270:return[b,0,k,b];default:return[0,0,b,k]}},ht=new WeakSet,$e=function(){const{ctx:i,color:b,opacity:k,thickness:U,parentScale:K,scaleFactor:gt}=this;i.lineWidth=U*K/gt,i.lineCap="round",i.lineJoin="round",i.miterLimit=10,i.strokeStyle=`${b}${(0,V.opacityToHex)(k)}`},st=new WeakSet,Ss=function(i,b){var k;this.canvas.addEventListener("contextmenu",s(this,N)),this.canvas.addEventListener("pointerleave",s(this,D)),this.canvas.addEventListener("pointermove",s(this,y)),this.canvas.addEventListener("pointerup",s(this,r)),this.canvas.removeEventListener("pointerdown",s(this,g)),this.isEditing=!0,s(this,d)||(lt(this,d,!0),Q(this,Tt,ae).call(this),this.thickness||(this.thickness=Mt._defaultThickness),this.color||(this.color=Mt._defaultColor||P.AnnotationEditor._defaultLineColor),(k=this.opacity)!=null||(this.opacity=Mt._defaultOpacity)),this.currentPath.push([i,b]),lt(this,m,!1),Q(this,ht,$e).call(this),lt(this,e,()=>{Q(this,_,Ts).call(this),s(this,e)&&window.requestAnimationFrame(s(this,e))}),window.requestAnimationFrame(s(this,e))},vt=new WeakSet,Ye=function(i,b){const[k,U]=this.currentPath.at(-1);if(this.currentPath.length>1&&i===k&&b===U)return;const K=this.currentPath;let gt=s(this,A);if(K.push([i,b]),lt(this,m,!0),K.length<=2){gt.moveTo(...K[0]),gt.lineTo(i,b);return}K.length===3&&(lt(this,A,gt=new Path2D),gt.moveTo(...K[0])),Q(this,I,ws).call(this,gt,...K.at(-3),...K.at(-2),i,b)},Dt=new WeakSet,Es=function(){if(this.currentPath.length===0)return;const i=this.currentPath.at(-1);s(this,A).lineTo(...i)},o=new WeakSet,Cs=function(i,b){lt(this,e,null),i=Math.min(Math.max(i,0),this.canvas.width),b=Math.min(Math.max(b,0),this.canvas.height),Q(this,vt,Ye).call(this,i,b),Q(this,Dt,Es).call(this);let k;if(this.currentPath.length!==1)k=Q(this,H,Ps).call(this);else{const $=[i,b];k=[[$,$.slice(),$.slice(),$]]}const U=s(this,A),K=this.currentPath;this.currentPath=[],lt(this,A,new Path2D);const gt=()=>{this.allRawPaths.push(K),this.paths.push(k),this.bezierPath2D.push(U),this.rebuild()},_t=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Q(this,Et,Se).call(this),Q(this,xt,Ee).call(this)),Q(this,Wt,oe).call(this))};this.addCommands({cmd:gt,undo:_t,mustExec:!0})},_=new WeakSet,Ts=function(){if(!s(this,m))return;lt(this,m,!1);const i=Math.ceil(this.thickness*this.parentScale),b=this.currentPath.slice(-3),k=b.map(gt=>gt[0]),U=b.map(gt=>gt[1]);Math.min(...k)-i,Math.max(...k)+i,Math.min(...U)-i,Math.max(...U)+i;const{ctx:K}=this;K.save(),K.clearRect(0,0,this.canvas.width,this.canvas.height);for(const gt of this.bezierPath2D)K.stroke(gt);K.stroke(s(this,A)),K.restore()},I=new WeakSet,ws=function(i,b,k,U,K,gt,_t){const $=(b+U)/2,Ct=(k+K)/2,At=(U+gt)/2,Pt=(K+_t)/2;i.bezierCurveTo($+2*(U-$)/3,Ct+2*(K-Ct)/3,At+2*(U-At)/3,Pt+2*(K-Pt)/3,At,Pt)},H=new WeakSet,Ps=function(){const i=this.currentPath;if(i.length<=2)return[[i[0],i[0],i.at(-1),i.at(-1)]];const b=[];let k,[U,K]=i[0];for(k=1;k<i.length-2;k++){const[Ot,Bt]=i[k],[Ht,Gt]=i[k+1],zt=(Ot+Ht)/2,qt=(Bt+Gt)/2,Vt=[U+2*(Ot-U)/3,K+2*(Bt-K)/3],Kt=[zt+2*(Ot-zt)/3,qt+2*(Bt-qt)/3];b.push([[U,K],Vt,Kt,[zt,qt]]),[U,K]=[zt,qt]}const[gt,_t]=i[k],[$,Ct]=i[k+1],At=[U+2*(gt-U)/3,K+2*(_t-K)/3],Pt=[$+2*(gt-$)/3,Ct+2*(_t-Ct)/3];return b.push([[U,K],At,Pt,[$,Ct]]),b},nt=new WeakSet,ee=function(){if(this.isEmpty()){Q(this,ut,Ce).call(this);return}Q(this,ht,$e).call(this);const{canvas:i,ctx:b}=this;b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,i.width,i.height),Q(this,ut,Ce).call(this);for(const k of this.bezierPath2D)b.stroke(k)},ct=new WeakSet,Ke=function(i){this.canvas.removeEventListener("pointerleave",s(this,D)),this.canvas.removeEventListener("pointermove",s(this,y)),this.canvas.removeEventListener("pointerup",s(this,r)),this.canvas.addEventListener("pointerdown",s(this,g)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",s(this,N))},10),Q(this,o,Cs).call(this,i.offsetX,i.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Et=new WeakSet,Se=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Mt._l10nPromise.get("editor_ink_canvas_aria_label").then(i=>{var b;return(b=this.canvas)==null?void 0:b.setAttribute("aria-label",i)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},xt=new WeakSet,Ee=function(){lt(this,E,new ResizeObserver(i=>{const b=i[0].contentRect;b.width&&b.height&&this.setDimensions(b.width,b.height)})),s(this,E).observe(this.div)},Tt=new WeakSet,ae=function(){if(!s(this,d))return;const[i,b]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*i),this.canvas.height=Math.ceil(this.height*b),Q(this,ut,Ce).call(this)},J=new WeakSet,Je=function(i,b){const k=Q(this,Lt,Te).call(this),U=(i-k)/s(this,M),K=(b-k)/s(this,f);this.scaleFactor=Math.min(U,K)},ut=new WeakSet,Ce=function(){const i=Q(this,Lt,Te).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+i,this.translationY*this.scaleFactor+i)},wt=new WeakSet,xs=function(i){const b=new Path2D;for(let k=0,U=i.length;k<U;k++){const[K,gt,_t,$]=i[k];k===0&&b.moveTo(...K),b.bezierCurveTo(gt[0],gt[1],_t[0],_t[1],$[0],$[1])}return b},Nt=new WeakSet,Qe=function(i,b,k){const[U,K,gt,_t]=b;switch(k){case 0:for(let $=0,Ct=i.length;$<Ct;$+=2)i[$]+=U,i[$+1]=_t-i[$+1];break;case 90:for(let $=0,Ct=i.length;$<Ct;$+=2){const At=i[$];i[$]=i[$+1]+U,i[$+1]=At+K}break;case 180:for(let $=0,Ct=i.length;$<Ct;$+=2)i[$]=gt-i[$],i[$+1]+=K;break;case 270:for(let $=0,Ct=i.length;$<Ct;$+=2){const At=i[$];i[$]=gt-i[$+1],i[$+1]=_t-At}break;default:throw new Error("Invalid rotation")}return i},Ft=new WeakSet,ks=function(i,b,k){const[U,K,gt,_t]=b;switch(k){case 0:for(let $=0,Ct=i.length;$<Ct;$+=2)i[$]-=U,i[$+1]=_t-i[$+1];break;case 90:for(let $=0,Ct=i.length;$<Ct;$+=2){const At=i[$];i[$]=i[$+1]-K,i[$+1]=At-U}break;case 180:for(let $=0,Ct=i.length;$<Ct;$+=2)i[$]=gt-i[$],i[$+1]-=K;break;case 270:for(let $=0,Ct=i.length;$<Ct;$+=2){const At=i[$];i[$]=_t-i[$+1],i[$+1]=gt-At}break;default:throw new Error("Invalid rotation")}return i},C=new WeakSet,Fs=function(i,b,k,U){var Ct,At;const K=[],gt=this.thickness/2,_t=i*b+gt,$=i*k+gt;for(const Pt of this.paths){const Ot=[],Bt=[];for(let Ht=0,Gt=Pt.length;Ht<Gt;Ht++){const[zt,qt,Vt,Kt]=Pt[Ht],Zt=i*zt[0]+_t,le=i*zt[1]+$,pe=i*qt[0]+_t,te=i*qt[1]+$,we=i*Vt[0]+_t,Pe=i*Vt[1]+$,ge=i*Kt[0]+_t,me=i*Kt[1]+$;Ht===0&&(Ot.push(Zt,le),Bt.push(Zt,le)),Ot.push(pe,te,we,Pe,ge,me),Bt.push(pe,te),Ht===Gt-1&&Bt.push(ge,me)}K.push({bezier:Q(Ct=Mt,Nt,Qe).call(Ct,Ot,U,this.rotation),points:Q(At=Mt,Nt,Qe).call(At,Bt,U,this.rotation)})}return K},at=new WeakSet,Ze=function(){let i=1/0,b=-1/0,k=1/0,U=-1/0;for(const K of this.paths)for(const[gt,_t,$,Ct]of K){const At=c.Util.bezierBoundingBox(...gt,..._t,...$,...Ct);i=Math.min(i,At[0]),k=Math.min(k,At[1]),b=Math.max(b,At[2]),U=Math.max(U,At[3])}return[i,k,b,U]},Lt=new WeakSet,Te=function(){return s(this,S)?Math.ceil(this.thickness*this.parentScale):0},Wt=new WeakSet,oe=function(i=!1){if(this.isEmpty())return;if(!s(this,S)){Q(this,nt,ee).call(this);return}const b=Q(this,at,Ze).call(this),k=Q(this,Lt,Te).call(this);lt(this,M,Math.max(ot,b[2]-b[0])),lt(this,f,Math.max(ot,b[3]-b[1]));const U=Math.ceil(k+s(this,M)*this.scaleFactor),K=Math.ceil(k+s(this,f)*this.scaleFactor),[gt,_t]=this.parentDimensions;this.width=U/gt,this.height=K/_t,lt(this,x,U/K),Q(this,Xt,ts).call(this);const $=this.translationX,Ct=this.translationY;this.translationX=-b[0],this.translationY=-b[1],Q(this,Tt,ae).call(this),Q(this,nt,ee).call(this),lt(this,n,U),lt(this,t,K),this.setDims(U,K);const At=i?k/this.scaleFactor/2:0;this.translate($-this.translationX-At,Ct-this.translationY-At)},Xt=new WeakSet,ts=function(){const{style:i}=this.div;s(this,x)>=1?(i.minHeight=`${ot}px`,i.minWidth=`${Math.round(s(this,x)*ot)}px`):(i.minWidth=`${ot}px`,i.minHeight=`${Math.round(ot/s(this,x))}px`)},W(Mt,wt),W(Mt,Nt),W(Mt,Ft),$t(Mt,"_defaultColor",null),$t(Mt,"_defaultOpacity",1),$t(Mt,"_defaultThickness",1),$t(Mt,"_l10nPromise"),$t(Mt,"_type","ink");let tt=Mt;h.InkEditor=tt},(pt,h,et)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.SVGGraphics=void 0;var c=et(6),P=et(1),Z=et(10);const V={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},ot="http://www.w3.org/XML/1998/namespace",tt="http://www.w3.org/1999/xlink",x=["butt","round","square"],f=["miter","round","bevel"],M=function(E,n="",t=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!t)return URL.createObjectURL(new Blob([E],{type:n}));const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let l=`data:${n};base64,`;for(let p=0,F=E.length;p<F;p+=3){const O=E[p]&255,X=E[p+1]&255,w=E[p+2]&255,G=O>>2,it=(O&3)<<4|X>>4,ht=p+1<F?(X&15)<<2|w>>6:64,q=p+2<F?w&63:64;l+=e[G]+e[it]+e[ht]+e[q]}return l},N=function(){const E=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,t=new Int32Array(256);for(let w=0;w<256;w++){let G=w;for(let it=0;it<8;it++)G&1?G=3988292384^G>>1&2147483647:G=G>>1&2147483647;t[w]=G}function e(w,G,it){let ht=-1;for(let q=G;q<it;q++){const st=(ht^w[q])&255,St=t[st];ht=ht>>>8^St}return ht^-1}function l(w,G,it,ht){let q=ht;const st=G.length;it[q]=st>>24&255,it[q+1]=st>>16&255,it[q+2]=st>>8&255,it[q+3]=st&255,q+=4,it[q]=w.charCodeAt(0)&255,it[q+1]=w.charCodeAt(1)&255,it[q+2]=w.charCodeAt(2)&255,it[q+3]=w.charCodeAt(3)&255,q+=4,it.set(G,q),q+=G.length;const St=e(it,ht+4,q);it[q]=St>>24&255,it[q+1]=St>>16&255,it[q+2]=St>>8&255,it[q+3]=St&255}function p(w,G,it){let ht=1,q=0;for(let st=G;st<it;++st)ht=(ht+(w[st]&255))%65521,q=(q+ht)%65521;return q<<16|ht}function F(w){if(!Z.isNodeJS)return O(w);try{let G;parseInt(process.versions.node)>=8?G=w:G=Buffer.from(w);const it=require$$0.deflateSync(G,{level:9});return it instanceof Uint8Array?it:new Uint8Array(it)}catch(G){(0,P.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+G)}return O(w)}function O(w){let G=w.length;const it=65535,ht=Math.ceil(G/it),q=new Uint8Array(2+G+ht*5+4);let st=0;q[st++]=120,q[st++]=156;let St=0;for(;G>it;)q[st++]=0,q[st++]=255,q[st++]=255,q[st++]=0,q[st++]=0,q.set(w.subarray(St,St+it),st),st+=it,St+=it,G-=it;q[st++]=1,q[st++]=G&255,q[st++]=G>>8&255,q[st++]=~G&65535&255,q[st++]=(~G&65535)>>8&255,q.set(w.subarray(St),st),st+=w.length-St;const vt=p(w,0,w.length);return q[st++]=vt>>24&255,q[st++]=vt>>16&255,q[st++]=vt>>8&255,q[st++]=vt&255,q}function X(w,G,it,ht){const q=w.width,st=w.height;let St,vt,yt;const Dt=w.data;switch(G){case P.ImageKind.GRAYSCALE_1BPP:vt=0,St=1,yt=q+7>>3;break;case P.ImageKind.RGB_24BPP:vt=2,St=8,yt=q*3;break;case P.ImageKind.RGBA_32BPP:vt=6,St=8,yt=q*4;break;default:throw new Error("invalid format")}const j=new Uint8Array((1+yt)*st);let o=0,a=0;for(let Y=0;Y<st;++Y)j[o++]=0,j.set(Dt.subarray(a,a+yt),o),a+=yt,o+=yt;if(G===P.ImageKind.GRAYSCALE_1BPP&&ht){o=0;for(let Y=0;Y<st;Y++){o++;for(let nt=0;nt<yt;nt++)j[o++]^=255}}const _=new Uint8Array([q>>24&255,q>>16&255,q>>8&255,q&255,st>>24&255,st>>16&255,st>>8&255,st&255,St,vt,0,0,0]),R=F(j),I=E.length+n*3+_.length+R.length,B=new Uint8Array(I);let H=0;return B.set(E,H),H+=E.length,l("IHDR",_,B,H),H+=n+_.length,l("IDATA",R,B,H),H+=n+R.length,l("IEND",new Uint8Array(0),B,H),M(B,"image/png",it)}return function(G,it,ht){const q=G.kind===void 0?P.ImageKind.GRAYSCALE_1BPP:G.kind;return X(G,q,it,ht)}}();class y{constructor(){this.fontSizeScale=1,this.fontWeight=V.fontWeight,this.fontSize=0,this.textMatrix=P.IDENTITY_MATRIX,this.fontMatrix=P.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=P.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=V.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(n,t){this.x=n,this.y=t}}function D(E){let n=[];const t=[];for(const e of E){if(e.fn==="save"){n.push({fnId:92,fn:"group",items:[]}),t.push(n),n=n.at(-1).items;continue}e.fn==="restore"?n=t.pop():n.push(e)}return n}function r(E){if(Number.isInteger(E))return E.toString();const n=E.toFixed(10);let t=n.length-1;if(n[t]!=="0")return n;do t--;while(n[t]==="0");return n.substring(0,n[t]==="."?t:t+1)}function g(E){if(E[4]===0&&E[5]===0){if(E[1]===0&&E[2]===0)return E[0]===1&&E[3]===1?"":`scale(${r(E[0])} ${r(E[3])})`;if(E[0]===E[3]&&E[1]===-E[2]){const n=Math.acos(E[0])*180/Math.PI;return`rotate(${r(n)})`}}else if(E[0]===1&&E[1]===0&&E[2]===0&&E[3]===1)return`translate(${r(E[4])} ${r(E[5])})`;return`matrix(${r(E[0])} ${r(E[1])} ${r(E[2])} ${r(E[3])} ${r(E[4])} ${r(E[5])})`}let A=0,S=0,m=0;class d{constructor(n,t,e=!1){(0,c.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new c.DOMSVGFactory,this.current=new y,this.transformMatrix=P.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=n,this.objs=t,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!e,this._operatorIdMapping=[];for(const l in P.OPS)this._operatorIdMapping[P.OPS[l]]=l}getObject(n,t=null){return typeof n=="string"?n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n):t}save(){this.transformStack.push(this.transformMatrix);const n=this.current;this.extraStack.push(n),this.current=n.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(n){this.save(),this.executeOpTree(n),this.restore()}loadDependencies(n){const t=n.fnArray,e=n.argsArray;for(let l=0,p=t.length;l<p;l++)if(t[l]===P.OPS.dependency)for(const F of e[l]){const O=F.startsWith("g_")?this.commonObjs:this.objs,X=new Promise(w=>{O.get(F,w)});this.current.dependencies.push(X)}return Promise.all(this.current.dependencies)}transform(n,t,e,l,p,F){const O=[n,t,e,l,p,F];this.transformMatrix=P.Util.transform(this.transformMatrix,O),this.tgrp=null}getSVG(n,t){this.viewport=t;const e=this._initialize(t);return this.loadDependencies(n).then(()=>(this.transformMatrix=P.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(n)),e))}convertOpList(n){const t=this._operatorIdMapping,e=n.argsArray,l=n.fnArray,p=[];for(let F=0,O=l.length;F<O;F++){const X=l[F];p.push({fnId:X,fn:t[X],args:e[F]})}return D(p)}executeOpTree(n){for(const t of n){const e=t.fn,l=t.fnId,p=t.args;switch(l|0){case P.OPS.beginText:this.beginText();break;case P.OPS.dependency:break;case P.OPS.setLeading:this.setLeading(p);break;case P.OPS.setLeadingMoveText:this.setLeadingMoveText(p[0],p[1]);break;case P.OPS.setFont:this.setFont(p);break;case P.OPS.showText:this.showText(p[0]);break;case P.OPS.showSpacedText:this.showText(p[0]);break;case P.OPS.endText:this.endText();break;case P.OPS.moveText:this.moveText(p[0],p[1]);break;case P.OPS.setCharSpacing:this.setCharSpacing(p[0]);break;case P.OPS.setWordSpacing:this.setWordSpacing(p[0]);break;case P.OPS.setHScale:this.setHScale(p[0]);break;case P.OPS.setTextMatrix:this.setTextMatrix(p[0],p[1],p[2],p[3],p[4],p[5]);break;case P.OPS.setTextRise:this.setTextRise(p[0]);break;case P.OPS.setTextRenderingMode:this.setTextRenderingMode(p[0]);break;case P.OPS.setLineWidth:this.setLineWidth(p[0]);break;case P.OPS.setLineJoin:this.setLineJoin(p[0]);break;case P.OPS.setLineCap:this.setLineCap(p[0]);break;case P.OPS.setMiterLimit:this.setMiterLimit(p[0]);break;case P.OPS.setFillRGBColor:this.setFillRGBColor(p[0],p[1],p[2]);break;case P.OPS.setStrokeRGBColor:this.setStrokeRGBColor(p[0],p[1],p[2]);break;case P.OPS.setStrokeColorN:this.setStrokeColorN(p);break;case P.OPS.setFillColorN:this.setFillColorN(p);break;case P.OPS.shadingFill:this.shadingFill(p[0]);break;case P.OPS.setDash:this.setDash(p[0],p[1]);break;case P.OPS.setRenderingIntent:this.setRenderingIntent(p[0]);break;case P.OPS.setFlatness:this.setFlatness(p[0]);break;case P.OPS.setGState:this.setGState(p[0]);break;case P.OPS.fill:this.fill();break;case P.OPS.eoFill:this.eoFill();break;case P.OPS.stroke:this.stroke();break;case P.OPS.fillStroke:this.fillStroke();break;case P.OPS.eoFillStroke:this.eoFillStroke();break;case P.OPS.clip:this.clip("nonzero");break;case P.OPS.eoClip:this.clip("evenodd");break;case P.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case P.OPS.paintImageXObject:this.paintImageXObject(p[0]);break;case P.OPS.paintInlineImageXObject:this.paintInlineImageXObject(p[0]);break;case P.OPS.paintImageMaskXObject:this.paintImageMaskXObject(p[0]);break;case P.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(p[0],p[1]);break;case P.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case P.OPS.closePath:this.closePath();break;case P.OPS.closeStroke:this.closeStroke();break;case P.OPS.closeFillStroke:this.closeFillStroke();break;case P.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case P.OPS.nextLine:this.nextLine();break;case P.OPS.transform:this.transform(p[0],p[1],p[2],p[3],p[4],p[5]);break;case P.OPS.constructPath:this.constructPath(p[0],p[1]);break;case P.OPS.endPath:this.endPath();break;case 92:this.group(t.items);break;default:(0,P.warn)(`Unimplemented operator ${e}`);break}}}setWordSpacing(n){this.current.wordSpacing=n}setCharSpacing(n){this.current.charSpacing=n}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(n,t,e,l,p,F){const O=this.current;O.textMatrix=O.lineMatrix=[n,t,e,l,p,F],O.textMatrixScale=Math.hypot(n,t),O.x=O.lineX=0,O.y=O.lineY=0,O.xcoords=[],O.ycoords=[],O.tspan=this.svgFactory.createElement("svg:tspan"),O.tspan.setAttributeNS(null,"font-family",O.fontFamily),O.tspan.setAttributeNS(null,"font-size",`${r(O.fontSize)}px`),O.tspan.setAttributeNS(null,"y",r(-O.y)),O.txtElement=this.svgFactory.createElement("svg:text"),O.txtElement.append(O.tspan)}beginText(){const n=this.current;n.x=n.lineX=0,n.y=n.lineY=0,n.textMatrix=P.IDENTITY_MATRIX,n.lineMatrix=P.IDENTITY_MATRIX,n.textMatrixScale=1,n.tspan=this.svgFactory.createElement("svg:tspan"),n.txtElement=this.svgFactory.createElement("svg:text"),n.txtgrp=this.svgFactory.createElement("svg:g"),n.xcoords=[],n.ycoords=[]}moveText(n,t){const e=this.current;e.x=e.lineX+=n,e.y=e.lineY+=t,e.xcoords=[],e.ycoords=[],e.tspan=this.svgFactory.createElement("svg:tspan"),e.tspan.setAttributeNS(null,"font-family",e.fontFamily),e.tspan.setAttributeNS(null,"font-size",`${r(e.fontSize)}px`),e.tspan.setAttributeNS(null,"y",r(-e.y))}showText(n){const t=this.current,e=t.font,l=t.fontSize;if(l===0)return;const p=t.fontSizeScale,F=t.charSpacing,O=t.wordSpacing,X=t.fontDirection,w=t.textHScale*X,G=e.vertical,it=G?1:-1,ht=e.defaultVMetrics,q=l*t.fontMatrix[0];let st=0;for(const yt of n){if(yt===null){st+=X*O;continue}else if(typeof yt=="number"){st+=it*yt*l/1e3;continue}const Dt=(yt.isSpace?O:0)+F,j=yt.fontChar;let o,a,_=yt.width;if(G){let I;const B=yt.vmetric||ht;I=yt.vmetric?B[1]:_*.5,I=-I*q;const H=B[2]*q;_=B?-B[0]:_,o=I/p,a=(st+H)/p}else o=st/p,a=0;(yt.isInFont||e.missingFile)&&(t.xcoords.push(t.x+o),G&&t.ycoords.push(-t.y+a),t.tspan.textContent+=j);let R;G?R=_*q-Dt*X:R=_*q+Dt*X,st+=R}t.tspan.setAttributeNS(null,"x",t.xcoords.map(r).join(" ")),G?t.tspan.setAttributeNS(null,"y",t.ycoords.map(r).join(" ")):t.tspan.setAttributeNS(null,"y",r(-t.y)),G?t.y-=st:t.x+=st*w,t.tspan.setAttributeNS(null,"font-family",t.fontFamily),t.tspan.setAttributeNS(null,"font-size",`${r(t.fontSize)}px`),t.fontStyle!==V.fontStyle&&t.tspan.setAttributeNS(null,"font-style",t.fontStyle),t.fontWeight!==V.fontWeight&&t.tspan.setAttributeNS(null,"font-weight",t.fontWeight);const St=t.textRenderingMode&P.TextRenderingMode.FILL_STROKE_MASK;if(St===P.TextRenderingMode.FILL||St===P.TextRenderingMode.FILL_STROKE?(t.fillColor!==V.fillColor&&t.tspan.setAttributeNS(null,"fill",t.fillColor),t.fillAlpha<1&&t.tspan.setAttributeNS(null,"fill-opacity",t.fillAlpha)):t.textRenderingMode===P.TextRenderingMode.ADD_TO_PATH?t.tspan.setAttributeNS(null,"fill","transparent"):t.tspan.setAttributeNS(null,"fill","none"),St===P.TextRenderingMode.STROKE||St===P.TextRenderingMode.FILL_STROKE){const yt=1/(t.textMatrixScale||1);this._setStrokeAttributes(t.tspan,yt)}let vt=t.textMatrix;t.textRise!==0&&(vt=vt.slice(),vt[5]+=t.textRise),t.txtElement.setAttributeNS(null,"transform",`${g(vt)} scale(${r(w)}, -1)`),t.txtElement.setAttributeNS(ot,"xml:space","preserve"),t.txtElement.append(t.tspan),t.txtgrp.append(t.txtElement),this._ensureTransformGroup().append(t.txtElement)}setLeadingMoveText(n,t){this.setLeading(-t),this.moveText(n,t)}addFontStyle(n){if(!n.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const t=M(n.data,n.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${n.loadedName}"; src: url(${t}); }
`}setFont(n){const t=this.current,e=this.commonObjs.get(n[0]);let l=n[1];t.font=e,this.embedFonts&&!e.missingFile&&!this.embeddedFonts[e.loadedName]&&(this.addFontStyle(e),this.embeddedFonts[e.loadedName]=e),t.fontMatrix=e.fontMatrix||P.FONT_IDENTITY_MATRIX;let p="normal";e.black?p="900":e.bold&&(p="bold");const F=e.italic?"italic":"normal";l<0?(l=-l,t.fontDirection=-1):t.fontDirection=1,t.fontSize=l,t.fontFamily=e.loadedName,t.fontWeight=p,t.fontStyle=F,t.tspan=this.svgFactory.createElement("svg:tspan"),t.tspan.setAttributeNS(null,"y",r(-t.y)),t.xcoords=[],t.ycoords=[]}endText(){var t;const n=this.current;n.textRenderingMode&P.TextRenderingMode.ADD_TO_PATH_FLAG&&((t=n.txtElement)!=null&&t.hasChildNodes())&&(n.element=n.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(n){n>0&&(this.current.lineWidth=n)}setLineCap(n){this.current.lineCap=x[n]}setLineJoin(n){this.current.lineJoin=f[n]}setMiterLimit(n){this.current.miterLimit=n}setStrokeAlpha(n){this.current.strokeAlpha=n}setStrokeRGBColor(n,t,e){this.current.strokeColor=P.Util.makeHexColor(n,t,e)}setFillAlpha(n){this.current.fillAlpha=n}setFillRGBColor(n,t,e){this.current.fillColor=P.Util.makeHexColor(n,t,e),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(n){this.current.strokeColor=this._makeColorN_Pattern(n)}setFillColorN(n){this.current.fillColor=this._makeColorN_Pattern(n)}shadingFill(n){const{width:t,height:e}=this.viewport,l=P.Util.inverseTransform(this.transformMatrix),[p,F,O,X]=P.Util.getAxialAlignedBoundingBox([0,0,t,e],l),w=this.svgFactory.createElement("svg:rect");w.setAttributeNS(null,"x",p),w.setAttributeNS(null,"y",F),w.setAttributeNS(null,"width",O-p),w.setAttributeNS(null,"height",X-F),w.setAttributeNS(null,"fill",this._makeShadingPattern(n)),this.current.fillAlpha<1&&w.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(w)}_makeColorN_Pattern(n){return n[0]==="TilingPattern"?this._makeTilingPattern(n):this._makeShadingPattern(n)}_makeTilingPattern(n){const t=n[1],e=n[2],l=n[3]||P.IDENTITY_MATRIX,[p,F,O,X]=n[4],w=n[5],G=n[6],it=n[7],ht=`shading${m++}`,[q,st,St,vt]=P.Util.normalizeRect([...P.Util.applyTransform([p,F],l),...P.Util.applyTransform([O,X],l)]),[yt,Dt]=P.Util.singularValueDecompose2dScale(l),j=w*yt,o=G*Dt,a=this.svgFactory.createElement("svg:pattern");a.setAttributeNS(null,"id",ht),a.setAttributeNS(null,"patternUnits","userSpaceOnUse"),a.setAttributeNS(null,"width",j),a.setAttributeNS(null,"height",o),a.setAttributeNS(null,"x",`${q}`),a.setAttributeNS(null,"y",`${st}`);const _=this.svg,R=this.transformMatrix,I=this.current.fillColor,B=this.current.strokeColor,H=this.svgFactory.create(St-q,vt-st);if(this.svg=H,this.transformMatrix=l,it===2){const Y=P.Util.makeHexColor(...t);this.current.fillColor=Y,this.current.strokeColor=Y}return this.executeOpTree(this.convertOpList(e)),this.svg=_,this.transformMatrix=R,this.current.fillColor=I,this.current.strokeColor=B,a.append(H.childNodes[0]),this.defs.append(a),`url(#${ht})`}_makeShadingPattern(n){switch(typeof n=="string"&&(n=this.objs.get(n)),n[0]){case"RadialAxial":const t=`shading${m++}`,e=n[3];let l;switch(n[1]){case"axial":const p=n[4],F=n[5];l=this.svgFactory.createElement("svg:linearGradient"),l.setAttributeNS(null,"id",t),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"x1",p[0]),l.setAttributeNS(null,"y1",p[1]),l.setAttributeNS(null,"x2",F[0]),l.setAttributeNS(null,"y2",F[1]);break;case"radial":const O=n[4],X=n[5],w=n[6],G=n[7];l=this.svgFactory.createElement("svg:radialGradient"),l.setAttributeNS(null,"id",t),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"cx",X[0]),l.setAttributeNS(null,"cy",X[1]),l.setAttributeNS(null,"r",G),l.setAttributeNS(null,"fx",O[0]),l.setAttributeNS(null,"fy",O[1]),l.setAttributeNS(null,"fr",w);break;default:throw new Error(`Unknown RadialAxial type: ${n[1]}`)}for(const p of e){const F=this.svgFactory.createElement("svg:stop");F.setAttributeNS(null,"offset",p[0]),F.setAttributeNS(null,"stop-color",p[1]),l.append(F)}return this.defs.append(l),`url(#${t})`;case"Mesh":return(0,P.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${n[0]}`)}}setDash(n,t){this.current.dashArray=n,this.current.dashPhase=t}constructPath(n,t){const e=this.current;let l=e.x,p=e.y,F=[],O=0;for(const X of n)switch(X|0){case P.OPS.rectangle:l=t[O++],p=t[O++];const w=t[O++],G=t[O++],it=l+w,ht=p+G;F.push("M",r(l),r(p),"L",r(it),r(p),"L",r(it),r(ht),"L",r(l),r(ht),"Z");break;case P.OPS.moveTo:l=t[O++],p=t[O++],F.push("M",r(l),r(p));break;case P.OPS.lineTo:l=t[O++],p=t[O++],F.push("L",r(l),r(p));break;case P.OPS.curveTo:l=t[O+4],p=t[O+5],F.push("C",r(t[O]),r(t[O+1]),r(t[O+2]),r(t[O+3]),r(l),r(p)),O+=6;break;case P.OPS.curveTo2:F.push("C",r(l),r(p),r(t[O]),r(t[O+1]),r(t[O+2]),r(t[O+3])),l=t[O+2],p=t[O+3],O+=4;break;case P.OPS.curveTo3:l=t[O+2],p=t[O+3],F.push("C",r(t[O]),r(t[O+1]),r(l),r(p),r(l),r(p)),O+=4;break;case P.OPS.closePath:F.push("Z");break}F=F.join(" "),e.path&&n.length>0&&n[0]!==P.OPS.rectangle&&n[0]!==P.OPS.moveTo?F=e.path.getAttributeNS(null,"d")+F:(e.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(e.path)),e.path.setAttributeNS(null,"d",F),e.path.setAttributeNS(null,"fill","none"),e.element=e.path,e.setCurrentPoint(l,p)}endPath(){const n=this.current;if(n.path=null,!this.pendingClip)return;if(!n.element){this.pendingClip=null;return}const t=`clippath${A++}`,e=this.svgFactory.createElement("svg:clipPath");e.setAttributeNS(null,"id",t),e.setAttributeNS(null,"transform",g(this.transformMatrix));const l=n.element.cloneNode(!0);if(this.pendingClip==="evenodd"?l.setAttributeNS(null,"clip-rule","evenodd"):l.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,e.append(l),this.defs.append(e),n.activeClipUrl){n.clipGroup=null;for(const p of this.extraStack)p.clipGroup=null;e.setAttributeNS(null,"clip-path",n.activeClipUrl)}n.activeClipUrl=`url(#${t})`,this.tgrp=null}clip(n){this.pendingClip=n}closePath(){const n=this.current;if(n.path){const t=`${n.path.getAttributeNS(null,"d")}Z`;n.path.setAttributeNS(null,"d",t)}}setLeading(n){this.current.leading=-n}setTextRise(n){this.current.textRise=n}setTextRenderingMode(n){this.current.textRenderingMode=n}setHScale(n){this.current.textHScale=n/100}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(const[t,e]of n)switch(t){case"LW":this.setLineWidth(e);break;case"LC":this.setLineCap(e);break;case"LJ":this.setLineJoin(e);break;case"ML":this.setMiterLimit(e);break;case"D":this.setDash(e[0],e[1]);break;case"RI":this.setRenderingIntent(e);break;case"FL":this.setFlatness(e);break;case"Font":this.setFont(e);break;case"CA":this.setStrokeAlpha(e);break;case"ca":this.setFillAlpha(e);break;default:(0,P.warn)(`Unimplemented graphic state operator ${t}`);break}}fill(){const n=this.current;n.element&&(n.element.setAttributeNS(null,"fill",n.fillColor),n.element.setAttributeNS(null,"fill-opacity",n.fillAlpha),this.endPath())}stroke(){const n=this.current;n.element&&(this._setStrokeAttributes(n.element),n.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(n,t=1){const e=this.current;let l=e.dashArray;t!==1&&l.length>0&&(l=l.map(function(p){return t*p})),n.setAttributeNS(null,"stroke",e.strokeColor),n.setAttributeNS(null,"stroke-opacity",e.strokeAlpha),n.setAttributeNS(null,"stroke-miterlimit",r(e.miterLimit)),n.setAttributeNS(null,"stroke-linecap",e.lineCap),n.setAttributeNS(null,"stroke-linejoin",e.lineJoin),n.setAttributeNS(null,"stroke-width",r(t*e.lineWidth)+"px"),n.setAttributeNS(null,"stroke-dasharray",l.map(r).join(" ")),n.setAttributeNS(null,"stroke-dashoffset",r(t*e.dashPhase)+"px")}eoFill(){var n;(n=this.current.element)==null||n.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var n;(n=this.current.element)==null||n.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const n=this.svgFactory.createElement("svg:rect");n.setAttributeNS(null,"x","0"),n.setAttributeNS(null,"y","0"),n.setAttributeNS(null,"width","1px"),n.setAttributeNS(null,"height","1px"),n.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(n)}paintImageXObject(n){const t=this.getObject(n);if(!t){(0,P.warn)(`Dependent image with object ID ${n} is not ready yet`);return}this.paintInlineImageXObject(t)}paintInlineImageXObject(n,t){const e=n.width,l=n.height,p=N(n,this.forceDataSchema,!!t),F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",r(e)),F.setAttributeNS(null,"height",r(l)),this.current.element=F,this.clip("nonzero");const O=this.svgFactory.createElement("svg:image");O.setAttributeNS(tt,"xlink:href",p),O.setAttributeNS(null,"x","0"),O.setAttributeNS(null,"y",r(-l)),O.setAttributeNS(null,"width",r(e)+"px"),O.setAttributeNS(null,"height",r(l)+"px"),O.setAttributeNS(null,"transform",`scale(${r(1/e)} ${r(-1/l)})`),t?t.append(O):this._ensureTransformGroup().append(O)}paintImageMaskXObject(n){const t=this.getObject(n.data,n);if(t.bitmap){(0,P.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const e=this.current,l=t.width,p=t.height,F=e.fillColor;e.maskId=`mask${S++}`;const O=this.svgFactory.createElement("svg:mask");O.setAttributeNS(null,"id",e.maskId);const X=this.svgFactory.createElement("svg:rect");X.setAttributeNS(null,"x","0"),X.setAttributeNS(null,"y","0"),X.setAttributeNS(null,"width",r(l)),X.setAttributeNS(null,"height",r(p)),X.setAttributeNS(null,"fill",F),X.setAttributeNS(null,"mask",`url(#${e.maskId})`),this.defs.append(O),this._ensureTransformGroup().append(X),this.paintInlineImageXObject(t,O)}paintFormXObjectBegin(n,t){if(Array.isArray(n)&&n.length===6&&this.transform(n[0],n[1],n[2],n[3],n[4],n[5]),t){const e=t[2]-t[0],l=t[3]-t[1],p=this.svgFactory.createElement("svg:rect");p.setAttributeNS(null,"x",t[0]),p.setAttributeNS(null,"y",t[1]),p.setAttributeNS(null,"width",r(e)),p.setAttributeNS(null,"height",r(l)),this.current.element=p,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(n){const t=this.svgFactory.create(n.width,n.height),e=this.svgFactory.createElement("svg:defs");t.append(e),this.defs=e;const l=this.svgFactory.createElement("svg:g");return l.setAttributeNS(null,"transform",g(n.transform)),t.append(l),this.svg=l,t}_ensureClipGroup(){if(!this.current.clipGroup){const n=this.svgFactory.createElement("svg:g");n.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(n),this.current.clipGroup=n}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",g(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}h.SVGGraphics=d}],__webpack_module_cache__={};function __w_pdfjs_require__(pt){var h=__webpack_module_cache__[pt];if(h!==void 0)return h.exports;var et=__webpack_module_cache__[pt]={exports:{}};return __webpack_modules__[pt](et,et.exports,__w_pdfjs_require__),et.exports}var __webpack_exports__={};return(()=>{var pt=__webpack_exports__;Object.defineProperty(pt,"__esModule",{value:!0}),Object.defineProperty(pt,"AbortException",{enumerable:!0,get:function(){return h.AbortException}}),Object.defineProperty(pt,"AnnotationEditorLayer",{enumerable:!0,get:function(){return Z.AnnotationEditorLayer}}),Object.defineProperty(pt,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return h.AnnotationEditorParamsType}}),Object.defineProperty(pt,"AnnotationEditorType",{enumerable:!0,get:function(){return h.AnnotationEditorType}}),Object.defineProperty(pt,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return V.AnnotationEditorUIManager}}),Object.defineProperty(pt,"AnnotationLayer",{enumerable:!0,get:function(){return ot.AnnotationLayer}}),Object.defineProperty(pt,"AnnotationMode",{enumerable:!0,get:function(){return h.AnnotationMode}}),Object.defineProperty(pt,"CMapCompressionType",{enumerable:!0,get:function(){return h.CMapCompressionType}}),Object.defineProperty(pt,"FeatureTest",{enumerable:!0,get:function(){return h.FeatureTest}}),Object.defineProperty(pt,"GlobalWorkerOptions",{enumerable:!0,get:function(){return tt.GlobalWorkerOptions}}),Object.defineProperty(pt,"ImageKind",{enumerable:!0,get:function(){return h.ImageKind}}),Object.defineProperty(pt,"InvalidPDFException",{enumerable:!0,get:function(){return h.InvalidPDFException}}),Object.defineProperty(pt,"MissingPDFException",{enumerable:!0,get:function(){return h.MissingPDFException}}),Object.defineProperty(pt,"OPS",{enumerable:!0,get:function(){return h.OPS}}),Object.defineProperty(pt,"PDFDataRangeTransport",{enumerable:!0,get:function(){return et.PDFDataRangeTransport}}),Object.defineProperty(pt,"PDFDateString",{enumerable:!0,get:function(){return c.PDFDateString}}),Object.defineProperty(pt,"PDFWorker",{enumerable:!0,get:function(){return et.PDFWorker}}),Object.defineProperty(pt,"PasswordResponses",{enumerable:!0,get:function(){return h.PasswordResponses}}),Object.defineProperty(pt,"PermissionFlag",{enumerable:!0,get:function(){return h.PermissionFlag}}),Object.defineProperty(pt,"PixelsPerInch",{enumerable:!0,get:function(){return c.PixelsPerInch}}),Object.defineProperty(pt,"PromiseCapability",{enumerable:!0,get:function(){return h.PromiseCapability}}),Object.defineProperty(pt,"RenderingCancelledException",{enumerable:!0,get:function(){return c.RenderingCancelledException}}),pt.SVGGraphics=void 0,Object.defineProperty(pt,"UnexpectedResponseException",{enumerable:!0,get:function(){return h.UnexpectedResponseException}}),Object.defineProperty(pt,"Util",{enumerable:!0,get:function(){return h.Util}}),Object.defineProperty(pt,"VerbosityLevel",{enumerable:!0,get:function(){return h.VerbosityLevel}}),Object.defineProperty(pt,"XfaLayer",{enumerable:!0,get:function(){return x.XfaLayer}}),Object.defineProperty(pt,"build",{enumerable:!0,get:function(){return et.build}}),Object.defineProperty(pt,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return h.createValidAbsoluteUrl}}),Object.defineProperty(pt,"getDocument",{enumerable:!0,get:function(){return et.getDocument}}),Object.defineProperty(pt,"getFilenameFromUrl",{enumerable:!0,get:function(){return c.getFilenameFromUrl}}),Object.defineProperty(pt,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return c.getPdfFilenameFromUrl}}),Object.defineProperty(pt,"getXfaPageViewport",{enumerable:!0,get:function(){return c.getXfaPageViewport}}),Object.defineProperty(pt,"isDataScheme",{enumerable:!0,get:function(){return c.isDataScheme}}),Object.defineProperty(pt,"isPdfFile",{enumerable:!0,get:function(){return c.isPdfFile}}),Object.defineProperty(pt,"loadScript",{enumerable:!0,get:function(){return c.loadScript}}),Object.defineProperty(pt,"normalizeUnicode",{enumerable:!0,get:function(){return h.normalizeUnicode}}),Object.defineProperty(pt,"renderTextLayer",{enumerable:!0,get:function(){return P.renderTextLayer}}),Object.defineProperty(pt,"setLayerDimensions",{enumerable:!0,get:function(){return c.setLayerDimensions}}),Object.defineProperty(pt,"shadow",{enumerable:!0,get:function(){return h.shadow}}),Object.defineProperty(pt,"updateTextLayer",{enumerable:!0,get:function(){return P.updateTextLayer}}),Object.defineProperty(pt,"version",{enumerable:!0,get:function(){return et.version}});var h=__w_pdfjs_require__(1),et=__w_pdfjs_require__(2),c=__w_pdfjs_require__(6),P=__w_pdfjs_require__(26),Z=__w_pdfjs_require__(27),V=__w_pdfjs_require__(5),ot=__w_pdfjs_require__(29),tt=__w_pdfjs_require__(14),x=__w_pdfjs_require__(31);const f=__w_pdfjs_require__(34).SVGGraphics;pt.SVGGraphics=f})(),__webpack_exports__})())})(pdf$2);var pdfExports=pdf$2.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdf$1=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);export{pdfExports as a,pdf$1 as p};
