import{_ as Z}from"./chunks/Button.vue_vue_type_script_setup_true_lang.EqSgP6OH.js";import"./chunks/Button.vue_vue_type_style_index_0_lang.w40geAFS.js";import{_ as j,o as E,c as f,k as d,d as J,V as G,h as b,g as O,j as K,a7 as ss,D as $,a8 as es,a5 as as,e as D,I as i,w as u,t as L,T as ts,b as U,r as is,n as ns,X as ls,m as q,R as y,a as w,a4 as Q}from"./chunks/framework.5W3OCrpp.js";import{u as rs}from"./chunks/index.uAbLSuRm.js";import{f as Y}from"./chunks/base64.6dLoFO2g.js";import{a as os,b as ds,c as hs}from"./chunks/index.vDTeR44h.js";import{a as X}from"./chunks/index.MmQDCL56.js";import{d as ps}from"./chunks/defu.sEzLH6yp.js";import{p as cs}from"./chunks/index.bhOh96es.js";import{u as ks}from"./chunks/index.vqmJczYN.js";import{p as us}from"./chunks/Banner.COOtr5dL.js";import"./chunks/index.hjpy5ZnQ.js";import"./chunks/SpinnerRinggo.fbIZkiat.js";import"./chunks/index.7xvmVwVd.js";import"./chunks/use-singleton.yYWIbiAX.js";import"./chunks/Input.QY1Ljkmg.js";import"./chunks/20.QtnYFWvP.js";import"./chunks/accept._rvVzN4h.js";import"./chunks/Input.vue_vue_type_style_index_0_lang.w40geAFS.js";import"./chunks/FormGroup.vue_vue_type_style_index_0_lang.GsRfqmNQ.js";import"./chunks/20.7Ywwt4rc.js";import"./chunks/Caption.lyGTd4HY.js";import"./chunks/Caption.vue_vue_type_style_index_0_lang.w40geAFS.js";import"./chunks/index.xrtdoFjR.js";import"./chunks/commonjsHelpers.4gQjN7DL.js";import"./chunks/vite-browser-external_commonjs-proxy.KqFAHE5p.js";import"./chunks/index.ZfSagMVW.js";import"./chunks/16.sG-bdMPB.js";import"./chunks/Banner.vue_vue_type_style_index_0_lang.w40geAFS.js";const Es={},ms={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",class:"persona-icon",viewBox:"0 0 16 16"},gs=d("path",{fill:"currentColor",d:"M5.743 2.44A6 6 0 0 1 14 7.935a.5.5 0 0 0 1-.01A7 7 0 0 0 2.722 3.401V1.5a.5.5 0 1 0-1 0v2.889a.5.5 0 0 0 .5.5h2.89a.5.5 0 1 0 0-1H3.63A6 6 0 0 1 5.743 2.44M9.945 13.676a6 6 0 0 1-7.944-5.755.5.5 0 0 0-1-.013 7 7 0 0 0 12.277 4.69V14.5a.5.5 0 1 0 1 0v-2.889a.5.5 0 0 0-.5-.5h-2.889a.5.5 0 0 0 0 1h1.482a6 6 0 0 1-2.426 1.565"},null,-1),_s=[gs];function ys(s,e){return E(),f("svg",ms,_s)}const vs=j(Es,[["render",ys]]),fs={},bs={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",class:"persona-icon",viewBox:"0 0 24 24"},As=d("path",{fill:"currentColor","fill-rule":"evenodd",d:"M12 9.171a3.852 3.852 0 0 0-3.846 3.858A3.852 3.852 0 0 0 12 16.886a3.852 3.852 0 0 0 3.846-3.857A3.852 3.852 0 0 0 12 9.17M9.692 13.03A2.311 2.311 0 0 1 12 10.714a2.311 2.311 0 0 1 2.308 2.315A2.311 2.311 0 0 1 12 15.343a2.311 2.311 0 0 1-2.308-2.314","clip-rule":"evenodd"},null,-1),Cs=d("path",{fill:"currentColor","fill-rule":"evenodd",d:"M10.798 3c-.748 0-1.465.298-1.994.829l-2.25 2.257h-.708A3.852 3.852 0 0 0 2 9.943v7.2A3.852 3.852 0 0 0 5.846 21h12.308A3.852 3.852 0 0 0 22 17.143v-7.2a3.852 3.852 0 0 0-3.846-3.857h-.707l-2.251-2.258A2.816 2.816 0 0 0 13.202 3zm-.906 1.92a1.28 1.28 0 0 1 .906-.377h2.404c.34 0 .666.135.906.376l2.476 2.484c.145.144.34.226.544.226h1.026a2.31 2.31 0 0 1 2.308 2.314v7.2a2.31 2.31 0 0 1-2.308 2.314H5.846a2.311 2.311 0 0 1-2.307-2.314v-7.2a2.311 2.311 0 0 1 2.307-2.314h1.026c.204 0 .4-.082.544-.226z","clip-rule":"evenodd"},null,-1),Ts=[As,Cs];function ws(s,e){return E(),f("svg",bs,Ts)}const Ps=j(fs,[["render",ws]]),Ss={},Fs={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",class:"persona-icon",viewBox:"0 0 24 24"},Ds=d("path",{fill:"currentColor",d:"M4.564 2.77a.77.77 0 0 0-1.538 0v4.102a.77.77 0 0 0 .769.769h4.102a.77.77 0 1 0 0-1.538H5.932a8.461 8.461 0 1 1-2.393 5.804.77.77 0 0 0-1.538-.017 10 10 0 1 0 2.563-6.576z"},null,-1),qs=[Ds];function xs(s,e){return E(),f("svg",Fs,qs)}const Is=j(Ss,[["render",xs]]),Bs="/design-system/assets/shutter.HZ1ql8DV.wav";function H(s,e=!1){const a=document.createElement("canvas"),r=a.getContext("2d");return a.width=s.videoWidth,a.height=s.videoHeight,e?(r.save(),r.scale(-1,1),r.drawImage(s,0,0,a.width*-1,a.height),r.restore()):r.drawImage(s,0,0,a.width,a.height),a.toDataURL("image/jpeg")}const Vs={meta:{facingMode:"environment"},run({video:s,meta:e,modifier:a}){const r=!!(e.value.mirror&&e.value.mirror!=="preview"),l=H(s.value,r),t=a.value.base64?l:Y(l);return{preview:l,result:t}}},Ms=J({components:{pButton:Z,IconCamera:Ps,IconRetake:Is,IconRotate:vs},directives:{pAspectRatio:cs},props:{modelValue:{type:[globalThis.File,String,Array],default:""},modelModifiers:{type:Object,default:()=>({})},mirror:{type:[Boolean,String],default:void 0},mask:{type:String,default:void 0},adapter:{type:Object,default:Vs},facingMode:{type:String,default:void 0},silent:{type:Boolean,default:!1}},models:{prop:"modelValue",event:"update:modelValue"},emits:["start","change","result","update:modelValue"],setup(s,{emit:e}){const a=rs(s),r=G(s,"modelModifiers"),l=b(!1),t=b(!1),o=b(""),h=b(""),n=b(),m=b(),g=os("camera",{controls:!0}),p=b(0),k=O(()=>ps({mirror:s.mirror,mask:s.mask,facingMode:s.facingMode},s.adapter.meta,{autoStart:!1})),{videoInputs:v}=ds({requestPermissions:!1,constraints:{video:{facingMode:k.value.facingMode}}}),P=O(()=>{var c,R;return(R=(c=v.value)==null?void 0:c.at(p.value))==null?void 0:R.deviceId}),T=O(()=>({video:{deviceId:P.value},audio:!1})),{stream:A,start:x,stop:I,enabled:B}=hs({constraints:T}),V=O(()=>{const c=[];return k.value.mirror&&c.push("camera--mirror"),k.value.mask?c.push(`camera__mask--${k.value.mask}`):c.push("camera__mask--none"),c});async function S(){var c;g.state.value==="denied"&&await X({title:"Camera Access Blocked",text:"Privy need to access your internal camera to process this journey",confirm:{text:"Ok"},footerAlign:"end"}),g.state.value==="prompt"&&await X({title:"Camera Access Required",text:"Privy need to access your internal camera to process this journey",confirm:{text:"Ok"},footerAlign:"end"}),await x(),typeof((c=m.value)==null?void 0:c.play)=="function"&&await m.value.play()}function N(){p.value=(p.value+1)%v.value.length}function M(c){h.value=c}async function F(){var R;l.value=!0;const c=await s.adapter.run({video:m,toast:M,stream:A,meta:k,modifier:r});o.value=c.preview,a.value=c.result,t.value=!0,l.value=!1,B.value=!1,e("result",c.result),e("change",c.result),typeof((R=n.value)==null?void 0:R.play)=="function"&&n.value.play()}async function z(){B.value=!0,t.value=!1,o.value="",h.value=""}function W(){e("start",A.value),k.value.autoStart&&F()}return K(async()=>{g.isSupported&&(await ks(g.state).not.toBeUndefined(),await S())}),ss(()=>{I()}),{ShutterWav:Bs,classNames:V,cameras:v,video:m,shutter:n,stream:A,toggle:N,isActive:B,isTaken:t,isProcessing:l,message:h,take:F,retake:z,preview:o,turnOn:S,onStart:W,toast:M,deviceId:P,constraints:T}}}),Rs=["data-deviceid"],$s=[".srcObject"],Ns=["src"],Os={key:2,"data-testid":"camera-off",class:"camera__off-info"},Us={class:"camera__mask-container"},Hs={key:0,"data-testid":"camera-mask",class:"camera__mask"},js={"data-testid":"camera-toast",class:"camera__toast-text"},Ls={class:"camera__controls"},Ys=["src","muted"];function Qs(s,e,a,r,l,t){const o=$("icon-rotate"),h=$("p-button"),n=$("icon-camera"),m=$("icon-retake"),g=es("p-aspect-ratio");return as((E(),f("div",{class:ns(["camera",s.classNames]),"data-testid":"camera","data-deviceid":s.deviceId},[s.stream?(E(),f("video",{key:0,ref:"video","data-testid":"camera-video",".srcObject":s.stream,class:"camera__video",autoplay:"",muted:"",playsinline:"",onPlay:e[0]||(e[0]=(...p)=>s.onStart&&s.onStart(...p))},null,40,$s)):D("",!0),s.isTaken&&!s.stream?(E(),f("img",{key:1,"data-testid":"camera-result",class:"camera__result",src:s.preview,alt:"camera-result"},null,8,Ns)):D("",!0),!s.isActive&&!s.isTaken?(E(),f("span",Os," Camera is off ")):D("",!0),d("div",Us,[s.isTaken?D("",!0):(E(),f("div",Hs))]),i(ts,{name:"slide-up"},{default:u(()=>[s.message?(E(),f("div",{key:s.message,class:"camera__toast"},[d("div",js,L(s.message),1)])):D("",!0)]),_:1}),d("div",Ls,[s.cameras.length>1&&!s.isTaken?(E(),U(h,{key:0,"data-testid":"camera-toggle",color:"danger",size:"sm",icon:"",pill:"",onClick:s.toggle},{default:u(()=>[i(o)]),_:1},8,["onClick"])):D("",!0),!s.isActive&&!s.isTaken?(E(),U(h,{key:1,"data-testid":"camera-turn-on",class:"camera__main-control",color:"danger",icon:"",pill:"",onClick:e[1]||(e[1]=p=>s.turnOn())},{default:u(()=>[i(n)]),_:1})):s.isActive&&!s.isTaken?(E(),U(h,{key:2,"data-testid":"camera-take",class:"camera__main-control",color:"danger",icon:"",pill:"",disabled:s.isProcessing,onClick:e[2]||(e[2]=p=>s.take())},{default:u(()=>[i(n)]),_:1},8,["disabled"])):(E(),U(h,{key:3,"data-testid":"camera-retake",class:"camera__main-control",color:"danger",icon:"",pill:"",onClick:e[3]||(e[3]=p=>s.retake())},{default:u(()=>[i(m)]),_:1}))]),d("audio",{ref:"shutter",src:s.ShutterWav,muted:s.silent},null,8,Ys),is(s.$slots,"default",{cameras:s.cameras,preview:s.preview,stream:s.stream,video:s.video,shutter:s.shutter,toast:s.toast})],10,Rs)),[[g,4/3,void 0,{fixed:!0}]])}const _=j(Ms,[["render",Qs]]),Xs=40,zs=15,C=160;function Ws(s,e){const a=s.getContext("2d",{willReadFrequently:!0});return a.drawImage(e,e.videoWidth/2-C,e.videoHeight/2-C,C,C,0,0,C,C),a.getImageData(0,0,s.width,s.height)}function Zs(s){const e=s.width/2,a=s.height/2,r=s.width/4,l=s.height/4,t=e-r/2,o=a-l/2,h=new Uint8ClampedArray(r*l),n={centerX:e,centerY:a,width:r,height:l,xPos:t,yPos:o,buffer:h},m=s.data;let g=0;for(let p=n.yPos;p<n.yPos+n.height;p++){let k=p*s.width*4+n.xPos*4+1;for(let v=n.xPos;v<n.xPos+n.width;v++)n.buffer[g++]=m[k],k+=4}return n}function Js(s,e){let a=0,r=0,l=0;const t=s.width/4,o=s.height/4,h=s.data;for(let T=e.centerY-o;T<=e.centerY+o-e.height;T++)for(let A=e.centerX-t;A<=e.centerX+t-e.width;A++){let x=0,I=0,B=0;for(let S=0;S<e.height;S++){let N=A*4+1+(T+S)*s.width*4;for(let M=0;M<e.width;M++){const F=h[N];x+=e.buffer[B++]*F,I+=F*F,N+=4}}let V=0;I>0&&(V=x*x/I),V>l&&(l=V,a=A,r=T)}const n=a-e.xPos,m=r-e.yPos,g=Math.hypot(n,m),p=t-e.width/2,k=o-e.height/2,v=Math.hypot(p,k);let P=g/v*100;return P>100&&(P=100),P}const Gs={meta:{mask:"round",mirror:!0,facingMode:"user"},async run({video:s,toast:e,meta:a,modifier:r}){return await new Promise(l=>{const t=!!(a.value.mirror&&a.value.mirror!=="preview"),o=H(s.value,t),h=document.createElement("canvas");h.width=C,h.height=C;let n;const m=setInterval(function(){if(s.value){const p=Ws(h,s.value);if(!n)n=Zs(p);else if(Js(p,n)>Xs){const k=H(s.value,t),v=r.value.base64?[k,o]:[Y(k),Y(o)];clearInterval(m),e(""),l({preview:k,result:v})}}},1e3/zs);e("Move your head slowly. Your photo will be taken automatically")})}},Ks={meta:{mask:"square",facingMode:"environment",autoStart:!0},async run({video:s,toast:e,meta:a}){const r=!!(a.value.mirror&&a.value.mirror!=="preview"),{BrowserQRCodeReader:l}=await ls(()=>import("./chunks/index.5ZgwmU29.js"),__vite__mapDeps([])),o=await new l().decodeOnceFromVideoElement(s.value),h=H(s.value,r),n=o.getText();return e(n),{preview:h,result:n}}},se=y("",4),ee=y("",3),ae=y("",3),te=y("",3),ie=y("",3),ne=y("",3),le=y("",3),re=y("",3),oe=y("",2),de={class:"truncate"},he=d("h3",{id:"encode-to-base64",tabindex:"-1"},[w("Encode to base64 "),d("a",{class:"header-anchor",href:"#encode-to-base64","aria-label":'Permalink to "Encode to base64"'},"​")],-1),pe=d("p",null,[w("You can add modifier "),d("code",null,"base64"),w(" to your "),d("code",null,"v-model"),w(", it's enforce result to "),d("a",{href:"https://en.wikipedia.org/wiki/Data_URI_scheme",target:"_blank",rel:"noreferrer"},"base64-dataURI"),w(".")],-1),ce=d("b",null,"Note!",-1),ke=d("code",null,"v-model.base64",-1),ue=y("",2),Ee={class:"truncate"},me=y("",7),Xe=JSON.parse(`{"title":"Camera · Components","description":"Take picture from user's camera","frontmatter":{"title":"Camera · Components","description":"Take picture from user's camera"},"headers":[],"relativePath":"components/camera/index.md","filePath":"components/camera/index.md"}`),ge={name:"components/camera/index.md"},ze=Object.assign(ge,{setup(s){const e=b(),a=b();return(r,l)=>{const t=$("preview");return E(),f("div",null,[se,i(t,{class:"flex-col"},{default:u(()=>[i(_)]),_:1}),ee,i(t,{class:"flex-col"},{default:u(()=>[i(_,{mirror:""})]),_:1}),ae,i(t,{class:"flex-col"},{default:u(()=>[i(_,{mirror:"preview"})]),_:1}),te,i(t,{class:"flex-col space-y-2"},{default:u(()=>[i(_,{mask:"square"}),i(_,{mask:"round"}),i(_,{mask:"card"})]),_:1}),ie,i(t,{class:"flex-col"},{default:u(()=>[i(_,{silent:""})]),_:1}),ne,i(t,{class:"flex-col space-y-2"},{default:u(()=>[i(_,{adapter:q(Gs)},null,8,["adapter"])]),_:1}),le,i(t,{class:"flex-col space-y-2"},{default:u(()=>[i(_,{adapter:q(Ks)},null,8,["adapter"])]),_:1}),re,i(t,{class:"flex-col"},{default:u(()=>[i(_,{modelValue:q(e),"onUpdate:modelValue":l[0]||(l[0]=o=>Q(e)?e.value=o:null)},null,8,["modelValue"])]),_:1}),oe,d("pre",de,[d("code",null,L(q(e)),1)]),he,pe,i(us,{dismissable:!1},{default:u(()=>[ce,w(),ke,w(" on QRCodeAdapter has no effect, the result will always original scanned text. ")]),_:1}),i(t,{class:"flex-col"},{default:u(()=>[i(_,{modelValue:q(a),"onUpdate:modelValue":l[1]||(l[1]=o=>Q(a)?a.value=o:null),modelModifiers:{base64:!0}},null,8,["modelValue"])]),_:1}),ue,d("pre",Ee,[d("code",null,L(q(a)),1)]),me])}}});export{Xe as __pageData,ze as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}