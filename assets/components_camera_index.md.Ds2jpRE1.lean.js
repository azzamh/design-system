import{_ as X,o as u,c as C,m as d,d as es,t as as,r as w,l as N,A as ts,a3 as is,ac as ns,p as a,h as I,K as l,w as c,f as Q,T as ls,g as O,a as rs,n as os,Z as ds,a9 as b,b as D,F as hs,aa as J}from"./chunks/framework.Ke_sWmBU.js";import{_ as U}from"./chunks/Button.vue_vue_type_script_setup_true_lang.Dot1FQgg.js";/* empty css                                                      */import{u as ps}from"./chunks/index.D9CApx7s.js";import{f as Y}from"./chunks/base64.CRVHLH2y.js";import{u as cs,a as ks,b as us}from"./chunks/index.CbnL-2pa.js";import{a as K}from"./chunks/index.DB1uRHdk.js";import{d as Es}from"./chunks/defu.CMw4_7D2.js";import{v as gs}from"./chunks/index.DtgqDGZE.js";import{u as ms}from"./chunks/index.CqD3toHj.js";import{_ as _s}from"./chunks/Banner.vue_vue_type_script_setup_true_lang.CoeXiL-n.js";/* empty css                                                      */import"./chunks/index.DvWHfs5K.js";import"./chunks/SpinnerRinggo.vue_vue_type_script_setup_true_lang.CbT9L0Vr.js";import"./chunks/use-singleton.ByB_QdE9.js";import"./chunks/queue.DLTVddtq.js";import"./chunks/Input.vue_vue_type_script_setup_true_lang.BvnyDapq.js";import"./chunks/20.CbZcV1rM.js";import"./chunks/accept.6g-OpsWF.js";/* empty css                                                     */import"./chunks/FormGroup.vue_vue_type_script_setup_true_lang.Bg2x2SYK.js";import"./chunks/20.CIfqJWd3.js";import"./chunks/Caption.vue_vue_type_script_setup_true_lang.CgZHdFor.js";/* empty css                                                       */import"./chunks/index.Ch_HVpsp.js";import"./chunks/purify.es.CRcNyHaS.js";import"./chunks/index.B0KwmiQP.js";/* empty css                                                         */import"./chunks/20.D2LeYss6.js";import"./chunks/16.DVvCa9Z_.js";const ys={},vs={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",class:"persona-icon",viewBox:"0 0 16 16"},fs=d("path",{fill:"currentColor",d:"M5.743 2.44A6 6 0 0 1 14 7.935a.5.5 0 0 0 1-.01A7 7 0 0 0 2.722 3.401V1.5a.5.5 0 1 0-1 0v2.889a.5.5 0 0 0 .5.5h2.89a.5.5 0 1 0 0-1H3.63A6 6 0 0 1 5.743 2.44M9.945 13.676a6 6 0 0 1-7.944-5.755.5.5 0 0 0-1-.013 7 7 0 0 0 12.277 4.69V14.5a.5.5 0 1 0 1 0v-2.889a.5.5 0 0 0-.5-.5h-2.889a.5.5 0 0 0 0 1h1.482a6 6 0 0 1-2.426 1.565"},null,-1),bs=[fs];function As(e,s){return u(),C("svg",vs,bs)}const Cs=X(ys,[["render",As]]),xs={},ws={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",class:"persona-icon",viewBox:"0 0 24 24"},Ts=d("path",{fill:"currentColor","fill-rule":"evenodd",d:"M12 9.171a3.85 3.85 0 0 0-3.846 3.858A3.85 3.85 0 0 0 12 16.886a3.85 3.85 0 0 0 3.846-3.857A3.85 3.85 0 0 0 12 9.17M9.692 13.03A2.31 2.31 0 0 1 12 10.714a2.31 2.31 0 0 1 2.308 2.315A2.31 2.31 0 0 1 12 15.343a2.31 2.31 0 0 1-2.308-2.314","clip-rule":"evenodd"},null,-1),Fs=d("path",{fill:"currentColor","fill-rule":"evenodd",d:"M10.798 3c-.748 0-1.465.298-1.994.829l-2.25 2.257h-.708A3.85 3.85 0 0 0 2 9.943v7.2A3.85 3.85 0 0 0 5.846 21h12.308A3.85 3.85 0 0 0 22 17.143v-7.2a3.85 3.85 0 0 0-3.846-3.857h-.707l-2.251-2.258A2.82 2.82 0 0 0 13.202 3zm-.906 1.92a1.28 1.28 0 0 1 .906-.377h2.404c.34 0 .666.135.906.376l2.476 2.484c.145.144.34.226.544.226h1.026a2.31 2.31 0 0 1 2.308 2.314v7.2a2.31 2.31 0 0 1-2.308 2.314H5.846a2.31 2.31 0 0 1-2.307-2.314v-7.2a2.31 2.31 0 0 1 2.307-2.314h1.026c.204 0 .4-.082.544-.226z","clip-rule":"evenodd"},null,-1),Ps=[Ts,Fs];function Ss(e,s){return u(),C("svg",ws,Ps)}const G=X(xs,[["render",Ss]]),Ds={},qs={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",class:"persona-icon",viewBox:"0 0 24 24"},Bs=d("path",{fill:"currentColor",d:"M4.564 2.77a.77.77 0 0 0-1.538 0v4.102a.77.77 0 0 0 .769.769h4.102a.77.77 0 1 0 0-1.538H5.932a8.461 8.461 0 1 1-2.393 5.804.77.77 0 0 0-1.538-.017 10 10 0 1 0 2.563-6.576z"},null,-1),Is=[Bs];function Vs(e,s){return u(),C("svg",qs,Is)}const Ms=X(Ds,[["render",Vs]]),Rs="/design-system/assets/shutter.dnWqXwNU.wav";function H(e,s=!1){const t=document.createElement("canvas"),i=t.getContext("2d");return t.width=e.videoWidth,t.height=e.videoHeight,s?(i.save(),i.scale(-1,1),i.drawImage(e,0,0,t.width*-1,t.height),i.restore()):i.drawImage(e,0,0,t.width,t.height),t.toDataURL("image/jpeg")}const $s={meta:{facingMode:"environment"},run({video:e,meta:s,modifier:t}){const i=!!(s.value.mirror&&s.value.mirror!=="preview"),r=H(e.value,i),o=t.value.base64?r:Y(r);return{preview:r,result:o}}},Ns=["data-deviceid"],Os=[".srcObject"],Us=["src"],Hs={key:2,"data-testid":"camera-off",class:"camera__off-info"},Ls={class:"camera__mask-container"},js={key:0,"data-testid":"camera-mask",class:"camera__mask"},Qs={"data-testid":"camera-toast",class:"camera__toast-text"},Ys={class:"camera__controls"},Xs=["src","muted"],f=es({__name:"Camera",props:{modelValue:{type:[globalThis.File,String,Array],default:""},modelModifiers:{type:Object,default:()=>({})},mirror:{type:[Boolean,String],default:void 0},mask:{type:String,default:void 0},adapter:{type:Object,default:$s},facingMode:{type:String,default:void 0},silent:{type:Boolean,default:!1}},emits:["update:modelValue","result","change","start"],setup(e,{expose:s,emit:t}){const i=e,r=t,o=ps(i),p=as(i,"modelModifiers"),E=w(!1),n=w(!1),m=w(""),A=w(""),g=w(),k=w(),y=cs("camera",{controls:!0}),S=w(0),v=N(()=>Es({mirror:i.mirror,mask:i.mask,facingMode:i.facingMode},i.adapter.meta,{autoStart:!1})),{videoInputs:x}=ks({requestPermissions:!1,constraints:{video:{facingMode:v.value.facingMode}}}),q=N(()=>{var h,_;return(_=(h=x.value)==null?void 0:h.at(S.value))==null?void 0:_.deviceId}),V=N(()=>({video:{deviceId:q.value},audio:!1})),{stream:T,start:M,stop:R,enabled:F}=us({constraints:V}),$=N(()=>{const h=[];return v.value.mirror&&h.push("camera--mirror"),v.value.mask?h.push(`camera__mask--${v.value.mask}`):h.push("camera__mask--none"),h});async function B(){var h;y.state.value==="denied"&&await K({title:"Camera Access Blocked",text:"Privy need to access your internal camera to process this journey",confirm:{text:"Ok"},footerAlign:"end"}),y.state.value==="prompt"&&await K({title:"Camera Access Required",text:"Privy need to access your internal camera to process this journey",confirm:{text:"Ok"},footerAlign:"end"}),await M(),typeof((h=k.value)==null?void 0:h.play)=="function"&&await k.value.play()}function z(){S.value=(S.value+1)%x.value.length}function L(h){A.value=h}async function j(){var _;E.value=!0;const h=await i.adapter.run({video:k,toast:L,stream:T,meta:v,modifier:p});m.value=h.preview,o.value=h.result,n.value=!0,E.value=!1,F.value=!1,r("result",h.result),r("change",h.result),typeof((_=g.value)==null?void 0:_.play)=="function"&&g.value.play()}async function W(){F.value=!0,n.value=!1,m.value="",A.value=""}function ss(){r("start",T.value),v.value.autoStart&&j()}return ts(async()=>{y.isSupported&&(await ms(y.state).not.toBeUndefined(),await B())}),is(()=>{R()}),s({take:j,retake:W,toast:L,toggle:z}),(h,_)=>ns((u(),C("div",{class:os(["camera",a($)]),"data-testid":"camera","data-deviceid":a(q)},[a(T)?(u(),C("video",{key:0,ref_key:"video",ref:k,"data-testid":"camera-video",".srcObject":a(T),class:"camera__video",autoplay:"",muted:"",playsinline:"",onPlay:ss},null,40,Os)):I("",!0),a(n)&&!a(T)?(u(),C("img",{key:1,"data-testid":"camera-result",class:"camera__result",src:a(m),alt:"camera-result"},null,8,Us)):I("",!0),!a(F)&&!a(n)?(u(),C("span",Hs," Camera is off ")):I("",!0),d("div",Ls,[a(n)?I("",!0):(u(),C("div",js))]),l(ls,{name:"slide-up"},{default:c(()=>[a(A)?(u(),C("div",{key:a(A),class:"camera__toast"},[d("div",Qs,Q(a(A)),1)])):I("",!0)]),_:1}),d("div",Ys,[a(x).length>1&&!a(n)?(u(),O(U,{key:0,"data-testid":"camera-toggle",color:"danger",size:"sm",icon:"",pill:"",onClick:z},{default:c(()=>[l(Cs)]),_:1})):I("",!0),!a(F)&&!a(n)?(u(),O(U,{key:1,"data-testid":"camera-turn-on",class:"camera__main-control",color:"danger",icon:"",pill:"",onClick:_[0]||(_[0]=Z=>B())},{default:c(()=>[l(G)]),_:1})):a(F)&&!a(n)?(u(),O(U,{key:2,"data-testid":"camera-take",class:"camera__main-control",color:"danger",icon:"",pill:"",disabled:a(E),onClick:_[1]||(_[1]=Z=>j())},{default:c(()=>[l(G)]),_:1},8,["disabled"])):(u(),O(U,{key:3,"data-testid":"camera-retake",class:"camera__main-control",color:"danger",icon:"",pill:"",onClick:_[2]||(_[2]=Z=>W())},{default:c(()=>[l(Ms)]),_:1}))]),d("audio",{ref_key:"shutter",ref:g,src:a(Rs),muted:e.silent},null,8,Xs),rs(h.$slots,"default",{cameras:a(x),preview:a(m),stream:a(T),video:a(k),shutter:a(g),toast:L})],10,Ns)),[[a(gs),4/3,void 0,{fixed:!0}]])}}),zs=40,Ws=15,P=160;function Zs(e,s){const t=e.getContext("2d",{willReadFrequently:!0});return t.drawImage(s,s.videoWidth/2-P,s.videoHeight/2-P,P,P,0,0,P,P),t.getImageData(0,0,e.width,e.height)}function Js(e){const s=e.width/2,t=e.height/2,i=e.width/4,r=e.height/4,o=s-i/2,p=t-r/2,E=new Uint8ClampedArray(i*r),n={centerX:s,centerY:t,width:i,height:r,xPos:o,yPos:p,buffer:E},m=e.data;let A=0;for(let g=n.yPos;g<n.yPos+n.height;g++){let k=g*e.width*4+n.xPos*4+1;for(let y=n.xPos;y<n.xPos+n.width;y++)n.buffer[A++]=m[k],k+=4}return n}function Ks(e,s){let t=0,i=0,r=0;const o=e.width/4,p=e.height/4,E=e.data;for(let v=s.centerY-p;v<=s.centerY+p-s.height;v++)for(let x=s.centerX-o;x<=s.centerX+o-s.width;x++){let q=0,V=0,T=0;for(let R=0;R<s.height;R++){let F=x*4+1+(v+R)*e.width*4;for(let $=0;$<s.width;$++){const B=E[F];q+=s.buffer[T++]*B,V+=B*B,F+=4}}let M=0;V>0&&(M=q*q/V),M>r&&(r=M,t=x,i=v)}const n=t-s.xPos,m=i-s.yPos,A=Math.hypot(n,m),g=o-s.width/2,k=p-s.height/2,y=Math.hypot(g,k);let S=A/y*100;return S>100&&(S=100),S}const Gs={meta:{mask:"round",mirror:!0,facingMode:"user"},async run({video:e,toast:s,meta:t,modifier:i}){return await new Promise(r=>{const o=!!(t.value.mirror&&t.value.mirror!=="preview"),p=H(e.value,o),E=document.createElement("canvas");E.width=P,E.height=P;let n;const m=setInterval(function(){if(e.value){const g=Zs(E,e.value);if(!n)n=Js(g);else if(Ks(g,n)>zs){const k=H(e.value,o),y=i.value.base64?[k,p]:[Y(k),Y(p)];clearInterval(m),s(""),r({preview:k,result:y})}}},1e3/Ws);s("Move your head slowly. Your photo will be taken automatically")})}},se={meta:{mask:"square",facingMode:"environment",autoStart:!0},async run({video:e,toast:s,meta:t}){const i=!!(t.value.mirror&&t.value.mirror!=="preview"),{BrowserQRCodeReader:r}=await ds(async()=>{const{BrowserQRCodeReader:m}=await import("./chunks/index.BLK68x_E.js");return{BrowserQRCodeReader:m}},[]),p=await new r().decodeOnceFromVideoElement(e.value),E=H(e.value,i),n=p.getText();return s(n),{preview:E,result:n}}},ee=b("",4),ae=b("",3),te=b("",3),ie=b("",3),ne=b("",3),le=b("",3),re=b("",3),oe=b("",3),de=b("",2),he={class:"truncate"},pe=d("h3",{id:"encode-to-base64",tabindex:"-1"},[D("Encode to base64 "),d("a",{class:"header-anchor",href:"#encode-to-base64","aria-label":'Permalink to "Encode to base64"'},"​")],-1),ce=d("p",null,[D("You can add modifier "),d("code",null,"base64"),D(" to your "),d("code",null,"v-model"),D(", it's enforce result to "),d("a",{href:"https://en.wikipedia.org/wiki/Data_URI_scheme",target:"_blank",rel:"noreferrer"},"base64-dataURI"),D(".")],-1),ke=d("b",null,"Note!",-1),ue=d("code",null,"v-model.base64",-1),Ee=b("",2),ge={class:"truncate"},me=b("",7),We=JSON.parse(`{"title":"Camera · Components","description":"Take picture from user's camera","frontmatter":{"title":"Camera · Components","description":"Take picture from user's camera"},"headers":[],"relativePath":"components/camera/index.md","filePath":"components/camera/index.md"}`),_e={name:"components/camera/index.md"},Ze=Object.assign(_e,{setup(e){const s=w(),t=w();return(i,r)=>{const o=hs("preview");return u(),C("div",null,[ee,l(o,{class:"flex-col"},{default:c(()=>[l(f)]),_:1}),ae,l(o,{class:"flex-col"},{default:c(()=>[l(f,{mirror:""})]),_:1}),te,l(o,{class:"flex-col"},{default:c(()=>[l(f,{mirror:"preview"})]),_:1}),ie,l(o,{class:"flex-col space-y-2"},{default:c(()=>[l(f,{mask:"square"}),l(f,{mask:"round"}),l(f,{mask:"card"})]),_:1}),ne,l(o,{class:"flex-col"},{default:c(()=>[l(f,{silent:""})]),_:1}),le,l(o,{class:"flex-col space-y-2"},{default:c(()=>[l(f,{adapter:a(Gs)},null,8,["adapter"])]),_:1}),re,l(o,{class:"flex-col space-y-2"},{default:c(()=>[l(f,{adapter:a(se)},null,8,["adapter"])]),_:1}),oe,l(o,{class:"flex-col"},{default:c(()=>[l(f,{modelValue:a(s),"onUpdate:modelValue":r[0]||(r[0]=p=>J(s)?s.value=p:null)},null,8,["modelValue"])]),_:1}),de,d("pre",he,[d("code",null,Q(a(s)),1)]),pe,ce,l(_s,{dismissable:!1},{default:c(()=>[ke,D(),ue,D(" on QRCodeAdapter has no effect, the result will always original scanned text. ")]),_:1}),l(o,{class:"flex-col"},{default:c(()=>[l(f,{modelValue:a(t),"onUpdate:modelValue":r[1]||(r[1]=p=>J(t)?t.value=p:null),modelModifiers:{base64:!0}},null,8,["modelValue"])]),_:1}),Ee,d("pre",ge,[d("code",null,Q(a(t)),1)]),me])}}});export{We as __pageData,Ze as default};
